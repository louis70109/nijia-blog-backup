{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/uploads/avatar.jpg","path":"uploads/avatar.jpg","modified":0,"renderable":0},{"_id":"source/diagrams/src/diagrams.wsd","path":"diagrams/src/diagrams.wsd","modified":0,"renderable":0},{"_id":"source/diagrams/src/http_request.wsd","path":"diagrams/src/http_request.wsd","modified":0,"renderable":0},{"_id":"source/diagrams/src/three_way_handshake.wsd","path":"diagrams/src/three_way_handshake.wsd","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"source/diagrams/out/http_request/http_request.png","path":"diagrams/out/http_request/http_request.png","modified":0,"renderable":0},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"c3b182ff582ab602256a9314c80cf31d9c059ae7","modified":1571212337000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1571190048000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1571190048000},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1571190048000},{"_id":"themes/next/.gitignore","hash":"0b5c2ffd41f66eb1849d6426ba8cf9649eeed329","modified":1571190048000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1571190048000},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1571190048000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1571190048000},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1571190048000},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1571190048000},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1571190048000},{"_id":"themes/next/README.cn.md","hash":"263b74f1ac7c0f6f9424b8cced4b0b320ae61efc","modified":1571190048000},{"_id":"themes/next/README.md","hash":"287c7e6b7a6ddf75d815dda0df8bd228e3f285c5","modified":1571190048000},{"_id":"themes/next/_config.yml","hash":"1c6785e1d70a2df0f311d067fdae24064ba41eb0","modified":1591000593917},{"_id":"themes/next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1571190048000},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1571190048000},{"_id":"themes/next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1571190048000},{"_id":"source/Privacy-Policy/index.md","hash":"34c789927afb3bd567280fccfa3b2c55299afc62","modified":1571392055000},{"_id":"source/_drafts/ recap－serverless.md","hash":"0cdaec57086173156307ff829fe4bbd20aa0892b","modified":1592575438824},{"_id":"source/_drafts/2020-春轉夏的個人檢視.md","hash":"1ff5d28d82103d5a74a75a3e97138c53fd46227b","modified":1592575438823},{"_id":"source/_drafts/using-graceful-shutdown-in-python.md","hash":"32c295c0344536dd74296551ead45abcb8db7f21","modified":1592938487182},{"_id":"source/_drafts/【Mac】使用OBS-SoundFlower讓直播上Youtube.md","hash":"cf0e507ce608800621c659bff8c5c4358b199a07","modified":1592575438827},{"_id":"source/_posts/2020-01-10-的mur-mur.md","hash":"f42bff13ab51e89c365e324e25b476c7e64b43a5","modified":1592575438826},{"_id":"source/_posts/2020-Q1最近的學習紀錄.md","hash":"b74ad786775caa7f1355f619223415e44f47ce6e","modified":1592575438827},{"_id":"source/_posts/Armeria-A-Microservice-Framework-Well-suited-Everywhere.md","hash":"13107dc57abe9b3f00225cc73b3260719c272c1e","modified":1592575438830},{"_id":"source/_posts/Bottender-x-Dialogflow-x-LINE.md","hash":"16ab12e559651a87eee6d6df60b56620edd9aca9","modified":1592575438828},{"_id":"source/_posts/Chatbot-meetup-12-心得分享-2019-09-17.md","hash":"9b7ffbe49505c5197a7107282cc154aeffbeb284","modified":1592575438832},{"_id":"source/_posts/Day1-serverless-介紹.md","hash":"09d93074ce15231247aef66da0f1d8ce6830a236","modified":1592576497640},{"_id":"source/_posts/Day10-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-1-介紹.md","hash":"92ead1d44b04ae114c5c63ba62e228ff99bb4f3a","modified":1592575438831},{"_id":"source/_posts/Day11-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-2-申請一步步.md","hash":"d36a2a75d99d2172a10f3fb861a00a484ecf8620","modified":1592575438833},{"_id":"source/_posts/Day12-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-3-應聲蟲實作.md","hash":"e6dcd406bc59126c48ae385026c318be80e0a7e6","modified":1592575438837},{"_id":"source/_posts/Day13-試玩-python-SDK.md","hash":"a62bc05aa35cd49431cb8ada8ac1d7514b972a0c","modified":1592575438837},{"_id":"source/_posts/Day14-LINE-Richmenu-介紹.md","hash":"1696c908864c5cffa2a8010d7b36bac6b31ef58f","modified":1592575438834},{"_id":"source/_posts/Day15-串接-LINE-Richmenu-API.md","hash":"f1619b3119ef7956164f6b3a1627f7fa645ed56b","modified":1592575438838},{"_id":"source/_posts/Day16-實作一個上下頁的-richmenu.md","hash":"34acd57b2ab96dc81a22f6359e31ee78f732ccfc","modified":1592575438838},{"_id":"source/_posts/Day17-看一下自己寫的東西都去哪了.md","hash":"c1cee121a1c172220dad53e4cb1d0e0a504f63f1","modified":1592575438835},{"_id":"source/_posts/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧.md","hash":"be055388a827bd733744405b0aed9a6cc54733c1","modified":1592575438836},{"_id":"source/_posts/Day19-LINE-LOGIN-介紹.md","hash":"f2d78f72ad2b64cdc9e5843d9d590d8ab7f46b1c","modified":1592575438839},{"_id":"source/_posts/Day2-安裝並使用 wsgi & flask 建立第一個 Serverless 的專案.md","hash":"ac23a43f9eb4318b4e175b1c3f620140cbc53295","modified":1592576492955},{"_id":"source/_posts/Day20-LINE-Login-申請與基本頁面.md","hash":"1731b3c5a34d2839cb2dfa8bcf34b5b600d9c68c","modified":1592575438839},{"_id":"source/_posts/Day21-LINE-Login-實作.md","hash":"43212c44fb560648149fcb796963cba46ce543a7","modified":1592575438841},{"_id":"source/_posts/Day22-最常用的搭配-使用-Login-Message-API-讓使用者在掃描加入好友時就綁定帳號.md","hash":"31b889b148d5753d4bd5a02ad070e2f3c2a82284","modified":1592575438840},{"_id":"source/_posts/Day23-LIFF-LINE-Front-end-Framework-簡介.md","hash":"069df08c885b499ec7f32250feb4e25eaad35a0d","modified":1592575438841},{"_id":"source/_posts/Day24-簡單使用-LINE-LIFF-API.md","hash":"1c25fd7fe2aed5c71d670f1990a6503bb89d3d08","modified":1592575438843},{"_id":"source/_posts/Day25-Lambda-好像有時候一開始回應很久？用-warm-up-來熱機吧.md","hash":"b2adfca9efdc297cc1095f11a775ae22b35a94e4","modified":1592575438842},{"_id":"source/_posts/Day26-Use-CDN-1-建立-Certificate-與-Domain.md","hash":"6bb1df1cd9a2a9c4da0519c4e61bc3869f25406e","modified":1592575438843},{"_id":"source/_posts/Day27-Use-CDN-2-CloudFront.md","hash":"bd90827b2d57af62aa43a21b53ea2cfe82d81423","modified":1592575438844},{"_id":"source/_posts/Day28-用-S3-幫忙轉址到原有的服務上.md","hash":"726c338c2ade0331eaf1143a6b1860060daed3bc","modified":1592575438845},{"_id":"source/_posts/Day29-LINE-API-的使用心得.md","hash":"82848631dcb2fddcda4cb6e5ca6d4ea174cc3475","modified":1592575438846},{"_id":"source/_posts/Day3-LINE-Notify-介紹.md","hash":"0eff76fb771be1b9d4feece272a8af29dd10dffd","modified":1592575438854},{"_id":"source/_posts/Day30-老是在吹-Serverless，他真的有那麼好？.md","hash":"1b389ffe792af105e6e561fec7ded6e64a88ca3a","modified":1592575438848},{"_id":"source/_posts/Day4-認識與使用-S3-容器.md","hash":"cb0fb10de72fb888651b98709a93713e09eec63f","modified":1592575438847},{"_id":"source/_posts/Day5-做一個與-LINE-Notify-連動的服務.md","hash":"103a276dd96058865b1c1399c693ae61b9c5165e","modified":1592575438849},{"_id":"source/_posts/Day6-建立一個使用-Query-string-來幫忙發送的-LINE-Notify.md","hash":"27ce20526b42eb69bdf3a21a4216cae37e31ed36","modified":1592575438850},{"_id":"source/_posts/Day7-在-serverless-裡使用環境變數讓這些-key-好管理.md","hash":"25ab372bb371b7ea0f753812b10222ebc68ca632","modified":1592575438852},{"_id":"source/_posts/Day8-SQS-簡單介紹-建立.md","hash":"3f30af99687bed54a4337751e43d66fc7094b3ea","modified":1592575438851},{"_id":"source/_posts/Day9-SQS-串接-Notify-實作！.md","hash":"fcb1955e9b80fe13fa73bf68bf0e14752301a305","modified":1592575438853},{"_id":"source/_posts/Docker-Mysql-PHPMyadmin-映射-連接方法.md","hash":"fe5b26fd85504ed11c37430df3d2fb60fc4f1177","modified":1592575438854},{"_id":"source/_posts/How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality.md","hash":"88667bef45fb435ba646f140ec7e993c8a3dabc6","modified":1592575438856},{"_id":"source/_posts/LINE-Flex-message-LIFF-Richmenu-Provider.md","hash":"d1893b1b097bef0c279682ecaf94d9c9f7bcaf6a","modified":1592579626238},{"_id":"source/_posts/LINE-new-API-Icon-Switch.md","hash":"71e480b0820e9f1686a9bc1572b9edfa1a78ef8a","modified":1592575438855},{"_id":"source/_posts/Python-operator.md","hash":"afb869a95ab54924bd24e4ea267f7670e8347260","modified":1592575438857},{"_id":"source/_posts/Seamless-device-migration-using-LINE-secure-backup.md","hash":"d28edb5e70cce11861eff23650acc4ccb3102f8a","modified":1592575438858},{"_id":"source/_posts/Streamlabs-Youtube-streaming.md","hash":"ea2bfa4bf04ea86e44fb7366ef270d826ea08ffb","modified":1592579553742},{"_id":"source/_posts/Twich-chatroom-IRC.md","hash":"e6e5b725c017618c01f154fe5b5fe7f42a82f616","modified":1592575438862},{"_id":"source/_posts/Twitch-Bot-全面升級！.md","hash":"db587516935908dcf418ade28b267f9caf2abfb8","modified":1592575438859},{"_id":"source/_posts/Typescript-的怪異之處-文章簡評.md","hash":"76a9510b43be2ef33e1ccfc53106cecdd99d97ed","modified":1592575438861},{"_id":"source/_posts/chatbot-13.md","hash":"ae049bef7ea32873f76269884c8a504938077bf1","modified":1592575438860},{"_id":"source/_posts/chatbot-meetup-2019Q4.md","hash":"a291fdbbd0d2668ba199b38d837f2fbd925ea935","modified":1592575438863},{"_id":"source/_posts/chatbot-meetups-20-sharing.md","hash":"ff0855b250468b1be367e202a9d4ba1640750a1f","modified":1593014275783},{"_id":"source/_posts/create-plant-uml-in-hexo.md","hash":"199ec3e2c5640bd6957eda5b36ce302bb5bdab0a","modified":1592758509753},{"_id":"source/_posts/learn-docker-with-twitch-bot.md","hash":"d99b5e9299900e5a06bcf15ca943300183bcdf34","modified":1592575438862},{"_id":"source/_posts/learn-javascript-promise.md","hash":"fbabaeb95007f620a5d59431c6e1ba5335f82e19","modified":1592579585205},{"_id":"source/_posts/node-gyp-rebuild-error.md","hash":"6daf07c2564fedf4fdc4e1658bfbd6c8793527df","modified":1592575438864},{"_id":"source/_posts/python-class-instance-level-diff.md","hash":"c74c90a87884acd4e79fa7dd757ea58114d9543f","modified":1592579657809},{"_id":"source/_posts/sentry-in-serverless.md","hash":"f16911c1ee01f3407e4c9437140b636598364b18","modified":1592575438865},{"_id":"source/_posts/serverless-cold-start.md","hash":"c1a07c59fff4d02a4118393f120ec442513ee951","modified":1592575438865},{"_id":"source/_posts/welcome-line-api-expert.md","hash":"c125a6a6e8f4ae801a3ddb3e86bc1454de51ec52","modified":1592575438867},{"_id":"source/_posts/why-i-need-lint.md","hash":"caababe29bc7912551cc7576c2b3c3c71c487a71","modified":1592758209321},{"_id":"source/_posts/【AWS】使用-API-Gateway-Authorizer-做使用者驗證-feat-Serverless.md","hash":"b9c5cb20f6a23715a99401bbcc9d8fe3e02a0e14","modified":1592575438870},{"_id":"source/_posts/【SQL】如何在-pgAdmin-上使用-DDL-快速初始化資料表.md","hash":"552082a20f2bf04dc17300f46183ae3e3c614f6f","modified":1592575438873},{"_id":"source/_posts/【觀察系列-01】我認知的社群生態.md","hash":"0b002917ec1eeeff6417b358fea9a110646154ab","modified":1592575438875},{"_id":"source/_posts/使用-Serverless-Flask-Swagger-在-AWS-上搭建打造-Open-API.md","hash":"43bc74971432dc98562cf54d64e7806f3d481d69","modified":1592575438872},{"_id":"source/_posts/使用-Serverless-Line-Message-API-在-AWS-上打造一個-Echo-bot.md","hash":"f074b91dc350896b763e5d450a9f8036699ea2de","modified":1592576544339},{"_id":"source/_posts/如何建立一個跨平台的Twitch機器人.md","hash":"66b2079e20e3a7716f3dd2e61e25c69347f3602b","modified":1592576423117},{"_id":"source/_posts/第一次寫-python-套件的實戰全記錄.md","hash":"41c478e47702ded55292b93cb0311e445c979e29","modified":1592575438876},{"_id":"source/_posts/從-Http-請求到認識-OAuth-以及-OpenID.md","hash":"b791cb1fabae817b082cdcbc7aaa0c05233f8374","modified":1592575438880},{"_id":"source/_posts/續篇-—-serverless-WSGI-flask-chatbot-的開發指南.md","hash":"5ee5f28aec4187f55ad1006b7e4c503409ecdfaa","modified":1592576513213},{"_id":"source/_posts/鐵人賽-文章列表.md","hash":"c63c85081a2512d0c72944bafaf4b2664c296f71","modified":1592575438879},{"_id":"source/about/index.md","hash":"42f9daa32c66101635a88861fba9e38503662acb","modified":1591537597794},{"_id":"source/categories/index.md","hash":"c0c29b8beccc9876c9805050aaaa9ae98869caa3","modified":1571232231000},{"_id":"source/tags/index.md","hash":"304828ddf4aa3812fb4a9e7ed23aa87fafff1fe5","modified":1571232200000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1571190048000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"50d48c47162817a3810a9d9ad51104e83947419a","modified":1571190048000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"902f627155a65099e0a37842ff396a58d0dc306f","modified":1571190048000},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1571190048000},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1571190048000},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1571190048000},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1571190048000},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1571190048000},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1571190048000},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1571190048000},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1571190048000},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1571190048000},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1571190048000},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1571190048000},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1571190048000},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1571190048000},{"_id":"themes/next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1571190048000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1571190048000},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1571190048000},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1571190048000},{"_id":"themes/next/layout/_layout.swig","hash":"da0929166674ea637e0ad454f85ad0d7bac4aff2","modified":1571190048000},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1571190048000},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1571190048000},{"_id":"themes/next/layout/index.swig","hash":"aa2b6b51464f749d31871cfef969e55dd882eb4e","modified":1571205679000},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1571190048000},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1571190048000},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1571190048000},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1571190048000},{"_id":"themes/next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1571190048000},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1571190048000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1571190048000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1571190048000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1571190048000},{"_id":"source/uploads/avatar.jpg","hash":"81ff05e48535b3b77b933b8a2cdd7d97bfefa7cd","modified":1571212463000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"source/diagrams/src/diagrams.wsd","hash":"08cedb09d1279a475a939114644b1f49b8ce44c8","modified":1592392507293},{"_id":"source/diagrams/src/http_request.wsd","hash":"91103484a776fb19cba4afe1b074d799f911822b","modified":1590998861344},{"_id":"source/diagrams/src/three_way_handshake.wsd","hash":"afd0ce1692ca0b78565e359b6ce737e25c46ac38","modified":1591028200290},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1571190048000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1571190048000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1571190048000},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1571190048000},{"_id":"themes/next/layout/_macro/post.swig","hash":"446a35a2cd389f8cfc3aa38973a9b44ad0740134","modified":1571190048000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1571190048000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"6a54c3c85ff6b19d275827a327abbf4bd99b2ebf","modified":1571190048000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1571190048000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1571190048000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"c4d6181f5d3db5365e622f78714af8cc58d7a45e","modified":1571190048000},{"_id":"themes/next/layout/_partials/head.swig","hash":"6b94fe8f3279daea5623c49ef4bb35917ba57510","modified":1571190048000},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1571190048000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1571190048000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1571190048000},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1571190048000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1571190048000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1571190048000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1571190048000},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1571190048000},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1571190048000},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1571190048000},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1571190048000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1571190048000},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1571190048000},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1571190048000},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1571190048000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1571190048000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1571190048000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1571190048000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1571190048000},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1571190048000},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1571190048000},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1571190048000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1571190048000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1571190048000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1571190048000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1571190048000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1571190048000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1571190048000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1571190048000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1571190048000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1571190048000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1571190048000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1571190048000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1571190048000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1571190048000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1571190048000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1571190048000},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1571190048000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1571190048000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1571190048000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1571190048000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1571190048000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1571190048000},{"_id":"source/diagrams/out/http_request/http_request.png","hash":"7d55530c44cae29666d6f5d64ca95699355ed89e","modified":1590998866979},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1571190048000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1571190048000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1571190048000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1571190048000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1571190048000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1571190048000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1571190048000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1571190048000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1571190048000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1571190048000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1571190048000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1571190048000},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1571190048000},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1571190048000},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1571190048000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1571190048000},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1571190048000},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1571190048000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1571190048000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1571190048000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1571190048000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1571190048000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1571190048000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"edd3a938c2b45c84fff9d4d4f71210023e76e7d5","modified":1580987848000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1571190048000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1571190048000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1571190048000},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1571190048000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1571190048000},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1571190048000},{"_id":"themes/next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1571190048000},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1571190048000},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1571190048000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1571190048000},{"_id":"themes/next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1571190048000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1571190048000},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1571190048000},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1571190048000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1571190048000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1571190048000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1571190048000},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1571190048000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1571190048000},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1571190048000},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1571190048000},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1571190048000},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1571190048000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1571190048000},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1571190048000},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1571190048000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1571190048000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4aac01962520d60b03b23022ab601ad4bd19c08c","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9d16fa3c14ed76b71229f022b63a02fd0f580958","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1571190048000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1571190048000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1571190048000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1571190048000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1571190048000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1571190048000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1571190048000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1571190048000},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1571190048000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1571190048000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1571190048000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1571190048000},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1571190048000},{"_id":"public/search.xml","hash":"9b5920b8d89e6b2ba90361f36dd1cb12233f2d82","modified":1593062179386},{"_id":"public/atom.xml","hash":"858bdb8208d3bd6f7d6c75026cac8b57eecf0779","modified":1593062179422},{"_id":"public/sitemap.xml","hash":"8d67d7145d35e9489a7c64f075ac6ca6b55bfd19","modified":1593062179424},{"_id":"public/Privacy-Policy/index.html","hash":"cbed0af548882e076733230626325b48deca0b2e","modified":1593062179504},{"_id":"public/about/index.html","hash":"9ed9a44406e03c80375712f191bc51564bb1e4f4","modified":1593062179504},{"_id":"public/categories/index.html","hash":"d5cf184b96ab24c58187907f4aa77467d86bc952","modified":1593062179504},{"_id":"public/tags/index.html","hash":"c99bb792286d66477983693bb411221a58f0635e","modified":1593062179504},{"_id":"public/2020/06/24/chatbot-meetups-20-sharing/index.html","hash":"c960aee3adcbf357fa3549eb12e626c655ccc0b9","modified":1593062179505},{"_id":"public/2020/06/22/why-i-need-lint/index.html","hash":"8037e216523f88a5c1e5773281b7d98b0fe94f5c","modified":1593062179505},{"_id":"public/2020/06/17/python-class-instance-level-diff/index.html","hash":"f6448ba2fc31e4d4c0c953dc37fa8736a1a0aac3","modified":1593062179505},{"_id":"public/2020/06/13/learn-javascript-promise/index.html","hash":"a5d6fb9f274f407a25d39577211dbc23185cc81b","modified":1593062179505},{"_id":"public/2020/06/12/【觀察系列-01】我認知的社群生態/index.html","hash":"47ea1dc8d6bbe8085a6abc13cfaa682cf7cb5e69","modified":1593062179505},{"_id":"public/2020/06/06/【SQL】如何在-pgAdmin-上使用-DDL-快速初始化資料表/index.html","hash":"5daec91a8e7c994a3af8f659137acf26cf089885","modified":1593062179505},{"_id":"public/2020/06/03/create-plant-uml-in-hexo/index.html","hash":"6411b54493b19776254d26bb98e04216d9492396","modified":1593062179505},{"_id":"public/2020/06/01/從-Http-請求到認識-OAuth-以及-OpenID/index.html","hash":"013e5536004cdbf9fe2bfa7c079a7715612d5deb","modified":1593062179505},{"_id":"public/2020/05/05/使用-Serverless-Flask-Swagger-在-AWS-上搭建打造-Open-API/index.html","hash":"11e340191633dea92a2d7679f18fce63e5ec26d0","modified":1593062179505},{"_id":"public/2020/05/03/第一次寫-python-套件的實戰全記錄/index.html","hash":"795e82e35bdf0bacf772cec0531eb5d50c976b6f","modified":1593062179505},{"_id":"public/2020/04/19/【AWS】使用-API-Gateway-Authorizer-做使用者驗證-feat-Serverless/index.html","hash":"8ede4e2af116d61c914af28ef8a36b2afe3cb95f","modified":1593062179506},{"_id":"public/2020/04/11/LINE-Flex-message-LIFF-Richmenu-Provider/index.html","hash":"486046902e2b5a86ca4f0db36aa988c6daf89952","modified":1593062179506},{"_id":"public/2020/03/28/LINE-new-API-Icon-Switch/index.html","hash":"341f534d69e51dc4d7e4a81a8c93ff4ea40cba85","modified":1593062179506},{"_id":"public/2020/03/21/Typescript-的怪異之處-文章簡評/index.html","hash":"cf8f947d881f0e44a6e2685a849be111021dbf37","modified":1593062179506},{"_id":"public/2020/03/21/Streamlabs-Youtube-streaming/index.html","hash":"78421f83ea2699cfcb6fc62fcfc1b2031ee790fa","modified":1593062179506},{"_id":"public/2020/03/09/Twitch-Bot-全面升級！/index.html","hash":"483120651d536df55103bfd3ed0c6e940b2e69bc","modified":1593062179506},{"_id":"public/2020/02/16/serverless-cold-start/index.html","hash":"09bc3ab5ba5d81f7941071fe29699bc32e075312","modified":1593062179506},{"_id":"public/2020/02/08/2020-Q1最近的學習紀錄/index.html","hash":"a009ff5c3d0a953dbf9d3221ae46145d7fd84ca2","modified":1593062179506},{"_id":"public/2020/02/02/node-gyp-rebuild-error/index.html","hash":"32ff98da79cedfc3be28a7fc99cbbc32d4912a86","modified":1593062179506},{"_id":"public/2020/01/27/learn-docker-with-twitch-bot/index.html","hash":"8f8213f17543e3b66dcb9d74652dbc08427a086f","modified":1593062179506},{"_id":"public/2020/01/12/如何建立一個跨平台的Twitch機器人/index.html","hash":"3e1f09bad24cd75c5daaa6fd9225bfde61fcd7e0","modified":1593062179506},{"_id":"public/2020/01/10/2020-01-10-的mur-mur/index.html","hash":"2dec1f3380759c2a2ae7e6348088282431b08132","modified":1593062179507},{"_id":"public/2020/01/07/Python-operator/index.html","hash":"4d0773c040ef0831445ee31e4b643d8019e1706a","modified":1593062179507},{"_id":"public/2019/12/24/Twich-chatroom-IRC/index.html","hash":"d138262991392929781eec89ba069010bae3386f","modified":1593062179507},{"_id":"public/2019/12/22/chatbot-meetup-2019Q4/index.html","hash":"723b5116817b5e4646bb4b5187ce86598e2778e1","modified":1593062179507},{"_id":"public/2019/12/10/Bottender-x-Dialogflow-x-LINE/index.html","hash":"f1481c371da48a1ea47ecef0ddc57fa6588cd2ae","modified":1593062179507},{"_id":"public/2019/12/01/Armeria-A-Microservice-Framework-Well-suited-Everywhere/index.html","hash":"71811a4f86eec92de5278abe5fe2ddffae4d5222","modified":1593062179507},{"_id":"public/2019/11/22/How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality/index.html","hash":"57edb48ced47bcec06ad67a310ec8c62aa8350d9","modified":1593062179507},{"_id":"public/2019/11/21/Seamless-device-migration-using-LINE-secure-backup/index.html","hash":"2d61a7023e918693803d24fa392b80e0937d9ebd","modified":1593062179507},{"_id":"public/2019/11/12/sentry-in-serverless/index.html","hash":"0bde1a0a776f0a2dc9475489e8e3b0673e9683af","modified":1593062179507},{"_id":"public/2019/11/02/續篇-—-serverless-WSGI-flask-chatbot-的開發指南/index.html","hash":"ce4a26d5c1f7c5f307cc53064ed9d4119e4b3454","modified":1593062179508},{"_id":"public/2019/10/31/使用-Serverless-Line-Message-API-在-AWS-上打造一個-Echo-bot/index.html","hash":"3bfcdf66ae4b4fd223b2f5a82d22abff19bd848b","modified":1593062179508},{"_id":"public/2019/10/25/chatbot-13/index.html","hash":"a48e2f940999c723febf987e73227c670a2d0ec3","modified":1593062179508},{"_id":"public/2019/10/20/鐵人賽-文章列表/index.html","hash":"d69f2deaf05cab856ffccb37275f39ed3d4c59c8","modified":1593062179508},{"_id":"public/2019/10/16/Docker-Mysql-PHPMyadmin-映射-連接方法/index.html","hash":"637634a5cca9f8809a38bf0d1b066030f97e0bab","modified":1593062179508},{"_id":"public/2019/10/14/Day30-老是在吹-Serverless，他真的有那麼好？/index.html","hash":"ab15cf2ca969f72f335735c6563c557b61da6e32","modified":1593062179508},{"_id":"public/2019/10/13/Day29-LINE-API-的使用心得/index.html","hash":"d5f3eac1eacaffd77b477ecf3378a8bcd7a17f6a","modified":1593062179508},{"_id":"public/2019/10/12/Day28-用-S3-幫忙轉址到原有的服務上/index.html","hash":"630de0900c5c79cfdb2ac022da10649ff6bad597","modified":1593062179508},{"_id":"public/2019/10/11/Day27-Use-CDN-2-CloudFront/index.html","hash":"a48a5ca9218607f497b735678c70a14330213f07","modified":1593062179508},{"_id":"public/2019/10/10/Day26-Use-CDN-1-建立-Certificate-與-Domain/index.html","hash":"fb6af55f387d7c55f438247196d7bf2f0f7685c6","modified":1593062179508},{"_id":"public/2019/10/10/welcome-line-api-expert/index.html","hash":"2fb61a67553e47c88556f3b996fb33dbb50af913","modified":1593062179508},{"_id":"public/2019/10/09/Day25-Lambda-好像有時候一開始回應很久？用-warm-up-來熱機吧/index.html","hash":"5f00a1617a4e0ad5cc7b9d0a488a1717a61fa249","modified":1593062179509},{"_id":"public/2019/10/08/Day24-簡單使用-LINE-LIFF-API/index.html","hash":"44eb1227bc540443278786afe7fa5cf5d21438de","modified":1593062179509},{"_id":"public/2019/10/07/Day23-LIFF-LINE-Front-end-Framework-簡介/index.html","hash":"72a31c7c028f84a8d324f26dd183bb9038a48ff0","modified":1593062179509},{"_id":"public/2019/10/06/Day22-最常用的搭配-使用-Login-Message-API-讓使用者在掃描加入好友時就綁定帳號/index.html","hash":"ff1aa26ad8901be979c6cb989dc1d924ed8f11bf","modified":1593062179509},{"_id":"public/2019/10/05/Day21-LINE-Login-實作/index.html","hash":"748bf94fef7cd8e7d3a6bd888c21cae562082ca2","modified":1593062179509},{"_id":"public/2019/10/04/Day20-LINE-Login-申請與基本頁面/index.html","hash":"bd80e8d485efacc7610f4458095f9a56398ff9d9","modified":1593062179509},{"_id":"public/2019/10/03/Day19-LINE-LOGIN-介紹/index.html","hash":"1d8654a403fc902e8e03f8ccfa0917499d8b5b75","modified":1593062179509},{"_id":"public/2019/10/02/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧/index.html","hash":"6fc4f71885785fe390625cf63fc6ab53cf9eb92e","modified":1593062179509},{"_id":"public/2019/10/01/Day17-看一下自己寫的東西都去哪了/index.html","hash":"ea5f3ad9c97f5c77c96e0f27e0409d7f39a8a037","modified":1593062179510},{"_id":"public/2019/09/30/Day16-實作一個上下頁的-richmenu/index.html","hash":"ad090c782bdb8d472c748b76cb9f217ed8d3b2a1","modified":1593062179510},{"_id":"public/2019/09/29/Day15-串接-LINE-Richmenu-API/index.html","hash":"dde0ac666cd11542cd980d2499cca77703839975","modified":1593062179510},{"_id":"public/2019/09/28/Day14-LINE-Richmenu-介紹/index.html","hash":"4c32565a6b677cb2251974d665ac3a46b46ccef6","modified":1593062179510},{"_id":"public/2019/09/27/Day13-試玩-python-SDK/index.html","hash":"7fe5561c31886a797b21d6b051b698d95261f004","modified":1593062179510},{"_id":"public/2019/09/26/Day12-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-3-應聲蟲實作/index.html","hash":"8ec7fc46335ebdf39d6dd427043fd1be855af4b4","modified":1593062179510},{"_id":"public/2019/09/25/Day11-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-2-申請一步步/index.html","hash":"644b70d2f12dce3f283ab7c9e95d7673785acf76","modified":1593062179510},{"_id":"public/2019/09/24/Day10-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-1-介紹/index.html","hash":"844c73e99e316247399db6dde4dcf3da6ff48a0b","modified":1593062179511},{"_id":"public/2019/09/23/Day9-SQS-串接-Notify-實作！/index.html","hash":"1c7dbb19aca34ebf28c9ccf641dbd91b3d31c527","modified":1593062179511},{"_id":"public/2019/09/22/Day8-SQS-簡單介紹-建立/index.html","hash":"22e57eac3152218d8631fbe7aa02ca44454c9045","modified":1593062179511},{"_id":"public/2019/09/21/Day7-在-serverless-裡使用環境變數讓這些-key-好管理/index.html","hash":"f0630920fd5e2adf092e83e0acdf2df64b5a9ffa","modified":1593062179511},{"_id":"public/2019/09/21/Day6-建立一個使用-Query-string-來幫忙發送的-LINE-Notify/index.html","hash":"c1d3cb7e42a5a9178f9fb989a104259b4f36dcd5","modified":1593062179511},{"_id":"public/2019/09/20/Day5-做一個與-LINE-Notify-連動的服務/index.html","hash":"ef88b900435d07a5badeacbdcc1a4b6a9d3b4793","modified":1593062179511},{"_id":"public/2019/09/19/Day4-認識與使用-S3-容器/index.html","hash":"4049c2f9dc64fe5badea8669bb9f6393e9a24704","modified":1593062179511},{"_id":"public/2019/09/18/Day3-LINE-Notify-介紹/index.html","hash":"99f4ac30cbfc5f4d3056665fe5496b321a576fbb","modified":1593062179512},{"_id":"public/2019/09/17/Day2-安裝並使用 wsgi & flask 建立第一個 Serverless 的專案/index.html","hash":"6528ec85d97ad2105d1cda7b02646e315b38c376","modified":1593062179512},{"_id":"public/2019/09/16/Day1-serverless-介紹/index.html","hash":"3c3ecd6c567b2f33fffe95669b00e66d36287fa1","modified":1593062179512},{"_id":"public/2019/09/12/Chatbot-meetup-12-心得分享-2019-09-17/index.html","hash":"63c09a8a49b715ff97fcfdfa351118d571956efe","modified":1593062179512},{"_id":"public/archives/index.html","hash":"a57d7229ffff898f9ff628f6fcc05006d9a6d111","modified":1593062179512},{"_id":"public/archives/page/2/index.html","hash":"b446562ac7571fa2229d8a24da138ad2a50553dd","modified":1593062179512},{"_id":"public/archives/page/3/index.html","hash":"4f26f6376e721eda99e9e47cf91d3772b3eef1e4","modified":1593062179512},{"_id":"public/archives/page/4/index.html","hash":"8da0bce6b37e77f0cbd8dd63e92671da8c63d4c1","modified":1593062179512},{"_id":"public/archives/page/5/index.html","hash":"6a808b120e35f416c76512de92a4fc3d200d562b","modified":1593062179512},{"_id":"public/archives/page/6/index.html","hash":"50966f6742e34cccae3453b895f1696116aa91fa","modified":1593062179512},{"_id":"public/archives/page/7/index.html","hash":"049b57ca2531f6e73b7ff6efc87156dcdbf2e587","modified":1593062179512},{"_id":"public/archives/2019/index.html","hash":"d2d35d0a048483f31951cde3c2f3754473214d2f","modified":1593062179513},{"_id":"public/archives/2019/page/2/index.html","hash":"1ddee3c482462c136295e00fe6a95a4cbddf7aca","modified":1593062179513},{"_id":"public/archives/2019/page/3/index.html","hash":"0f128e21d181efa67956aef4bea308cfcc122641","modified":1593062179513},{"_id":"public/archives/2019/page/4/index.html","hash":"137d30420abed9d7108157bb1f95c6acd8ce1ae0","modified":1593062179513},{"_id":"public/archives/2019/page/5/index.html","hash":"a88a32dec78bdee085ed9321c3fcb7f36d0090f5","modified":1593062179513},{"_id":"public/archives/2019/09/index.html","hash":"d5b397005b2391680624c400dcbf7381509d7644","modified":1593062179513},{"_id":"public/archives/2019/09/page/2/index.html","hash":"9c9c70b27370b96fae0e9ca816e68561b6bbc723","modified":1593062179513},{"_id":"public/archives/2019/10/page/2/index.html","hash":"c33cafead154f4bdbe260080e700af81ac0b9066","modified":1593062179514},{"_id":"public/archives/2019/10/index.html","hash":"904dfda33b9b2987acc87239096d99fff6d758a9","modified":1593062179514},{"_id":"public/archives/2019/11/index.html","hash":"df06015391cd7a9d51c01957304f64125336c57a","modified":1593062179514},{"_id":"public/archives/2019/12/index.html","hash":"1ec7ad390dce1b77f972d63ad62ef388dd4349f7","modified":1593062179514},{"_id":"public/archives/2020/index.html","hash":"6b0be1a4966f746f254f65b747c145d0d0552394","modified":1593062179514},{"_id":"public/archives/2020/page/2/index.html","hash":"e9515116d710119a9a8a6fc89115e9cdab677a8c","modified":1593062179514},{"_id":"public/archives/2020/page/3/index.html","hash":"b61e849d76b980892c411e067598d19cb322bd57","modified":1593062179514},{"_id":"public/archives/2020/01/index.html","hash":"152d7b84e709a9c797ac47d9ca16e4798002122b","modified":1593062179514},{"_id":"public/archives/2020/02/index.html","hash":"e06b5693eb868ac75fcefa2098148c6245861b60","modified":1593062179514},{"_id":"public/archives/2020/03/index.html","hash":"0335cd82e58bf9b8a84d1ce40cddbd56b2ed14db","modified":1593062179514},{"_id":"public/archives/2020/04/index.html","hash":"fe427a95193061d5319f2637ba81b84530419ad8","modified":1593062179514},{"_id":"public/archives/2020/05/index.html","hash":"50be29ef71dbda59e957bd98bd96aad4690ce25d","modified":1593062179514},{"_id":"public/archives/2020/06/index.html","hash":"0dd25fe4b2731ec61c6c261e42045097f64daebc","modified":1593062179514},{"_id":"public/categories/日記/index.html","hash":"c420cd16d9a1d335dcb27cf4896027869ce707c5","modified":1593062179514},{"_id":"public/categories/學習紀錄/index.html","hash":"f7ccdda83a00c6c2eeb5f240057a4308a5f88c4a","modified":1593062179514},{"_id":"public/categories/研討會/index.html","hash":"3ae18313bd47cb3ec94d1f4402e0d9fe448078a5","modified":1593062179515},{"_id":"public/categories/Chatbot/index.html","hash":"1b06bd8ca7ee450e53f5e26228c8f9560a37642b","modified":1593062179515},{"_id":"public/categories/2019鐵人賽/index.html","hash":"9cf02493f89e295c56efe5f3931faefa841b3142","modified":1593062179515},{"_id":"public/categories/2019鐵人賽/page/2/index.html","hash":"a224c867c1b546820f282d8ad328a22e2fec6fb8","modified":1593062179515},{"_id":"public/categories/2019鐵人賽/page/3/index.html","hash":"cda710b6b7187abaa3a0ba3c2d8b01eb441a2f1b","modified":1593062179515},{"_id":"public/categories/2019鐵人賽/page/4/index.html","hash":"b4ab20a3667a095eb83371a3f3b39585c3792dc7","modified":1593062179515},{"_id":"public/categories/Docker/index.html","hash":"5f2483e0fc7978507906e6255722d4dcd4d2a3e7","modified":1593062179515},{"_id":"public/categories/Javascript/index.html","hash":"658d976083e2b981b6e7c1e32347937622e31dad","modified":1593062179515},{"_id":"public/categories/Python/index.html","hash":"afbc265c18e378f0377186567c9c66d13c3bc6ab","modified":1593062179515},{"_id":"public/categories/Third-Party/index.html","hash":"9c0a8c51c8a9c2b290029504da11f713e73682b9","modified":1593062179515},{"_id":"public/categories/Serverless/index.html","hash":"6d5edf0e1cfd3976d515863c84d533e93fd77ebe","modified":1593062179515},{"_id":"public/categories/SQL/index.html","hash":"e5c950706e8f961e815b948f223e3bd3d9e93c26","modified":1593062179515},{"_id":"public/categories/觀察系列/index.html","hash":"d40a1f8ff593b2ca3424fc33ca1b039d9c44fe30","modified":1593062179515},{"_id":"public/categories/Document-tools/index.html","hash":"bb5d41208e9fad7f0f8464fcf497c44935d5d255","modified":1593062179516},{"_id":"public/index.html","hash":"ccb33f2488f967b07a888f3af7e842ef91a2810d","modified":1593062179516},{"_id":"public/page/2/index.html","hash":"0c3756efe5194d94c2f5d80ed16513b47a6d32e7","modified":1593062179516},{"_id":"public/page/3/index.html","hash":"325232a9509bf9d5674df0427f494e26aa40e77c","modified":1593062179516},{"_id":"public/page/4/index.html","hash":"b4bcb0e1d9f7141ceec2ae08b6b3d86ba95ba4fd","modified":1593062179516},{"_id":"public/page/5/index.html","hash":"e5c18ded666fbe91978afc0a3f361142ecd0c843","modified":1593062179516},{"_id":"public/page/6/index.html","hash":"d9368fe2406231985d8ed3504cd63cf91fea80d7","modified":1593062179517},{"_id":"public/page/7/index.html","hash":"2b3bf4b4117b9f0f783347c5493d1297ac577b35","modified":1593062179517},{"_id":"public/tags/Serverless/index.html","hash":"5e38456e9bb5cb0ae669faf8e940d99d142176f9","modified":1593062179518},{"_id":"public/tags/Serverless/page/2/index.html","hash":"57df4fe7807fd2ec27a2dbd23fb170e03ce0d402","modified":1593062179518},{"_id":"public/tags/Docker/index.html","hash":"f197ab65e8151450cbf0a83a0e7c190ad88c7c7e","modified":1593062179519},{"_id":"public/tags/日記/index.html","hash":"bcc1f29e7f546813255b24dd54deeafc2dc861af","modified":1593062179519},{"_id":"public/tags/LINE-SDK/index.html","hash":"52119918ab1488db18c9164c21f3f9bc16e25a46","modified":1593062179519},{"_id":"public/tags/AWS/index.html","hash":"a08e6a788723a88484f5b340c3e3a5c96b226af9","modified":1593062179519},{"_id":"public/tags/AWS/page/2/index.html","hash":"60cb6329afe9e9a9e5ff4d8e90c865f2fa6198df","modified":1593062179519},{"_id":"public/tags/LINT/index.html","hash":"5f2ada5c60bb4de50cc51856b6a922871276ff24","modified":1593062179519},{"_id":"public/tags/Netflix/index.html","hash":"52472ae7cfdc3306c0c4e1d76a483038e9f839ff","modified":1593062179519},{"_id":"public/tags/LINE/index.html","hash":"65a268d5f77d906b70c9e91e2fb251e5fe85db09","modified":1593062179519},{"_id":"public/tags/LINE/page/2/index.html","hash":"2d45a0ca656962be29d6759090b889fd8b932354","modified":1593062179519},{"_id":"public/tags/LINE/page/3/index.html","hash":"c470afd8258f346123664321a0637368eeaf4c12","modified":1593062179519},{"_id":"public/tags/Dev-Day-2019/index.html","hash":"3f588d98fe3e18401be798853ccb8315947fdffb","modified":1593062179519},{"_id":"public/tags/chatbot/index.html","hash":"34e82ad5c3af3f159ae7785ec0aee8f299284cbb","modified":1593062179519},{"_id":"public/tags/chatbot/page/2/index.html","hash":"4860de54fdcdb7b41d322ab8099d8bd6a935545a","modified":1593062179519},{"_id":"public/tags/Google/index.html","hash":"ad390f03bd30dfd3a70356124b109fd0d9c20b5a","modified":1593062179519},{"_id":"public/tags/Dialogflow/index.html","hash":"6c00b8dcbd516e38727b8b6e0f621fd7ab85f4cd","modified":1593062179519},{"_id":"public/tags/Lambda/index.html","hash":"badb7ec0fd66c3e655278a65ea7fc1e37d7a7239","modified":1593062179519},{"_id":"public/tags/Message-API/index.html","hash":"8b60c4c79bc7396daeebc14dfad6ca5abb7961fa","modified":1593062179519},{"_id":"public/tags/Message-api/index.html","hash":"ca00256e4382c6e78aed4a20daa80ef0ac55bacb","modified":1593062179520},{"_id":"public/tags/python/index.html","hash":"d97bc909b4de5f7d9ba6c22143342b146434ca42","modified":1593062179520},{"_id":"public/tags/Richmenu/index.html","hash":"66ba98af6c61a282018898dcc4c71604d2c52bbf","modified":1593062179520},{"_id":"public/tags/CloudFormation/index.html","hash":"a2b9478ea35fdd63fb7b52685a7a629897e66597","modified":1593062179520},{"_id":"public/tags/S3/index.html","hash":"eb29ac4263f5305288bf518a9d3ad18e13262a7b","modified":1593062179520},{"_id":"public/tags/API-gateway/index.html","hash":"32c7950e3a07a2bdb8474eb73d497cfd26fed805","modified":1593062179520},{"_id":"public/tags/Schedule/index.html","hash":"269ee0e4f12edd5a71a48a3040859b17cd848743","modified":1593062179520},{"_id":"public/tags/LINE-Login/index.html","hash":"c2b1c1fe953dd7261b7f7c5409993294778059e5","modified":1593062179520},{"_id":"public/tags/LIFF/index.html","hash":"c631750bcc686e341dca667041efada1542a4e05","modified":1593062179520},{"_id":"public/tags/webview/index.html","hash":"df6931fded1cdcfd5515e4391adcb0b06a32ab57","modified":1593062179520},{"_id":"public/tags/warm-up/index.html","hash":"2036fc0f48d5ac77a1bb7e31aacf4b6f8976a2aa","modified":1593062179520},{"_id":"public/tags/CDN/index.html","hash":"d2a2cf00e42ab929afbb592f8c3c7d83f732cea5","modified":1593062179520},{"_id":"public/tags/Route-53/index.html","hash":"6ada716afa76d7d42493f5aa8a7c4f86c45da8a2","modified":1593062179520},{"_id":"public/tags/Certificate-Manager/index.html","hash":"c806353cb137faa395b31767c276a08834c05fa9","modified":1593062179520},{"_id":"public/tags/CloudFront/index.html","hash":"9534d8e32e345eed8f30498e706557a9f24b8234","modified":1593062179520},{"_id":"public/tags/Route53/index.html","hash":"c153dabb2be2854abdfd38e4f0468dbe0d873cae","modified":1593062179521},{"_id":"public/tags/richmenu/index.html","hash":"312d6eb96eaa846aeb947244b3d6bdc9c22d6ab7","modified":1593062179522},{"_id":"public/tags/Notify/index.html","hash":"e9146f4329da5d52d29da2beb732e5e5c570ab5f","modified":1593062179522},{"_id":"public/tags/dotenv/index.html","hash":"1bbedf93a8f0183088ceba2c967d3e08acdd04d6","modified":1593062179522},{"_id":"public/tags/LINE-Notify/index.html","hash":"f5e7eead36f2786889af002e8f7efa307fe8d240","modified":1593062179522},{"_id":"public/tags/SQS/index.html","hash":"6085187ef95dd38db4952afe3c7068d1d9b73761","modified":1593062179522},{"_id":"public/tags/IAM/index.html","hash":"eb837e99b9c835110f7ab9f6060b71fd78625777","modified":1593062179522},{"_id":"public/tags/Mysql/index.html","hash":"b1e0253380c1f5eb003e8cad8bce1647f038941b","modified":1593062179522},{"_id":"public/tags/PHPMyadmin/index.html","hash":"e558cc51aada47d911ace98599e965420cf3d207","modified":1593062179522},{"_id":"public/tags/Flex-message/index.html","hash":"54ee5d00e7407bc44b98ea9306092de7ac8c9efc","modified":1593062179522},{"_id":"public/tags/Provider/index.html","hash":"d24374bfdd121258818dab9aaae8313d5cc3a42c","modified":1593062179522},{"_id":"public/tags/Icon-Switch/index.html","hash":"647e9b8c600c0321b9f3f207e4e72d2b0a845be8","modified":1593062179522},{"_id":"public/tags/Python/index.html","hash":"81b8323afee2f1edd3cfef6e74e0c9a4a0fa1fb2","modified":1593062179522},{"_id":"public/tags/operator/index.html","hash":"7bbb2812634c4088e1103c0d08e84462abd54d3f","modified":1593062179523},{"_id":"public/tags/Streamlabs/index.html","hash":"38133a584bb5c63ecfec8f7d008e4fefdf19e70a","modified":1593062179523},{"_id":"public/tags/Youtube/index.html","hash":"c31e205a76dfcc90fa0de36a52a5eb0a230304fc","modified":1593062179523},{"_id":"public/tags/Stream/index.html","hash":"509f1b323304391e820f8d01807565bad6229bf8","modified":1593062179523},{"_id":"public/tags/meetups/index.html","hash":"67deae2adbf6e5a4902872d6d4b604c0f1ef69eb","modified":1593062179523},{"_id":"public/tags/Twitch/index.html","hash":"4c0b09ac4cf71531d51681ad36ac613f5215d9bd","modified":1593062179523},{"_id":"public/tags/irc/index.html","hash":"15e4fbd17c2b84202597514da78917a5c2af8d94","modified":1593062179523},{"_id":"public/tags/TypeScript/index.html","hash":"eda848b71eba05abd4b801986229dc44a7cdf2c7","modified":1593062179523},{"_id":"public/tags/meetup/index.html","hash":"a9df4d6b2bfdb6628d2d79e034c49e4a19c85767","modified":1593062179523},{"_id":"public/tags/LINE-Bot/index.html","hash":"f4ce07ad39c647c0b7d85cfe7c58aa9fae2b6c43","modified":1593062179524},{"_id":"public/tags/Bottender/index.html","hash":"f25dd879f3bb93a9bd49e433e596d1448c590cb9","modified":1593062179524},{"_id":"public/tags/Chatbot/index.html","hash":"751e5e36f40a9987f31551162708b092c1e52043","modified":1593062179524},{"_id":"public/tags/PlantUML/index.html","hash":"87a90b92537126ab6f0b9b4e378928fab1202742","modified":1593062179524},{"_id":"public/tags/Hexo/index.html","hash":"358ed695fdb6c06a31b65fbe8525b7af6b4e9482","modified":1593062179524},{"_id":"public/tags/VScode/index.html","hash":"511f5ae8ccc8c186f7ec66a1c52d9755098acf92","modified":1593062179524},{"_id":"public/tags/container/index.html","hash":"67384a0af001382c48a2ec5b2e3bbad4d61646ea","modified":1593062179524},{"_id":"public/tags/docker-compose/index.html","hash":"eef274556acdc2f1fb3c28c4d3b8f646c7dad100","modified":1593062179524},{"_id":"public/tags/Promise/index.html","hash":"66b5f7d95de0703603dca71b5c7ee50e52ca1bf2","modified":1593062179525},{"_id":"public/tags/IIFE/index.html","hash":"1b997ac24d5832f9ae43574ebddfe319b7803acf","modified":1593062179525},{"_id":"public/tags/Arrow-Function/index.html","hash":"fb92fc93d40b701e31116a3b8c0007e0dab31c49","modified":1593062179525},{"_id":"public/tags/Callback/index.html","hash":"de46b76554d8b336fcbaafb221d60f32d9be1424","modified":1593062179525},{"_id":"public/tags/node-gyp/index.html","hash":"a7081c2cf27c6f6ee5f150f15b383801da30d3a4","modified":1593062179525},{"_id":"public/tags/MacOS/index.html","hash":"b1531bbadf6d75307b06cce7c832606292891ba0","modified":1593062179525},{"_id":"public/tags/Xcode/index.html","hash":"480e44366e52dbf21bdd09e11230ccb1e5c3d875","modified":1593062179525},{"_id":"public/tags/jest/index.html","hash":"1b8c9658353769364f0ddb84953fc61fce24c027","modified":1593062179525},{"_id":"public/tags/npm/index.html","hash":"0b41c61d468d9a353a62db80b75c572b6a14a51c","modified":1593062179525},{"_id":"public/tags/yarn/index.html","hash":"fb8ba2300af48208bd4649913efde241ce217a2a","modified":1593062179525},{"_id":"public/tags/Class-level/index.html","hash":"f06e9ed0de7e39b5083152c3806528d63933aca8","modified":1593062179525},{"_id":"public/tags/Instance-level/index.html","hash":"51e7728faf1b6de6c75e387ba503867841f6961b","modified":1593062179525},{"_id":"public/tags/Sentry/index.html","hash":"de3050cd0feb46809af6b2ef22061415e16234ba","modified":1593062179525},{"_id":"public/tags/GCP/index.html","hash":"eacbf75c8995dd185fa2c8b2619700a66453a558","modified":1593062179525},{"_id":"public/tags/Azure/index.html","hash":"defedfdf66aeb5329c10f5907cd107591e94bc83","modified":1593062179525},{"_id":"public/tags/Heroku/index.html","hash":"22f02cd6fcfcc5b3901f120cb0cea0fc6e36fe43","modified":1593062179525},{"_id":"public/tags/cold-start/index.html","hash":"a80ea36b726b522854b3d4ce21c9763e1f19fc30","modified":1593062179525},{"_id":"public/tags/Lint/index.html","hash":"3b3d79493aeeb6a94b360c4fc89dd2b31c0b7d98","modified":1593062179526},{"_id":"public/tags/Flake8/index.html","hash":"48f8216660b22eeb07ca0272550613b78b8eada3","modified":1593062179526},{"_id":"public/tags/SonarQube/index.html","hash":"55d56ffc48983daf4ae1439412461017fc11c5cf","modified":1593062179526},{"_id":"public/tags/ESLint/index.html","hash":"d43a986fad65fa7a7dc5f98b829eb45e9861ffd7","modified":1593062179526},{"_id":"public/tags/API-Gateway/index.html","hash":"2f7c916348d0a4abfa6602cd0f53bb0c9a8dcccc","modified":1593062179526},{"_id":"public/tags/Authorizer/index.html","hash":"0d9d32f30e967bd2ea7449f2a50912553b2718dd","modified":1593062179526},{"_id":"public/tags/Amazon-Web-Service/index.html","hash":"fb0457ae77f6f26c623fece8682478fbc77e31be","modified":1593062179526},{"_id":"public/tags/JWT/index.html","hash":"3edd2fdf9eec72127154f02f62f9d46aecd2647a","modified":1593062179526},{"_id":"public/tags/PostgreSQL/index.html","hash":"d143b4f3dc0ddd61785f776b45384e69d62fbfc3","modified":1593062179526},{"_id":"public/tags/pgAdmin/index.html","hash":"ac35d2cc84ab5b113c8e138a75a085d3c42ebb25","modified":1593062179526},{"_id":"public/tags/SQL/index.html","hash":"45f1435630bd648921bcbec98214beacac565dec","modified":1593062179526},{"_id":"public/tags/DDL/index.html","hash":"e541da2c9ca2b1e57bc201015a87ce8a32d82c70","modified":1593062179526},{"_id":"public/tags/核心型/index.html","hash":"6637ea9297bde0c22a9f1c33d4fbcde2691ebf18","modified":1593062179526},{"_id":"public/tags/應用型/index.html","hash":"bdedc3235ec5fe82f2a6a7ae6cb40e8224598ec4","modified":1593062179526},{"_id":"public/tags/社群/index.html","hash":"b59f3680c3915ddf97313e563f7afa3e08fc6ba3","modified":1593062179526},{"_id":"public/tags/學習/index.html","hash":"27a27908be68cc1d1180a0bc0f3c08a485d51232","modified":1593062179526},{"_id":"public/tags/Swagger/index.html","hash":"ead550ddb0f0b9065ab4943453b9590d59d8f3b7","modified":1593062179526},{"_id":"public/tags/Flask/index.html","hash":"de75b489cdca1bb69f8ba4a06820fff1fb5c1c98","modified":1593062179526},{"_id":"public/tags/Open-Api/index.html","hash":"67c2654d19c8ffc8f02f29d49fe8cdd6fff62ad7","modified":1593062179526},{"_id":"public/tags/bottender/index.html","hash":"ed042bbf1bd76930fea69e0e7772a0eddefe1497","modified":1593062179526},{"_id":"public/tags/Lotify/index.html","hash":"79c8219c8c78b50e1bb2f1ae8c65c9772d8b07d4","modified":1593062179526},{"_id":"public/tags/Http/index.html","hash":"61dd86535186661c69e6dfbde0c2f980c9027bd5","modified":1593062179527},{"_id":"public/tags/SSL/index.html","hash":"6bb51dbcf4d3e20ab02c11639db43c10661f57b1","modified":1593062179527},{"_id":"public/tags/OAuth/index.html","hash":"da4b68cb24e12f0dc7f64e33d251157b966fa53a","modified":1593062179527},{"_id":"public/tags/OpenID/index.html","hash":"df76435d502d1307cbd6f2e446b1a1439bf2bd74","modified":1593062179527},{"_id":"public/diagrams/src/http_request.wsd","hash":"91103484a776fb19cba4afe1b074d799f911822b","modified":1593062179536},{"_id":"public/CNAME","hash":"c3b182ff582ab602256a9314c80cf31d9c059ae7","modified":1593062179536},{"_id":"public/diagrams/src/diagrams.wsd","hash":"08cedb09d1279a475a939114644b1f49b8ce44c8","modified":1593062179536},{"_id":"public/diagrams/src/three_way_handshake.wsd","hash":"afd0ce1692ca0b78565e359b6ce737e25c46ac38","modified":1593062179536},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1593062179536},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1593062179536},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1593062179537},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1593062179537},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1593062179537},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1593062179537},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1593062179537},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1593062179537},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1593062179537},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1593062179537},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1593062179537},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1593062179537},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1593062179537},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1593062179537},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1593062179537},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1593062179537},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1593062179537},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1593062179537},{"_id":"public/diagrams/out/http_request/http_request.png","hash":"7d55530c44cae29666d6f5d64ca95699355ed89e","modified":1593062179537},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1593062179537},{"_id":"public/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1593062179537},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1593062179537},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1593062179537},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1593062179537},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1593062179538},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1593062179538},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1593062179538},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1593062179538},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1593062179538},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1593062179538},{"_id":"public/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1593062179538},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1593062179538},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1593062179538},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1593062179538},{"_id":"public/uploads/avatar.jpg","hash":"81ff05e48535b3b77b933b8a2cdd7d97bfefa7cd","modified":1593062180000},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1593062180004},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1593062180021},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1593062180021},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1593062180021},{"_id":"public/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1593062180022},{"_id":"public/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1593062180022},{"_id":"public/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1593062180022},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1593062180022},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1593062180022},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1593062180022},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1593062180022},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1593062180022},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1593062180022},{"_id":"public/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1593062180022},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1593062180022},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1593062180022},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1593062180022},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1593062180022},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1593062180022},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1593062180022},{"_id":"public/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1593062180022},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1593062180022},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1593062180022},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1593062180023},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1593062180023},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1593062180023},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1593062180023},{"_id":"public/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1593062180023},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1593062180023},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1593062180023},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1593062180023},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1593062180023},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1593062180023},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1593062180023},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1593062180023},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1593062180023},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1593062180024},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1593062180024},{"_id":"public/lib/jquery_lazyload/README.html","hash":"18a600ca1aafd3bf08af52b6a6fe5f056aeed9f4","modified":1593062180024},{"_id":"public/lib/fastclick/README.html","hash":"c5a4c05ca80132b7e343d5fd1d1d1a976b4ad151","modified":1593062180024},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"81057e5b518b8ab60474e1ad027e868b558f15b7","modified":1593062180024},{"_id":"public/css/main.css","hash":"8dd169207bb140497fb75f6780c28e38f34d9fa2","modified":1593062180024},{"_id":"public/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1593062180024},{"_id":"public/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1593062180024},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1593062180024},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1593062180024},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1593062180024},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1593062180025},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1593062180025},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1593062180025},{"_id":"public/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1593062180025},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1593062180025},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1593062180025},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1593062180026},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1593062180026},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1593062180026},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1593062180026},{"_id":"public/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1593062180026},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1593062180026},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1593062180026},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1593062180027},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1593062180027},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1593062180027},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1593062180028},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1593062180046},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1593062180055},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1593062180190}],"Category":[{"name":"日記","_id":"ckbuc31ip00047crigbmscdx5"},{"name":"學習紀錄","_id":"ckbuc31iw000a7criy3rzqckq"},{"name":"研討會","_id":"ckbuc31j5000m7criucs5w3lx"},{"name":"Chatbot","_id":"ckbuc31jf000y7criotuxmklj"},{"name":"2019鐵人賽","_id":"ckbuc31jh00147cri7afsh43d"},{"name":"Docker","_id":"ckbuc31kg003d7crixediulks"},{"name":"Javascript","_id":"ckbuc31l4004s7criky3d1ezy"},{"name":"Python","_id":"ckbuc31l9004z7cri7duzpurk"},{"name":"Third Party","_id":"ckbuc31ld00577cri0tmrlbpu"},{"name":"Serverless","_id":"ckbuc31lh005g7cri7jzfo9u8"},{"name":"SQL","_id":"ckbuc31lo005p7crivtshzpd6"},{"name":"觀察系列","_id":"ckbuc31lv005y7cri8x4becca"},{"name":"Document tools","_id":"ckbuc31m100667criose0w2tl"}],"Data":[],"Page":[{"title":"Privacy Policy","date":"2019-10-18T09:45:17.000Z","_content":"\n這是以《政府網站版型與內容管理規範》中為基礎的隱私權條款範本，稍微調整過移除不適用一般企業的項目，任何網站皆可將此範本加上自己的網站名稱，並做修改後使用於網站上。\n\n請注意，若您要針對此以私權條款模板做修改，需要至少包含以下項目:\n\n### 一、隱私權保護政策的適用範圍\n\n請說明該網站隱私權保護政策的適用範圍。\n\n### 二、個人資料的蒐集、處理及利用方式\n\n請說明該網站針對個人資料的蒐集、處理及利用方式。\n\n### 三、資料之保護\n\n請說明該網站針對取得資料的安全維護措施，如防止個人資料被竊取、竄改、毀損、滅失或洩漏，採取技術上及組織上之必要措施。\n\n### 四、網站對外的相關連結\n\n請說明對外連結網站不適用本網站的隱私權保護政策，必須參考該連結網站中的隱私權保護政策。\n\n### 五、與第三人共用個人資料之政策\n\n### 六、Cookie 之使用\n\n請說明該網站使用 Cookie 技術來儲存或追蹤使用者的資料的情況。\n\n### 七、隱私權保護政策之修正\n\n請說明該網站針對隱私權保護政策之修正措施。\n\n---\n\n## 隱私權條款範本文件\n\n非常歡迎您光臨「NiJia Lin 的個人網站」（以下簡稱本網站），為了讓您能夠安心的使用本網站的各項服務與資訊，特此向您說明本網站的隱私權保護政策，以保障您的權益，請您詳閱下列內容：\n\n### 一、隱私權保護政策的適用範圍\n\n隱私權保護政策內容，包括本網站如何處理在您使用網站服務時收集到的個人識別資料。隱私權保護政策不適用於本網站以外的相關連結網站，也不適用於非本網站所委託或參與管理的人員。\n\n### 二、個人資料的蒐集、處理及利用方式\n\n- 當您造訪本網站或使用本網站所提供之功能服務時，我們將視該服務功能性質，請您提供必要的個人資料，並在該特定目的範圍內處理及利用您的個人資料；非經您書面同意，本網站不會將個人資料用於其他用途。\n- 本網站在您使用服務信箱、問卷調查等互動性功能時，會保留您所提供的姓名、電子郵件地址、聯絡方式及使用時間等。\n- 於一般瀏覽時，伺服器會自行記錄相關行徑，包括您使用連線設備的 IP 位址、使用時間、使用的瀏覽器、瀏覽及點選資料記錄等，做為我們增進網站服務的參考依據，此記錄為內部應用，決不對外公佈。\n- 為提供精確的服務，我們會將收集的問卷調查內容進行統計與分析，分析結果之統計數據或說明文字呈現，除供內部研究外，我們會視需要公佈統計數據及說明文字，但不涉及特定個人之資料。\n\n### 三、資料之保護\n\n- 本網站主機均設有防火牆、防毒系統等相關的各項資訊安全設備及必要的安全防護措施，加以保護網站及您的個人資料採用嚴格的保護措施，只由經過授權的人員才能接觸您的個人資料，相關處理人員皆簽有保密合約，如有違反保密義務者，將會受到相關的法律處分。\n- 如因業務需要有必要委託其他單位提供服務時，本網站亦會嚴格要求其遵守保密義務，並且採取必要檢查程序以確定其將確實遵守。\n\n### 四、網站對外的相關連結\n\n本網站的網頁提供其他網站的網路連結，您也可經由本網站所提供的連結，點選進入其他網站。但該連結網站不適用本網站的隱私權保護政策，您必須參考該連結網站中的隱私權保護政策。\n\n### 五、與第三人共用個人資料之政策\n\n本網站絕不會提供、交換、出租或出售任何您的個人資料給其他個人、團體、私人企業或公務機關，但有法律依據或合約義務者，不在此限。\n\n前項但書之情形包括不限於：\n\n- 經由您書面同意。\n- 法律明文規定。\n- 為免除您生命、身體、自由或財產上之危險。\n- 與公務機關或學術研究機構合作，基於公共利益為統計或學術研究而有必要，且資料經過提供者處理或蒐集者依其揭露方式無從識別特定之當事人。\n- 當您在網站的行為，違反服務條款或可能損害或妨礙網站與其他使用者權益或導致任何人遭受損害時，經網站管理單位研析揭露您的個人資料是為了辨識、聯絡或採取法律行動所必要者。\n- 有利於您的權益。\n- 本網站委託廠商協助蒐集、處理或利用您的個人資料時，將對委外廠商或個人善盡監督管理之責。\n\n### 六、Cookie 之使用\n\n為了提供您最佳的服務，本網站會在您的電腦中放置並取用我們的 Cookie，若您不願接受 Cookie 的寫入，您可在您使用的瀏覽器功能項中設定隱私權等級為高，即可拒絕 Cookie 的寫入，但可能會導致網站某些功能無法正常執行 。\n\n### 七、隱私權保護政策之修正\n\n本網站隱私權保護政策將因應需求隨時進行修正，修正後的條款將刊登於網站上。\n\n---\n\n> 基礎資料來源: [《政府網站版型與內容管理規範》](http://www.webguide.nat.gov.tw/index.php/ch/speci/index.html)\n\n> 如果您需要英文版的模板，可以參考 [MDN 隱私權政策制定指南](https://developer.mozilla.org/zh-TW/docs/Mozilla/Marketplace/Publishing/Privacy_policies#Mozilla_Marketplace_.E7.9A.84.E9.9A.B1.E7.A7.81.E6.AC.8A.E8.A6.81.E6.B1.82) 與 https://github.com/flamsmark/privacy-policy-template\n","source":"Privacy-Policy/index.md","raw":"---\ntitle: Privacy Policy\ndate: 2019-10-18 17:45:17\n---\n\n這是以《政府網站版型與內容管理規範》中為基礎的隱私權條款範本，稍微調整過移除不適用一般企業的項目，任何網站皆可將此範本加上自己的網站名稱，並做修改後使用於網站上。\n\n請注意，若您要針對此以私權條款模板做修改，需要至少包含以下項目:\n\n### 一、隱私權保護政策的適用範圍\n\n請說明該網站隱私權保護政策的適用範圍。\n\n### 二、個人資料的蒐集、處理及利用方式\n\n請說明該網站針對個人資料的蒐集、處理及利用方式。\n\n### 三、資料之保護\n\n請說明該網站針對取得資料的安全維護措施，如防止個人資料被竊取、竄改、毀損、滅失或洩漏，採取技術上及組織上之必要措施。\n\n### 四、網站對外的相關連結\n\n請說明對外連結網站不適用本網站的隱私權保護政策，必須參考該連結網站中的隱私權保護政策。\n\n### 五、與第三人共用個人資料之政策\n\n### 六、Cookie 之使用\n\n請說明該網站使用 Cookie 技術來儲存或追蹤使用者的資料的情況。\n\n### 七、隱私權保護政策之修正\n\n請說明該網站針對隱私權保護政策之修正措施。\n\n---\n\n## 隱私權條款範本文件\n\n非常歡迎您光臨「NiJia Lin 的個人網站」（以下簡稱本網站），為了讓您能夠安心的使用本網站的各項服務與資訊，特此向您說明本網站的隱私權保護政策，以保障您的權益，請您詳閱下列內容：\n\n### 一、隱私權保護政策的適用範圍\n\n隱私權保護政策內容，包括本網站如何處理在您使用網站服務時收集到的個人識別資料。隱私權保護政策不適用於本網站以外的相關連結網站，也不適用於非本網站所委託或參與管理的人員。\n\n### 二、個人資料的蒐集、處理及利用方式\n\n- 當您造訪本網站或使用本網站所提供之功能服務時，我們將視該服務功能性質，請您提供必要的個人資料，並在該特定目的範圍內處理及利用您的個人資料；非經您書面同意，本網站不會將個人資料用於其他用途。\n- 本網站在您使用服務信箱、問卷調查等互動性功能時，會保留您所提供的姓名、電子郵件地址、聯絡方式及使用時間等。\n- 於一般瀏覽時，伺服器會自行記錄相關行徑，包括您使用連線設備的 IP 位址、使用時間、使用的瀏覽器、瀏覽及點選資料記錄等，做為我們增進網站服務的參考依據，此記錄為內部應用，決不對外公佈。\n- 為提供精確的服務，我們會將收集的問卷調查內容進行統計與分析，分析結果之統計數據或說明文字呈現，除供內部研究外，我們會視需要公佈統計數據及說明文字，但不涉及特定個人之資料。\n\n### 三、資料之保護\n\n- 本網站主機均設有防火牆、防毒系統等相關的各項資訊安全設備及必要的安全防護措施，加以保護網站及您的個人資料採用嚴格的保護措施，只由經過授權的人員才能接觸您的個人資料，相關處理人員皆簽有保密合約，如有違反保密義務者，將會受到相關的法律處分。\n- 如因業務需要有必要委託其他單位提供服務時，本網站亦會嚴格要求其遵守保密義務，並且採取必要檢查程序以確定其將確實遵守。\n\n### 四、網站對外的相關連結\n\n本網站的網頁提供其他網站的網路連結，您也可經由本網站所提供的連結，點選進入其他網站。但該連結網站不適用本網站的隱私權保護政策，您必須參考該連結網站中的隱私權保護政策。\n\n### 五、與第三人共用個人資料之政策\n\n本網站絕不會提供、交換、出租或出售任何您的個人資料給其他個人、團體、私人企業或公務機關，但有法律依據或合約義務者，不在此限。\n\n前項但書之情形包括不限於：\n\n- 經由您書面同意。\n- 法律明文規定。\n- 為免除您生命、身體、自由或財產上之危險。\n- 與公務機關或學術研究機構合作，基於公共利益為統計或學術研究而有必要，且資料經過提供者處理或蒐集者依其揭露方式無從識別特定之當事人。\n- 當您在網站的行為，違反服務條款或可能損害或妨礙網站與其他使用者權益或導致任何人遭受損害時，經網站管理單位研析揭露您的個人資料是為了辨識、聯絡或採取法律行動所必要者。\n- 有利於您的權益。\n- 本網站委託廠商協助蒐集、處理或利用您的個人資料時，將對委外廠商或個人善盡監督管理之責。\n\n### 六、Cookie 之使用\n\n為了提供您最佳的服務，本網站會在您的電腦中放置並取用我們的 Cookie，若您不願接受 Cookie 的寫入，您可在您使用的瀏覽器功能項中設定隱私權等級為高，即可拒絕 Cookie 的寫入，但可能會導致網站某些功能無法正常執行 。\n\n### 七、隱私權保護政策之修正\n\n本網站隱私權保護政策將因應需求隨時進行修正，修正後的條款將刊登於網站上。\n\n---\n\n> 基礎資料來源: [《政府網站版型與內容管理規範》](http://www.webguide.nat.gov.tw/index.php/ch/speci/index.html)\n\n> 如果您需要英文版的模板，可以參考 [MDN 隱私權政策制定指南](https://developer.mozilla.org/zh-TW/docs/Mozilla/Marketplace/Publishing/Privacy_policies#Mozilla_Marketplace_.E7.9A.84.E9.9A.B1.E7.A7.81.E6.AC.8A.E8.A6.81.E6.B1.82) 與 https://github.com/flamsmark/privacy-policy-template\n","updated":"2019-10-18T09:47:35.000Z","path":"Privacy-Policy/index.html","comments":1,"layout":"page","_id":"ckbuc31if00007cri75h9bijd","content":"<p>這是以《政府網站版型與內容管理規範》中為基礎的隱私權條款範本，稍微調整過移除不適用一般企業的項目，任何網站皆可將此範本加上自己的網站名稱，並做修改後使用於網站上。</p>\n<p>請注意，若您要針對此以私權條款模板做修改，需要至少包含以下項目:</p>\n<h3 id=\"一、隱私權保護政策的適用範圍\"><a href=\"#一、隱私權保護政策的適用範圍\" class=\"headerlink\" title=\"一、隱私權保護政策的適用範圍\"></a>一、隱私權保護政策的適用範圍</h3><p>請說明該網站隱私權保護政策的適用範圍。</p>\n<h3 id=\"二、個人資料的蒐集、處理及利用方式\"><a href=\"#二、個人資料的蒐集、處理及利用方式\" class=\"headerlink\" title=\"二、個人資料的蒐集、處理及利用方式\"></a>二、個人資料的蒐集、處理及利用方式</h3><p>請說明該網站針對個人資料的蒐集、處理及利用方式。</p>\n<h3 id=\"三、資料之保護\"><a href=\"#三、資料之保護\" class=\"headerlink\" title=\"三、資料之保護\"></a>三、資料之保護</h3><p>請說明該網站針對取得資料的安全維護措施，如防止個人資料被竊取、竄改、毀損、滅失或洩漏，採取技術上及組織上之必要措施。</p>\n<h3 id=\"四、網站對外的相關連結\"><a href=\"#四、網站對外的相關連結\" class=\"headerlink\" title=\"四、網站對外的相關連結\"></a>四、網站對外的相關連結</h3><p>請說明對外連結網站不適用本網站的隱私權保護政策，必須參考該連結網站中的隱私權保護政策。</p>\n<h3 id=\"五、與第三人共用個人資料之政策\"><a href=\"#五、與第三人共用個人資料之政策\" class=\"headerlink\" title=\"五、與第三人共用個人資料之政策\"></a>五、與第三人共用個人資料之政策</h3><h3 id=\"六、Cookie-之使用\"><a href=\"#六、Cookie-之使用\" class=\"headerlink\" title=\"六、Cookie 之使用\"></a>六、Cookie 之使用</h3><p>請說明該網站使用 Cookie 技術來儲存或追蹤使用者的資料的情況。</p>\n<h3 id=\"七、隱私權保護政策之修正\"><a href=\"#七、隱私權保護政策之修正\" class=\"headerlink\" title=\"七、隱私權保護政策之修正\"></a>七、隱私權保護政策之修正</h3><p>請說明該網站針對隱私權保護政策之修正措施。</p>\n<hr>\n<h2 id=\"隱私權條款範本文件\"><a href=\"#隱私權條款範本文件\" class=\"headerlink\" title=\"隱私權條款範本文件\"></a>隱私權條款範本文件</h2><p>非常歡迎您光臨「NiJia Lin 的個人網站」（以下簡稱本網站），為了讓您能夠安心的使用本網站的各項服務與資訊，特此向您說明本網站的隱私權保護政策，以保障您的權益，請您詳閱下列內容：</p>\n<h3 id=\"一、隱私權保護政策的適用範圍-1\"><a href=\"#一、隱私權保護政策的適用範圍-1\" class=\"headerlink\" title=\"一、隱私權保護政策的適用範圍\"></a>一、隱私權保護政策的適用範圍</h3><p>隱私權保護政策內容，包括本網站如何處理在您使用網站服務時收集到的個人識別資料。隱私權保護政策不適用於本網站以外的相關連結網站，也不適用於非本網站所委託或參與管理的人員。</p>\n<h3 id=\"二、個人資料的蒐集、處理及利用方式-1\"><a href=\"#二、個人資料的蒐集、處理及利用方式-1\" class=\"headerlink\" title=\"二、個人資料的蒐集、處理及利用方式\"></a>二、個人資料的蒐集、處理及利用方式</h3><ul>\n<li>當您造訪本網站或使用本網站所提供之功能服務時，我們將視該服務功能性質，請您提供必要的個人資料，並在該特定目的範圍內處理及利用您的個人資料；非經您書面同意，本網站不會將個人資料用於其他用途。</li>\n<li>本網站在您使用服務信箱、問卷調查等互動性功能時，會保留您所提供的姓名、電子郵件地址、聯絡方式及使用時間等。</li>\n<li>於一般瀏覽時，伺服器會自行記錄相關行徑，包括您使用連線設備的 IP 位址、使用時間、使用的瀏覽器、瀏覽及點選資料記錄等，做為我們增進網站服務的參考依據，此記錄為內部應用，決不對外公佈。</li>\n<li>為提供精確的服務，我們會將收集的問卷調查內容進行統計與分析，分析結果之統計數據或說明文字呈現，除供內部研究外，我們會視需要公佈統計數據及說明文字，但不涉及特定個人之資料。</li>\n</ul>\n<h3 id=\"三、資料之保護-1\"><a href=\"#三、資料之保護-1\" class=\"headerlink\" title=\"三、資料之保護\"></a>三、資料之保護</h3><ul>\n<li>本網站主機均設有防火牆、防毒系統等相關的各項資訊安全設備及必要的安全防護措施，加以保護網站及您的個人資料採用嚴格的保護措施，只由經過授權的人員才能接觸您的個人資料，相關處理人員皆簽有保密合約，如有違反保密義務者，將會受到相關的法律處分。</li>\n<li>如因業務需要有必要委託其他單位提供服務時，本網站亦會嚴格要求其遵守保密義務，並且採取必要檢查程序以確定其將確實遵守。</li>\n</ul>\n<h3 id=\"四、網站對外的相關連結-1\"><a href=\"#四、網站對外的相關連結-1\" class=\"headerlink\" title=\"四、網站對外的相關連結\"></a>四、網站對外的相關連結</h3><p>本網站的網頁提供其他網站的網路連結，您也可經由本網站所提供的連結，點選進入其他網站。但該連結網站不適用本網站的隱私權保護政策，您必須參考該連結網站中的隱私權保護政策。</p>\n<h3 id=\"五、與第三人共用個人資料之政策-1\"><a href=\"#五、與第三人共用個人資料之政策-1\" class=\"headerlink\" title=\"五、與第三人共用個人資料之政策\"></a>五、與第三人共用個人資料之政策</h3><p>本網站絕不會提供、交換、出租或出售任何您的個人資料給其他個人、團體、私人企業或公務機關，但有法律依據或合約義務者，不在此限。</p>\n<p>前項但書之情形包括不限於：</p>\n<ul>\n<li>經由您書面同意。</li>\n<li>法律明文規定。</li>\n<li>為免除您生命、身體、自由或財產上之危險。</li>\n<li>與公務機關或學術研究機構合作，基於公共利益為統計或學術研究而有必要，且資料經過提供者處理或蒐集者依其揭露方式無從識別特定之當事人。</li>\n<li>當您在網站的行為，違反服務條款或可能損害或妨礙網站與其他使用者權益或導致任何人遭受損害時，經網站管理單位研析揭露您的個人資料是為了辨識、聯絡或採取法律行動所必要者。</li>\n<li>有利於您的權益。</li>\n<li>本網站委託廠商協助蒐集、處理或利用您的個人資料時，將對委外廠商或個人善盡監督管理之責。</li>\n</ul>\n<h3 id=\"六、Cookie-之使用-1\"><a href=\"#六、Cookie-之使用-1\" class=\"headerlink\" title=\"六、Cookie 之使用\"></a>六、Cookie 之使用</h3><p>為了提供您最佳的服務，本網站會在您的電腦中放置並取用我們的 Cookie，若您不願接受 Cookie 的寫入，您可在您使用的瀏覽器功能項中設定隱私權等級為高，即可拒絕 Cookie 的寫入，但可能會導致網站某些功能無法正常執行 。</p>\n<h3 id=\"七、隱私權保護政策之修正-1\"><a href=\"#七、隱私權保護政策之修正-1\" class=\"headerlink\" title=\"七、隱私權保護政策之修正\"></a>七、隱私權保護政策之修正</h3><p>本網站隱私權保護政策將因應需求隨時進行修正，修正後的條款將刊登於網站上。</p>\n<hr>\n<blockquote>\n<p>基礎資料來源: <a href=\"http://www.webguide.nat.gov.tw/index.php/ch/speci/index.html\" target=\"_blank\" rel=\"noopener\">《政府網站版型與內容管理規範》</a></p>\n</blockquote>\n<blockquote>\n<p>如果您需要英文版的模板，可以參考 <a href=\"https://developer.mozilla.org/zh-TW/docs/Mozilla/Marketplace/Publishing/Privacy_policies#Mozilla_Marketplace_.E7.9A.84.E9.9A.B1.E7.A7.81.E6.AC.8A.E8.A6.81.E6.B1.82\" target=\"_blank\" rel=\"noopener\">MDN 隱私權政策制定指南</a> 與 <a href=\"https://github.com/flamsmark/privacy-policy-template\" target=\"_blank\" rel=\"noopener\">https://github.com/flamsmark/privacy-policy-template</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>這是以《政府網站版型與內容管理規範》中為基礎的隱私權條款範本，稍微調整過移除不適用一般企業的項目，任何網站皆可將此範本加上自己的網站名稱，並做修改後使用於網站上。</p>\n<p>請注意，若您要針對此以私權條款模板做修改，需要至少包含以下項目:</p>\n<h3 id=\"一、隱私權保護政策的適用範圍\"><a href=\"#一、隱私權保護政策的適用範圍\" class=\"headerlink\" title=\"一、隱私權保護政策的適用範圍\"></a>一、隱私權保護政策的適用範圍</h3><p>請說明該網站隱私權保護政策的適用範圍。</p>\n<h3 id=\"二、個人資料的蒐集、處理及利用方式\"><a href=\"#二、個人資料的蒐集、處理及利用方式\" class=\"headerlink\" title=\"二、個人資料的蒐集、處理及利用方式\"></a>二、個人資料的蒐集、處理及利用方式</h3><p>請說明該網站針對個人資料的蒐集、處理及利用方式。</p>\n<h3 id=\"三、資料之保護\"><a href=\"#三、資料之保護\" class=\"headerlink\" title=\"三、資料之保護\"></a>三、資料之保護</h3><p>請說明該網站針對取得資料的安全維護措施，如防止個人資料被竊取、竄改、毀損、滅失或洩漏，採取技術上及組織上之必要措施。</p>\n<h3 id=\"四、網站對外的相關連結\"><a href=\"#四、網站對外的相關連結\" class=\"headerlink\" title=\"四、網站對外的相關連結\"></a>四、網站對外的相關連結</h3><p>請說明對外連結網站不適用本網站的隱私權保護政策，必須參考該連結網站中的隱私權保護政策。</p>\n<h3 id=\"五、與第三人共用個人資料之政策\"><a href=\"#五、與第三人共用個人資料之政策\" class=\"headerlink\" title=\"五、與第三人共用個人資料之政策\"></a>五、與第三人共用個人資料之政策</h3><h3 id=\"六、Cookie-之使用\"><a href=\"#六、Cookie-之使用\" class=\"headerlink\" title=\"六、Cookie 之使用\"></a>六、Cookie 之使用</h3><p>請說明該網站使用 Cookie 技術來儲存或追蹤使用者的資料的情況。</p>\n<h3 id=\"七、隱私權保護政策之修正\"><a href=\"#七、隱私權保護政策之修正\" class=\"headerlink\" title=\"七、隱私權保護政策之修正\"></a>七、隱私權保護政策之修正</h3><p>請說明該網站針對隱私權保護政策之修正措施。</p>\n<hr>\n<h2 id=\"隱私權條款範本文件\"><a href=\"#隱私權條款範本文件\" class=\"headerlink\" title=\"隱私權條款範本文件\"></a>隱私權條款範本文件</h2><p>非常歡迎您光臨「NiJia Lin 的個人網站」（以下簡稱本網站），為了讓您能夠安心的使用本網站的各項服務與資訊，特此向您說明本網站的隱私權保護政策，以保障您的權益，請您詳閱下列內容：</p>\n<h3 id=\"一、隱私權保護政策的適用範圍-1\"><a href=\"#一、隱私權保護政策的適用範圍-1\" class=\"headerlink\" title=\"一、隱私權保護政策的適用範圍\"></a>一、隱私權保護政策的適用範圍</h3><p>隱私權保護政策內容，包括本網站如何處理在您使用網站服務時收集到的個人識別資料。隱私權保護政策不適用於本網站以外的相關連結網站，也不適用於非本網站所委託或參與管理的人員。</p>\n<h3 id=\"二、個人資料的蒐集、處理及利用方式-1\"><a href=\"#二、個人資料的蒐集、處理及利用方式-1\" class=\"headerlink\" title=\"二、個人資料的蒐集、處理及利用方式\"></a>二、個人資料的蒐集、處理及利用方式</h3><ul>\n<li>當您造訪本網站或使用本網站所提供之功能服務時，我們將視該服務功能性質，請您提供必要的個人資料，並在該特定目的範圍內處理及利用您的個人資料；非經您書面同意，本網站不會將個人資料用於其他用途。</li>\n<li>本網站在您使用服務信箱、問卷調查等互動性功能時，會保留您所提供的姓名、電子郵件地址、聯絡方式及使用時間等。</li>\n<li>於一般瀏覽時，伺服器會自行記錄相關行徑，包括您使用連線設備的 IP 位址、使用時間、使用的瀏覽器、瀏覽及點選資料記錄等，做為我們增進網站服務的參考依據，此記錄為內部應用，決不對外公佈。</li>\n<li>為提供精確的服務，我們會將收集的問卷調查內容進行統計與分析，分析結果之統計數據或說明文字呈現，除供內部研究外，我們會視需要公佈統計數據及說明文字，但不涉及特定個人之資料。</li>\n</ul>\n<h3 id=\"三、資料之保護-1\"><a href=\"#三、資料之保護-1\" class=\"headerlink\" title=\"三、資料之保護\"></a>三、資料之保護</h3><ul>\n<li>本網站主機均設有防火牆、防毒系統等相關的各項資訊安全設備及必要的安全防護措施，加以保護網站及您的個人資料採用嚴格的保護措施，只由經過授權的人員才能接觸您的個人資料，相關處理人員皆簽有保密合約，如有違反保密義務者，將會受到相關的法律處分。</li>\n<li>如因業務需要有必要委託其他單位提供服務時，本網站亦會嚴格要求其遵守保密義務，並且採取必要檢查程序以確定其將確實遵守。</li>\n</ul>\n<h3 id=\"四、網站對外的相關連結-1\"><a href=\"#四、網站對外的相關連結-1\" class=\"headerlink\" title=\"四、網站對外的相關連結\"></a>四、網站對外的相關連結</h3><p>本網站的網頁提供其他網站的網路連結，您也可經由本網站所提供的連結，點選進入其他網站。但該連結網站不適用本網站的隱私權保護政策，您必須參考該連結網站中的隱私權保護政策。</p>\n<h3 id=\"五、與第三人共用個人資料之政策-1\"><a href=\"#五、與第三人共用個人資料之政策-1\" class=\"headerlink\" title=\"五、與第三人共用個人資料之政策\"></a>五、與第三人共用個人資料之政策</h3><p>本網站絕不會提供、交換、出租或出售任何您的個人資料給其他個人、團體、私人企業或公務機關，但有法律依據或合約義務者，不在此限。</p>\n<p>前項但書之情形包括不限於：</p>\n<ul>\n<li>經由您書面同意。</li>\n<li>法律明文規定。</li>\n<li>為免除您生命、身體、自由或財產上之危險。</li>\n<li>與公務機關或學術研究機構合作，基於公共利益為統計或學術研究而有必要，且資料經過提供者處理或蒐集者依其揭露方式無從識別特定之當事人。</li>\n<li>當您在網站的行為，違反服務條款或可能損害或妨礙網站與其他使用者權益或導致任何人遭受損害時，經網站管理單位研析揭露您的個人資料是為了辨識、聯絡或採取法律行動所必要者。</li>\n<li>有利於您的權益。</li>\n<li>本網站委託廠商協助蒐集、處理或利用您的個人資料時，將對委外廠商或個人善盡監督管理之責。</li>\n</ul>\n<h3 id=\"六、Cookie-之使用-1\"><a href=\"#六、Cookie-之使用-1\" class=\"headerlink\" title=\"六、Cookie 之使用\"></a>六、Cookie 之使用</h3><p>為了提供您最佳的服務，本網站會在您的電腦中放置並取用我們的 Cookie，若您不願接受 Cookie 的寫入，您可在您使用的瀏覽器功能項中設定隱私權等級為高，即可拒絕 Cookie 的寫入，但可能會導致網站某些功能無法正常執行 。</p>\n<h3 id=\"七、隱私權保護政策之修正-1\"><a href=\"#七、隱私權保護政策之修正-1\" class=\"headerlink\" title=\"七、隱私權保護政策之修正\"></a>七、隱私權保護政策之修正</h3><p>本網站隱私權保護政策將因應需求隨時進行修正，修正後的條款將刊登於網站上。</p>\n<hr>\n<blockquote>\n<p>基礎資料來源: <a href=\"http://www.webguide.nat.gov.tw/index.php/ch/speci/index.html\" target=\"_blank\" rel=\"noopener\">《政府網站版型與內容管理規範》</a></p>\n</blockquote>\n<blockquote>\n<p>如果您需要英文版的模板，可以參考 <a href=\"https://developer.mozilla.org/zh-TW/docs/Mozilla/Marketplace/Publishing/Privacy_policies#Mozilla_Marketplace_.E7.9A.84.E9.9A.B1.E7.A7.81.E6.AC.8A.E8.A6.81.E6.B1.82\" target=\"_blank\" rel=\"noopener\">MDN 隱私權政策制定指南</a> 與 <a href=\"https://github.com/flamsmark/privacy-policy-template\" target=\"_blank\" rel=\"noopener\">https://github.com/flamsmark/privacy-policy-template</a></p>\n</blockquote>\n"},{"title":"關於 NiJia Lin","date":"2019-10-16T03:28:36.000Z","_content":"\n目前為 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) Co-organizer 以及 台灣 **11** 位 [LINE API Expert](https://www.line-community.me/contributors) 之一，平時喜愛關注與貢獻 GitHub 上的各種開源專案，從 ReadMe 的撰寫到程式碼的各種架構應用，盡可能在業餘時間幫忙 Close Issue，同時也熱愛參加各大研討會了解當前技術的走向與認識來自不同社群的朋友，對於新事物總是有著很多的熱情並勇於嘗試，休閒時間可為一位 **農夫**、**健身者** 或 從替代役時期服務至今的**身障教養院 志工**，其餘時間則熱愛研究與貢獻各種有趣的開源專案，並於 2019 獲得 **LINE 官方專將認證** 與 iThome 鐵人賽 Modern Web 組**佳作**。\n\n- 👊🐛Backend Developer\n- 👨‍🌾Farmer / 🏋️‍♂️Body Builder\n- ⭐️[2019 LINE API Expert](https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0)\n- 👾[Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - Co-organizers\n- 😇 德水園身障教養院 - 長期志工 2016~\n\n# Experience\n\n- 凱納股份有限公司 2019/06~2020/04\n- 慶宇行銷有限公司 2018/05~2019/05\n- 宜興資訊有限公司 2017/09~2018/05\n\n# Education\n\n- 朝陽科技大學 - 碩士 2015/09~2016/6\n- 朝陽科技大學 - 學士 2011/09~2015/6\n\n# Achievements\n\n- [LINE API Expert](https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0) - 2019\n- [iThome 2019 第 11 屆 **佳作**](https://ithelp.ithome.com.tw/announces/48) - 2019-11-26\n\n# Skills\n\n### Frontend\n\n- Javascript / Vue.js, jQuery\n- CSS / Bootstrap\n\n### Backend\n\n- Python / Flask\n- NodeJS / express\n- Ruby / Rails\n\n### SQL / NoSQL\n\n- PostgreSQL / MySQL\n- MongoDB / Redis\n\n### Others\n\n| Category       | List                                                                      |\n| -------------- | ------------------------------------------------------------------------- |\n| AWS            | Route53, CloudFront, SQS, Lambda, API Gateway, Amplify, S3, Cognito, IoT  |\n| LINE           | Message API(Bot), Notify, Login, LIFF                                     |\n| OS             | Ubuntu, CentOS                                                            |\n| Git            | GitHub, Azure DevOps, Bitbucket                                           |\n| Google         | Dialogflow                                                                |\n| Document tools | Markdown, [Swagger](https://github.com/louis70109/aws-swagger-wsgi-flask) |\n| DevOps         | Docker, Serverless                                                        |\n\n# Workshop\n\n- [手把手帶你用 LINE Notify @ 朝陽科技大學(2019/05)](https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527)\n- [GDG 週年之 Hachathon party @ GDG Taichung #12](https://www.meetup.com/GDGTaichung/events/266686542/)\n\n# Side project\n\n- [Lotify](https://github.com/louis70109/lotify) - LINE Notify Client SDK\n- [肌肉仔](https://github.com/louis70109/muscle_man)\n- [2019 鐵人賽 Serverless 範例](https://github.com/louis70109/aws-python-line-api)\n- [圖奇獸 - Twitch Bot](https://github.com/louis70109/Twitch-Bot) - 基於 Bottender 建立查詢 Twtich 直播的 LINE bot\n- [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot)\n- ~~[ABL 台灣隊賽程查詢機器人](https://github.com/louis70109/Taiwan-ABL-games)~~ (因疫情關係停賽導致無法更新 😭)\n- [動物森友會揪團機器人](https://github.com/louis70109/animal-crossing-bot)\n\n# Talks\n\n- [COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot](https://coscup2019.kktix.cc/events/coscup-taigi2019?)\n  - [活動照片](https://www.flickr.com/photos/coscup/49694567242/in/album-72157713607815171/)\n  - [影片](https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3)\n- [Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot](https://chatbots.kktix.cc/events/meetup-019)\n  - [直播剪輯](https://www.youtube.com/watch?v=agYVz6dzh1I)\n  - [投影片](https://www.slideshare.net/JiaYuLin6/build-line-notify-bot-by-lotify-and-create-client-library-by-swagger-20200527-234623929)\n- [Chatbot Taiwan meetup 14 - 如何使用 kamigo 加速開發 LINE bot](https://chatbots.kktix.cc/events/meetup-014)\n  - [投影片](https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007)\n- [Chatbot Taiwan meetup 8 - Chatbot x IOT](https://chatbots.kktix.cc/events/meetup-008)\n\n# Videos\n\n- [COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot](https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3)\n- [Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot](https://www.youtube.com/watch?v=agYVz6dzh1I)\n- [Chatbot Taiwan meetup 14 - 如何使用 kamigo 快速打造 LINE bot](https://youtu.be/EJgfjrfVZPo)\n- [Modern Web 2019 - muscle man lighting talk](https://www.youtube.com/watch?v=0UUFH_nysFY)\n- [Modern web 2019 - Twitch bot lighting talk](https://www.youtube.com/watch?v=Plt9Hbt3P_I)\n- [Modern web 2019 - Live demo Kamigo gem in dojo](https://www.youtube.com/watch?v=rtULUl1eyXo)\n\n# Activities\n\n### Organizer\n\n- [2019 / 2020 COSCUP [chatbot Taiwan]](https://coscup.org/2019/)\n- [2019 Modern Web [Chatbot Taiwan]](https://modernweb.tw/2019/index.html)\n- [2019 MOPCON [Chatbot Taiwan]](https://mopcon.org/2019/community/)\n","source":"about/index.md","raw":"---\ntitle: 關於 NiJia Lin\ndate: 2019-10-16 11:28:36\n---\n\n目前為 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) Co-organizer 以及 台灣 **11** 位 [LINE API Expert](https://www.line-community.me/contributors) 之一，平時喜愛關注與貢獻 GitHub 上的各種開源專案，從 ReadMe 的撰寫到程式碼的各種架構應用，盡可能在業餘時間幫忙 Close Issue，同時也熱愛參加各大研討會了解當前技術的走向與認識來自不同社群的朋友，對於新事物總是有著很多的熱情並勇於嘗試，休閒時間可為一位 **農夫**、**健身者** 或 從替代役時期服務至今的**身障教養院 志工**，其餘時間則熱愛研究與貢獻各種有趣的開源專案，並於 2019 獲得 **LINE 官方專將認證** 與 iThome 鐵人賽 Modern Web 組**佳作**。\n\n- 👊🐛Backend Developer\n- 👨‍🌾Farmer / 🏋️‍♂️Body Builder\n- ⭐️[2019 LINE API Expert](https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0)\n- 👾[Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - Co-organizers\n- 😇 德水園身障教養院 - 長期志工 2016~\n\n# Experience\n\n- 凱納股份有限公司 2019/06~2020/04\n- 慶宇行銷有限公司 2018/05~2019/05\n- 宜興資訊有限公司 2017/09~2018/05\n\n# Education\n\n- 朝陽科技大學 - 碩士 2015/09~2016/6\n- 朝陽科技大學 - 學士 2011/09~2015/6\n\n# Achievements\n\n- [LINE API Expert](https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0) - 2019\n- [iThome 2019 第 11 屆 **佳作**](https://ithelp.ithome.com.tw/announces/48) - 2019-11-26\n\n# Skills\n\n### Frontend\n\n- Javascript / Vue.js, jQuery\n- CSS / Bootstrap\n\n### Backend\n\n- Python / Flask\n- NodeJS / express\n- Ruby / Rails\n\n### SQL / NoSQL\n\n- PostgreSQL / MySQL\n- MongoDB / Redis\n\n### Others\n\n| Category       | List                                                                      |\n| -------------- | ------------------------------------------------------------------------- |\n| AWS            | Route53, CloudFront, SQS, Lambda, API Gateway, Amplify, S3, Cognito, IoT  |\n| LINE           | Message API(Bot), Notify, Login, LIFF                                     |\n| OS             | Ubuntu, CentOS                                                            |\n| Git            | GitHub, Azure DevOps, Bitbucket                                           |\n| Google         | Dialogflow                                                                |\n| Document tools | Markdown, [Swagger](https://github.com/louis70109/aws-swagger-wsgi-flask) |\n| DevOps         | Docker, Serverless                                                        |\n\n# Workshop\n\n- [手把手帶你用 LINE Notify @ 朝陽科技大學(2019/05)](https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527)\n- [GDG 週年之 Hachathon party @ GDG Taichung #12](https://www.meetup.com/GDGTaichung/events/266686542/)\n\n# Side project\n\n- [Lotify](https://github.com/louis70109/lotify) - LINE Notify Client SDK\n- [肌肉仔](https://github.com/louis70109/muscle_man)\n- [2019 鐵人賽 Serverless 範例](https://github.com/louis70109/aws-python-line-api)\n- [圖奇獸 - Twitch Bot](https://github.com/louis70109/Twitch-Bot) - 基於 Bottender 建立查詢 Twtich 直播的 LINE bot\n- [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot)\n- ~~[ABL 台灣隊賽程查詢機器人](https://github.com/louis70109/Taiwan-ABL-games)~~ (因疫情關係停賽導致無法更新 😭)\n- [動物森友會揪團機器人](https://github.com/louis70109/animal-crossing-bot)\n\n# Talks\n\n- [COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot](https://coscup2019.kktix.cc/events/coscup-taigi2019?)\n  - [活動照片](https://www.flickr.com/photos/coscup/49694567242/in/album-72157713607815171/)\n  - [影片](https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3)\n- [Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot](https://chatbots.kktix.cc/events/meetup-019)\n  - [直播剪輯](https://www.youtube.com/watch?v=agYVz6dzh1I)\n  - [投影片](https://www.slideshare.net/JiaYuLin6/build-line-notify-bot-by-lotify-and-create-client-library-by-swagger-20200527-234623929)\n- [Chatbot Taiwan meetup 14 - 如何使用 kamigo 加速開發 LINE bot](https://chatbots.kktix.cc/events/meetup-014)\n  - [投影片](https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007)\n- [Chatbot Taiwan meetup 8 - Chatbot x IOT](https://chatbots.kktix.cc/events/meetup-008)\n\n# Videos\n\n- [COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot](https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3)\n- [Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot](https://www.youtube.com/watch?v=agYVz6dzh1I)\n- [Chatbot Taiwan meetup 14 - 如何使用 kamigo 快速打造 LINE bot](https://youtu.be/EJgfjrfVZPo)\n- [Modern Web 2019 - muscle man lighting talk](https://www.youtube.com/watch?v=0UUFH_nysFY)\n- [Modern web 2019 - Twitch bot lighting talk](https://www.youtube.com/watch?v=Plt9Hbt3P_I)\n- [Modern web 2019 - Live demo Kamigo gem in dojo](https://www.youtube.com/watch?v=rtULUl1eyXo)\n\n# Activities\n\n### Organizer\n\n- [2019 / 2020 COSCUP [chatbot Taiwan]](https://coscup.org/2019/)\n- [2019 Modern Web [Chatbot Taiwan]](https://modernweb.tw/2019/index.html)\n- [2019 MOPCON [Chatbot Taiwan]](https://mopcon.org/2019/community/)\n","updated":"2020-06-07T13:46:37.794Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckbuc31il00027crid87oooyd","content":"<p>目前為 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> Co-organizer 以及 台灣 <strong>11</strong> 位 <a href=\"https://www.line-community.me/contributors\" target=\"_blank\" rel=\"noopener\">LINE API Expert</a> 之一，平時喜愛關注與貢獻 GitHub 上的各種開源專案，從 ReadMe 的撰寫到程式碼的各種架構應用，盡可能在業餘時間幫忙 Close Issue，同時也熱愛參加各大研討會了解當前技術的走向與認識來自不同社群的朋友，對於新事物總是有著很多的熱情並勇於嘗試，休閒時間可為一位 <strong>農夫</strong>、<strong>健身者</strong> 或 從替代役時期服務至今的<strong>身障教養院 志工</strong>，其餘時間則熱愛研究與貢獻各種有趣的開源專案，並於 2019 獲得 <strong>LINE 官方專將認證</strong> 與 iThome 鐵人賽 Modern Web 組<strong>佳作</strong>。</p>\n<ul>\n<li>👊🐛Backend Developer</li>\n<li>👨‍🌾Farmer / 🏋️‍♂️Body Builder</li>\n<li>⭐️<a href=\"https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0\" target=\"_blank\" rel=\"noopener\">2019 LINE API Expert</a></li>\n<li>👾<a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - Co-organizers</li>\n<li>😇 德水園身障教養院 - 長期志工 2016~</li>\n</ul>\n<h1 id=\"Experience\"><a href=\"#Experience\" class=\"headerlink\" title=\"Experience\"></a>Experience</h1><ul>\n<li>凱納股份有限公司 2019/06~2020/04</li>\n<li>慶宇行銷有限公司 2018/05~2019/05</li>\n<li>宜興資訊有限公司 2017/09~2018/05</li>\n</ul>\n<h1 id=\"Education\"><a href=\"#Education\" class=\"headerlink\" title=\"Education\"></a>Education</h1><ul>\n<li>朝陽科技大學 - 碩士 2015/09~2016/6</li>\n<li>朝陽科技大學 - 學士 2011/09~2015/6</li>\n</ul>\n<h1 id=\"Achievements\"><a href=\"#Achievements\" class=\"headerlink\" title=\"Achievements\"></a>Achievements</h1><ul>\n<li><a href=\"https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0\" target=\"_blank\" rel=\"noopener\">LINE API Expert</a> - 2019</li>\n<li><a href=\"https://ithelp.ithome.com.tw/announces/48\" target=\"_blank\" rel=\"noopener\">iThome 2019 第 11 屆 <strong>佳作</strong></a> - 2019-11-26</li>\n</ul>\n<h1 id=\"Skills\"><a href=\"#Skills\" class=\"headerlink\" title=\"Skills\"></a>Skills</h1><h3 id=\"Frontend\"><a href=\"#Frontend\" class=\"headerlink\" title=\"Frontend\"></a>Frontend</h3><ul>\n<li>Javascript / Vue.js, jQuery</li>\n<li>CSS / Bootstrap</li>\n</ul>\n<h3 id=\"Backend\"><a href=\"#Backend\" class=\"headerlink\" title=\"Backend\"></a>Backend</h3><ul>\n<li>Python / Flask</li>\n<li>NodeJS / express</li>\n<li>Ruby / Rails</li>\n</ul>\n<h3 id=\"SQL-NoSQL\"><a href=\"#SQL-NoSQL\" class=\"headerlink\" title=\"SQL / NoSQL\"></a>SQL / NoSQL</h3><ul>\n<li>PostgreSQL / MySQL</li>\n<li>MongoDB / Redis</li>\n</ul>\n<h3 id=\"Others\"><a href=\"#Others\" class=\"headerlink\" title=\"Others\"></a>Others</h3><table>\n<thead>\n<tr>\n<th>Category</th>\n<th>List</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AWS</td>\n<td>Route53, CloudFront, SQS, Lambda, API Gateway, Amplify, S3, Cognito, IoT</td>\n</tr>\n<tr>\n<td>LINE</td>\n<td>Message API(Bot), Notify, Login, LIFF</td>\n</tr>\n<tr>\n<td>OS</td>\n<td>Ubuntu, CentOS</td>\n</tr>\n<tr>\n<td>Git</td>\n<td>GitHub, Azure DevOps, Bitbucket</td>\n</tr>\n<tr>\n<td>Google</td>\n<td>Dialogflow</td>\n</tr>\n<tr>\n<td>Document tools</td>\n<td>Markdown, <a href=\"https://github.com/louis70109/aws-swagger-wsgi-flask\" target=\"_blank\" rel=\"noopener\">Swagger</a></td>\n</tr>\n<tr>\n<td>DevOps</td>\n<td>Docker, Serverless</td>\n</tr>\n</tbody></table>\n<h1 id=\"Workshop\"><a href=\"#Workshop\" class=\"headerlink\" title=\"Workshop\"></a>Workshop</h1><ul>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527\" target=\"_blank\" rel=\"noopener\">手把手帶你用 LINE Notify @ 朝陽科技大學(2019/05)</a></li>\n<li><a href=\"https://www.meetup.com/GDGTaichung/events/266686542/\" target=\"_blank\" rel=\"noopener\">GDG 週年之 Hachathon party @ GDG Taichung #12</a></li>\n</ul>\n<h1 id=\"Side-project\"><a href=\"#Side-project\" class=\"headerlink\" title=\"Side project\"></a>Side project</h1><ul>\n<li><a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">Lotify</a> - LINE Notify Client SDK</li>\n<li><a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a></li>\n<li><a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">2019 鐵人賽 Serverless 範例</a></li>\n<li><a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">圖奇獸 - Twitch Bot</a> - 基於 Bottender 建立查詢 Twtich 直播的 LINE bot</li>\n<li><a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a></li>\n<li><del><a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">ABL 台灣隊賽程查詢機器人</a></del> (因疫情關係停賽導致無法更新 😭)</li>\n<li><a href=\"https://github.com/louis70109/animal-crossing-bot\" target=\"_blank\" rel=\"noopener\">動物森友會揪團機器人</a></li>\n</ul>\n<h1 id=\"Talks\"><a href=\"#Talks\" class=\"headerlink\" title=\"Talks\"></a>Talks</h1><ul>\n<li><a href=\"https://coscup2019.kktix.cc/events/coscup-taigi2019?\" target=\"_blank\" rel=\"noopener\">COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot</a><ul>\n<li><a href=\"https://www.flickr.com/photos/coscup/49694567242/in/album-72157713607815171/\" target=\"_blank\" rel=\"noopener\">活動照片</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3\" target=\"_blank\" rel=\"noopener\">影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-019\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot</a><ul>\n<li><a href=\"https://www.youtube.com/watch?v=agYVz6dzh1I\" target=\"_blank\" rel=\"noopener\">直播剪輯</a></li>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/build-line-notify-bot-by-lotify-and-create-client-library-by-swagger-20200527-234623929\" target=\"_blank\" rel=\"noopener\">投影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-014\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 14 - 如何使用 kamigo 加速開發 LINE bot</a><ul>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007\" target=\"_blank\" rel=\"noopener\">投影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-008\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 8 - Chatbot x IOT</a></li>\n</ul>\n<h1 id=\"Videos\"><a href=\"#Videos\" class=\"headerlink\" title=\"Videos\"></a>Videos</h1><ul>\n<li><a href=\"https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3\" target=\"_blank\" rel=\"noopener\">COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=agYVz6dzh1I\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot</a></li>\n<li><a href=\"https://youtu.be/EJgfjrfVZPo\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 14 - 如何使用 kamigo 快速打造 LINE bot</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=0UUFH_nysFY\" target=\"_blank\" rel=\"noopener\">Modern Web 2019 - muscle man lighting talk</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=Plt9Hbt3P_I\" target=\"_blank\" rel=\"noopener\">Modern web 2019 - Twitch bot lighting talk</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=rtULUl1eyXo\" target=\"_blank\" rel=\"noopener\">Modern web 2019 - Live demo Kamigo gem in dojo</a></li>\n</ul>\n<h1 id=\"Activities\"><a href=\"#Activities\" class=\"headerlink\" title=\"Activities\"></a>Activities</h1><h3 id=\"Organizer\"><a href=\"#Organizer\" class=\"headerlink\" title=\"Organizer\"></a>Organizer</h3><ul>\n<li><a href=\"https://coscup.org/2019/\" target=\"_blank\" rel=\"noopener\">2019 / 2020 COSCUP [chatbot Taiwan]</a></li>\n<li><a href=\"https://modernweb.tw/2019/index.html\" target=\"_blank\" rel=\"noopener\">2019 Modern Web [Chatbot Taiwan]</a></li>\n<li><a href=\"https://mopcon.org/2019/community/\" target=\"_blank\" rel=\"noopener\">2019 MOPCON [Chatbot Taiwan]</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>目前為 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> Co-organizer 以及 台灣 <strong>11</strong> 位 <a href=\"https://www.line-community.me/contributors\" target=\"_blank\" rel=\"noopener\">LINE API Expert</a> 之一，平時喜愛關注與貢獻 GitHub 上的各種開源專案，從 ReadMe 的撰寫到程式碼的各種架構應用，盡可能在業餘時間幫忙 Close Issue，同時也熱愛參加各大研討會了解當前技術的走向與認識來自不同社群的朋友，對於新事物總是有著很多的熱情並勇於嘗試，休閒時間可為一位 <strong>農夫</strong>、<strong>健身者</strong> 或 從替代役時期服務至今的<strong>身障教養院 志工</strong>，其餘時間則熱愛研究與貢獻各種有趣的開源專案，並於 2019 獲得 <strong>LINE 官方專將認證</strong> 與 iThome 鐵人賽 Modern Web 組<strong>佳作</strong>。</p>\n<ul>\n<li>👊🐛Backend Developer</li>\n<li>👨‍🌾Farmer / 🏋️‍♂️Body Builder</li>\n<li>⭐️<a href=\"https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0\" target=\"_blank\" rel=\"noopener\">2019 LINE API Expert</a></li>\n<li>👾<a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - Co-organizers</li>\n<li>😇 德水園身障教養院 - 長期志工 2016~</li>\n</ul>\n<h1 id=\"Experience\"><a href=\"#Experience\" class=\"headerlink\" title=\"Experience\"></a>Experience</h1><ul>\n<li>凱納股份有限公司 2019/06~2020/04</li>\n<li>慶宇行銷有限公司 2018/05~2019/05</li>\n<li>宜興資訊有限公司 2017/09~2018/05</li>\n</ul>\n<h1 id=\"Education\"><a href=\"#Education\" class=\"headerlink\" title=\"Education\"></a>Education</h1><ul>\n<li>朝陽科技大學 - 碩士 2015/09~2016/6</li>\n<li>朝陽科技大學 - 學士 2011/09~2015/6</li>\n</ul>\n<h1 id=\"Achievements\"><a href=\"#Achievements\" class=\"headerlink\" title=\"Achievements\"></a>Achievements</h1><ul>\n<li><a href=\"https://www.line-community.me/contributors/detail?apiId=0037F00001fJ0NHQA0\" target=\"_blank\" rel=\"noopener\">LINE API Expert</a> - 2019</li>\n<li><a href=\"https://ithelp.ithome.com.tw/announces/48\" target=\"_blank\" rel=\"noopener\">iThome 2019 第 11 屆 <strong>佳作</strong></a> - 2019-11-26</li>\n</ul>\n<h1 id=\"Skills\"><a href=\"#Skills\" class=\"headerlink\" title=\"Skills\"></a>Skills</h1><h3 id=\"Frontend\"><a href=\"#Frontend\" class=\"headerlink\" title=\"Frontend\"></a>Frontend</h3><ul>\n<li>Javascript / Vue.js, jQuery</li>\n<li>CSS / Bootstrap</li>\n</ul>\n<h3 id=\"Backend\"><a href=\"#Backend\" class=\"headerlink\" title=\"Backend\"></a>Backend</h3><ul>\n<li>Python / Flask</li>\n<li>NodeJS / express</li>\n<li>Ruby / Rails</li>\n</ul>\n<h3 id=\"SQL-NoSQL\"><a href=\"#SQL-NoSQL\" class=\"headerlink\" title=\"SQL / NoSQL\"></a>SQL / NoSQL</h3><ul>\n<li>PostgreSQL / MySQL</li>\n<li>MongoDB / Redis</li>\n</ul>\n<h3 id=\"Others\"><a href=\"#Others\" class=\"headerlink\" title=\"Others\"></a>Others</h3><table>\n<thead>\n<tr>\n<th>Category</th>\n<th>List</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AWS</td>\n<td>Route53, CloudFront, SQS, Lambda, API Gateway, Amplify, S3, Cognito, IoT</td>\n</tr>\n<tr>\n<td>LINE</td>\n<td>Message API(Bot), Notify, Login, LIFF</td>\n</tr>\n<tr>\n<td>OS</td>\n<td>Ubuntu, CentOS</td>\n</tr>\n<tr>\n<td>Git</td>\n<td>GitHub, Azure DevOps, Bitbucket</td>\n</tr>\n<tr>\n<td>Google</td>\n<td>Dialogflow</td>\n</tr>\n<tr>\n<td>Document tools</td>\n<td>Markdown, <a href=\"https://github.com/louis70109/aws-swagger-wsgi-flask\" target=\"_blank\" rel=\"noopener\">Swagger</a></td>\n</tr>\n<tr>\n<td>DevOps</td>\n<td>Docker, Serverless</td>\n</tr>\n</tbody></table>\n<h1 id=\"Workshop\"><a href=\"#Workshop\" class=\"headerlink\" title=\"Workshop\"></a>Workshop</h1><ul>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527\" target=\"_blank\" rel=\"noopener\">手把手帶你用 LINE Notify @ 朝陽科技大學(2019/05)</a></li>\n<li><a href=\"https://www.meetup.com/GDGTaichung/events/266686542/\" target=\"_blank\" rel=\"noopener\">GDG 週年之 Hachathon party @ GDG Taichung #12</a></li>\n</ul>\n<h1 id=\"Side-project\"><a href=\"#Side-project\" class=\"headerlink\" title=\"Side project\"></a>Side project</h1><ul>\n<li><a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">Lotify</a> - LINE Notify Client SDK</li>\n<li><a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a></li>\n<li><a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">2019 鐵人賽 Serverless 範例</a></li>\n<li><a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">圖奇獸 - Twitch Bot</a> - 基於 Bottender 建立查詢 Twtich 直播的 LINE bot</li>\n<li><a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a></li>\n<li><del><a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">ABL 台灣隊賽程查詢機器人</a></del> (因疫情關係停賽導致無法更新 😭)</li>\n<li><a href=\"https://github.com/louis70109/animal-crossing-bot\" target=\"_blank\" rel=\"noopener\">動物森友會揪團機器人</a></li>\n</ul>\n<h1 id=\"Talks\"><a href=\"#Talks\" class=\"headerlink\" title=\"Talks\"></a>Talks</h1><ul>\n<li><a href=\"https://coscup2019.kktix.cc/events/coscup-taigi2019?\" target=\"_blank\" rel=\"noopener\">COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot</a><ul>\n<li><a href=\"https://www.flickr.com/photos/coscup/49694567242/in/album-72157713607815171/\" target=\"_blank\" rel=\"noopener\">活動照片</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3\" target=\"_blank\" rel=\"noopener\">影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-019\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot</a><ul>\n<li><a href=\"https://www.youtube.com/watch?v=agYVz6dzh1I\" target=\"_blank\" rel=\"noopener\">直播剪輯</a></li>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/build-line-notify-bot-by-lotify-and-create-client-library-by-swagger-20200527-234623929\" target=\"_blank\" rel=\"noopener\">投影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-014\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 14 - 如何使用 kamigo 加速開發 LINE bot</a><ul>\n<li><a href=\"https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007\" target=\"_blank\" rel=\"noopener\">投影片</a></li>\n</ul>\n</li>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-008\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 8 - Chatbot x IOT</a></li>\n</ul>\n<h1 id=\"Videos\"><a href=\"#Videos\" class=\"headerlink\" title=\"Videos\"></a>Videos</h1><ul>\n<li><a href=\"https://www.youtube.com/watch?v=wXV8aPj1Ibo&list=PLqfib4St70XNIzROJgyALYAdp-sQmfK0m&index=3\" target=\"_blank\" rel=\"noopener\">COSCUP 「來台講」- 有一 tsiah 完全用 kamigo 做出來 ê muscle-man line bot</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=agYVz6dzh1I\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 19 - 使用 Lotify + Swagger 建置可共用的 LINE Notify bot</a></li>\n<li><a href=\"https://youtu.be/EJgfjrfVZPo\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan meetup 14 - 如何使用 kamigo 快速打造 LINE bot</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=0UUFH_nysFY\" target=\"_blank\" rel=\"noopener\">Modern Web 2019 - muscle man lighting talk</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=Plt9Hbt3P_I\" target=\"_blank\" rel=\"noopener\">Modern web 2019 - Twitch bot lighting talk</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=rtULUl1eyXo\" target=\"_blank\" rel=\"noopener\">Modern web 2019 - Live demo Kamigo gem in dojo</a></li>\n</ul>\n<h1 id=\"Activities\"><a href=\"#Activities\" class=\"headerlink\" title=\"Activities\"></a>Activities</h1><h3 id=\"Organizer\"><a href=\"#Organizer\" class=\"headerlink\" title=\"Organizer\"></a>Organizer</h3><ul>\n<li><a href=\"https://coscup.org/2019/\" target=\"_blank\" rel=\"noopener\">2019 / 2020 COSCUP [chatbot Taiwan]</a></li>\n<li><a href=\"https://modernweb.tw/2019/index.html\" target=\"_blank\" rel=\"noopener\">2019 Modern Web [Chatbot Taiwan]</a></li>\n<li><a href=\"https://mopcon.org/2019/community/\" target=\"_blank\" rel=\"noopener\">2019 MOPCON [Chatbot Taiwan]</a></li>\n</ul>\n"},{"title":"分類","date":"2019-10-16T13:12:49.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: 分類\ndate: 2019-10-16 21:12:49\ntype: \"categories\"\n---\n","updated":"2019-10-16T13:23:51.000Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckbuc31iq00057cribjj6hvsb","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"文章標籤","date":"2019-10-16T03:32:40.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: 文章標籤\ndate: 2019-10-16 11:32:40\ntype: \"tags\"\n---\n","updated":"2019-10-16T13:23:20.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckbuc31te00en7criseodc1pf","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"[object Object]","abbrlink":2185937872,"_content":"\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n四月底離開前公司後，\b\b 休息了一個禮拜後終於開始丟履歷(太空戰士 7 終於全破了 😝)，休息期間也安排時間找朋友一起共同開發 LINE Notify Client SDK - [lotify](https://github.com/louis70109/lotify)，把我們所學到的東西 (單元測試、CI、版本演進、一鍵部署...) 用更好的方式呈現出來給大家，接著就來回顧一下自己這段時間準備的東西。\n\n<!-- more -->\n\n# 使用平台\n\n休息是為了走更長的路，但一直休息就不對 🤣，有別於之前都只用 104，這次用了以下幾個平台來交叉比對找工作：\n\n- 104\n- Linkedin\n- Yourator\n- CakeResume\n\n> 同時管理這麼多平台時，HR 打來聊的時候都很容易錯亂他是從哪個平台找到我的～哈哈，尤其漏了一些東西時還會更莫名其妙 😆\n\n# 分析自己\n\n## 優點\n\n## 缺點\n\n# Chatbot\n\n## 了解多少\n\n有些人總是認為 Chatbot 就是有 AI，但這樣的想法不完全對，主要是以回覆、推播的方式存在，再依照各個平台產生不一樣的擴充功能。\n\n以 LINE 來說，擴充功能就含有 ImageMap、FlexMessage、LIFF、之前的 LINE Things、Quick Reply(FB 先出的)，在基於這些實作出與行銷相關的 API(NarrowCast)、如小程序般的 Share Target Picker 以及可以管理 Access Token 的功能...\n\n另一方面我認為 Chatbot 跟做全端的感覺很像，如卡米哥去年做的 Kamigo 一樣，與 Rails 巧妙的結合，如前端般的用 js 控制 LIFF 做表單填寫、FlexMessage 的轉譯器將訊息轉成卡片的方式呈現給使用者，使用正規表示法從路由(Route)就處理針對使用者發送不同話語時所對應的 Controller，Model 就處理 Schema 相關以及資料定位的問題。\n\n## 開發時有遇過什麼麻煩的事\n\n初期串接 DialogFlow 時總是將它放在程式的源頭，殊不知這樣會錯失許多彈性，經由 Bottender 的承澤哥在某次小聚與我解釋了老半天才得知應當在程式邏輯處理完時這句還是無法辨識，才丟進去 DialogFlow 去做意圖偵測，這樣方法讓程式先運行後可做較多的前處理，如此一來就可以有效地控制使用者的行為，抑或是下註解。\n\n# 目標\n\n## 短期\n\n- DevOps or SRE 相關技能\n- 在實戰中多用 SOLID、Clean Code 相關技能\n- 增進對文案的敏感度\n\n## 中期\n\n持續分享文章吧，很認同 Evan 常於演講時所說他是「如何~~成為 GDE~~學習 Golang 」中的這一段，分享對我從來就不是為了拿頭銜，頭銜 \b 或證照是用來認可你的努力與熱情，所以繼續撰文影響更多的新血以及幫助到許多有著相同問題的人，然後繼續投稿各大研討會，讓自己的分享的內容可以讓大家知道並挑戰不一樣的自己。\n\n## 長期\n\n多方學習不同領域的技能，讓自己保持學習熱忱。\n\n# 結論\n","source":"_drafts/2020-春轉夏的個人檢視.md","raw":"---\ntitle:\n  '[object Object]': null\ncategories: 日記\nabbrlink: 2185937872\ntags:\n---\n\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n四月底離開前公司後，\b\b 休息了一個禮拜後終於開始丟履歷(太空戰士 7 終於全破了 😝)，休息期間也安排時間找朋友一起共同開發 LINE Notify Client SDK - [lotify](https://github.com/louis70109/lotify)，把我們所學到的東西 (單元測試、CI、版本演進、一鍵部署...) 用更好的方式呈現出來給大家，接著就來回顧一下自己這段時間準備的東西。\n\n<!-- more -->\n\n# 使用平台\n\n休息是為了走更長的路，但一直休息就不對 🤣，有別於之前都只用 104，這次用了以下幾個平台來交叉比對找工作：\n\n- 104\n- Linkedin\n- Yourator\n- CakeResume\n\n> 同時管理這麼多平台時，HR 打來聊的時候都很容易錯亂他是從哪個平台找到我的～哈哈，尤其漏了一些東西時還會更莫名其妙 😆\n\n# 分析自己\n\n## 優點\n\n## 缺點\n\n# Chatbot\n\n## 了解多少\n\n有些人總是認為 Chatbot 就是有 AI，但這樣的想法不完全對，主要是以回覆、推播的方式存在，再依照各個平台產生不一樣的擴充功能。\n\n以 LINE 來說，擴充功能就含有 ImageMap、FlexMessage、LIFF、之前的 LINE Things、Quick Reply(FB 先出的)，在基於這些實作出與行銷相關的 API(NarrowCast)、如小程序般的 Share Target Picker 以及可以管理 Access Token 的功能...\n\n另一方面我認為 Chatbot 跟做全端的感覺很像，如卡米哥去年做的 Kamigo 一樣，與 Rails 巧妙的結合，如前端般的用 js 控制 LIFF 做表單填寫、FlexMessage 的轉譯器將訊息轉成卡片的方式呈現給使用者，使用正規表示法從路由(Route)就處理針對使用者發送不同話語時所對應的 Controller，Model 就處理 Schema 相關以及資料定位的問題。\n\n## 開發時有遇過什麼麻煩的事\n\n初期串接 DialogFlow 時總是將它放在程式的源頭，殊不知這樣會錯失許多彈性，經由 Bottender 的承澤哥在某次小聚與我解釋了老半天才得知應當在程式邏輯處理完時這句還是無法辨識，才丟進去 DialogFlow 去做意圖偵測，這樣方法讓程式先運行後可做較多的前處理，如此一來就可以有效地控制使用者的行為，抑或是下註解。\n\n# 目標\n\n## 短期\n\n- DevOps or SRE 相關技能\n- 在實戰中多用 SOLID、Clean Code 相關技能\n- 增進對文案的敏感度\n\n## 中期\n\n持續分享文章吧，很認同 Evan 常於演講時所說他是「如何~~成為 GDE~~學習 Golang 」中的這一段，分享對我從來就不是為了拿頭銜，頭銜 \b 或證照是用來認可你的努力與熱情，所以繼續撰文影響更多的新血以及幫助到許多有著相同問題的人，然後繼續投稿各大研討會，讓自己的分享的內容可以讓大家知道並挑戰不一樣的自己。\n\n## 長期\n\n多方學習不同領域的技能，讓自己保持學習熱忱。\n\n# 結論\n","slug":"2020-春轉夏的個人檢視","published":0,"date":"2020-05-18T08:14:03.000Z","updated":"2020-06-19T14:03:58.823Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ih00017cri3f50tvjp","content":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>四月底離開前公司後，\b\b 休息了一個禮拜後終於開始丟履歷(太空戰士 7 終於全破了 😝)，休息期間也安排時間找朋友一起共同開發 LINE Notify Client SDK - <a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">lotify</a>，把我們所學到的東西 (單元測試、CI、版本演進、一鍵部署…) 用更好的方式呈現出來給大家，接著就來回顧一下自己這段時間準備的東西。</p>\n<a id=\"more\"></a>\n\n<h1 id=\"使用平台\"><a href=\"#使用平台\" class=\"headerlink\" title=\"使用平台\"></a>使用平台</h1><p>休息是為了走更長的路，但一直休息就不對 🤣，有別於之前都只用 104，這次用了以下幾個平台來交叉比對找工作：</p>\n<ul>\n<li>104</li>\n<li>Linkedin</li>\n<li>Yourator</li>\n<li>CakeResume</li>\n</ul>\n<blockquote>\n<p>同時管理這麼多平台時，HR 打來聊的時候都很容易錯亂他是從哪個平台找到我的～哈哈，尤其漏了一些東西時還會更莫名其妙 😆</p>\n</blockquote>\n<h1 id=\"分析自己\"><a href=\"#分析自己\" class=\"headerlink\" title=\"分析自己\"></a>分析自己</h1><h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2><h2 id=\"缺點\"><a href=\"#缺點\" class=\"headerlink\" title=\"缺點\"></a>缺點</h2><h1 id=\"Chatbot\"><a href=\"#Chatbot\" class=\"headerlink\" title=\"Chatbot\"></a>Chatbot</h1><h2 id=\"了解多少\"><a href=\"#了解多少\" class=\"headerlink\" title=\"了解多少\"></a>了解多少</h2><p>有些人總是認為 Chatbot 就是有 AI，但這樣的想法不完全對，主要是以回覆、推播的方式存在，再依照各個平台產生不一樣的擴充功能。</p>\n<p>以 LINE 來說，擴充功能就含有 ImageMap、FlexMessage、LIFF、之前的 LINE Things、Quick Reply(FB 先出的)，在基於這些實作出與行銷相關的 API(NarrowCast)、如小程序般的 Share Target Picker 以及可以管理 Access Token 的功能…</p>\n<p>另一方面我認為 Chatbot 跟做全端的感覺很像，如卡米哥去年做的 Kamigo 一樣，與 Rails 巧妙的結合，如前端般的用 js 控制 LIFF 做表單填寫、FlexMessage 的轉譯器將訊息轉成卡片的方式呈現給使用者，使用正規表示法從路由(Route)就處理針對使用者發送不同話語時所對應的 Controller，Model 就處理 Schema 相關以及資料定位的問題。</p>\n<h2 id=\"開發時有遇過什麼麻煩的事\"><a href=\"#開發時有遇過什麼麻煩的事\" class=\"headerlink\" title=\"開發時有遇過什麼麻煩的事\"></a>開發時有遇過什麼麻煩的事</h2><p>初期串接 DialogFlow 時總是將它放在程式的源頭，殊不知這樣會錯失許多彈性，經由 Bottender 的承澤哥在某次小聚與我解釋了老半天才得知應當在程式邏輯處理完時這句還是無法辨識，才丟進去 DialogFlow 去做意圖偵測，這樣方法讓程式先運行後可做較多的前處理，如此一來就可以有效地控制使用者的行為，抑或是下註解。</p>\n<h1 id=\"目標\"><a href=\"#目標\" class=\"headerlink\" title=\"目標\"></a>目標</h1><h2 id=\"短期\"><a href=\"#短期\" class=\"headerlink\" title=\"短期\"></a>短期</h2><ul>\n<li>DevOps or SRE 相關技能</li>\n<li>在實戰中多用 SOLID、Clean Code 相關技能</li>\n<li>增進對文案的敏感度</li>\n</ul>\n<h2 id=\"中期\"><a href=\"#中期\" class=\"headerlink\" title=\"中期\"></a>中期</h2><p>持續分享文章吧，很認同 Evan 常於演講時所說他是「如何<del>成為 GDE</del>學習 Golang 」中的這一段，分享對我從來就不是為了拿頭銜，頭銜 \b 或證照是用來認可你的努力與熱情，所以繼續撰文影響更多的新血以及幫助到許多有著相同問題的人，然後繼續投稿各大研討會，讓自己的分享的內容可以讓大家知道並挑戰不一樣的自己。</p>\n<h2 id=\"長期\"><a href=\"#長期\" class=\"headerlink\" title=\"長期\"></a>長期</h2><p>多方學習不同領域的技能，讓自己保持學習熱忱。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1>","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>四月底離開前公司後，\b\b 休息了一個禮拜後終於開始丟履歷(太空戰士 7 終於全破了 😝)，休息期間也安排時間找朋友一起共同開發 LINE Notify Client SDK - <a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">lotify</a>，把我們所學到的東西 (單元測試、CI、版本演進、一鍵部署…) 用更好的方式呈現出來給大家，接著就來回顧一下自己這段時間準備的東西。</p>","more":"<h1 id=\"使用平台\"><a href=\"#使用平台\" class=\"headerlink\" title=\"使用平台\"></a>使用平台</h1><p>休息是為了走更長的路，但一直休息就不對 🤣，有別於之前都只用 104，這次用了以下幾個平台來交叉比對找工作：</p>\n<ul>\n<li>104</li>\n<li>Linkedin</li>\n<li>Yourator</li>\n<li>CakeResume</li>\n</ul>\n<blockquote>\n<p>同時管理這麼多平台時，HR 打來聊的時候都很容易錯亂他是從哪個平台找到我的～哈哈，尤其漏了一些東西時還會更莫名其妙 😆</p>\n</blockquote>\n<h1 id=\"分析自己\"><a href=\"#分析自己\" class=\"headerlink\" title=\"分析自己\"></a>分析自己</h1><h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2><h2 id=\"缺點\"><a href=\"#缺點\" class=\"headerlink\" title=\"缺點\"></a>缺點</h2><h1 id=\"Chatbot\"><a href=\"#Chatbot\" class=\"headerlink\" title=\"Chatbot\"></a>Chatbot</h1><h2 id=\"了解多少\"><a href=\"#了解多少\" class=\"headerlink\" title=\"了解多少\"></a>了解多少</h2><p>有些人總是認為 Chatbot 就是有 AI，但這樣的想法不完全對，主要是以回覆、推播的方式存在，再依照各個平台產生不一樣的擴充功能。</p>\n<p>以 LINE 來說，擴充功能就含有 ImageMap、FlexMessage、LIFF、之前的 LINE Things、Quick Reply(FB 先出的)，在基於這些實作出與行銷相關的 API(NarrowCast)、如小程序般的 Share Target Picker 以及可以管理 Access Token 的功能…</p>\n<p>另一方面我認為 Chatbot 跟做全端的感覺很像，如卡米哥去年做的 Kamigo 一樣，與 Rails 巧妙的結合，如前端般的用 js 控制 LIFF 做表單填寫、FlexMessage 的轉譯器將訊息轉成卡片的方式呈現給使用者，使用正規表示法從路由(Route)就處理針對使用者發送不同話語時所對應的 Controller，Model 就處理 Schema 相關以及資料定位的問題。</p>\n<h2 id=\"開發時有遇過什麼麻煩的事\"><a href=\"#開發時有遇過什麼麻煩的事\" class=\"headerlink\" title=\"開發時有遇過什麼麻煩的事\"></a>開發時有遇過什麼麻煩的事</h2><p>初期串接 DialogFlow 時總是將它放在程式的源頭，殊不知這樣會錯失許多彈性，經由 Bottender 的承澤哥在某次小聚與我解釋了老半天才得知應當在程式邏輯處理完時這句還是無法辨識，才丟進去 DialogFlow 去做意圖偵測，這樣方法讓程式先運行後可做較多的前處理，如此一來就可以有效地控制使用者的行為，抑或是下註解。</p>\n<h1 id=\"目標\"><a href=\"#目標\" class=\"headerlink\" title=\"目標\"></a>目標</h1><h2 id=\"短期\"><a href=\"#短期\" class=\"headerlink\" title=\"短期\"></a>短期</h2><ul>\n<li>DevOps or SRE 相關技能</li>\n<li>在實戰中多用 SOLID、Clean Code 相關技能</li>\n<li>增進對文案的敏感度</li>\n</ul>\n<h2 id=\"中期\"><a href=\"#中期\" class=\"headerlink\" title=\"中期\"></a>中期</h2><p>持續分享文章吧，很認同 Evan 常於演講時所說他是「如何<del>成為 GDE</del>學習 Golang 」中的這一段，分享對我從來就不是為了拿頭銜，頭銜 \b 或證照是用來認可你的努力與熱情，所以繼續撰文影響更多的新血以及幫助到許多有著相同問題的人，然後繼續投稿各大研討會，讓自己的分享的內容可以讓大家知道並挑戰不一樣的自己。</p>\n<h2 id=\"長期\"><a href=\"#長期\" class=\"headerlink\" title=\"長期\"></a>長期</h2><p>多方學習不同領域的技能，讓自己保持學習熱忱。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1>"},{"title":"recap serverless","abbrlink":123039300,"_content":"\n# 前言\n\n這陣子在公司使用[Serverless](https://github.com/serverless/serverless)建立許多的服務在`AWS`上，而套件上也提供了[serverless-wsgi](https://www.npmjs.com/package/serverless-wsgi)這方便的的工具，讓需要快速上線一個 API 服務不再那麼難，同時也可以快速介接 AWS 的 API gateway 以及 Lambda 來實作`Serverless`架構的 API 服務。此外 Lambda 的另一個功能就是串接 AWS 上的各種服務，像是`SQS`、`SNS`、`IoT`..等等的服務，都需要在事件被觸發後有個實體(Lambda)來幫忙執行事件處理，總之講了這麼多就要來稍微抱怨一下 😆\n\n# 起源\n\n2019 的鐵人賽中我寫了使用 [serverless 串接 LINE API 的三十天文章](https://nijialin.com/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/)，裡頭提到很多使用 flask + WSGI 並搭配 LINE API 去建立 RESTful API，雖然這樣架起來之後很方便，但如果串到其他服務時就會有所有東西綁在一起搞成一大包的困擾\n\n所以我私心認為 API 應該要獨立開來去建立成一個 container 或是在 Server 上，因為當所有關聯服務都在同一個資料夾下時都服務越來越複雜時會導致整體服務被雲平台綁架走，而導致裡頭服務不敢更動\n\n因此我認為若有使用 AWS 服務的話用 serverless 寫`yaml`去控制裡頭的相依設定以及調用 AWS 上各種服務與`Lambda`相依作用來完成觸發任務會是比較好的選擇\n雖然 AWS Lambda 有 Auto-scaling 的服務，但在整個服務綁在一起之後就會一直依賴雲平台而沒辦法自己控制整體狀態\n\n而將 API 轉換成 container 之類的則可以更有彈性的切換到各個雲平台上(AWS、Google、Azure...)，只需要一個 container 就能解決這個問題，然後又想去玩看看 Google 的 GKE 😆\n\n使用 Serverless 專門來處理 AWS 上的各種應用服務可以讓這包程式不會因為加了 API 而讓整個專案耦合性暴增，彼此都用 call API 的方式互相溝通，達到微服務的開發方式，即便未來不想用 AWS 的服務時在切割專案時只需要換掉 Serverless 這包而不是將 container 刪除，如此一來 API 擁有 Docker 的靈活性並且擁有 Serverless 快速介接 AWS 的能力，\n\n## 短期\n\n為了快速實現與交付的情境下很適合使用，將所有資源給平台託管，只需要將`yaml`檔設定好之後基本上部署都不會有問題，後端工程師可以專心在實現需求服務，其他伺服器上的問題都交給平台來處理。\n\n> 在服務完整度、穩定性以及多元性讓開發者在前期不需要擔心整體服務是否會遇到什麼問題。\n\n## 中期\n\n在服務上線一陣子之後，流量也會逐漸提升，這些平台基本上都會提供 Auto-scaling 的服務，若可能在某些節慶中會遇到流量較大時其實還不太需要擔心，這些雲平台會幫忙處理。\n\n此時架構也有一定規模服務也穩定了，我認為在此時就要開始將 API 與其他特定雲平台服務拆開來，將 API 轉換為容器(Container)或是架在虛擬機(EC2 之類)上，原本服務可能有串接`IoT`、`SQS`等服務就繼續使用 Serverless 來幫忙，這樣的好處我列出幾點：\n\n- 服務間的責任可以分開\n- 容器化之後就不會因為雲平台有問題時而讓服務當在那邊，只需要帶著容器去其他地方即可。\n- 此時還是會依賴特定平台的其他功能，特此還是會繼續使用 Serverless 來方便串接\n  - 這些服務被觸發後都建議使用 call API 的方式來傳\n  - 才不會有共用資料庫的問題\n- 把主體先拿走才不會被綁架\n\n## 長期\n\n長期來說其實像是 AWS、Google、Azure 其實都還滿穩定的，只是說今天在實作一些東西時會需要考量到會不會有過度依賴的問題，當然被綁在特定平台上其實平常也不會遇到什麼問題，但就只是需要想好應對措施以防哪天你主機區域炸掉時所需面對到的問題們，當然自建就自建的問題，平台也會有平台的問題，還是要互相取捨去取出中間最大利益的部分，\n\n# 結論\n\n簡單來說就只是自己想把 Docker 這個技能補足而已 😆\n","source":"_drafts/ recap－serverless.md","raw":"---\ntitle: recap serverless\ntags:\n  - Serverless\n  - Docker\nabbrlink: 123039300\n---\n\n# 前言\n\n這陣子在公司使用[Serverless](https://github.com/serverless/serverless)建立許多的服務在`AWS`上，而套件上也提供了[serverless-wsgi](https://www.npmjs.com/package/serverless-wsgi)這方便的的工具，讓需要快速上線一個 API 服務不再那麼難，同時也可以快速介接 AWS 的 API gateway 以及 Lambda 來實作`Serverless`架構的 API 服務。此外 Lambda 的另一個功能就是串接 AWS 上的各種服務，像是`SQS`、`SNS`、`IoT`..等等的服務，都需要在事件被觸發後有個實體(Lambda)來幫忙執行事件處理，總之講了這麼多就要來稍微抱怨一下 😆\n\n# 起源\n\n2019 的鐵人賽中我寫了使用 [serverless 串接 LINE API 的三十天文章](https://nijialin.com/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/)，裡頭提到很多使用 flask + WSGI 並搭配 LINE API 去建立 RESTful API，雖然這樣架起來之後很方便，但如果串到其他服務時就會有所有東西綁在一起搞成一大包的困擾\n\n所以我私心認為 API 應該要獨立開來去建立成一個 container 或是在 Server 上，因為當所有關聯服務都在同一個資料夾下時都服務越來越複雜時會導致整體服務被雲平台綁架走，而導致裡頭服務不敢更動\n\n因此我認為若有使用 AWS 服務的話用 serverless 寫`yaml`去控制裡頭的相依設定以及調用 AWS 上各種服務與`Lambda`相依作用來完成觸發任務會是比較好的選擇\n雖然 AWS Lambda 有 Auto-scaling 的服務，但在整個服務綁在一起之後就會一直依賴雲平台而沒辦法自己控制整體狀態\n\n而將 API 轉換成 container 之類的則可以更有彈性的切換到各個雲平台上(AWS、Google、Azure...)，只需要一個 container 就能解決這個問題，然後又想去玩看看 Google 的 GKE 😆\n\n使用 Serverless 專門來處理 AWS 上的各種應用服務可以讓這包程式不會因為加了 API 而讓整個專案耦合性暴增，彼此都用 call API 的方式互相溝通，達到微服務的開發方式，即便未來不想用 AWS 的服務時在切割專案時只需要換掉 Serverless 這包而不是將 container 刪除，如此一來 API 擁有 Docker 的靈活性並且擁有 Serverless 快速介接 AWS 的能力，\n\n## 短期\n\n為了快速實現與交付的情境下很適合使用，將所有資源給平台託管，只需要將`yaml`檔設定好之後基本上部署都不會有問題，後端工程師可以專心在實現需求服務，其他伺服器上的問題都交給平台來處理。\n\n> 在服務完整度、穩定性以及多元性讓開發者在前期不需要擔心整體服務是否會遇到什麼問題。\n\n## 中期\n\n在服務上線一陣子之後，流量也會逐漸提升，這些平台基本上都會提供 Auto-scaling 的服務，若可能在某些節慶中會遇到流量較大時其實還不太需要擔心，這些雲平台會幫忙處理。\n\n此時架構也有一定規模服務也穩定了，我認為在此時就要開始將 API 與其他特定雲平台服務拆開來，將 API 轉換為容器(Container)或是架在虛擬機(EC2 之類)上，原本服務可能有串接`IoT`、`SQS`等服務就繼續使用 Serverless 來幫忙，這樣的好處我列出幾點：\n\n- 服務間的責任可以分開\n- 容器化之後就不會因為雲平台有問題時而讓服務當在那邊，只需要帶著容器去其他地方即可。\n- 此時還是會依賴特定平台的其他功能，特此還是會繼續使用 Serverless 來方便串接\n  - 這些服務被觸發後都建議使用 call API 的方式來傳\n  - 才不會有共用資料庫的問題\n- 把主體先拿走才不會被綁架\n\n## 長期\n\n長期來說其實像是 AWS、Google、Azure 其實都還滿穩定的，只是說今天在實作一些東西時會需要考量到會不會有過度依賴的問題，當然被綁在特定平台上其實平常也不會遇到什麼問題，但就只是需要想好應對措施以防哪天你主機區域炸掉時所需面對到的問題們，當然自建就自建的問題，平台也會有平台的問題，還是要互相取捨去取出中間最大利益的部分，\n\n# 結論\n\n簡單來說就只是自己想把 Docker 這個技能補足而已 😆\n","slug":" recap－serverless","published":0,"date":"2020-01-24T14:27:25.000Z","updated":"2020-06-19T14:03:58.824Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31im00037criqb0duigm","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>這陣子在公司使用<a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless</a>建立許多的服務在<code>AWS</code>上，而套件上也提供了<a href=\"https://www.npmjs.com/package/serverless-wsgi\" target=\"_blank\" rel=\"noopener\">serverless-wsgi</a>這方便的的工具，讓需要快速上線一個 API 服務不再那麼難，同時也可以快速介接 AWS 的 API gateway 以及 Lambda 來實作<code>Serverless</code>架構的 API 服務。此外 Lambda 的另一個功能就是串接 AWS 上的各種服務，像是<code>SQS</code>、<code>SNS</code>、<code>IoT</code>..等等的服務，都需要在事件被觸發後有個實體(Lambda)來幫忙執行事件處理，總之講了這麼多就要來稍微抱怨一下 😆</p>\n<h1 id=\"起源\"><a href=\"#起源\" class=\"headerlink\" title=\"起源\"></a>起源</h1><p>2019 的鐵人賽中我寫了使用 <a href=\"https://nijialin.com/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/\">serverless 串接 LINE API 的三十天文章</a>，裡頭提到很多使用 flask + WSGI 並搭配 LINE API 去建立 RESTful API，雖然這樣架起來之後很方便，但如果串到其他服務時就會有所有東西綁在一起搞成一大包的困擾</p>\n<p>所以我私心認為 API 應該要獨立開來去建立成一個 container 或是在 Server 上，因為當所有關聯服務都在同一個資料夾下時都服務越來越複雜時會導致整體服務被雲平台綁架走，而導致裡頭服務不敢更動</p>\n<p>因此我認為若有使用 AWS 服務的話用 serverless 寫<code>yaml</code>去控制裡頭的相依設定以及調用 AWS 上各種服務與<code>Lambda</code>相依作用來完成觸發任務會是比較好的選擇<br>雖然 AWS Lambda 有 Auto-scaling 的服務，但在整個服務綁在一起之後就會一直依賴雲平台而沒辦法自己控制整體狀態</p>\n<p>而將 API 轉換成 container 之類的則可以更有彈性的切換到各個雲平台上(AWS、Google、Azure…)，只需要一個 container 就能解決這個問題，然後又想去玩看看 Google 的 GKE 😆</p>\n<p>使用 Serverless 專門來處理 AWS 上的各種應用服務可以讓這包程式不會因為加了 API 而讓整個專案耦合性暴增，彼此都用 call API 的方式互相溝通，達到微服務的開發方式，即便未來不想用 AWS 的服務時在切割專案時只需要換掉 Serverless 這包而不是將 container 刪除，如此一來 API 擁有 Docker 的靈活性並且擁有 Serverless 快速介接 AWS 的能力，</p>\n<h2 id=\"短期\"><a href=\"#短期\" class=\"headerlink\" title=\"短期\"></a>短期</h2><p>為了快速實現與交付的情境下很適合使用，將所有資源給平台託管，只需要將<code>yaml</code>檔設定好之後基本上部署都不會有問題，後端工程師可以專心在實現需求服務，其他伺服器上的問題都交給平台來處理。</p>\n<blockquote>\n<p>在服務完整度、穩定性以及多元性讓開發者在前期不需要擔心整體服務是否會遇到什麼問題。</p>\n</blockquote>\n<h2 id=\"中期\"><a href=\"#中期\" class=\"headerlink\" title=\"中期\"></a>中期</h2><p>在服務上線一陣子之後，流量也會逐漸提升，這些平台基本上都會提供 Auto-scaling 的服務，若可能在某些節慶中會遇到流量較大時其實還不太需要擔心，這些雲平台會幫忙處理。</p>\n<p>此時架構也有一定規模服務也穩定了，我認為在此時就要開始將 API 與其他特定雲平台服務拆開來，將 API 轉換為容器(Container)或是架在虛擬機(EC2 之類)上，原本服務可能有串接<code>IoT</code>、<code>SQS</code>等服務就繼續使用 Serverless 來幫忙，這樣的好處我列出幾點：</p>\n<ul>\n<li>服務間的責任可以分開</li>\n<li>容器化之後就不會因為雲平台有問題時而讓服務當在那邊，只需要帶著容器去其他地方即可。</li>\n<li>此時還是會依賴特定平台的其他功能，特此還是會繼續使用 Serverless 來方便串接<ul>\n<li>這些服務被觸發後都建議使用 call API 的方式來傳</li>\n<li>才不會有共用資料庫的問題</li>\n</ul>\n</li>\n<li>把主體先拿走才不會被綁架</li>\n</ul>\n<h2 id=\"長期\"><a href=\"#長期\" class=\"headerlink\" title=\"長期\"></a>長期</h2><p>長期來說其實像是 AWS、Google、Azure 其實都還滿穩定的，只是說今天在實作一些東西時會需要考量到會不會有過度依賴的問題，當然被綁在特定平台上其實平常也不會遇到什麼問題，但就只是需要想好應對措施以防哪天你主機區域炸掉時所需面對到的問題們，當然自建就自建的問題，平台也會有平台的問題，還是要互相取捨去取出中間最大利益的部分，</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>簡單來說就只是自己想把 Docker 這個技能補足而已 😆</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>這陣子在公司使用<a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless</a>建立許多的服務在<code>AWS</code>上，而套件上也提供了<a href=\"https://www.npmjs.com/package/serverless-wsgi\" target=\"_blank\" rel=\"noopener\">serverless-wsgi</a>這方便的的工具，讓需要快速上線一個 API 服務不再那麼難，同時也可以快速介接 AWS 的 API gateway 以及 Lambda 來實作<code>Serverless</code>架構的 API 服務。此外 Lambda 的另一個功能就是串接 AWS 上的各種服務，像是<code>SQS</code>、<code>SNS</code>、<code>IoT</code>..等等的服務，都需要在事件被觸發後有個實體(Lambda)來幫忙執行事件處理，總之講了這麼多就要來稍微抱怨一下 😆</p>\n<h1 id=\"起源\"><a href=\"#起源\" class=\"headerlink\" title=\"起源\"></a>起源</h1><p>2019 的鐵人賽中我寫了使用 <a href=\"https://nijialin.com/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/\">serverless 串接 LINE API 的三十天文章</a>，裡頭提到很多使用 flask + WSGI 並搭配 LINE API 去建立 RESTful API，雖然這樣架起來之後很方便，但如果串到其他服務時就會有所有東西綁在一起搞成一大包的困擾</p>\n<p>所以我私心認為 API 應該要獨立開來去建立成一個 container 或是在 Server 上，因為當所有關聯服務都在同一個資料夾下時都服務越來越複雜時會導致整體服務被雲平台綁架走，而導致裡頭服務不敢更動</p>\n<p>因此我認為若有使用 AWS 服務的話用 serverless 寫<code>yaml</code>去控制裡頭的相依設定以及調用 AWS 上各種服務與<code>Lambda</code>相依作用來完成觸發任務會是比較好的選擇<br>雖然 AWS Lambda 有 Auto-scaling 的服務，但在整個服務綁在一起之後就會一直依賴雲平台而沒辦法自己控制整體狀態</p>\n<p>而將 API 轉換成 container 之類的則可以更有彈性的切換到各個雲平台上(AWS、Google、Azure…)，只需要一個 container 就能解決這個問題，然後又想去玩看看 Google 的 GKE 😆</p>\n<p>使用 Serverless 專門來處理 AWS 上的各種應用服務可以讓這包程式不會因為加了 API 而讓整個專案耦合性暴增，彼此都用 call API 的方式互相溝通，達到微服務的開發方式，即便未來不想用 AWS 的服務時在切割專案時只需要換掉 Serverless 這包而不是將 container 刪除，如此一來 API 擁有 Docker 的靈活性並且擁有 Serverless 快速介接 AWS 的能力，</p>\n<h2 id=\"短期\"><a href=\"#短期\" class=\"headerlink\" title=\"短期\"></a>短期</h2><p>為了快速實現與交付的情境下很適合使用，將所有資源給平台託管，只需要將<code>yaml</code>檔設定好之後基本上部署都不會有問題，後端工程師可以專心在實現需求服務，其他伺服器上的問題都交給平台來處理。</p>\n<blockquote>\n<p>在服務完整度、穩定性以及多元性讓開發者在前期不需要擔心整體服務是否會遇到什麼問題。</p>\n</blockquote>\n<h2 id=\"中期\"><a href=\"#中期\" class=\"headerlink\" title=\"中期\"></a>中期</h2><p>在服務上線一陣子之後，流量也會逐漸提升，這些平台基本上都會提供 Auto-scaling 的服務，若可能在某些節慶中會遇到流量較大時其實還不太需要擔心，這些雲平台會幫忙處理。</p>\n<p>此時架構也有一定規模服務也穩定了，我認為在此時就要開始將 API 與其他特定雲平台服務拆開來，將 API 轉換為容器(Container)或是架在虛擬機(EC2 之類)上，原本服務可能有串接<code>IoT</code>、<code>SQS</code>等服務就繼續使用 Serverless 來幫忙，這樣的好處我列出幾點：</p>\n<ul>\n<li>服務間的責任可以分開</li>\n<li>容器化之後就不會因為雲平台有問題時而讓服務當在那邊，只需要帶著容器去其他地方即可。</li>\n<li>此時還是會依賴特定平台的其他功能，特此還是會繼續使用 Serverless 來方便串接<ul>\n<li>這些服務被觸發後都建議使用 call API 的方式來傳</li>\n<li>才不會有共用資料庫的問題</li>\n</ul>\n</li>\n<li>把主體先拿走才不會被綁架</li>\n</ul>\n<h2 id=\"長期\"><a href=\"#長期\" class=\"headerlink\" title=\"長期\"></a>長期</h2><p>長期來說其實像是 AWS、Google、Azure 其實都還滿穩定的，只是說今天在實作一些東西時會需要考量到會不會有過度依賴的問題，當然被綁在特定平台上其實平常也不會遇到什麼問題，但就只是需要想好應對措施以防哪天你主機區域炸掉時所需面對到的問題們，當然自建就自建的問題，平台也會有平台的問題，還是要互相取捨去取出中間最大利益的部分，</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>簡單來說就只是自己想把 Docker 這個技能補足而已 😆</p>\n"},{"title":"【Mac】使用OBS+SoundFlower讓直播上Youtube","abbrlink":2051073782,"_content":"\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n<!-- more -->\n\n# 介紹\n\n# 結論\n","source":"_drafts/【Mac】使用OBS-SoundFlower讓直播上Youtube.md","raw":"---\ntitle: 【Mac】使用OBS+SoundFlower讓直播上Youtube\ncategories: 學習紀錄\nabbrlink: 2051073782\ntags:\n---\n\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n<!-- more -->\n\n# 介紹\n\n# 結論\n","slug":"【Mac】使用OBS-SoundFlower讓直播上Youtube","published":0,"date":"2020-05-16T13:05:52.000Z","updated":"2020-06-19T14:03:58.827Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ir00067cri3pszhxrz","content":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><a id=\"more\"></a>\n\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1>","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1>","more":"<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1>"},{"title":"[object Object]","abbrlink":60549,"_content":"\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n<!-- more -->\n\n# 介紹\n\n# 結論\n\n# 參考\n\n[[Go 教學] 什麼是 graceful shutdown?](https://blog.wu-boy.com/2020/02/what-is-graceful-shutdown-in-golang/)\n[Graceful Shutdown：盡 Server 最後的義務 — 以 Node.js 與 Kubernetes 為例](https://medium.com/@chentsulin/graceful-shutdown-%E7%9B%A1-server-%E6%9C%80%E5%BE%8C%E7%9A%84%E7%BE%A9%E5%8B%99-%E4%BB%A5-node-js-%E8%88%87-kubernetes-%E7%82%BA%E4%BE%8B-cb7f519389ea)\n","source":"_drafts/using-graceful-shutdown-in-python.md","raw":"---\ntitle:\n  '[object Object]': null\ncategories: 學習紀錄\nabbrlink: 60549\ntags:\n---\n\n![](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n<!-- more -->\n\n# 介紹\n\n# 結論\n\n# 參考\n\n[[Go 教學] 什麼是 graceful shutdown?](https://blog.wu-boy.com/2020/02/what-is-graceful-shutdown-in-golang/)\n[Graceful Shutdown：盡 Server 最後的義務 — 以 Node.js 與 Kubernetes 為例](https://medium.com/@chentsulin/graceful-shutdown-%E7%9B%A1-server-%E6%9C%80%E5%BE%8C%E7%9A%84%E7%BE%A9%E5%8B%99-%E4%BB%A5-node-js-%E8%88%87-kubernetes-%E7%82%BA%E4%BE%8B-cb7f519389ea)\n","slug":"using-graceful-shutdown-in-python","published":0,"date":"2020-06-22T12:58:09.703Z","updated":"2020-06-23T18:54:47.182Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31it00087crisp928fe6","content":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><a id=\"more\"></a>\n\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://blog.wu-boy.com/2020/02/what-is-graceful-shutdown-in-golang/\" target=\"_blank\" rel=\"noopener\">[Go 教學] 什麼是 graceful shutdown?</a><br><a href=\"https://medium.com/@chentsulin/graceful-shutdown-%E7%9B%A1-server-%E6%9C%80%E5%BE%8C%E7%9A%84%E7%BE%A9%E5%8B%99-%E4%BB%A5-node-js-%E8%88%87-kubernetes-%E7%82%BA%E4%BE%8B-cb7f519389ea\" target=\"_blank\" rel=\"noopener\">Graceful Shutdown：盡 Server 最後的義務 — 以 Node.js 與 Kubernetes 為例</a></p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1>","more":"<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://blog.wu-boy.com/2020/02/what-is-graceful-shutdown-in-golang/\" target=\"_blank\" rel=\"noopener\">[Go 教學] 什麼是 graceful shutdown?</a><br><a href=\"https://medium.com/@chentsulin/graceful-shutdown-%E7%9B%A1-server-%E6%9C%80%E5%BE%8C%E7%9A%84%E7%BE%A9%E5%8B%99-%E4%BB%A5-node-js-%E8%88%87-kubernetes-%E7%82%BA%E4%BE%8B-cb7f519389ea\" target=\"_blank\" rel=\"noopener\">Graceful Shutdown：盡 Server 最後的義務 — 以 Node.js 與 Kubernetes 為例</a></p>"},{"title":"2020/01/10 的mur mur","abbrlink":1838736663,"date":"2020-01-10T13:19:08.000Z","_content":"\n# Header\n\n其實本來也沒打算在我的部落格發這種 mur mur 文，但總覺得在前往更高層級時總是需要思考一下自己在做的事情是不是對的，接下來就在描述一下好了 😆\n\n# Body\n\n就在今天跟著大家一起看`GitHub` 全球最大軟體工程師交友平台的排名網站(可惜我貢獻還不夠多沒排進去 😭)\nhttps://commits.top/taiwan.html\n\n看著各位為大神的排行榜中點來點去就碰巧點到了這篇文章\nhttps://jaceju.net/be-a-senior-engineer/\n\n而最近也是一直在想這問題\n\n> 「如何才有資格稱為資深工程師」\n\n以前總想著只要工作一陣子之後我就可以號稱我是 senior\n但工作後又跑社群發現認識的一個比一個還強都覺得離他們好遠啊 👀\n\n但看完這篇之後也很慶幸自己身邊有那麼多貴人在幫助我往資深工程師的方向在走\n但不管職稱是什麼我認為「自我反省」是一件很重要的事\n小到文件錯字、大到系統 runtime 爆炸 🐛\n都得從中去找到錯誤去找出讓自己成長的契機\n\n這是最近做了一個類似 AWS IoT Job 的 mur mur 🤣\n讓自己成為更好的軟體工程師～\n","source":"_posts/2020-01-10-的mur-mur.md","raw":"---\ntitle: 2020/01/10 的mur mur\ntags: 日記\ncategories: 日記\nabbrlink: 1838736663\ndate: 2020-01-10 21:19:08\n---\n\n# Header\n\n其實本來也沒打算在我的部落格發這種 mur mur 文，但總覺得在前往更高層級時總是需要思考一下自己在做的事情是不是對的，接下來就在描述一下好了 😆\n\n# Body\n\n就在今天跟著大家一起看`GitHub` 全球最大軟體工程師交友平台的排名網站(可惜我貢獻還不夠多沒排進去 😭)\nhttps://commits.top/taiwan.html\n\n看著各位為大神的排行榜中點來點去就碰巧點到了這篇文章\nhttps://jaceju.net/be-a-senior-engineer/\n\n而最近也是一直在想這問題\n\n> 「如何才有資格稱為資深工程師」\n\n以前總想著只要工作一陣子之後我就可以號稱我是 senior\n但工作後又跑社群發現認識的一個比一個還強都覺得離他們好遠啊 👀\n\n但看完這篇之後也很慶幸自己身邊有那麼多貴人在幫助我往資深工程師的方向在走\n但不管職稱是什麼我認為「自我反省」是一件很重要的事\n小到文件錯字、大到系統 runtime 爆炸 🐛\n都得從中去找到錯誤去找出讓自己成長的契機\n\n這是最近做了一個類似 AWS IoT Job 的 mur mur 🤣\n讓自己成為更好的軟體工程師～\n","slug":"2020-01-10-的mur-mur","published":1,"updated":"2020-06-19T14:03:58.826Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31iv00097crihhkpq6xd","content":"<h1 id=\"Header\"><a href=\"#Header\" class=\"headerlink\" title=\"Header\"></a>Header</h1><p>其實本來也沒打算在我的部落格發這種 mur mur 文，但總覺得在前往更高層級時總是需要思考一下自己在做的事情是不是對的，接下來就在描述一下好了 😆</p>\n<h1 id=\"Body\"><a href=\"#Body\" class=\"headerlink\" title=\"Body\"></a>Body</h1><p>就在今天跟著大家一起看<code>GitHub</code> 全球最大軟體工程師交友平台的排名網站(可惜我貢獻還不夠多沒排進去 😭)<br><a href=\"https://commits.top/taiwan.html\" target=\"_blank\" rel=\"noopener\">https://commits.top/taiwan.html</a></p>\n<p>看著各位為大神的排行榜中點來點去就碰巧點到了這篇文章<br><a href=\"https://jaceju.net/be-a-senior-engineer/\" target=\"_blank\" rel=\"noopener\">https://jaceju.net/be-a-senior-engineer/</a></p>\n<p>而最近也是一直在想這問題</p>\n<blockquote>\n<p>「如何才有資格稱為資深工程師」</p>\n</blockquote>\n<p>以前總想著只要工作一陣子之後我就可以號稱我是 senior<br>但工作後又跑社群發現認識的一個比一個還強都覺得離他們好遠啊 👀</p>\n<p>但看完這篇之後也很慶幸自己身邊有那麼多貴人在幫助我往資深工程師的方向在走<br>但不管職稱是什麼我認為「自我反省」是一件很重要的事<br>小到文件錯字、大到系統 runtime 爆炸 🐛<br>都得從中去找到錯誤去找出讓自己成長的契機</p>\n<p>這是最近做了一個類似 AWS IoT Job 的 mur mur 🤣<br>讓自己成為更好的軟體工程師～</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Header\"><a href=\"#Header\" class=\"headerlink\" title=\"Header\"></a>Header</h1><p>其實本來也沒打算在我的部落格發這種 mur mur 文，但總覺得在前往更高層級時總是需要思考一下自己在做的事情是不是對的，接下來就在描述一下好了 😆</p>\n<h1 id=\"Body\"><a href=\"#Body\" class=\"headerlink\" title=\"Body\"></a>Body</h1><p>就在今天跟著大家一起看<code>GitHub</code> 全球最大軟體工程師交友平台的排名網站(可惜我貢獻還不夠多沒排進去 😭)<br><a href=\"https://commits.top/taiwan.html\" target=\"_blank\" rel=\"noopener\">https://commits.top/taiwan.html</a></p>\n<p>看著各位為大神的排行榜中點來點去就碰巧點到了這篇文章<br><a href=\"https://jaceju.net/be-a-senior-engineer/\" target=\"_blank\" rel=\"noopener\">https://jaceju.net/be-a-senior-engineer/</a></p>\n<p>而最近也是一直在想這問題</p>\n<blockquote>\n<p>「如何才有資格稱為資深工程師」</p>\n</blockquote>\n<p>以前總想著只要工作一陣子之後我就可以號稱我是 senior<br>但工作後又跑社群發現認識的一個比一個還強都覺得離他們好遠啊 👀</p>\n<p>但看完這篇之後也很慶幸自己身邊有那麼多貴人在幫助我往資深工程師的方向在走<br>但不管職稱是什麼我認為「自我反省」是一件很重要的事<br>小到文件錯字、大到系統 runtime 爆炸 🐛<br>都得從中去找到錯誤去找出讓自己成長的契機</p>\n<p>這是最近做了一個類似 AWS IoT Job 的 mur mur 🤣<br>讓自己成為更好的軟體工程師～</p>\n"},{"title":"2020 一、二月的學習紀錄","abbrlink":2040281021,"date":"2020-02-07T17:28:42.000Z","_content":"\n![learn records](https://i.imgur.com/0uMmQBV.jpg)\n\n# 前言\n\n礙於最近做事有點手忙腳亂，沒有很有效的管理時間，記錄下來讓往後能有個經驗可循並增加自我管理能力。\n\n# 實作項目\n\n## Docker & Docker-Compose\n\n我記得上次自己弄 docker container 已經是一年多前，當時還結合 Drone CI 來跑(好久了 👀)，對於 Dockerfile 使用方法依稀有點印象，而最近因為看了許多 open source 後對於 Dockerfile 的內容了解度也提升了許多(實在是個不錯的方法 👍)，會這樣子弄的原因是我認為 Serverless 的架構很容易被 AWS 綁架，我認為 API 這類可拆出來的功能應該要包成 container 增加彈性不讓平台限制，被這個想法 trigger 後就來好好練習 Docker 了 🏋️‍♂️。\n\n這次使用 [Twitch-Bot](https://github.com/louis70109/Twitch-Bot) 做我的練習對象，裡面主要用了 `node` 以及 `mongo` 兩個服務，在此同時如果各別起 docker 挺麻煩，因此就需要使用 `docker-compose` 幫忙啟動，而在這過程中學到了:\n\n- 把 Dockerfile 遷移到 docker-compose 上 (~~如何複製別人的檔案(大誤)~~)。\n- 藉由 docker-compose 裡面的 `network` 連接兩個容器的使用方法。\n- Google container-registry 上傳以及 gcloud 過期的 docker 使用方法([參考](https://cloud.google.com/container-registry/docs/support/deprecation-notices))，同時也修正後可以使用 docker 的原生指令將 container 送上 Google。\n\n接下來就是趁六月 credit 過期前趕快來玩玩 Google Kubernetes 🚀\n\n## AWS IoT Job\n\n最近在公司實作 AWS IoT Job 部分的功能(以下稱為 Job)，因為 Job 每次執行收費約 1 塊台幣，之所以會用它是因為在 IoT 執行時不是只會單純發送訊號出來讓後台收訊號做事，而是需要跟後台經過一連串的溝通來達成功能(例如 `韌體更新`)，當然還有很多更複雜的功能，這邊只列舉一個小部分。\n\n從這段時間的實作上學到的部分:\n\n### 裝置工作列表\n\n當後台的 Queue 同時塞進很多工作時要如何管理並通知裝置此時的工作有哪些(All Job)以及要做哪件事(Next Job)，實作這功能時不能只考慮到一個裝置，而是考慮到 N 個裝置時要如何過濾並管理狀態機，限制裝置要依照狀態執行避免系統錯亂。\n\n### 平台化\n\n之前主要功能都是介接 AWS IoT，而這次是要實作一個類似的功能提供給其他使用者，不能只開一個 API 就想要功能都包好，而是將功能明確劃分，讓使用者可以有彈性的去組合，只是在此時我沒有處理得很好，之後的 Task 需要更注意。\n\n## LINE SDK - Narrowcast Clinet API\n\n> 參考 Pull Request: [Add narrowcast client api #237](https://github.com/line/line-bot-sdk-python/pull/237)\n\n### 工廠模式\n\n功能主要是讓開發者可以透過 API 來做分眾的推播，在實作這個 issue 時讓我原本模糊的工廠模式清晰了許多，主要是 SDK 使用了 Python Class 來擔任 Model 的角色，讓進來資料可以經過 model 去轉換成對應的 key-value，所有的資料都分類進去對應的工廠處理完再回傳出來。\n\n在還沒開始看 code 前只想著要寫什麼邏輯去處理，其實使用 Model 的方法就處理掉大部分資料格式的問題，很多 LINE 文件已經清楚定義的格式只要照著填就解決了，只是在這個 Task 遇到了`Python 保留字`的問題，而經過各種 google 後只好自己寫邏輯去判斷掉這件事，之後只能繼續看有沒有更好的寫法可以取代掉這個`保留字`的問題。\n\n### Lint\n\n官方 Github 有寫要 Contribute 時需要執行的內容([參考](https://github.com/line/line-bot-sdk-python#contributing))，lint 則是遵照`flake8`，而執行`tox`後會對每個版本的 python 去做測試，但像我電腦只有 3.7 版 tox 就只會針對這個版本做測試。\n\n- 在這件事上學到的 `tab` 與 `空白鍵(space)` 的差異，[PEP-08](https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces) 上也告訴建議使用`空白鍵`，而 python 3 之後也不允許兩個混用，畢盡 python 是很注重縮排，既然官網都寫了哪有不遵守的道理呢？😃\n\n> Lint 也不會無緣無故來刁難開發者 XD\n\n- 內部函式(Class、Function)都需要再第一行下註解，而會這樣用的因素可能在 python 上並沒有 `public`、`private` 的觀念，透過這樣的方法來表示它(Class、Function)是一個內部函式，藉由 Lint 讓開發者可以知道這個功能是內部還外部，只是在 python 只能使用這個 lint 讓大家遵守這規則，如果沒有 CI 要硬上的話其實也管不住，畢竟不像 golang 這類語言會編譯(汗顏)。\n\n總之使用 lint 的好處就是開發風格可以統一，能夠盡量避免不必要的 programing 麻煩，在寫任何語言都推薦使用各個語言的 lint，雖然一開始會很討厭它，但它真的是在幫助你 😆。\n\n## Netflix\n\n這時間與家人一起訂閱了一年份的會員，而我的初衷就是想把英文學好，而我也花了時間好好的看完一部全英文影集(發英與字幕)，第一次嘗試這樣看全英文，並且邊看邊 Google 翻譯不懂的單字同時口述跟著念一遍增加記憶力，隨著工作量減輕後下班也可以再安排時間繼續看下個影集學了～\n\n> 然後迷上了`愛的迫降`這個韓劇，推薦喜歡看愛情片的朋友去看 ❤️\n\n## 武漢肺炎\n\n最近剛好因為這傳染病盛行，除了防疫之餘，g0v 也提供 API 讓開發者可以拿去介接，隨著大家各種開發前端 web 以及 chatbot ...的應用後本來在想有個什麼想法可以參與這個全民黑客松，只是我認為用途實在重複性太高，而在大家開發應用時我又剛好在寫 LINE SDK，錯失了第一時間發佈口罩相關的服務建立時間，本來想到 LIFF v2 + LINE Notify，但只是在使用上很容易吵到用戶進而封鎖它(LINE Notify)，因此要考慮好功能再來看會不會有比較好的使用情境。\n\n> 出入公共場所記得戴口罩，有帶隨身瓶酒精的記得消毒！😷\n\n# 結論\n\n有時候在思考與規劃的過程中如果經驗不夠時真的很難馬上到位，不過任何事情都一樣，若這件事可以輕鬆且又得心應手，代表它可能已經是你熟悉的領域或是過於簡單，就像我一開始處理社群一樣，若是沒有前輩們帶著走的話我跟本無法有效地處理事情，總之凡是起頭難，即早加入即早熟悉各個領域才是王道 😆\n\n# 參考\n\n[AWS IoT 觸發後可以執行的功能](https://docs.aws.amazon.com/zh_tw/iot/latest/developerguide/iot-rule-actions.html)\n[Job Events](https://docs.aws.amazon.com/iot/latest/developerguide/events-jobs.html)\n[Tab 與 space 的差異(PEP-08)](https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces)\n","source":"_posts/2020-Q1最近的學習紀錄.md","raw":"---\ntitle: 2020 一、二月的學習紀錄\ntags:\n  - 日記\n  - Docker\n  - LINE SDK\n  - AWS\n  - LINT\n  - Netflix\ncategories: 學習紀錄\nabbrlink: 2040281021\ndate: 2020-02-08 01:28:42\n---\n\n![learn records](https://i.imgur.com/0uMmQBV.jpg)\n\n# 前言\n\n礙於最近做事有點手忙腳亂，沒有很有效的管理時間，記錄下來讓往後能有個經驗可循並增加自我管理能力。\n\n# 實作項目\n\n## Docker & Docker-Compose\n\n我記得上次自己弄 docker container 已經是一年多前，當時還結合 Drone CI 來跑(好久了 👀)，對於 Dockerfile 使用方法依稀有點印象，而最近因為看了許多 open source 後對於 Dockerfile 的內容了解度也提升了許多(實在是個不錯的方法 👍)，會這樣子弄的原因是我認為 Serverless 的架構很容易被 AWS 綁架，我認為 API 這類可拆出來的功能應該要包成 container 增加彈性不讓平台限制，被這個想法 trigger 後就來好好練習 Docker 了 🏋️‍♂️。\n\n這次使用 [Twitch-Bot](https://github.com/louis70109/Twitch-Bot) 做我的練習對象，裡面主要用了 `node` 以及 `mongo` 兩個服務，在此同時如果各別起 docker 挺麻煩，因此就需要使用 `docker-compose` 幫忙啟動，而在這過程中學到了:\n\n- 把 Dockerfile 遷移到 docker-compose 上 (~~如何複製別人的檔案(大誤)~~)。\n- 藉由 docker-compose 裡面的 `network` 連接兩個容器的使用方法。\n- Google container-registry 上傳以及 gcloud 過期的 docker 使用方法([參考](https://cloud.google.com/container-registry/docs/support/deprecation-notices))，同時也修正後可以使用 docker 的原生指令將 container 送上 Google。\n\n接下來就是趁六月 credit 過期前趕快來玩玩 Google Kubernetes 🚀\n\n## AWS IoT Job\n\n最近在公司實作 AWS IoT Job 部分的功能(以下稱為 Job)，因為 Job 每次執行收費約 1 塊台幣，之所以會用它是因為在 IoT 執行時不是只會單純發送訊號出來讓後台收訊號做事，而是需要跟後台經過一連串的溝通來達成功能(例如 `韌體更新`)，當然還有很多更複雜的功能，這邊只列舉一個小部分。\n\n從這段時間的實作上學到的部分:\n\n### 裝置工作列表\n\n當後台的 Queue 同時塞進很多工作時要如何管理並通知裝置此時的工作有哪些(All Job)以及要做哪件事(Next Job)，實作這功能時不能只考慮到一個裝置，而是考慮到 N 個裝置時要如何過濾並管理狀態機，限制裝置要依照狀態執行避免系統錯亂。\n\n### 平台化\n\n之前主要功能都是介接 AWS IoT，而這次是要實作一個類似的功能提供給其他使用者，不能只開一個 API 就想要功能都包好，而是將功能明確劃分，讓使用者可以有彈性的去組合，只是在此時我沒有處理得很好，之後的 Task 需要更注意。\n\n## LINE SDK - Narrowcast Clinet API\n\n> 參考 Pull Request: [Add narrowcast client api #237](https://github.com/line/line-bot-sdk-python/pull/237)\n\n### 工廠模式\n\n功能主要是讓開發者可以透過 API 來做分眾的推播，在實作這個 issue 時讓我原本模糊的工廠模式清晰了許多，主要是 SDK 使用了 Python Class 來擔任 Model 的角色，讓進來資料可以經過 model 去轉換成對應的 key-value，所有的資料都分類進去對應的工廠處理完再回傳出來。\n\n在還沒開始看 code 前只想著要寫什麼邏輯去處理，其實使用 Model 的方法就處理掉大部分資料格式的問題，很多 LINE 文件已經清楚定義的格式只要照著填就解決了，只是在這個 Task 遇到了`Python 保留字`的問題，而經過各種 google 後只好自己寫邏輯去判斷掉這件事，之後只能繼續看有沒有更好的寫法可以取代掉這個`保留字`的問題。\n\n### Lint\n\n官方 Github 有寫要 Contribute 時需要執行的內容([參考](https://github.com/line/line-bot-sdk-python#contributing))，lint 則是遵照`flake8`，而執行`tox`後會對每個版本的 python 去做測試，但像我電腦只有 3.7 版 tox 就只會針對這個版本做測試。\n\n- 在這件事上學到的 `tab` 與 `空白鍵(space)` 的差異，[PEP-08](https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces) 上也告訴建議使用`空白鍵`，而 python 3 之後也不允許兩個混用，畢盡 python 是很注重縮排，既然官網都寫了哪有不遵守的道理呢？😃\n\n> Lint 也不會無緣無故來刁難開發者 XD\n\n- 內部函式(Class、Function)都需要再第一行下註解，而會這樣用的因素可能在 python 上並沒有 `public`、`private` 的觀念，透過這樣的方法來表示它(Class、Function)是一個內部函式，藉由 Lint 讓開發者可以知道這個功能是內部還外部，只是在 python 只能使用這個 lint 讓大家遵守這規則，如果沒有 CI 要硬上的話其實也管不住，畢竟不像 golang 這類語言會編譯(汗顏)。\n\n總之使用 lint 的好處就是開發風格可以統一，能夠盡量避免不必要的 programing 麻煩，在寫任何語言都推薦使用各個語言的 lint，雖然一開始會很討厭它，但它真的是在幫助你 😆。\n\n## Netflix\n\n這時間與家人一起訂閱了一年份的會員，而我的初衷就是想把英文學好，而我也花了時間好好的看完一部全英文影集(發英與字幕)，第一次嘗試這樣看全英文，並且邊看邊 Google 翻譯不懂的單字同時口述跟著念一遍增加記憶力，隨著工作量減輕後下班也可以再安排時間繼續看下個影集學了～\n\n> 然後迷上了`愛的迫降`這個韓劇，推薦喜歡看愛情片的朋友去看 ❤️\n\n## 武漢肺炎\n\n最近剛好因為這傳染病盛行，除了防疫之餘，g0v 也提供 API 讓開發者可以拿去介接，隨著大家各種開發前端 web 以及 chatbot ...的應用後本來在想有個什麼想法可以參與這個全民黑客松，只是我認為用途實在重複性太高，而在大家開發應用時我又剛好在寫 LINE SDK，錯失了第一時間發佈口罩相關的服務建立時間，本來想到 LIFF v2 + LINE Notify，但只是在使用上很容易吵到用戶進而封鎖它(LINE Notify)，因此要考慮好功能再來看會不會有比較好的使用情境。\n\n> 出入公共場所記得戴口罩，有帶隨身瓶酒精的記得消毒！😷\n\n# 結論\n\n有時候在思考與規劃的過程中如果經驗不夠時真的很難馬上到位，不過任何事情都一樣，若這件事可以輕鬆且又得心應手，代表它可能已經是你熟悉的領域或是過於簡單，就像我一開始處理社群一樣，若是沒有前輩們帶著走的話我跟本無法有效地處理事情，總之凡是起頭難，即早加入即早熟悉各個領域才是王道 😆\n\n# 參考\n\n[AWS IoT 觸發後可以執行的功能](https://docs.aws.amazon.com/zh_tw/iot/latest/developerguide/iot-rule-actions.html)\n[Job Events](https://docs.aws.amazon.com/iot/latest/developerguide/events-jobs.html)\n[Tab 與 space 的差異(PEP-08)](https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces)\n","slug":"2020-Q1最近的學習紀錄","published":1,"updated":"2020-06-19T14:03:58.827Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ix000b7cricxcw4ump","content":"<p><img src=\"https://i.imgur.com/0uMmQBV.jpg\" alt=\"learn records\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>礙於最近做事有點手忙腳亂，沒有很有效的管理時間，記錄下來讓往後能有個經驗可循並增加自我管理能力。</p>\n<h1 id=\"實作項目\"><a href=\"#實作項目\" class=\"headerlink\" title=\"實作項目\"></a>實作項目</h1><h2 id=\"Docker-amp-Docker-Compose\"><a href=\"#Docker-amp-Docker-Compose\" class=\"headerlink\" title=\"Docker &amp; Docker-Compose\"></a>Docker &amp; Docker-Compose</h2><p>我記得上次自己弄 docker container 已經是一年多前，當時還結合 Drone CI 來跑(好久了 👀)，對於 Dockerfile 使用方法依稀有點印象，而最近因為看了許多 open source 後對於 Dockerfile 的內容了解度也提升了許多(實在是個不錯的方法 👍)，會這樣子弄的原因是我認為 Serverless 的架構很容易被 AWS 綁架，我認為 API 這類可拆出來的功能應該要包成 container 增加彈性不讓平台限制，被這個想法 trigger 後就來好好練習 Docker 了 🏋️‍♂️。</p>\n<p>這次使用 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a> 做我的練習對象，裡面主要用了 <code>node</code> 以及 <code>mongo</code> 兩個服務，在此同時如果各別起 docker 挺麻煩，因此就需要使用 <code>docker-compose</code> 幫忙啟動，而在這過程中學到了:</p>\n<ul>\n<li>把 Dockerfile 遷移到 docker-compose 上 (<del>如何複製別人的檔案(大誤)</del>)。</li>\n<li>藉由 docker-compose 裡面的 <code>network</code> 連接兩個容器的使用方法。</li>\n<li>Google container-registry 上傳以及 gcloud 過期的 docker 使用方法(<a href=\"https://cloud.google.com/container-registry/docs/support/deprecation-notices\" target=\"_blank\" rel=\"noopener\">參考</a>)，同時也修正後可以使用 docker 的原生指令將 container 送上 Google。</li>\n</ul>\n<p>接下來就是趁六月 credit 過期前趕快來玩玩 Google Kubernetes 🚀</p>\n<h2 id=\"AWS-IoT-Job\"><a href=\"#AWS-IoT-Job\" class=\"headerlink\" title=\"AWS IoT Job\"></a>AWS IoT Job</h2><p>最近在公司實作 AWS IoT Job 部分的功能(以下稱為 Job)，因為 Job 每次執行收費約 1 塊台幣，之所以會用它是因為在 IoT 執行時不是只會單純發送訊號出來讓後台收訊號做事，而是需要跟後台經過一連串的溝通來達成功能(例如 <code>韌體更新</code>)，當然還有很多更複雜的功能，這邊只列舉一個小部分。</p>\n<p>從這段時間的實作上學到的部分:</p>\n<h3 id=\"裝置工作列表\"><a href=\"#裝置工作列表\" class=\"headerlink\" title=\"裝置工作列表\"></a>裝置工作列表</h3><p>當後台的 Queue 同時塞進很多工作時要如何管理並通知裝置此時的工作有哪些(All Job)以及要做哪件事(Next Job)，實作這功能時不能只考慮到一個裝置，而是考慮到 N 個裝置時要如何過濾並管理狀態機，限制裝置要依照狀態執行避免系統錯亂。</p>\n<h3 id=\"平台化\"><a href=\"#平台化\" class=\"headerlink\" title=\"平台化\"></a>平台化</h3><p>之前主要功能都是介接 AWS IoT，而這次是要實作一個類似的功能提供給其他使用者，不能只開一個 API 就想要功能都包好，而是將功能明確劃分，讓使用者可以有彈性的去組合，只是在此時我沒有處理得很好，之後的 Task 需要更注意。</p>\n<h2 id=\"LINE-SDK-Narrowcast-Clinet-API\"><a href=\"#LINE-SDK-Narrowcast-Clinet-API\" class=\"headerlink\" title=\"LINE SDK - Narrowcast Clinet API\"></a>LINE SDK - Narrowcast Clinet API</h2><blockquote>\n<p>參考 Pull Request: <a href=\"https://github.com/line/line-bot-sdk-python/pull/237\" target=\"_blank\" rel=\"noopener\">Add narrowcast client api #237</a></p>\n</blockquote>\n<h3 id=\"工廠模式\"><a href=\"#工廠模式\" class=\"headerlink\" title=\"工廠模式\"></a>工廠模式</h3><p>功能主要是讓開發者可以透過 API 來做分眾的推播，在實作這個 issue 時讓我原本模糊的工廠模式清晰了許多，主要是 SDK 使用了 Python Class 來擔任 Model 的角色，讓進來資料可以經過 model 去轉換成對應的 key-value，所有的資料都分類進去對應的工廠處理完再回傳出來。</p>\n<p>在還沒開始看 code 前只想著要寫什麼邏輯去處理，其實使用 Model 的方法就處理掉大部分資料格式的問題，很多 LINE 文件已經清楚定義的格式只要照著填就解決了，只是在這個 Task 遇到了<code>Python 保留字</code>的問題，而經過各種 google 後只好自己寫邏輯去判斷掉這件事，之後只能繼續看有沒有更好的寫法可以取代掉這個<code>保留字</code>的問題。</p>\n<h3 id=\"Lint\"><a href=\"#Lint\" class=\"headerlink\" title=\"Lint\"></a>Lint</h3><p>官方 Github 有寫要 Contribute 時需要執行的內容(<a href=\"https://github.com/line/line-bot-sdk-python#contributing\" target=\"_blank\" rel=\"noopener\">參考</a>)，lint 則是遵照<code>flake8</code>，而執行<code>tox</code>後會對每個版本的 python 去做測試，但像我電腦只有 3.7 版 tox 就只會針對這個版本做測試。</p>\n<ul>\n<li>在這件事上學到的 <code>tab</code> 與 <code>空白鍵(space)</code> 的差異，<a href=\"https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces\" target=\"_blank\" rel=\"noopener\">PEP-08</a> 上也告訴建議使用<code>空白鍵</code>，而 python 3 之後也不允許兩個混用，畢盡 python 是很注重縮排，既然官網都寫了哪有不遵守的道理呢？😃</li>\n</ul>\n<blockquote>\n<p>Lint 也不會無緣無故來刁難開發者 XD</p>\n</blockquote>\n<ul>\n<li>內部函式(Class、Function)都需要再第一行下註解，而會這樣用的因素可能在 python 上並沒有 <code>public</code>、<code>private</code> 的觀念，透過這樣的方法來表示它(Class、Function)是一個內部函式，藉由 Lint 讓開發者可以知道這個功能是內部還外部，只是在 python 只能使用這個 lint 讓大家遵守這規則，如果沒有 CI 要硬上的話其實也管不住，畢竟不像 golang 這類語言會編譯(汗顏)。</li>\n</ul>\n<p>總之使用 lint 的好處就是開發風格可以統一，能夠盡量避免不必要的 programing 麻煩，在寫任何語言都推薦使用各個語言的 lint，雖然一開始會很討厭它，但它真的是在幫助你 😆。</p>\n<h2 id=\"Netflix\"><a href=\"#Netflix\" class=\"headerlink\" title=\"Netflix\"></a>Netflix</h2><p>這時間與家人一起訂閱了一年份的會員，而我的初衷就是想把英文學好，而我也花了時間好好的看完一部全英文影集(發英與字幕)，第一次嘗試這樣看全英文，並且邊看邊 Google 翻譯不懂的單字同時口述跟著念一遍增加記憶力，隨著工作量減輕後下班也可以再安排時間繼續看下個影集學了～</p>\n<blockquote>\n<p>然後迷上了<code>愛的迫降</code>這個韓劇，推薦喜歡看愛情片的朋友去看 ❤️</p>\n</blockquote>\n<h2 id=\"武漢肺炎\"><a href=\"#武漢肺炎\" class=\"headerlink\" title=\"武漢肺炎\"></a>武漢肺炎</h2><p>最近剛好因為這傳染病盛行，除了防疫之餘，g0v 也提供 API 讓開發者可以拿去介接，隨著大家各種開發前端 web 以及 chatbot …的應用後本來在想有個什麼想法可以參與這個全民黑客松，只是我認為用途實在重複性太高，而在大家開發應用時我又剛好在寫 LINE SDK，錯失了第一時間發佈口罩相關的服務建立時間，本來想到 LIFF v2 + LINE Notify，但只是在使用上很容易吵到用戶進而封鎖它(LINE Notify)，因此要考慮好功能再來看會不會有比較好的使用情境。</p>\n<blockquote>\n<p>出入公共場所記得戴口罩，有帶隨身瓶酒精的記得消毒！😷</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>有時候在思考與規劃的過程中如果經驗不夠時真的很難馬上到位，不過任何事情都一樣，若這件事可以輕鬆且又得心應手，代表它可能已經是你熟悉的領域或是過於簡單，就像我一開始處理社群一樣，若是沒有前輩們帶著走的話我跟本無法有效地處理事情，總之凡是起頭難，即早加入即早熟悉各個領域才是王道 😆</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://docs.aws.amazon.com/zh_tw/iot/latest/developerguide/iot-rule-actions.html\" target=\"_blank\" rel=\"noopener\">AWS IoT 觸發後可以執行的功能</a><br><a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/events-jobs.html\" target=\"_blank\" rel=\"noopener\">Job Events</a><br><a href=\"https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces\" target=\"_blank\" rel=\"noopener\">Tab 與 space 的差異(PEP-08)</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://i.imgur.com/0uMmQBV.jpg\" alt=\"learn records\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>礙於最近做事有點手忙腳亂，沒有很有效的管理時間，記錄下來讓往後能有個經驗可循並增加自我管理能力。</p>\n<h1 id=\"實作項目\"><a href=\"#實作項目\" class=\"headerlink\" title=\"實作項目\"></a>實作項目</h1><h2 id=\"Docker-amp-Docker-Compose\"><a href=\"#Docker-amp-Docker-Compose\" class=\"headerlink\" title=\"Docker &amp; Docker-Compose\"></a>Docker &amp; Docker-Compose</h2><p>我記得上次自己弄 docker container 已經是一年多前，當時還結合 Drone CI 來跑(好久了 👀)，對於 Dockerfile 使用方法依稀有點印象，而最近因為看了許多 open source 後對於 Dockerfile 的內容了解度也提升了許多(實在是個不錯的方法 👍)，會這樣子弄的原因是我認為 Serverless 的架構很容易被 AWS 綁架，我認為 API 這類可拆出來的功能應該要包成 container 增加彈性不讓平台限制，被這個想法 trigger 後就來好好練習 Docker 了 🏋️‍♂️。</p>\n<p>這次使用 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a> 做我的練習對象，裡面主要用了 <code>node</code> 以及 <code>mongo</code> 兩個服務，在此同時如果各別起 docker 挺麻煩，因此就需要使用 <code>docker-compose</code> 幫忙啟動，而在這過程中學到了:</p>\n<ul>\n<li>把 Dockerfile 遷移到 docker-compose 上 (<del>如何複製別人的檔案(大誤)</del>)。</li>\n<li>藉由 docker-compose 裡面的 <code>network</code> 連接兩個容器的使用方法。</li>\n<li>Google container-registry 上傳以及 gcloud 過期的 docker 使用方法(<a href=\"https://cloud.google.com/container-registry/docs/support/deprecation-notices\" target=\"_blank\" rel=\"noopener\">參考</a>)，同時也修正後可以使用 docker 的原生指令將 container 送上 Google。</li>\n</ul>\n<p>接下來就是趁六月 credit 過期前趕快來玩玩 Google Kubernetes 🚀</p>\n<h2 id=\"AWS-IoT-Job\"><a href=\"#AWS-IoT-Job\" class=\"headerlink\" title=\"AWS IoT Job\"></a>AWS IoT Job</h2><p>最近在公司實作 AWS IoT Job 部分的功能(以下稱為 Job)，因為 Job 每次執行收費約 1 塊台幣，之所以會用它是因為在 IoT 執行時不是只會單純發送訊號出來讓後台收訊號做事，而是需要跟後台經過一連串的溝通來達成功能(例如 <code>韌體更新</code>)，當然還有很多更複雜的功能，這邊只列舉一個小部分。</p>\n<p>從這段時間的實作上學到的部分:</p>\n<h3 id=\"裝置工作列表\"><a href=\"#裝置工作列表\" class=\"headerlink\" title=\"裝置工作列表\"></a>裝置工作列表</h3><p>當後台的 Queue 同時塞進很多工作時要如何管理並通知裝置此時的工作有哪些(All Job)以及要做哪件事(Next Job)，實作這功能時不能只考慮到一個裝置，而是考慮到 N 個裝置時要如何過濾並管理狀態機，限制裝置要依照狀態執行避免系統錯亂。</p>\n<h3 id=\"平台化\"><a href=\"#平台化\" class=\"headerlink\" title=\"平台化\"></a>平台化</h3><p>之前主要功能都是介接 AWS IoT，而這次是要實作一個類似的功能提供給其他使用者，不能只開一個 API 就想要功能都包好，而是將功能明確劃分，讓使用者可以有彈性的去組合，只是在此時我沒有處理得很好，之後的 Task 需要更注意。</p>\n<h2 id=\"LINE-SDK-Narrowcast-Clinet-API\"><a href=\"#LINE-SDK-Narrowcast-Clinet-API\" class=\"headerlink\" title=\"LINE SDK - Narrowcast Clinet API\"></a>LINE SDK - Narrowcast Clinet API</h2><blockquote>\n<p>參考 Pull Request: <a href=\"https://github.com/line/line-bot-sdk-python/pull/237\" target=\"_blank\" rel=\"noopener\">Add narrowcast client api #237</a></p>\n</blockquote>\n<h3 id=\"工廠模式\"><a href=\"#工廠模式\" class=\"headerlink\" title=\"工廠模式\"></a>工廠模式</h3><p>功能主要是讓開發者可以透過 API 來做分眾的推播，在實作這個 issue 時讓我原本模糊的工廠模式清晰了許多，主要是 SDK 使用了 Python Class 來擔任 Model 的角色，讓進來資料可以經過 model 去轉換成對應的 key-value，所有的資料都分類進去對應的工廠處理完再回傳出來。</p>\n<p>在還沒開始看 code 前只想著要寫什麼邏輯去處理，其實使用 Model 的方法就處理掉大部分資料格式的問題，很多 LINE 文件已經清楚定義的格式只要照著填就解決了，只是在這個 Task 遇到了<code>Python 保留字</code>的問題，而經過各種 google 後只好自己寫邏輯去判斷掉這件事，之後只能繼續看有沒有更好的寫法可以取代掉這個<code>保留字</code>的問題。</p>\n<h3 id=\"Lint\"><a href=\"#Lint\" class=\"headerlink\" title=\"Lint\"></a>Lint</h3><p>官方 Github 有寫要 Contribute 時需要執行的內容(<a href=\"https://github.com/line/line-bot-sdk-python#contributing\" target=\"_blank\" rel=\"noopener\">參考</a>)，lint 則是遵照<code>flake8</code>，而執行<code>tox</code>後會對每個版本的 python 去做測試，但像我電腦只有 3.7 版 tox 就只會針對這個版本做測試。</p>\n<ul>\n<li>在這件事上學到的 <code>tab</code> 與 <code>空白鍵(space)</code> 的差異，<a href=\"https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces\" target=\"_blank\" rel=\"noopener\">PEP-08</a> 上也告訴建議使用<code>空白鍵</code>，而 python 3 之後也不允許兩個混用，畢盡 python 是很注重縮排，既然官網都寫了哪有不遵守的道理呢？😃</li>\n</ul>\n<blockquote>\n<p>Lint 也不會無緣無故來刁難開發者 XD</p>\n</blockquote>\n<ul>\n<li>內部函式(Class、Function)都需要再第一行下註解，而會這樣用的因素可能在 python 上並沒有 <code>public</code>、<code>private</code> 的觀念，透過這樣的方法來表示它(Class、Function)是一個內部函式，藉由 Lint 讓開發者可以知道這個功能是內部還外部，只是在 python 只能使用這個 lint 讓大家遵守這規則，如果沒有 CI 要硬上的話其實也管不住，畢竟不像 golang 這類語言會編譯(汗顏)。</li>\n</ul>\n<p>總之使用 lint 的好處就是開發風格可以統一，能夠盡量避免不必要的 programing 麻煩，在寫任何語言都推薦使用各個語言的 lint，雖然一開始會很討厭它，但它真的是在幫助你 😆。</p>\n<h2 id=\"Netflix\"><a href=\"#Netflix\" class=\"headerlink\" title=\"Netflix\"></a>Netflix</h2><p>這時間與家人一起訂閱了一年份的會員，而我的初衷就是想把英文學好，而我也花了時間好好的看完一部全英文影集(發英與字幕)，第一次嘗試這樣看全英文，並且邊看邊 Google 翻譯不懂的單字同時口述跟著念一遍增加記憶力，隨著工作量減輕後下班也可以再安排時間繼續看下個影集學了～</p>\n<blockquote>\n<p>然後迷上了<code>愛的迫降</code>這個韓劇，推薦喜歡看愛情片的朋友去看 ❤️</p>\n</blockquote>\n<h2 id=\"武漢肺炎\"><a href=\"#武漢肺炎\" class=\"headerlink\" title=\"武漢肺炎\"></a>武漢肺炎</h2><p>最近剛好因為這傳染病盛行，除了防疫之餘，g0v 也提供 API 讓開發者可以拿去介接，隨著大家各種開發前端 web 以及 chatbot …的應用後本來在想有個什麼想法可以參與這個全民黑客松，只是我認為用途實在重複性太高，而在大家開發應用時我又剛好在寫 LINE SDK，錯失了第一時間發佈口罩相關的服務建立時間，本來想到 LIFF v2 + LINE Notify，但只是在使用上很容易吵到用戶進而封鎖它(LINE Notify)，因此要考慮好功能再來看會不會有比較好的使用情境。</p>\n<blockquote>\n<p>出入公共場所記得戴口罩，有帶隨身瓶酒精的記得消毒！😷</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>有時候在思考與規劃的過程中如果經驗不夠時真的很難馬上到位，不過任何事情都一樣，若這件事可以輕鬆且又得心應手，代表它可能已經是你熟悉的領域或是過於簡單，就像我一開始處理社群一樣，若是沒有前輩們帶著走的話我跟本無法有效地處理事情，總之凡是起頭難，即早加入即早熟悉各個領域才是王道 😆</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://docs.aws.amazon.com/zh_tw/iot/latest/developerguide/iot-rule-actions.html\" target=\"_blank\" rel=\"noopener\">AWS IoT 觸發後可以執行的功能</a><br><a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/events-jobs.html\" target=\"_blank\" rel=\"noopener\">Job Events</a><br><a href=\"https://www.python.org/dev/peps/pep-0008/#tabs-or-spaces\" target=\"_blank\" rel=\"noopener\">Tab 與 space 的差異(PEP-08)</a></p>\n"},{"title":"2019 LINE Dev Day - 議程心得(3) - Armeria - A Microservice Framework Well-suited Everywhere","abbrlink":1377449472,"date":"2019-12-01T02:44:45.000Z","_content":"\n# Armeria: A Microservice Framework Well-suited Everywhere\n![](https://i.imgur.com/MNnrFnm.jpg)\n\n- [簡報連結](https://speakerdeck.com/line_devday2019/armeria-a-microservice-framework-well-suited-everywhere)\n- [Github](https://github.com/line/armeria)\n- [官網](https://line.github.io/armeria/)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。\n\n本次議程是由韓國的 open source manager - [trustin](https://github.com/trustin) 為我們帶來議程。\n\n而在今年參加八月舉辦的 COSCUP，並且在第一天的 after party 參加 LINE BoF 上就已經看到 LINE 開發的 Open Source - [Armeria](https://github.com/line/armeria)，它是基於 Java 所撰寫的一個非同步的專案，支援 Java8, Netty, HTTP/2, Thrift 以及 gRPC，當時聽團隊簡單介紹就覺得這個專案一定是個很不得的專案，只不過當時因為他們快速介紹兒少聽了很多細節，這次就把我聽到的細節告訴各位吧！\n\n> 據之前的議程的以及講者的分享說這個服務已經被應用於很多 LINE 服務裡頭，因為覺得好用才推出來🤣\n\n# 如何讓開發者快速使用 Armeria\n\n接下來就用 Java code 來簡單火力展示如何用一個串聯式寫法把服務互叫起來，不管是要用什麼服務只要用串接的方式加入即可，像是 gRPC、Thrift、annotation...等等如下面幾張圖所示。\n\n![](https://i.imgur.com/KKU0eXG.png)\n\n---\n\n![](https://i.imgur.com/6rAex3K.png)\n\n---\n\n![](https://i.imgur.com/mAKhwh4.png)\n\n---\n\n![](https://i.imgur.com/Z9jfFkI.png)\n\n> 這邊看到可以這麼簡單就把一個服務叫起來，然後要讓他開發者可以很輕易地理解並上手，LINE 團隊的開發文化真的是令人佩服...\n\n# 為什麼要做成 async 以及 reactive\n首先就先提到若 Queue 裡頭的東西若是都 sync 的話會有什麼問題，這邊就以一個 Call API 常遇到的問題 - Timeout，在大量的 Queue 在排隊時，以 sync 的方式存在時光遇到 Timeout 就會有服務器爆炸的問題，因為彼此不能影響彼此，且這件事會發生在真實世界的每個地方。\n![](https://i.imgur.com/Telr7lG.jpg)\n\n---\n\n![](https://i.imgur.com/hkltFFS.jpg)\n\n這邊講者提出的解決方案為：\n- 增加執行緒的標記(#)並且減少呼叫堆疊(stack)\n- 預準備 Tread pools 讓大家互相共享\n- 少調用 points\n- 使用非同步的好處就是能夠平行呼叫+較少的執行緒\n\n現在他們能用非同步的方式解決系統被鎖住的問題，但今天若遇到一個很肥～的 payload 呢？以範例來說若一個用戶送他 10 MB 的大小，一次送給 100K 個用戶就相當於 1 TB 大小的流量。\n\n這邊使用的方法是用不同的頻寬 & 處理能力，並且只需要足夠的 buffer 來排除  Out of Memory 的錯誤。\n\n![](https://i.imgur.com/10mGUaD.jpg)\n\n聽到這邊看起來是使用相關的工具來讓整個串接服務可以更有效的 Debug，最後透過 Kibana 來讓訊息可視化，讓 Debug 可以更加快速。\n> 若對相關 Debug 工具可以參考我之前寫的 [Sentry 文章](https://nijialin.com/2019/11/12/sentry-in-serverless/)\n\n> Kibana 可參考： [安裝 ElasticSearch + Kibana 實現中文全文搜尋與數據分析](https://blog.toright.com/posts/5319/fulltext-search-elasticsearch-kibana-bigdata.html)\n\n# 結論\n\n經過了講者一連串的火力展示後感受到 LINE 對於 open source 有多麽的重視，連 Slack 也都愛上 Armeria 這套 Java 函式庫，用於他們的軟體中並公開推薦，讓像我這種喜歡做 open source 的工程師可以燃起新希望繼續為開源做努力。\n![](https://i.imgur.com/eKYqMpo.png)\n\n其實還有很多技術細節的部分在簡報裡，這邊我就不再多家贅述，大家可以參考 [GitHub](https://github.com/line/armeria)，裡面有更加詳細的用法提供給大家。\n\n這次來 LINE Developer Day 讓我感受到不同於其他大公司的文化，除了精彩的議程外也招待我們這群 LINE API Expert 前來共襄盛舉，若你也想成為 LINE API Expert，不妨拿著你的貢獻來申請看看[連結](https://www.line-community.me/contributors/request)，或許明年我們就能一起去啦！\n\n或是你想面對面直接問問看，也可以來 [Chatbot Taiwan](https://www.facebook.com/groups/chatbot.tw/) 參加我們一個月一次的社群聚會喔！我們時常會邀請 LINE 的資深技術傳教士 - Evan 來為各位帶來第一手 LINE 的資訊，也許可以跟他詢問看看，或許會有意外的收穫喔！\n![](https://i.imgur.com/kIDIfPl.jpg)\n","source":"_posts/Armeria-A-Microservice-Framework-Well-suited-Everywhere.md","raw":"---\ntitle: >-\n  2019 LINE Dev Day - 議程心得(3) - Armeria - A Microservice Framework Well-suited\n  Everywhere\ntags:\n  - LINE\n  - Dev Day 2019\ncategories: 研討會\nabbrlink: 1377449472\ndate: 2019-12-01 10:44:45\n---\n\n# Armeria: A Microservice Framework Well-suited Everywhere\n![](https://i.imgur.com/MNnrFnm.jpg)\n\n- [簡報連結](https://speakerdeck.com/line_devday2019/armeria-a-microservice-framework-well-suited-everywhere)\n- [Github](https://github.com/line/armeria)\n- [官網](https://line.github.io/armeria/)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。\n\n本次議程是由韓國的 open source manager - [trustin](https://github.com/trustin) 為我們帶來議程。\n\n而在今年參加八月舉辦的 COSCUP，並且在第一天的 after party 參加 LINE BoF 上就已經看到 LINE 開發的 Open Source - [Armeria](https://github.com/line/armeria)，它是基於 Java 所撰寫的一個非同步的專案，支援 Java8, Netty, HTTP/2, Thrift 以及 gRPC，當時聽團隊簡單介紹就覺得這個專案一定是個很不得的專案，只不過當時因為他們快速介紹兒少聽了很多細節，這次就把我聽到的細節告訴各位吧！\n\n> 據之前的議程的以及講者的分享說這個服務已經被應用於很多 LINE 服務裡頭，因為覺得好用才推出來🤣\n\n# 如何讓開發者快速使用 Armeria\n\n接下來就用 Java code 來簡單火力展示如何用一個串聯式寫法把服務互叫起來，不管是要用什麼服務只要用串接的方式加入即可，像是 gRPC、Thrift、annotation...等等如下面幾張圖所示。\n\n![](https://i.imgur.com/KKU0eXG.png)\n\n---\n\n![](https://i.imgur.com/6rAex3K.png)\n\n---\n\n![](https://i.imgur.com/mAKhwh4.png)\n\n---\n\n![](https://i.imgur.com/Z9jfFkI.png)\n\n> 這邊看到可以這麼簡單就把一個服務叫起來，然後要讓他開發者可以很輕易地理解並上手，LINE 團隊的開發文化真的是令人佩服...\n\n# 為什麼要做成 async 以及 reactive\n首先就先提到若 Queue 裡頭的東西若是都 sync 的話會有什麼問題，這邊就以一個 Call API 常遇到的問題 - Timeout，在大量的 Queue 在排隊時，以 sync 的方式存在時光遇到 Timeout 就會有服務器爆炸的問題，因為彼此不能影響彼此，且這件事會發生在真實世界的每個地方。\n![](https://i.imgur.com/Telr7lG.jpg)\n\n---\n\n![](https://i.imgur.com/hkltFFS.jpg)\n\n這邊講者提出的解決方案為：\n- 增加執行緒的標記(#)並且減少呼叫堆疊(stack)\n- 預準備 Tread pools 讓大家互相共享\n- 少調用 points\n- 使用非同步的好處就是能夠平行呼叫+較少的執行緒\n\n現在他們能用非同步的方式解決系統被鎖住的問題，但今天若遇到一個很肥～的 payload 呢？以範例來說若一個用戶送他 10 MB 的大小，一次送給 100K 個用戶就相當於 1 TB 大小的流量。\n\n這邊使用的方法是用不同的頻寬 & 處理能力，並且只需要足夠的 buffer 來排除  Out of Memory 的錯誤。\n\n![](https://i.imgur.com/10mGUaD.jpg)\n\n聽到這邊看起來是使用相關的工具來讓整個串接服務可以更有效的 Debug，最後透過 Kibana 來讓訊息可視化，讓 Debug 可以更加快速。\n> 若對相關 Debug 工具可以參考我之前寫的 [Sentry 文章](https://nijialin.com/2019/11/12/sentry-in-serverless/)\n\n> Kibana 可參考： [安裝 ElasticSearch + Kibana 實現中文全文搜尋與數據分析](https://blog.toright.com/posts/5319/fulltext-search-elasticsearch-kibana-bigdata.html)\n\n# 結論\n\n經過了講者一連串的火力展示後感受到 LINE 對於 open source 有多麽的重視，連 Slack 也都愛上 Armeria 這套 Java 函式庫，用於他們的軟體中並公開推薦，讓像我這種喜歡做 open source 的工程師可以燃起新希望繼續為開源做努力。\n![](https://i.imgur.com/eKYqMpo.png)\n\n其實還有很多技術細節的部分在簡報裡，這邊我就不再多家贅述，大家可以參考 [GitHub](https://github.com/line/armeria)，裡面有更加詳細的用法提供給大家。\n\n這次來 LINE Developer Day 讓我感受到不同於其他大公司的文化，除了精彩的議程外也招待我們這群 LINE API Expert 前來共襄盛舉，若你也想成為 LINE API Expert，不妨拿著你的貢獻來申請看看[連結](https://www.line-community.me/contributors/request)，或許明年我們就能一起去啦！\n\n或是你想面對面直接問問看，也可以來 [Chatbot Taiwan](https://www.facebook.com/groups/chatbot.tw/) 參加我們一個月一次的社群聚會喔！我們時常會邀請 LINE 的資深技術傳教士 - Evan 來為各位帶來第一手 LINE 的資訊，也許可以跟他詢問看看，或許會有意外的收穫喔！\n![](https://i.imgur.com/kIDIfPl.jpg)\n","slug":"Armeria-A-Microservice-Framework-Well-suited-Everywhere","published":1,"updated":"2020-06-19T14:03:58.830Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31iy000d7critlodkaaw","content":"<h1 id=\"Armeria-A-Microservice-Framework-Well-suited-Everywhere\"><a href=\"#Armeria-A-Microservice-Framework-Well-suited-Everywhere\" class=\"headerlink\" title=\"Armeria: A Microservice Framework Well-suited Everywhere\"></a>Armeria: A Microservice Framework Well-suited Everywhere</h1><p><img src=\"https://i.imgur.com/MNnrFnm.jpg\" alt></p>\n<ul>\n<li><a href=\"https://speakerdeck.com/line_devday2019/armeria-a-microservice-framework-well-suited-everywhere\" target=\"_blank\" rel=\"noopener\">簡報連結</a></li>\n<li><a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://line.github.io/armeria/\" target=\"_blank\" rel=\"noopener\">官網</a></li>\n</ul>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。</p>\n<p>本次議程是由韓國的 open source manager - <a href=\"https://github.com/trustin\" target=\"_blank\" rel=\"noopener\">trustin</a> 為我們帶來議程。</p>\n<p>而在今年參加八月舉辦的 COSCUP，並且在第一天的 after party 參加 LINE BoF 上就已經看到 LINE 開發的 Open Source - <a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">Armeria</a>，它是基於 Java 所撰寫的一個非同步的專案，支援 Java8, Netty, HTTP/2, Thrift 以及 gRPC，當時聽團隊簡單介紹就覺得這個專案一定是個很不得的專案，只不過當時因為他們快速介紹兒少聽了很多細節，這次就把我聽到的細節告訴各位吧！</p>\n<blockquote>\n<p>據之前的議程的以及講者的分享說這個服務已經被應用於很多 LINE 服務裡頭，因為覺得好用才推出來🤣</p>\n</blockquote>\n<h1 id=\"如何讓開發者快速使用-Armeria\"><a href=\"#如何讓開發者快速使用-Armeria\" class=\"headerlink\" title=\"如何讓開發者快速使用 Armeria\"></a>如何讓開發者快速使用 Armeria</h1><p>接下來就用 Java code 來簡單火力展示如何用一個串聯式寫法把服務互叫起來，不管是要用什麼服務只要用串接的方式加入即可，像是 gRPC、Thrift、annotation…等等如下面幾張圖所示。</p>\n<p><img src=\"https://i.imgur.com/KKU0eXG.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/6rAex3K.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/mAKhwh4.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/Z9jfFkI.png\" alt></p>\n<blockquote>\n<p>這邊看到可以這麼簡單就把一個服務叫起來，然後要讓他開發者可以很輕易地理解並上手，LINE 團隊的開發文化真的是令人佩服…</p>\n</blockquote>\n<h1 id=\"為什麼要做成-async-以及-reactive\"><a href=\"#為什麼要做成-async-以及-reactive\" class=\"headerlink\" title=\"為什麼要做成 async 以及 reactive\"></a>為什麼要做成 async 以及 reactive</h1><p>首先就先提到若 Queue 裡頭的東西若是都 sync 的話會有什麼問題，這邊就以一個 Call API 常遇到的問題 - Timeout，在大量的 Queue 在排隊時，以 sync 的方式存在時光遇到 Timeout 就會有服務器爆炸的問題，因為彼此不能影響彼此，且這件事會發生在真實世界的每個地方。<br><img src=\"https://i.imgur.com/Telr7lG.jpg\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/hkltFFS.jpg\" alt></p>\n<p>這邊講者提出的解決方案為：</p>\n<ul>\n<li>增加執行緒的標記(#)並且減少呼叫堆疊(stack)</li>\n<li>預準備 Tread pools 讓大家互相共享</li>\n<li>少調用 points</li>\n<li>使用非同步的好處就是能夠平行呼叫+較少的執行緒</li>\n</ul>\n<p>現在他們能用非同步的方式解決系統被鎖住的問題，但今天若遇到一個很肥～的 payload 呢？以範例來說若一個用戶送他 10 MB 的大小，一次送給 100K 個用戶就相當於 1 TB 大小的流量。</p>\n<p>這邊使用的方法是用不同的頻寬 &amp; 處理能力，並且只需要足夠的 buffer 來排除  Out of Memory 的錯誤。</p>\n<p><img src=\"https://i.imgur.com/10mGUaD.jpg\" alt></p>\n<p>聽到這邊看起來是使用相關的工具來讓整個串接服務可以更有效的 Debug，最後透過 Kibana 來讓訊息可視化，讓 Debug 可以更加快速。</p>\n<blockquote>\n<p>若對相關 Debug 工具可以參考我之前寫的 <a href=\"https://nijialin.com/2019/11/12/sentry-in-serverless/\">Sentry 文章</a></p>\n</blockquote>\n<blockquote>\n<p>Kibana 可參考： <a href=\"https://blog.toright.com/posts/5319/fulltext-search-elasticsearch-kibana-bigdata.html\" target=\"_blank\" rel=\"noopener\">安裝 ElasticSearch + Kibana 實現中文全文搜尋與數據分析</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>經過了講者一連串的火力展示後感受到 LINE 對於 open source 有多麽的重視，連 Slack 也都愛上 Armeria 這套 Java 函式庫，用於他們的軟體中並公開推薦，讓像我這種喜歡做 open source 的工程師可以燃起新希望繼續為開源做努力。<br><img src=\"https://i.imgur.com/eKYqMpo.png\" alt></p>\n<p>其實還有很多技術細節的部分在簡報裡，這邊我就不再多家贅述，大家可以參考 <a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">GitHub</a>，裡面有更加詳細的用法提供給大家。</p>\n<p>這次來 LINE Developer Day 讓我感受到不同於其他大公司的文化，除了精彩的議程外也招待我們這群 LINE API Expert 前來共襄盛舉，若你也想成為 LINE API Expert，不妨拿著你的貢獻來申請看看<a href=\"https://www.line-community.me/contributors/request\" target=\"_blank\" rel=\"noopener\">連結</a>，或許明年我們就能一起去啦！</p>\n<p>或是你想面對面直接問問看，也可以來 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan</a> 參加我們一個月一次的社群聚會喔！我們時常會邀請 LINE 的資深技術傳教士 - Evan 來為各位帶來第一手 LINE 的資訊，也許可以跟他詢問看看，或許會有意外的收穫喔！<br><img src=\"https://i.imgur.com/kIDIfPl.jpg\" alt></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Armeria-A-Microservice-Framework-Well-suited-Everywhere\"><a href=\"#Armeria-A-Microservice-Framework-Well-suited-Everywhere\" class=\"headerlink\" title=\"Armeria: A Microservice Framework Well-suited Everywhere\"></a>Armeria: A Microservice Framework Well-suited Everywhere</h1><p><img src=\"https://i.imgur.com/MNnrFnm.jpg\" alt></p>\n<ul>\n<li><a href=\"https://speakerdeck.com/line_devday2019/armeria-a-microservice-framework-well-suited-everywhere\" target=\"_blank\" rel=\"noopener\">簡報連結</a></li>\n<li><a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://line.github.io/armeria/\" target=\"_blank\" rel=\"noopener\">官網</a></li>\n</ul>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。</p>\n<p>本次議程是由韓國的 open source manager - <a href=\"https://github.com/trustin\" target=\"_blank\" rel=\"noopener\">trustin</a> 為我們帶來議程。</p>\n<p>而在今年參加八月舉辦的 COSCUP，並且在第一天的 after party 參加 LINE BoF 上就已經看到 LINE 開發的 Open Source - <a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">Armeria</a>，它是基於 Java 所撰寫的一個非同步的專案，支援 Java8, Netty, HTTP/2, Thrift 以及 gRPC，當時聽團隊簡單介紹就覺得這個專案一定是個很不得的專案，只不過當時因為他們快速介紹兒少聽了很多細節，這次就把我聽到的細節告訴各位吧！</p>\n<blockquote>\n<p>據之前的議程的以及講者的分享說這個服務已經被應用於很多 LINE 服務裡頭，因為覺得好用才推出來🤣</p>\n</blockquote>\n<h1 id=\"如何讓開發者快速使用-Armeria\"><a href=\"#如何讓開發者快速使用-Armeria\" class=\"headerlink\" title=\"如何讓開發者快速使用 Armeria\"></a>如何讓開發者快速使用 Armeria</h1><p>接下來就用 Java code 來簡單火力展示如何用一個串聯式寫法把服務互叫起來，不管是要用什麼服務只要用串接的方式加入即可，像是 gRPC、Thrift、annotation…等等如下面幾張圖所示。</p>\n<p><img src=\"https://i.imgur.com/KKU0eXG.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/6rAex3K.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/mAKhwh4.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/Z9jfFkI.png\" alt></p>\n<blockquote>\n<p>這邊看到可以這麼簡單就把一個服務叫起來，然後要讓他開發者可以很輕易地理解並上手，LINE 團隊的開發文化真的是令人佩服…</p>\n</blockquote>\n<h1 id=\"為什麼要做成-async-以及-reactive\"><a href=\"#為什麼要做成-async-以及-reactive\" class=\"headerlink\" title=\"為什麼要做成 async 以及 reactive\"></a>為什麼要做成 async 以及 reactive</h1><p>首先就先提到若 Queue 裡頭的東西若是都 sync 的話會有什麼問題，這邊就以一個 Call API 常遇到的問題 - Timeout，在大量的 Queue 在排隊時，以 sync 的方式存在時光遇到 Timeout 就會有服務器爆炸的問題，因為彼此不能影響彼此，且這件事會發生在真實世界的每個地方。<br><img src=\"https://i.imgur.com/Telr7lG.jpg\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/hkltFFS.jpg\" alt></p>\n<p>這邊講者提出的解決方案為：</p>\n<ul>\n<li>增加執行緒的標記(#)並且減少呼叫堆疊(stack)</li>\n<li>預準備 Tread pools 讓大家互相共享</li>\n<li>少調用 points</li>\n<li>使用非同步的好處就是能夠平行呼叫+較少的執行緒</li>\n</ul>\n<p>現在他們能用非同步的方式解決系統被鎖住的問題，但今天若遇到一個很肥～的 payload 呢？以範例來說若一個用戶送他 10 MB 的大小，一次送給 100K 個用戶就相當於 1 TB 大小的流量。</p>\n<p>這邊使用的方法是用不同的頻寬 &amp; 處理能力，並且只需要足夠的 buffer 來排除  Out of Memory 的錯誤。</p>\n<p><img src=\"https://i.imgur.com/10mGUaD.jpg\" alt></p>\n<p>聽到這邊看起來是使用相關的工具來讓整個串接服務可以更有效的 Debug，最後透過 Kibana 來讓訊息可視化，讓 Debug 可以更加快速。</p>\n<blockquote>\n<p>若對相關 Debug 工具可以參考我之前寫的 <a href=\"https://nijialin.com/2019/11/12/sentry-in-serverless/\">Sentry 文章</a></p>\n</blockquote>\n<blockquote>\n<p>Kibana 可參考： <a href=\"https://blog.toright.com/posts/5319/fulltext-search-elasticsearch-kibana-bigdata.html\" target=\"_blank\" rel=\"noopener\">安裝 ElasticSearch + Kibana 實現中文全文搜尋與數據分析</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>經過了講者一連串的火力展示後感受到 LINE 對於 open source 有多麽的重視，連 Slack 也都愛上 Armeria 這套 Java 函式庫，用於他們的軟體中並公開推薦，讓像我這種喜歡做 open source 的工程師可以燃起新希望繼續為開源做努力。<br><img src=\"https://i.imgur.com/eKYqMpo.png\" alt></p>\n<p>其實還有很多技術細節的部分在簡報裡，這邊我就不再多家贅述，大家可以參考 <a href=\"https://github.com/line/armeria\" target=\"_blank\" rel=\"noopener\">GitHub</a>，裡面有更加詳細的用法提供給大家。</p>\n<p>這次來 LINE Developer Day 讓我感受到不同於其他大公司的文化，除了精彩的議程外也招待我們這群 LINE API Expert 前來共襄盛舉，若你也想成為 LINE API Expert，不妨拿著你的貢獻來申請看看<a href=\"https://www.line-community.me/contributors/request\" target=\"_blank\" rel=\"noopener\">連結</a>，或許明年我們就能一起去啦！</p>\n<p>或是你想面對面直接問問看，也可以來 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan</a> 參加我們一個月一次的社群聚會喔！我們時常會邀請 LINE 的資深技術傳教士 - Evan 來為各位帶來第一手 LINE 的資訊，也許可以跟他詢問看看，或許會有意外的收穫喔！<br><img src=\"https://i.imgur.com/kIDIfPl.jpg\" alt></p>\n"},{"title":"Chatbot meetup #12 心得分享 - 2019/09/17","abbrlink":767274191,"date":"2019-09-12T06:52:43.000Z","_content":"\n\n# 前言\n本次小聚是 COSCUP 之後的第一場，趁著熱血玩兩個大型研討會的空檔舉辦了這次的小聚，先感謝各位的參與，別忘了定期關注社群，我們會在上面放出第一手 chatbot 小聚消息。\n[Chatbot Developers Taiwan](https://www.facebook.com/groups/chatbot.tw/?ref=bookmarks)\n\n# 小聚開始\n開場由 Evan Lin為大家帶來 LINE 的第一手消息，首先是 LINE 不在信義區啦(抓錯重點)，是 Flex message 更新啦 ，如下圖所示，他可以做出更多種不同的應用了，也有些實例可以供大家參考🎉\n\n![](https://i.imgur.com/sxEd0Fd.png)\n\n[Flex Messages](https://developers.line.biz/en/docs/messaging-api/using-flex-messages/?source=post_page-----65999085f029----------------------)\n另外出了一個模擬器，如果再使用 Flex message 不是太熟悉整個主體的話可以參考⬇️，目前還在 beta 階段，若有問題直接寫信去 “問候“ 一下🤣\n[Flex Message Simulator](https://developers.line.biz/console/fx/)\n> 中文版的文件也上線了，可以到官網去搜尋哦！\n\n# 議程\n\n> [簡報連結](https://docs.google.com/presentation/d/1QS1Esc-kvPK2x-Ys1oS4ucWVQOOggcEUxbnj3V1vi_I/edit#slide=id.p)\n\n第一位由 LAE — 郭冠宏 (ggm)為我們介紹 Confacts 訊息查證系統，在裡頭把使用者分為兩類\n\n- 收消息的人🙋‍♂️\n- 編輯訊息的人👨‍💻\n\n在上面看得到的資料都是透過 「工人智慧」誕生的，所以看到每一個真假消息都要歸功於這些編輯們🎉\n而 Confacts 也秉持的 g0v 開放原始碼的精神把東西都 open，供大家去使用，像是 美玉姨 以及 趨勢科技防詐達人 都是使用他們的資料庫建立出來的，如果有需要請去找 GGM 大大～\n上次參加 g0v 小聚有稍微了解 Confacts 是做什麼的，聽到這次的講題就讓我更深入了解整個運作流程了，光想到要控制狀態就覺得苦惱，也因 Confacts 讓我瞭解到更多詳細流程～以下是他們的網站，討厭看到人家亂轉發消息嗎？直接加入消息並一起打造工人智慧的平台～\n了解更多: https://cofacts.g0v.tw\n\n---\n\n接著由 酮好的創辦人 撒景賢 為我們帶來 聊天機器人與社群經營，主要是透過機器人來幫忙定時推播訊息給讓使用者下單後會收到提醒訊息而不會跑單，也建議大家把機器人就定義他為機器人，別讓使用者誤會他是一個活生生的人，要定義好自己的機器人取向，最後提到了一個問題就是他認為工程師的毛病就是想要產品做完才去找市場，可能的意思是且戰且走(?)，或許直接吸收市場的經驗也是個不錯的方法(筆記)。\n\n---\n\n再來就是台北商業大學的 溫明輝 教授為我們帶來 商用聊天機器人 UX 的十三種設計原則\n\n> [商用聊天機器人 UX 的 13 個設計原則 (heuristics)](https://medium.com/uxerlab/13-heuristics-for-commercial-chatbot-ux-design-58c1aa191c77)\n\n首先介紹了微股力與記帳雞上面應用中的實例以及一些與使用者互動的案例分享，兩隻機器人都被 LINE 收為官方帳號囉！有興趣的朋友可以去搜尋一下～🔍\n1. 確認目標族群的關鍵需求：要找到用戶滾動增長的點\n2. APP的成功是無法直接複製的：找到 app 上的缺點去卡市場定位點。\n3. 人們可能並不想「聊天」：這邊分享的案例是讓 記帳雞 出來湊人鬧目的是讓使用者記得他並去引導記帳 。\n4. 擬人化vs機器主張定位：若在一開始實作時是以特定主題去做開發的話就該讓他是對應功能機器人，別想著機器人可以做原本的事又要去回應使用者的任何話。\n5. 對話是互動並不限於對話(dialog)：有時候適時地在圖片上加入一些訊息也能讓使用者去自然觸擊。\n6. 讓使用者隨時握有主導權：因為人們可以隨時關掉它，就也意味著使用者的抗拒心不會那麼大，主要還是別讓使用者封鎖他～\n7. 不一眛追求介面的簡潔性：根本的需求滿足之後使用者還是會去用，把互動愉悅感弄出來，這邊例子是放在群組使用久了，有些使用者會自然地去記憶這他的指令。\n8. 考量對話訊息的時間堆疊：使用者因為訊息過多而演變成去點訊息已成敷衍的行為了。\n9. 避免一視同仁的廣播訊息：這邊分享的做法是透過工具去紀錄使用者的互動軌跡，且每個每個感應區塊都會有相對應的 tag，當後台在準備做推薦時可以針對分眾去做對應內容的推播。\n10. 用數據驅動的同理心：將機器人加入群組並紀錄使用者打過的指令，當今天已經封鎖的使用者在特定情況下看到群組裡面有其他使用者在打相關指令時或許會勾引出以前的興趣藉此解除封鎖並回歸。\n11. 用 UI來補償AI的能力極限：藉由專家寫的文章以及當使用者點選到特定的內容時會直接把文章透過 LINE 嵌在訊息下方，讓使用者透過 UI 去看到相關內容，讓他看起來有點類似 AI。\n12. 個人化是 chatbot UX 極致：或許是因為客製化的關係所以當然個人化是最好的🤣\n13. chatbot是無所不在的意識：隨著運算越來越快，人可以隨心所欲去取用環境資訊，需要有個個人化服務，就能透過 chatbot 來搜集並歸納出對應的訊息內容。\n\n# 閃電秀\n最期待的其中一個部分就是閃電秀啦，因為每次閃電秀不僅可以展謝自己的練習成果，也可以發現到其他使用者對於同樣開發內容所想出不一樣的應用！\n第一個由 斑斑 為大家帶來市容幫手，主要是因為現在各種公家機關幾乎都用 LINE 在做聯繫，但一個里長擁有上百個群組會造成很多收集訊息上的困擾，那這邊講者就希望透過提案的方式來尋求參與者一起參與這個提案，有興趣的可以參考一下他的簡報哦！\n\n接著就是由小弟我帶來的閃電秀，這次主題是使用 kamigo 打造的一個紀錄健身記錄的機器人，透過 Restful 格式的內容以及對應網址的樣式做出一個類似網頁版的機器人來記錄成績，以下是我的簡報以及 Github，有興趣可以參考一下😃\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/jmxmRbp1QcYgHB\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/JiaYuLin6/muscle-man-light-talk-20190917-in-chatbottw\" title=\"Muscle man light talk 20190917 in chatbotTW\" target=\"_blank\">Muscle man light talk 20190917 in chatbotTW</a> </strong> from <strong><a href=\"https://www.slideshare.net/JiaYuLin6\" target=\"_blank\">Jia Yu Lin</a></strong> </div>\n> [louis70109/muscle_man](https://github.com/louis70109/muscle_man)\n\n這是一個基於 kamigo 實作 LINE bot 來紀錄重訓數據的 肌肉仔 聊天機器人 在健身的過程中飲食固然重要，但往往訓練的人都是透過通靈的方法來選取適合自己的訓練重量，而透過數據的記載則是突破不可或缺的因素，因此產生了這個…\n\n再來由 Fly Chang 帶來的在宅醫療服務，主要是幫助各地需要居家醫療的人讓他們有資源可以透過地圖的方式去找到，並想整合機器人提供在宅醫療診所情報、長期照護、藥物使用、衛教資訊…等等的資訊，有興趣的朋友可以點選以下網址去觀看哦！\n台灣在宅支援診所聯盟\n[HSCA 在宅支援診所聯盟](https://i.hsca.me/?source=post_page-----65999085f029----------------------)是秉持開放、共享、共學精神的網路平台社群。 資源地圖邀請在宅醫療團隊提供服務資訊，讓診所服務可以變得更透明、更公開，產生正面的循環。\n\n最後由 kevin 介紹一下有關於 dialogflow 串接 LINE bot 的簡單介紹，並順便推廣了 voice hackthon，有興趣的朋友可以參考一下哦\n\n若是 dialogflow+LINE bot 可以參考我之前寫的文章\n[Chatbot Taichung #2 工作坊心得分享](https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3)\n\n# 結論\n雖然每次下班都從台中直接殺上台北辦小聚很累，但往往在小聚結束時總是收穫滿滿，因為大家的熱情交流讓我學到了不少東西，謝謝各位的支持與參與，小弟拜託大家有報名要來啊～看在火山孝子的份上(咦？)就來參加吧🙏\nChatbot TW 很樂意接收到不同的意見，若有好的建立不好意思公開可以私訊我哦！很樂意為大家解答😁","source":"_posts/Chatbot-meetup-12-心得分享-2019-09-17.md","raw":"---\ntitle: 'Chatbot meetup #12 心得分享 - 2019/09/17'\ntags:\n  - chatbot\ncategories: 研討會\nabbrlink: 767274191\ndate: 2019-09-12 14:52:43\n---\n\n\n# 前言\n本次小聚是 COSCUP 之後的第一場，趁著熱血玩兩個大型研討會的空檔舉辦了這次的小聚，先感謝各位的參與，別忘了定期關注社群，我們會在上面放出第一手 chatbot 小聚消息。\n[Chatbot Developers Taiwan](https://www.facebook.com/groups/chatbot.tw/?ref=bookmarks)\n\n# 小聚開始\n開場由 Evan Lin為大家帶來 LINE 的第一手消息，首先是 LINE 不在信義區啦(抓錯重點)，是 Flex message 更新啦 ，如下圖所示，他可以做出更多種不同的應用了，也有些實例可以供大家參考🎉\n\n![](https://i.imgur.com/sxEd0Fd.png)\n\n[Flex Messages](https://developers.line.biz/en/docs/messaging-api/using-flex-messages/?source=post_page-----65999085f029----------------------)\n另外出了一個模擬器，如果再使用 Flex message 不是太熟悉整個主體的話可以參考⬇️，目前還在 beta 階段，若有問題直接寫信去 “問候“ 一下🤣\n[Flex Message Simulator](https://developers.line.biz/console/fx/)\n> 中文版的文件也上線了，可以到官網去搜尋哦！\n\n# 議程\n\n> [簡報連結](https://docs.google.com/presentation/d/1QS1Esc-kvPK2x-Ys1oS4ucWVQOOggcEUxbnj3V1vi_I/edit#slide=id.p)\n\n第一位由 LAE — 郭冠宏 (ggm)為我們介紹 Confacts 訊息查證系統，在裡頭把使用者分為兩類\n\n- 收消息的人🙋‍♂️\n- 編輯訊息的人👨‍💻\n\n在上面看得到的資料都是透過 「工人智慧」誕生的，所以看到每一個真假消息都要歸功於這些編輯們🎉\n而 Confacts 也秉持的 g0v 開放原始碼的精神把東西都 open，供大家去使用，像是 美玉姨 以及 趨勢科技防詐達人 都是使用他們的資料庫建立出來的，如果有需要請去找 GGM 大大～\n上次參加 g0v 小聚有稍微了解 Confacts 是做什麼的，聽到這次的講題就讓我更深入了解整個運作流程了，光想到要控制狀態就覺得苦惱，也因 Confacts 讓我瞭解到更多詳細流程～以下是他們的網站，討厭看到人家亂轉發消息嗎？直接加入消息並一起打造工人智慧的平台～\n了解更多: https://cofacts.g0v.tw\n\n---\n\n接著由 酮好的創辦人 撒景賢 為我們帶來 聊天機器人與社群經營，主要是透過機器人來幫忙定時推播訊息給讓使用者下單後會收到提醒訊息而不會跑單，也建議大家把機器人就定義他為機器人，別讓使用者誤會他是一個活生生的人，要定義好自己的機器人取向，最後提到了一個問題就是他認為工程師的毛病就是想要產品做完才去找市場，可能的意思是且戰且走(?)，或許直接吸收市場的經驗也是個不錯的方法(筆記)。\n\n---\n\n再來就是台北商業大學的 溫明輝 教授為我們帶來 商用聊天機器人 UX 的十三種設計原則\n\n> [商用聊天機器人 UX 的 13 個設計原則 (heuristics)](https://medium.com/uxerlab/13-heuristics-for-commercial-chatbot-ux-design-58c1aa191c77)\n\n首先介紹了微股力與記帳雞上面應用中的實例以及一些與使用者互動的案例分享，兩隻機器人都被 LINE 收為官方帳號囉！有興趣的朋友可以去搜尋一下～🔍\n1. 確認目標族群的關鍵需求：要找到用戶滾動增長的點\n2. APP的成功是無法直接複製的：找到 app 上的缺點去卡市場定位點。\n3. 人們可能並不想「聊天」：這邊分享的案例是讓 記帳雞 出來湊人鬧目的是讓使用者記得他並去引導記帳 。\n4. 擬人化vs機器主張定位：若在一開始實作時是以特定主題去做開發的話就該讓他是對應功能機器人，別想著機器人可以做原本的事又要去回應使用者的任何話。\n5. 對話是互動並不限於對話(dialog)：有時候適時地在圖片上加入一些訊息也能讓使用者去自然觸擊。\n6. 讓使用者隨時握有主導權：因為人們可以隨時關掉它，就也意味著使用者的抗拒心不會那麼大，主要還是別讓使用者封鎖他～\n7. 不一眛追求介面的簡潔性：根本的需求滿足之後使用者還是會去用，把互動愉悅感弄出來，這邊例子是放在群組使用久了，有些使用者會自然地去記憶這他的指令。\n8. 考量對話訊息的時間堆疊：使用者因為訊息過多而演變成去點訊息已成敷衍的行為了。\n9. 避免一視同仁的廣播訊息：這邊分享的做法是透過工具去紀錄使用者的互動軌跡，且每個每個感應區塊都會有相對應的 tag，當後台在準備做推薦時可以針對分眾去做對應內容的推播。\n10. 用數據驅動的同理心：將機器人加入群組並紀錄使用者打過的指令，當今天已經封鎖的使用者在特定情況下看到群組裡面有其他使用者在打相關指令時或許會勾引出以前的興趣藉此解除封鎖並回歸。\n11. 用 UI來補償AI的能力極限：藉由專家寫的文章以及當使用者點選到特定的內容時會直接把文章透過 LINE 嵌在訊息下方，讓使用者透過 UI 去看到相關內容，讓他看起來有點類似 AI。\n12. 個人化是 chatbot UX 極致：或許是因為客製化的關係所以當然個人化是最好的🤣\n13. chatbot是無所不在的意識：隨著運算越來越快，人可以隨心所欲去取用環境資訊，需要有個個人化服務，就能透過 chatbot 來搜集並歸納出對應的訊息內容。\n\n# 閃電秀\n最期待的其中一個部分就是閃電秀啦，因為每次閃電秀不僅可以展謝自己的練習成果，也可以發現到其他使用者對於同樣開發內容所想出不一樣的應用！\n第一個由 斑斑 為大家帶來市容幫手，主要是因為現在各種公家機關幾乎都用 LINE 在做聯繫，但一個里長擁有上百個群組會造成很多收集訊息上的困擾，那這邊講者就希望透過提案的方式來尋求參與者一起參與這個提案，有興趣的可以參考一下他的簡報哦！\n\n接著就是由小弟我帶來的閃電秀，這次主題是使用 kamigo 打造的一個紀錄健身記錄的機器人，透過 Restful 格式的內容以及對應網址的樣式做出一個類似網頁版的機器人來記錄成績，以下是我的簡報以及 Github，有興趣可以參考一下😃\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/jmxmRbp1QcYgHB\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/JiaYuLin6/muscle-man-light-talk-20190917-in-chatbottw\" title=\"Muscle man light talk 20190917 in chatbotTW\" target=\"_blank\">Muscle man light talk 20190917 in chatbotTW</a> </strong> from <strong><a href=\"https://www.slideshare.net/JiaYuLin6\" target=\"_blank\">Jia Yu Lin</a></strong> </div>\n> [louis70109/muscle_man](https://github.com/louis70109/muscle_man)\n\n這是一個基於 kamigo 實作 LINE bot 來紀錄重訓數據的 肌肉仔 聊天機器人 在健身的過程中飲食固然重要，但往往訓練的人都是透過通靈的方法來選取適合自己的訓練重量，而透過數據的記載則是突破不可或缺的因素，因此產生了這個…\n\n再來由 Fly Chang 帶來的在宅醫療服務，主要是幫助各地需要居家醫療的人讓他們有資源可以透過地圖的方式去找到，並想整合機器人提供在宅醫療診所情報、長期照護、藥物使用、衛教資訊…等等的資訊，有興趣的朋友可以點選以下網址去觀看哦！\n台灣在宅支援診所聯盟\n[HSCA 在宅支援診所聯盟](https://i.hsca.me/?source=post_page-----65999085f029----------------------)是秉持開放、共享、共學精神的網路平台社群。 資源地圖邀請在宅醫療團隊提供服務資訊，讓診所服務可以變得更透明、更公開，產生正面的循環。\n\n最後由 kevin 介紹一下有關於 dialogflow 串接 LINE bot 的簡單介紹，並順便推廣了 voice hackthon，有興趣的朋友可以參考一下哦\n\n若是 dialogflow+LINE bot 可以參考我之前寫的文章\n[Chatbot Taichung #2 工作坊心得分享](https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3)\n\n# 結論\n雖然每次下班都從台中直接殺上台北辦小聚很累，但往往在小聚結束時總是收穫滿滿，因為大家的熱情交流讓我學到了不少東西，謝謝各位的支持與參與，小弟拜託大家有報名要來啊～看在火山孝子的份上(咦？)就來參加吧🙏\nChatbot TW 很樂意接收到不同的意見，若有好的建立不好意思公開可以私訊我哦！很樂意為大家解答😁","slug":"Chatbot-meetup-12-心得分享-2019-09-17","published":1,"updated":"2020-06-19T14:03:58.832Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31j2000g7crijc1liwiu","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>本次小聚是 COSCUP 之後的第一場，趁著熱血玩兩個大型研討會的空檔舉辦了這次的小聚，先感謝各位的參與，別忘了定期關注社群，我們會在上面放出第一手 chatbot 小聚消息。<br><a href=\"https://www.facebook.com/groups/chatbot.tw/?ref=bookmarks\" target=\"_blank\" rel=\"noopener\">Chatbot Developers Taiwan</a></p>\n<h1 id=\"小聚開始\"><a href=\"#小聚開始\" class=\"headerlink\" title=\"小聚開始\"></a>小聚開始</h1><p>開場由 Evan Lin為大家帶來 LINE 的第一手消息，首先是 LINE 不在信義區啦(抓錯重點)，是 Flex message 更新啦 ，如下圖所示，他可以做出更多種不同的應用了，也有些實例可以供大家參考🎉</p>\n<p><img src=\"https://i.imgur.com/sxEd0Fd.png\" alt></p>\n<p><a href=\"https://developers.line.biz/en/docs/messaging-api/using-flex-messages/?source=post_page-----65999085f029----------------------\" target=\"_blank\" rel=\"noopener\">Flex Messages</a><br>另外出了一個模擬器，如果再使用 Flex message 不是太熟悉整個主體的話可以參考⬇️，目前還在 beta 階段，若有問題直接寫信去 “問候“ 一下🤣<br><a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a></p>\n<blockquote>\n<p>中文版的文件也上線了，可以到官網去搜尋哦！</p>\n</blockquote>\n<h1 id=\"議程\"><a href=\"#議程\" class=\"headerlink\" title=\"議程\"></a>議程</h1><blockquote>\n<p><a href=\"https://docs.google.com/presentation/d/1QS1Esc-kvPK2x-Ys1oS4ucWVQOOggcEUxbnj3V1vi_I/edit#slide=id.p\" target=\"_blank\" rel=\"noopener\">簡報連結</a></p>\n</blockquote>\n<p>第一位由 LAE — 郭冠宏 (ggm)為我們介紹 Confacts 訊息查證系統，在裡頭把使用者分為兩類</p>\n<ul>\n<li>收消息的人🙋‍♂️</li>\n<li>編輯訊息的人👨‍💻</li>\n</ul>\n<p>在上面看得到的資料都是透過 「工人智慧」誕生的，所以看到每一個真假消息都要歸功於這些編輯們🎉<br>而 Confacts 也秉持的 g0v 開放原始碼的精神把東西都 open，供大家去使用，像是 美玉姨 以及 趨勢科技防詐達人 都是使用他們的資料庫建立出來的，如果有需要請去找 GGM 大大～<br>上次參加 g0v 小聚有稍微了解 Confacts 是做什麼的，聽到這次的講題就讓我更深入了解整個運作流程了，光想到要控制狀態就覺得苦惱，也因 Confacts 讓我瞭解到更多詳細流程～以下是他們的網站，討厭看到人家亂轉發消息嗎？直接加入消息並一起打造工人智慧的平台～<br>了解更多: <a href=\"https://cofacts.g0v.tw\" target=\"_blank\" rel=\"noopener\">https://cofacts.g0v.tw</a></p>\n<hr>\n<p>接著由 酮好的創辦人 撒景賢 為我們帶來 聊天機器人與社群經營，主要是透過機器人來幫忙定時推播訊息給讓使用者下單後會收到提醒訊息而不會跑單，也建議大家把機器人就定義他為機器人，別讓使用者誤會他是一個活生生的人，要定義好自己的機器人取向，最後提到了一個問題就是他認為工程師的毛病就是想要產品做完才去找市場，可能的意思是且戰且走(?)，或許直接吸收市場的經驗也是個不錯的方法(筆記)。</p>\n<hr>\n<p>再來就是台北商業大學的 溫明輝 教授為我們帶來 商用聊天機器人 UX 的十三種設計原則</p>\n<blockquote>\n<p><a href=\"https://medium.com/uxerlab/13-heuristics-for-commercial-chatbot-ux-design-58c1aa191c77\" target=\"_blank\" rel=\"noopener\">商用聊天機器人 UX 的 13 個設計原則 (heuristics)</a></p>\n</blockquote>\n<p>首先介紹了微股力與記帳雞上面應用中的實例以及一些與使用者互動的案例分享，兩隻機器人都被 LINE 收為官方帳號囉！有興趣的朋友可以去搜尋一下～🔍</p>\n<ol>\n<li>確認目標族群的關鍵需求：要找到用戶滾動增長的點</li>\n<li>APP的成功是無法直接複製的：找到 app 上的缺點去卡市場定位點。</li>\n<li>人們可能並不想「聊天」：這邊分享的案例是讓 記帳雞 出來湊人鬧目的是讓使用者記得他並去引導記帳 。</li>\n<li>擬人化vs機器主張定位：若在一開始實作時是以特定主題去做開發的話就該讓他是對應功能機器人，別想著機器人可以做原本的事又要去回應使用者的任何話。</li>\n<li>對話是互動並不限於對話(dialog)：有時候適時地在圖片上加入一些訊息也能讓使用者去自然觸擊。</li>\n<li>讓使用者隨時握有主導權：因為人們可以隨時關掉它，就也意味著使用者的抗拒心不會那麼大，主要還是別讓使用者封鎖他～</li>\n<li>不一眛追求介面的簡潔性：根本的需求滿足之後使用者還是會去用，把互動愉悅感弄出來，這邊例子是放在群組使用久了，有些使用者會自然地去記憶這他的指令。</li>\n<li>考量對話訊息的時間堆疊：使用者因為訊息過多而演變成去點訊息已成敷衍的行為了。</li>\n<li>避免一視同仁的廣播訊息：這邊分享的做法是透過工具去紀錄使用者的互動軌跡，且每個每個感應區塊都會有相對應的 tag，當後台在準備做推薦時可以針對分眾去做對應內容的推播。</li>\n<li>用數據驅動的同理心：將機器人加入群組並紀錄使用者打過的指令，當今天已經封鎖的使用者在特定情況下看到群組裡面有其他使用者在打相關指令時或許會勾引出以前的興趣藉此解除封鎖並回歸。</li>\n<li>用 UI來補償AI的能力極限：藉由專家寫的文章以及當使用者點選到特定的內容時會直接把文章透過 LINE 嵌在訊息下方，讓使用者透過 UI 去看到相關內容，讓他看起來有點類似 AI。</li>\n<li>個人化是 chatbot UX 極致：或許是因為客製化的關係所以當然個人化是最好的🤣</li>\n<li>chatbot是無所不在的意識：隨著運算越來越快，人可以隨心所欲去取用環境資訊，需要有個個人化服務，就能透過 chatbot 來搜集並歸納出對應的訊息內容。</li>\n</ol>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><p>最期待的其中一個部分就是閃電秀啦，因為每次閃電秀不僅可以展謝自己的練習成果，也可以發現到其他使用者對於同樣開發內容所想出不一樣的應用！<br>第一個由 斑斑 為大家帶來市容幫手，主要是因為現在各種公家機關幾乎都用 LINE 在做聯繫，但一個里長擁有上百個群組會造成很多收集訊息上的困擾，那這邊講者就希望透過提案的方式來尋求參與者一起參與這個提案，有興趣的可以參考一下他的簡報哦！</p>\n<p>接著就是由小弟我帶來的閃電秀，這次主題是使用 kamigo 打造的一個紀錄健身記錄的機器人，透過 Restful 格式的內容以及對應網址的樣式做出一個類似網頁版的機器人來記錄成績，以下是我的簡報以及 Github，有興趣可以參考一下😃</p>\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/jmxmRbp1QcYgHB\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/JiaYuLin6/muscle-man-light-talk-20190917-in-chatbottw\" title=\"Muscle man light talk 20190917 in chatbotTW\" target=\"_blank\">Muscle man light talk 20190917 in chatbotTW</a> </strong> from <strong><a href=\"https://www.slideshare.net/JiaYuLin6\" target=\"_blank\">Jia Yu Lin</a></strong> </div>\n> [louis70109/muscle_man](https://github.com/louis70109/muscle_man)\n\n<p>這是一個基於 kamigo 實作 LINE bot 來紀錄重訓數據的 肌肉仔 聊天機器人 在健身的過程中飲食固然重要，但往往訓練的人都是透過通靈的方法來選取適合自己的訓練重量，而透過數據的記載則是突破不可或缺的因素，因此產生了這個…</p>\n<p>再來由 Fly Chang 帶來的在宅醫療服務，主要是幫助各地需要居家醫療的人讓他們有資源可以透過地圖的方式去找到，並想整合機器人提供在宅醫療診所情報、長期照護、藥物使用、衛教資訊…等等的資訊，有興趣的朋友可以點選以下網址去觀看哦！<br>台灣在宅支援診所聯盟<br><a href=\"https://i.hsca.me/?source=post_page-----65999085f029----------------------\" target=\"_blank\" rel=\"noopener\">HSCA 在宅支援診所聯盟</a>是秉持開放、共享、共學精神的網路平台社群。 資源地圖邀請在宅醫療團隊提供服務資訊，讓診所服務可以變得更透明、更公開，產生正面的循環。</p>\n<p>最後由 kevin 介紹一下有關於 dialogflow 串接 LINE bot 的簡單介紹，並順便推廣了 voice hackthon，有興趣的朋友可以參考一下哦</p>\n<p>若是 dialogflow+LINE bot 可以參考我之前寫的文章<br><a href=\"https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3\" target=\"_blank\" rel=\"noopener\">Chatbot Taichung #2 工作坊心得分享</a></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然每次下班都從台中直接殺上台北辦小聚很累，但往往在小聚結束時總是收穫滿滿，因為大家的熱情交流讓我學到了不少東西，謝謝各位的支持與參與，小弟拜託大家有報名要來啊～看在火山孝子的份上(咦？)就來參加吧🙏<br>Chatbot TW 很樂意接收到不同的意見，若有好的建立不好意思公開可以私訊我哦！很樂意為大家解答😁</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>本次小聚是 COSCUP 之後的第一場，趁著熱血玩兩個大型研討會的空檔舉辦了這次的小聚，先感謝各位的參與，別忘了定期關注社群，我們會在上面放出第一手 chatbot 小聚消息。<br><a href=\"https://www.facebook.com/groups/chatbot.tw/?ref=bookmarks\" target=\"_blank\" rel=\"noopener\">Chatbot Developers Taiwan</a></p>\n<h1 id=\"小聚開始\"><a href=\"#小聚開始\" class=\"headerlink\" title=\"小聚開始\"></a>小聚開始</h1><p>開場由 Evan Lin為大家帶來 LINE 的第一手消息，首先是 LINE 不在信義區啦(抓錯重點)，是 Flex message 更新啦 ，如下圖所示，他可以做出更多種不同的應用了，也有些實例可以供大家參考🎉</p>\n<p><img src=\"https://i.imgur.com/sxEd0Fd.png\" alt></p>\n<p><a href=\"https://developers.line.biz/en/docs/messaging-api/using-flex-messages/?source=post_page-----65999085f029----------------------\" target=\"_blank\" rel=\"noopener\">Flex Messages</a><br>另外出了一個模擬器，如果再使用 Flex message 不是太熟悉整個主體的話可以參考⬇️，目前還在 beta 階段，若有問題直接寫信去 “問候“ 一下🤣<br><a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a></p>\n<blockquote>\n<p>中文版的文件也上線了，可以到官網去搜尋哦！</p>\n</blockquote>\n<h1 id=\"議程\"><a href=\"#議程\" class=\"headerlink\" title=\"議程\"></a>議程</h1><blockquote>\n<p><a href=\"https://docs.google.com/presentation/d/1QS1Esc-kvPK2x-Ys1oS4ucWVQOOggcEUxbnj3V1vi_I/edit#slide=id.p\" target=\"_blank\" rel=\"noopener\">簡報連結</a></p>\n</blockquote>\n<p>第一位由 LAE — 郭冠宏 (ggm)為我們介紹 Confacts 訊息查證系統，在裡頭把使用者分為兩類</p>\n<ul>\n<li>收消息的人🙋‍♂️</li>\n<li>編輯訊息的人👨‍💻</li>\n</ul>\n<p>在上面看得到的資料都是透過 「工人智慧」誕生的，所以看到每一個真假消息都要歸功於這些編輯們🎉<br>而 Confacts 也秉持的 g0v 開放原始碼的精神把東西都 open，供大家去使用，像是 美玉姨 以及 趨勢科技防詐達人 都是使用他們的資料庫建立出來的，如果有需要請去找 GGM 大大～<br>上次參加 g0v 小聚有稍微了解 Confacts 是做什麼的，聽到這次的講題就讓我更深入了解整個運作流程了，光想到要控制狀態就覺得苦惱，也因 Confacts 讓我瞭解到更多詳細流程～以下是他們的網站，討厭看到人家亂轉發消息嗎？直接加入消息並一起打造工人智慧的平台～<br>了解更多: <a href=\"https://cofacts.g0v.tw\" target=\"_blank\" rel=\"noopener\">https://cofacts.g0v.tw</a></p>\n<hr>\n<p>接著由 酮好的創辦人 撒景賢 為我們帶來 聊天機器人與社群經營，主要是透過機器人來幫忙定時推播訊息給讓使用者下單後會收到提醒訊息而不會跑單，也建議大家把機器人就定義他為機器人，別讓使用者誤會他是一個活生生的人，要定義好自己的機器人取向，最後提到了一個問題就是他認為工程師的毛病就是想要產品做完才去找市場，可能的意思是且戰且走(?)，或許直接吸收市場的經驗也是個不錯的方法(筆記)。</p>\n<hr>\n<p>再來就是台北商業大學的 溫明輝 教授為我們帶來 商用聊天機器人 UX 的十三種設計原則</p>\n<blockquote>\n<p><a href=\"https://medium.com/uxerlab/13-heuristics-for-commercial-chatbot-ux-design-58c1aa191c77\" target=\"_blank\" rel=\"noopener\">商用聊天機器人 UX 的 13 個設計原則 (heuristics)</a></p>\n</blockquote>\n<p>首先介紹了微股力與記帳雞上面應用中的實例以及一些與使用者互動的案例分享，兩隻機器人都被 LINE 收為官方帳號囉！有興趣的朋友可以去搜尋一下～🔍</p>\n<ol>\n<li>確認目標族群的關鍵需求：要找到用戶滾動增長的點</li>\n<li>APP的成功是無法直接複製的：找到 app 上的缺點去卡市場定位點。</li>\n<li>人們可能並不想「聊天」：這邊分享的案例是讓 記帳雞 出來湊人鬧目的是讓使用者記得他並去引導記帳 。</li>\n<li>擬人化vs機器主張定位：若在一開始實作時是以特定主題去做開發的話就該讓他是對應功能機器人，別想著機器人可以做原本的事又要去回應使用者的任何話。</li>\n<li>對話是互動並不限於對話(dialog)：有時候適時地在圖片上加入一些訊息也能讓使用者去自然觸擊。</li>\n<li>讓使用者隨時握有主導權：因為人們可以隨時關掉它，就也意味著使用者的抗拒心不會那麼大，主要還是別讓使用者封鎖他～</li>\n<li>不一眛追求介面的簡潔性：根本的需求滿足之後使用者還是會去用，把互動愉悅感弄出來，這邊例子是放在群組使用久了，有些使用者會自然地去記憶這他的指令。</li>\n<li>考量對話訊息的時間堆疊：使用者因為訊息過多而演變成去點訊息已成敷衍的行為了。</li>\n<li>避免一視同仁的廣播訊息：這邊分享的做法是透過工具去紀錄使用者的互動軌跡，且每個每個感應區塊都會有相對應的 tag，當後台在準備做推薦時可以針對分眾去做對應內容的推播。</li>\n<li>用數據驅動的同理心：將機器人加入群組並紀錄使用者打過的指令，當今天已經封鎖的使用者在特定情況下看到群組裡面有其他使用者在打相關指令時或許會勾引出以前的興趣藉此解除封鎖並回歸。</li>\n<li>用 UI來補償AI的能力極限：藉由專家寫的文章以及當使用者點選到特定的內容時會直接把文章透過 LINE 嵌在訊息下方，讓使用者透過 UI 去看到相關內容，讓他看起來有點類似 AI。</li>\n<li>個人化是 chatbot UX 極致：或許是因為客製化的關係所以當然個人化是最好的🤣</li>\n<li>chatbot是無所不在的意識：隨著運算越來越快，人可以隨心所欲去取用環境資訊，需要有個個人化服務，就能透過 chatbot 來搜集並歸納出對應的訊息內容。</li>\n</ol>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><p>最期待的其中一個部分就是閃電秀啦，因為每次閃電秀不僅可以展謝自己的練習成果，也可以發現到其他使用者對於同樣開發內容所想出不一樣的應用！<br>第一個由 斑斑 為大家帶來市容幫手，主要是因為現在各種公家機關幾乎都用 LINE 在做聯繫，但一個里長擁有上百個群組會造成很多收集訊息上的困擾，那這邊講者就希望透過提案的方式來尋求參與者一起參與這個提案，有興趣的可以參考一下他的簡報哦！</p>\n<p>接著就是由小弟我帶來的閃電秀，這次主題是使用 kamigo 打造的一個紀錄健身記錄的機器人，透過 Restful 格式的內容以及對應網址的樣式做出一個類似網頁版的機器人來記錄成績，以下是我的簡報以及 Github，有興趣可以參考一下😃</p>\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/jmxmRbp1QcYgHB\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/JiaYuLin6/muscle-man-light-talk-20190917-in-chatbottw\" title=\"Muscle man light talk 20190917 in chatbotTW\" target=\"_blank\">Muscle man light talk 20190917 in chatbotTW</a> </strong> from <strong><a href=\"https://www.slideshare.net/JiaYuLin6\" target=\"_blank\">Jia Yu Lin</a></strong> </div>\n> [louis70109/muscle_man](https://github.com/louis70109/muscle_man)\n\n<p>這是一個基於 kamigo 實作 LINE bot 來紀錄重訓數據的 肌肉仔 聊天機器人 在健身的過程中飲食固然重要，但往往訓練的人都是透過通靈的方法來選取適合自己的訓練重量，而透過數據的記載則是突破不可或缺的因素，因此產生了這個…</p>\n<p>再來由 Fly Chang 帶來的在宅醫療服務，主要是幫助各地需要居家醫療的人讓他們有資源可以透過地圖的方式去找到，並想整合機器人提供在宅醫療診所情報、長期照護、藥物使用、衛教資訊…等等的資訊，有興趣的朋友可以點選以下網址去觀看哦！<br>台灣在宅支援診所聯盟<br><a href=\"https://i.hsca.me/?source=post_page-----65999085f029----------------------\" target=\"_blank\" rel=\"noopener\">HSCA 在宅支援診所聯盟</a>是秉持開放、共享、共學精神的網路平台社群。 資源地圖邀請在宅醫療團隊提供服務資訊，讓診所服務可以變得更透明、更公開，產生正面的循環。</p>\n<p>最後由 kevin 介紹一下有關於 dialogflow 串接 LINE bot 的簡單介紹，並順便推廣了 voice hackthon，有興趣的朋友可以參考一下哦</p>\n<p>若是 dialogflow+LINE bot 可以參考我之前寫的文章<br><a href=\"https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3\" target=\"_blank\" rel=\"noopener\">Chatbot Taichung #2 工作坊心得分享</a></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然每次下班都從台中直接殺上台北辦小聚很累，但往往在小聚結束時總是收穫滿滿，因為大家的熱情交流讓我學到了不少東西，謝謝各位的支持與參與，小弟拜託大家有報名要來啊～看在火山孝子的份上(咦？)就來參加吧🙏<br>Chatbot TW 很樂意接收到不同的意見，若有好的建立不好意思公開可以私訊我哦！很樂意為大家解答😁</p>\n"},{"title":"Bottender x Dialogflow x LINE","abbrlink":2200933333,"date":"2019-12-10T15:18:31.000Z","_content":"\n大家好，我是 Chatbot Taiwan 的 NiJia，最近我們 Github 開張囉，想找之前演講的紀錄都會在此哦！\n\n- [Github](https://github.com/Chatbot-Taiwan/meetups)\n- [Facebook](https://www.facebook.com/groups/chatbot.tw/)\n- [KKTIX](https://chatbots.kktix.cc/)\n\n# 前言\n\n事情是這樣的，本週末 12/13-12/15 我要去 [GDG Taichung Hackthon Party](https://www.meetup.com/GDGTaichung/events/266686542/) 上當導師，礙於我實在想不出有個題目可以分享給其他同好，碰巧之前跟過 Wolke 大大的 Dialogflow + LINE bot 工作坊，憶起當時的明媚風景，接著前陣子寫鐵人賽也有跟到 C.T Lin 大大寫的[使用 Modern Web 技術來打造 Chat App](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)，如此一來我就乾脆把這兩個東西合在一起弄個東西！\n\n又這麼剛好的我最近瘋狂看 ABL 球賽(支持本土球隊！)，剛好週末也沒事，就順手把它做出來啦~有在看球賽的朋友別錯過這隻機器人囉！他可以告訴你下一場比賽是哪時候～\n![](https://i.imgur.com/RTmyJPr.png)\n\n以下記錄著我踩雷的過程 🤣，詳細 bottender 使用手冊還是參考 -> [使用 Modern Web 技術來打造 Chat App](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)\n\n本篇文章的程式碼已經開源囉 [Taiwan-ABL-Games](https://github.com/louis70109/Taiwan-ABL-games)\n\n# 建立專案\n\n```javascript\nnpx create-bottender-app taiwan-abl-games\n```\n\n接著會看到以下的畫面，bottender 很貼心的列出一些大家平常比較會使用的平台，這邊我們先選擇 LINE，後續會再告訴大家如何增加其他平台選項。\n![](https://i.imgur.com/k12ig2m.png)\n\n# Dialogflow 注意事項與串接\n\n這邊一定是要參考主要開發者所寫的文章啊 -> [Day25](https://ithelp.ithome.com.tw/articles/10226833)\n大致上創建服務的過程差不多，這個部分就簡單帶過比較重要的部分。\n\n> 在處理意圖部分有個小撇步，若鼠標從左邊到右邊，到第二個時會把第一個意圖覆蓋掉，這邊我都是從右邊到左邊一個一個選，才不會遇到覆蓋的問題。\n\n![](https://i.imgur.com/HtZ1OWd.png)\n\n接下來再處理 Dialogflow API 的問題，Day 25 文章中所提到的地方 Google UI 似乎有換位置，我找到的位置在此 -> [URL](https://cloud.google.com/docs/authentication/production#obtaining_and_providing_service_account_credentials_manually)\n![](https://i.imgur.com/5HJ3uL7.png)\n\n從頁面的藍色按鈕(建立服務金鑰)後會遇到下圖畫面，第一個紅色框框需要注意是不是剛剛建立的 Dialogflow 的 agent。\n而第二個下拉式選單選擇 `Dialogflow Integrations`，下面則選擇 `JSON` 格式。\n![](https://i.imgur.com/vBRfIgp.png)\n\n> 在一開始建立完之後若是要回來管理的話，直接到 GCP 的[主控台](https://console.cloud.google.com/home/dashboard)左側的`API & Services`的`Cedemtials`來管理金鑰。\n\n![](https://i.imgur.com/IEGyogB.png)\n\n把下載的檔案放在主目錄下，接著要在`.env`下新增以下兩個 key，`GOOGLE_APPLICATION_CREDENTIALS`則需要打上`絕對路徑`，後面再部署會再解釋這段。\n\n```\nGOOGLE_APPLICATION_CREDENTIALS=/Users/.../taiwan-abl-games/YOUR_KEY.json\nGOOGLE_APPLICATION_PROJECT_ID=taiwan-abl-games-mpmomf\n```\n\n`PROJECT_ID`要去 [GCP 主控台](https://console.cloud.google.com/home/dashboard)查詢。\n![](https://i.imgur.com/GSHaMTK.png)\n\n# 實作\n\n這邊就先複製原作者的 code 並稍做修改至 /src/index.js：\n\n```javascript\nconst dialogflow = require('dialogflow'); // 記得安裝\nconst { format } = require('date-fns'); // 記得安裝\n\nconst PROJECT_ID = process.env.GOOGLE_APPLICATION_PROJECT_ID;\nconst sessionClient = new dialogflow.SessionsClient();\n\nmodule.exports = async function App(context) {\n  if (context.event.isText) {\n    const sessionPath = sessionClient.sessionPath(\n      PROJECT_ID,\n      context.session.id\n    );\n\n    const request = {\n      session: sessionPath,\n      queryInput: {\n        text: {\n          text: context.event.text,\n          languageCode: 'zh-tw',\n        },\n      },\n      queryParams: {\n        timeZone: 'Asia/Taipei',\n      },\n    };\n\n    // 透過 dialogflow 偵測意圖\n    const responses = await sessionClient.detectIntent(request);\n    const { intent, parameters } = responses[0].queryResult;\n\n    if (intent.displayName === 'dreamer-next-game') {\n      //...YOUR CONTEXT\n    } else {\n      await context.sendText('\b您輸入的內容我不懂哦~🏀');\n    }\n  }\n};\n```\n\n藉由上述程式碼會發現藉由 Dialogflow 判斷出來的 intent 到底是要填入什麼？intent 顯示的字串就如下圖所示，我們在 Dialogflow 裡建立的 Intent 的名字就是最後 API 會回傳給我們的判斷字串，這邊就正規化一下自己所要提供的意圖吧！\n![](https://i.imgur.com/sEsEep8.png)\n\n## bottender.config.js\n\n最後這邊提一下如何設定給多平台使用，一開始藉由`npx create-bottender-app xxx`幫我們建立 app 時這個檔案就會自動生成，bottender 很好心的把所有明台所會用到的 key 全部都會放在這裡面。\n![](https://i.imgur.com/Ba6I5HR.png)\n以我為例我就有使用到 Messager 來試玩，這邊就需要把`enabled`啟動(false -> true)，實際建立粉絲頁相關可以[參考](https://ithelp.ithome.com.tw/articles/10218682)\n\n> 題外話: 最後再使用`npx bottender messenger webhook set`就會幫我們把 localhost 串接到 Message 上，實在是太讚了！！！\n\n# 部署注意事項\n\n我是使用 Heroku 當作我部署的環境，請服用這篇[Heroku 部署](https://ithelp.ithome.com.tw/articles/10228055)\n\n在本地端測試時會用到很多的環境變數，而 Dialogflow API json 的路徑我是透過環境變數去取得，在 Heroku 上會把專案的內容放在`/app`底下(不管你專案叫什麼名字)，因此環境變數`GOOGLE_APPLICATION_CREDENTIALS`需要輸入`/app/xx-ooo.json`這樣就會取到當前目錄下的檔案囉！\n\n# 結論\n\n經由這次試玩這個 project 讓我覺得 [bottender](https://github.com/Yoctol/bottender) 這個 chatbot 框架整合真的是厲害，幫開發者處理掉很多跨平台上的問題，我認為最酷的就是 console mode，在測試程式邏輯上可以不用每次都一直用手機開 LINE 或是 FB 來測試機器人狀態，而是在終端機就解決這件事，這是我開發機器人到目前為止覺得最酷的模式 👍！\n\n而在這個專案上我使用到 Dialogflow，除了參考的原文畫面 (GCP 頁面) 已有些許更動外，其實介接的速度是非常快的，此外我很認同原文作者的觀點，把 Dialogflow 接在程式後面才去處理這件事會增加很多彈性，畢竟當一個**回應**來的時候可能會想做其他不同的應用，此時若是模型就在前面先把訊息回覆掉，會增加很多開發上的問題(當然若簡單的功能單人沒問題 🤣)。\n\n總而言之～誠心推薦大家去玩玩 bottender，也許你會跟我一樣發現了新大陸 😎。\n\n# 參考\n\n[Dialogflow](https://dialogflow.com)\n[GCP](https://console.cloud.google.com/?hl=zh-TW)\n[Bottneder 建立專案](https://ithelp.ithome.com.tw/articles/10216040)\n[Heroku 部署](https://ithelp.ithome.com.tw/articles/10228055)\n","source":"_posts/Bottender-x-Dialogflow-x-LINE.md","raw":"---\ntitle: Bottender x Dialogflow x LINE\ntags:\n  - chatbot\n  - Google\n  - Dialogflow\ncategories: Chatbot\nabbrlink: 2200933333\ndate: 2019-12-10 23:18:31\n---\n\n大家好，我是 Chatbot Taiwan 的 NiJia，最近我們 Github 開張囉，想找之前演講的紀錄都會在此哦！\n\n- [Github](https://github.com/Chatbot-Taiwan/meetups)\n- [Facebook](https://www.facebook.com/groups/chatbot.tw/)\n- [KKTIX](https://chatbots.kktix.cc/)\n\n# 前言\n\n事情是這樣的，本週末 12/13-12/15 我要去 [GDG Taichung Hackthon Party](https://www.meetup.com/GDGTaichung/events/266686542/) 上當導師，礙於我實在想不出有個題目可以分享給其他同好，碰巧之前跟過 Wolke 大大的 Dialogflow + LINE bot 工作坊，憶起當時的明媚風景，接著前陣子寫鐵人賽也有跟到 C.T Lin 大大寫的[使用 Modern Web 技術來打造 Chat App](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)，如此一來我就乾脆把這兩個東西合在一起弄個東西！\n\n又這麼剛好的我最近瘋狂看 ABL 球賽(支持本土球隊！)，剛好週末也沒事，就順手把它做出來啦~有在看球賽的朋友別錯過這隻機器人囉！他可以告訴你下一場比賽是哪時候～\n![](https://i.imgur.com/RTmyJPr.png)\n\n以下記錄著我踩雷的過程 🤣，詳細 bottender 使用手冊還是參考 -> [使用 Modern Web 技術來打造 Chat App](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)\n\n本篇文章的程式碼已經開源囉 [Taiwan-ABL-Games](https://github.com/louis70109/Taiwan-ABL-games)\n\n# 建立專案\n\n```javascript\nnpx create-bottender-app taiwan-abl-games\n```\n\n接著會看到以下的畫面，bottender 很貼心的列出一些大家平常比較會使用的平台，這邊我們先選擇 LINE，後續會再告訴大家如何增加其他平台選項。\n![](https://i.imgur.com/k12ig2m.png)\n\n# Dialogflow 注意事項與串接\n\n這邊一定是要參考主要開發者所寫的文章啊 -> [Day25](https://ithelp.ithome.com.tw/articles/10226833)\n大致上創建服務的過程差不多，這個部分就簡單帶過比較重要的部分。\n\n> 在處理意圖部分有個小撇步，若鼠標從左邊到右邊，到第二個時會把第一個意圖覆蓋掉，這邊我都是從右邊到左邊一個一個選，才不會遇到覆蓋的問題。\n\n![](https://i.imgur.com/HtZ1OWd.png)\n\n接下來再處理 Dialogflow API 的問題，Day 25 文章中所提到的地方 Google UI 似乎有換位置，我找到的位置在此 -> [URL](https://cloud.google.com/docs/authentication/production#obtaining_and_providing_service_account_credentials_manually)\n![](https://i.imgur.com/5HJ3uL7.png)\n\n從頁面的藍色按鈕(建立服務金鑰)後會遇到下圖畫面，第一個紅色框框需要注意是不是剛剛建立的 Dialogflow 的 agent。\n而第二個下拉式選單選擇 `Dialogflow Integrations`，下面則選擇 `JSON` 格式。\n![](https://i.imgur.com/vBRfIgp.png)\n\n> 在一開始建立完之後若是要回來管理的話，直接到 GCP 的[主控台](https://console.cloud.google.com/home/dashboard)左側的`API & Services`的`Cedemtials`來管理金鑰。\n\n![](https://i.imgur.com/IEGyogB.png)\n\n把下載的檔案放在主目錄下，接著要在`.env`下新增以下兩個 key，`GOOGLE_APPLICATION_CREDENTIALS`則需要打上`絕對路徑`，後面再部署會再解釋這段。\n\n```\nGOOGLE_APPLICATION_CREDENTIALS=/Users/.../taiwan-abl-games/YOUR_KEY.json\nGOOGLE_APPLICATION_PROJECT_ID=taiwan-abl-games-mpmomf\n```\n\n`PROJECT_ID`要去 [GCP 主控台](https://console.cloud.google.com/home/dashboard)查詢。\n![](https://i.imgur.com/GSHaMTK.png)\n\n# 實作\n\n這邊就先複製原作者的 code 並稍做修改至 /src/index.js：\n\n```javascript\nconst dialogflow = require('dialogflow'); // 記得安裝\nconst { format } = require('date-fns'); // 記得安裝\n\nconst PROJECT_ID = process.env.GOOGLE_APPLICATION_PROJECT_ID;\nconst sessionClient = new dialogflow.SessionsClient();\n\nmodule.exports = async function App(context) {\n  if (context.event.isText) {\n    const sessionPath = sessionClient.sessionPath(\n      PROJECT_ID,\n      context.session.id\n    );\n\n    const request = {\n      session: sessionPath,\n      queryInput: {\n        text: {\n          text: context.event.text,\n          languageCode: 'zh-tw',\n        },\n      },\n      queryParams: {\n        timeZone: 'Asia/Taipei',\n      },\n    };\n\n    // 透過 dialogflow 偵測意圖\n    const responses = await sessionClient.detectIntent(request);\n    const { intent, parameters } = responses[0].queryResult;\n\n    if (intent.displayName === 'dreamer-next-game') {\n      //...YOUR CONTEXT\n    } else {\n      await context.sendText('\b您輸入的內容我不懂哦~🏀');\n    }\n  }\n};\n```\n\n藉由上述程式碼會發現藉由 Dialogflow 判斷出來的 intent 到底是要填入什麼？intent 顯示的字串就如下圖所示，我們在 Dialogflow 裡建立的 Intent 的名字就是最後 API 會回傳給我們的判斷字串，這邊就正規化一下自己所要提供的意圖吧！\n![](https://i.imgur.com/sEsEep8.png)\n\n## bottender.config.js\n\n最後這邊提一下如何設定給多平台使用，一開始藉由`npx create-bottender-app xxx`幫我們建立 app 時這個檔案就會自動生成，bottender 很好心的把所有明台所會用到的 key 全部都會放在這裡面。\n![](https://i.imgur.com/Ba6I5HR.png)\n以我為例我就有使用到 Messager 來試玩，這邊就需要把`enabled`啟動(false -> true)，實際建立粉絲頁相關可以[參考](https://ithelp.ithome.com.tw/articles/10218682)\n\n> 題外話: 最後再使用`npx bottender messenger webhook set`就會幫我們把 localhost 串接到 Message 上，實在是太讚了！！！\n\n# 部署注意事項\n\n我是使用 Heroku 當作我部署的環境，請服用這篇[Heroku 部署](https://ithelp.ithome.com.tw/articles/10228055)\n\n在本地端測試時會用到很多的環境變數，而 Dialogflow API json 的路徑我是透過環境變數去取得，在 Heroku 上會把專案的內容放在`/app`底下(不管你專案叫什麼名字)，因此環境變數`GOOGLE_APPLICATION_CREDENTIALS`需要輸入`/app/xx-ooo.json`這樣就會取到當前目錄下的檔案囉！\n\n# 結論\n\n經由這次試玩這個 project 讓我覺得 [bottender](https://github.com/Yoctol/bottender) 這個 chatbot 框架整合真的是厲害，幫開發者處理掉很多跨平台上的問題，我認為最酷的就是 console mode，在測試程式邏輯上可以不用每次都一直用手機開 LINE 或是 FB 來測試機器人狀態，而是在終端機就解決這件事，這是我開發機器人到目前為止覺得最酷的模式 👍！\n\n而在這個專案上我使用到 Dialogflow，除了參考的原文畫面 (GCP 頁面) 已有些許更動外，其實介接的速度是非常快的，此外我很認同原文作者的觀點，把 Dialogflow 接在程式後面才去處理這件事會增加很多彈性，畢竟當一個**回應**來的時候可能會想做其他不同的應用，此時若是模型就在前面先把訊息回覆掉，會增加很多開發上的問題(當然若簡單的功能單人沒問題 🤣)。\n\n總而言之～誠心推薦大家去玩玩 bottender，也許你會跟我一樣發現了新大陸 😎。\n\n# 參考\n\n[Dialogflow](https://dialogflow.com)\n[GCP](https://console.cloud.google.com/?hl=zh-TW)\n[Bottneder 建立專案](https://ithelp.ithome.com.tw/articles/10216040)\n[Heroku 部署](https://ithelp.ithome.com.tw/articles/10228055)\n","slug":"Bottender-x-Dialogflow-x-LINE","published":1,"updated":"2020-06-19T14:03:58.828Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31j4000j7cri1qsn9w2z","content":"<p>大家好，我是 Chatbot Taiwan 的 NiJia，最近我們 Github 開張囉，想找之前演講的紀錄都會在此哦！</p>\n<ul>\n<li><a href=\"https://github.com/Chatbot-Taiwan/meetups\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Facebook</a></li>\n<li><a href=\"https://chatbots.kktix.cc/\" target=\"_blank\" rel=\"noopener\">KKTIX</a></li>\n</ul>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>事情是這樣的，本週末 12/13-12/15 我要去 <a href=\"https://www.meetup.com/GDGTaichung/events/266686542/\" target=\"_blank\" rel=\"noopener\">GDG Taichung Hackthon Party</a> 上當導師，礙於我實在想不出有個題目可以分享給其他同好，碰巧之前跟過 Wolke 大大的 Dialogflow + LINE bot 工作坊，憶起當時的明媚風景，接著前陣子寫鐵人賽也有跟到 C.T Lin 大大寫的<a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">使用 Modern Web 技術來打造 Chat App</a>，如此一來我就乾脆把這兩個東西合在一起弄個東西！</p>\n<p>又這麼剛好的我最近瘋狂看 ABL 球賽(支持本土球隊！)，剛好週末也沒事，就順手把它做出來啦~有在看球賽的朋友別錯過這隻機器人囉！他可以告訴你下一場比賽是哪時候～<br><img src=\"https://i.imgur.com/RTmyJPr.png\" alt></p>\n<p>以下記錄著我踩雷的過程 🤣，詳細 bottender 使用手冊還是參考 -&gt; <a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">使用 Modern Web 技術來打造 Chat App</a></p>\n<p>本篇文章的程式碼已經開源囉 <a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">Taiwan-ABL-Games</a></p>\n<h1 id=\"建立專案\"><a href=\"#建立專案\" class=\"headerlink\" title=\"建立專案\"></a>建立專案</h1><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx create-bottender-app taiwan-abl-games</span><br></pre></td></tr></table></figure>\n\n<p>接著會看到以下的畫面，bottender 很貼心的列出一些大家平常比較會使用的平台，這邊我們先選擇 LINE，後續會再告訴大家如何增加其他平台選項。<br><img src=\"https://i.imgur.com/k12ig2m.png\" alt></p>\n<h1 id=\"Dialogflow-注意事項與串接\"><a href=\"#Dialogflow-注意事項與串接\" class=\"headerlink\" title=\"Dialogflow 注意事項與串接\"></a>Dialogflow 注意事項與串接</h1><p>這邊一定是要參考主要開發者所寫的文章啊 -&gt; <a href=\"https://ithelp.ithome.com.tw/articles/10226833\" target=\"_blank\" rel=\"noopener\">Day25</a><br>大致上創建服務的過程差不多，這個部分就簡單帶過比較重要的部分。</p>\n<blockquote>\n<p>在處理意圖部分有個小撇步，若鼠標從左邊到右邊，到第二個時會把第一個意圖覆蓋掉，這邊我都是從右邊到左邊一個一個選，才不會遇到覆蓋的問題。</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/HtZ1OWd.png\" alt></p>\n<p>接下來再處理 Dialogflow API 的問題，Day 25 文章中所提到的地方 Google UI 似乎有換位置，我找到的位置在此 -&gt; <a href=\"https://cloud.google.com/docs/authentication/production#obtaining_and_providing_service_account_credentials_manually\" target=\"_blank\" rel=\"noopener\">URL</a><br><img src=\"https://i.imgur.com/5HJ3uL7.png\" alt></p>\n<p>從頁面的藍色按鈕(建立服務金鑰)後會遇到下圖畫面，第一個紅色框框需要注意是不是剛剛建立的 Dialogflow 的 agent。<br>而第二個下拉式選單選擇 <code>Dialogflow Integrations</code>，下面則選擇 <code>JSON</code> 格式。<br><img src=\"https://i.imgur.com/vBRfIgp.png\" alt></p>\n<blockquote>\n<p>在一開始建立完之後若是要回來管理的話，直接到 GCP 的<a href=\"https://console.cloud.google.com/home/dashboard\" target=\"_blank\" rel=\"noopener\">主控台</a>左側的<code>API &amp; Services</code>的<code>Cedemtials</code>來管理金鑰。</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/IEGyogB.png\" alt></p>\n<p>把下載的檔案放在主目錄下，接著要在<code>.env</code>下新增以下兩個 key，<code>GOOGLE_APPLICATION_CREDENTIALS</code>則需要打上<code>絕對路徑</code>，後面再部署會再解釋這段。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GOOGLE_APPLICATION_CREDENTIALS=/Users/.../taiwan-abl-games/YOUR_KEY.json</span><br><span class=\"line\">GOOGLE_APPLICATION_PROJECT_ID=taiwan-abl-games-mpmomf</span><br></pre></td></tr></table></figure>\n\n<p><code>PROJECT_ID</code>要去 <a href=\"https://console.cloud.google.com/home/dashboard\" target=\"_blank\" rel=\"noopener\">GCP 主控台</a>查詢。<br><img src=\"https://i.imgur.com/GSHaMTK.png\" alt></p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>這邊就先複製原作者的 code 並稍做修改至 /src/index.js：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> dialogflow = <span class=\"built_in\">require</span>(<span class=\"string\">'dialogflow'</span>); <span class=\"comment\">// 記得安裝</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; format &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">'date-fns'</span>); <span class=\"comment\">// 記得安裝</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> PROJECT_ID = process.env.GOOGLE_APPLICATION_PROJECT_ID;</span><br><span class=\"line\"><span class=\"keyword\">const</span> sessionClient = <span class=\"keyword\">new</span> dialogflow.SessionsClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">App</span>(<span class=\"params\">context</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (context.event.isText) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> sessionPath = sessionClient.sessionPath(</span><br><span class=\"line\">      PROJECT_ID,</span><br><span class=\"line\">      context.session.id</span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> request = &#123;</span><br><span class=\"line\">      session: sessionPath,</span><br><span class=\"line\">      queryInput: &#123;</span><br><span class=\"line\">        text: &#123;</span><br><span class=\"line\">          text: context.event.text,</span><br><span class=\"line\">          languageCode: <span class=\"string\">'zh-tw'</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      queryParams: &#123;</span><br><span class=\"line\">        timeZone: <span class=\"string\">'Asia/Taipei'</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 透過 dialogflow 偵測意圖</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> responses = <span class=\"keyword\">await</span> sessionClient.detectIntent(request);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; intent, parameters &#125; = responses[<span class=\"number\">0</span>].queryResult;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (intent.displayName === <span class=\"string\">'dreamer-next-game'</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//...YOUR CONTEXT</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">await</span> context.sendText(<span class=\"string\">'\b您輸入的內容我不懂哦~🏀'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>藉由上述程式碼會發現藉由 Dialogflow 判斷出來的 intent 到底是要填入什麼？intent 顯示的字串就如下圖所示，我們在 Dialogflow 裡建立的 Intent 的名字就是最後 API 會回傳給我們的判斷字串，這邊就正規化一下自己所要提供的意圖吧！<br><img src=\"https://i.imgur.com/sEsEep8.png\" alt></p>\n<h2 id=\"bottender-config-js\"><a href=\"#bottender-config-js\" class=\"headerlink\" title=\"bottender.config.js\"></a>bottender.config.js</h2><p>最後這邊提一下如何設定給多平台使用，一開始藉由<code>npx create-bottender-app xxx</code>幫我們建立 app 時這個檔案就會自動生成，bottender 很好心的把所有明台所會用到的 key 全部都會放在這裡面。<br><img src=\"https://i.imgur.com/Ba6I5HR.png\" alt><br>以我為例我就有使用到 Messager 來試玩，這邊就需要把<code>enabled</code>啟動(false -&gt; true)，實際建立粉絲頁相關可以<a href=\"https://ithelp.ithome.com.tw/articles/10218682\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n<blockquote>\n<p>題外話: 最後再使用<code>npx bottender messenger webhook set</code>就會幫我們把 localhost 串接到 Message 上，實在是太讚了！！！</p>\n</blockquote>\n<h1 id=\"部署注意事項\"><a href=\"#部署注意事項\" class=\"headerlink\" title=\"部署注意事項\"></a>部署注意事項</h1><p>我是使用 Heroku 當作我部署的環境，請服用這篇<a href=\"https://ithelp.ithome.com.tw/articles/10228055\" target=\"_blank\" rel=\"noopener\">Heroku 部署</a></p>\n<p>在本地端測試時會用到很多的環境變數，而 Dialogflow API json 的路徑我是透過環境變數去取得，在 Heroku 上會把專案的內容放在<code>/app</code>底下(不管你專案叫什麼名字)，因此環境變數<code>GOOGLE_APPLICATION_CREDENTIALS</code>需要輸入<code>/app/xx-ooo.json</code>這樣就會取到當前目錄下的檔案囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>經由這次試玩這個 project 讓我覺得 <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">bottender</a> 這個 chatbot 框架整合真的是厲害，幫開發者處理掉很多跨平台上的問題，我認為最酷的就是 console mode，在測試程式邏輯上可以不用每次都一直用手機開 LINE 或是 FB 來測試機器人狀態，而是在終端機就解決這件事，這是我開發機器人到目前為止覺得最酷的模式 👍！</p>\n<p>而在這個專案上我使用到 Dialogflow，除了參考的原文畫面 (GCP 頁面) 已有些許更動外，其實介接的速度是非常快的，此外我很認同原文作者的觀點，把 Dialogflow 接在程式後面才去處理這件事會增加很多彈性，畢竟當一個<strong>回應</strong>來的時候可能會想做其他不同的應用，此時若是模型就在前面先把訊息回覆掉，會增加很多開發上的問題(當然若簡單的功能單人沒問題 🤣)。</p>\n<p>總而言之～誠心推薦大家去玩玩 bottender，也許你會跟我一樣發現了新大陸 😎。</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://dialogflow.com\" target=\"_blank\" rel=\"noopener\">Dialogflow</a><br><a href=\"https://console.cloud.google.com/?hl=zh-TW\" target=\"_blank\" rel=\"noopener\">GCP</a><br><a href=\"https://ithelp.ithome.com.tw/articles/10216040\" target=\"_blank\" rel=\"noopener\">Bottneder 建立專案</a><br><a href=\"https://ithelp.ithome.com.tw/articles/10228055\" target=\"_blank\" rel=\"noopener\">Heroku 部署</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>大家好，我是 Chatbot Taiwan 的 NiJia，最近我們 Github 開張囉，想找之前演講的紀錄都會在此哦！</p>\n<ul>\n<li><a href=\"https://github.com/Chatbot-Taiwan/meetups\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Facebook</a></li>\n<li><a href=\"https://chatbots.kktix.cc/\" target=\"_blank\" rel=\"noopener\">KKTIX</a></li>\n</ul>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>事情是這樣的，本週末 12/13-12/15 我要去 <a href=\"https://www.meetup.com/GDGTaichung/events/266686542/\" target=\"_blank\" rel=\"noopener\">GDG Taichung Hackthon Party</a> 上當導師，礙於我實在想不出有個題目可以分享給其他同好，碰巧之前跟過 Wolke 大大的 Dialogflow + LINE bot 工作坊，憶起當時的明媚風景，接著前陣子寫鐵人賽也有跟到 C.T Lin 大大寫的<a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">使用 Modern Web 技術來打造 Chat App</a>，如此一來我就乾脆把這兩個東西合在一起弄個東西！</p>\n<p>又這麼剛好的我最近瘋狂看 ABL 球賽(支持本土球隊！)，剛好週末也沒事，就順手把它做出來啦~有在看球賽的朋友別錯過這隻機器人囉！他可以告訴你下一場比賽是哪時候～<br><img src=\"https://i.imgur.com/RTmyJPr.png\" alt></p>\n<p>以下記錄著我踩雷的過程 🤣，詳細 bottender 使用手冊還是參考 -&gt; <a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">使用 Modern Web 技術來打造 Chat App</a></p>\n<p>本篇文章的程式碼已經開源囉 <a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">Taiwan-ABL-Games</a></p>\n<h1 id=\"建立專案\"><a href=\"#建立專案\" class=\"headerlink\" title=\"建立專案\"></a>建立專案</h1><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx create-bottender-app taiwan-abl-games</span><br></pre></td></tr></table></figure>\n\n<p>接著會看到以下的畫面，bottender 很貼心的列出一些大家平常比較會使用的平台，這邊我們先選擇 LINE，後續會再告訴大家如何增加其他平台選項。<br><img src=\"https://i.imgur.com/k12ig2m.png\" alt></p>\n<h1 id=\"Dialogflow-注意事項與串接\"><a href=\"#Dialogflow-注意事項與串接\" class=\"headerlink\" title=\"Dialogflow 注意事項與串接\"></a>Dialogflow 注意事項與串接</h1><p>這邊一定是要參考主要開發者所寫的文章啊 -&gt; <a href=\"https://ithelp.ithome.com.tw/articles/10226833\" target=\"_blank\" rel=\"noopener\">Day25</a><br>大致上創建服務的過程差不多，這個部分就簡單帶過比較重要的部分。</p>\n<blockquote>\n<p>在處理意圖部分有個小撇步，若鼠標從左邊到右邊，到第二個時會把第一個意圖覆蓋掉，這邊我都是從右邊到左邊一個一個選，才不會遇到覆蓋的問題。</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/HtZ1OWd.png\" alt></p>\n<p>接下來再處理 Dialogflow API 的問題，Day 25 文章中所提到的地方 Google UI 似乎有換位置，我找到的位置在此 -&gt; <a href=\"https://cloud.google.com/docs/authentication/production#obtaining_and_providing_service_account_credentials_manually\" target=\"_blank\" rel=\"noopener\">URL</a><br><img src=\"https://i.imgur.com/5HJ3uL7.png\" alt></p>\n<p>從頁面的藍色按鈕(建立服務金鑰)後會遇到下圖畫面，第一個紅色框框需要注意是不是剛剛建立的 Dialogflow 的 agent。<br>而第二個下拉式選單選擇 <code>Dialogflow Integrations</code>，下面則選擇 <code>JSON</code> 格式。<br><img src=\"https://i.imgur.com/vBRfIgp.png\" alt></p>\n<blockquote>\n<p>在一開始建立完之後若是要回來管理的話，直接到 GCP 的<a href=\"https://console.cloud.google.com/home/dashboard\" target=\"_blank\" rel=\"noopener\">主控台</a>左側的<code>API &amp; Services</code>的<code>Cedemtials</code>來管理金鑰。</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/IEGyogB.png\" alt></p>\n<p>把下載的檔案放在主目錄下，接著要在<code>.env</code>下新增以下兩個 key，<code>GOOGLE_APPLICATION_CREDENTIALS</code>則需要打上<code>絕對路徑</code>，後面再部署會再解釋這段。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GOOGLE_APPLICATION_CREDENTIALS=/Users/.../taiwan-abl-games/YOUR_KEY.json</span><br><span class=\"line\">GOOGLE_APPLICATION_PROJECT_ID=taiwan-abl-games-mpmomf</span><br></pre></td></tr></table></figure>\n\n<p><code>PROJECT_ID</code>要去 <a href=\"https://console.cloud.google.com/home/dashboard\" target=\"_blank\" rel=\"noopener\">GCP 主控台</a>查詢。<br><img src=\"https://i.imgur.com/GSHaMTK.png\" alt></p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>這邊就先複製原作者的 code 並稍做修改至 /src/index.js：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> dialogflow = <span class=\"built_in\">require</span>(<span class=\"string\">'dialogflow'</span>); <span class=\"comment\">// 記得安裝</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; format &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">'date-fns'</span>); <span class=\"comment\">// 記得安裝</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> PROJECT_ID = process.env.GOOGLE_APPLICATION_PROJECT_ID;</span><br><span class=\"line\"><span class=\"keyword\">const</span> sessionClient = <span class=\"keyword\">new</span> dialogflow.SessionsClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">App</span>(<span class=\"params\">context</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (context.event.isText) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> sessionPath = sessionClient.sessionPath(</span><br><span class=\"line\">      PROJECT_ID,</span><br><span class=\"line\">      context.session.id</span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> request = &#123;</span><br><span class=\"line\">      session: sessionPath,</span><br><span class=\"line\">      queryInput: &#123;</span><br><span class=\"line\">        text: &#123;</span><br><span class=\"line\">          text: context.event.text,</span><br><span class=\"line\">          languageCode: <span class=\"string\">'zh-tw'</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      queryParams: &#123;</span><br><span class=\"line\">        timeZone: <span class=\"string\">'Asia/Taipei'</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 透過 dialogflow 偵測意圖</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> responses = <span class=\"keyword\">await</span> sessionClient.detectIntent(request);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; intent, parameters &#125; = responses[<span class=\"number\">0</span>].queryResult;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (intent.displayName === <span class=\"string\">'dreamer-next-game'</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//...YOUR CONTEXT</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">await</span> context.sendText(<span class=\"string\">'\b您輸入的內容我不懂哦~🏀'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>藉由上述程式碼會發現藉由 Dialogflow 判斷出來的 intent 到底是要填入什麼？intent 顯示的字串就如下圖所示，我們在 Dialogflow 裡建立的 Intent 的名字就是最後 API 會回傳給我們的判斷字串，這邊就正規化一下自己所要提供的意圖吧！<br><img src=\"https://i.imgur.com/sEsEep8.png\" alt></p>\n<h2 id=\"bottender-config-js\"><a href=\"#bottender-config-js\" class=\"headerlink\" title=\"bottender.config.js\"></a>bottender.config.js</h2><p>最後這邊提一下如何設定給多平台使用，一開始藉由<code>npx create-bottender-app xxx</code>幫我們建立 app 時這個檔案就會自動生成，bottender 很好心的把所有明台所會用到的 key 全部都會放在這裡面。<br><img src=\"https://i.imgur.com/Ba6I5HR.png\" alt><br>以我為例我就有使用到 Messager 來試玩，這邊就需要把<code>enabled</code>啟動(false -&gt; true)，實際建立粉絲頁相關可以<a href=\"https://ithelp.ithome.com.tw/articles/10218682\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n<blockquote>\n<p>題外話: 最後再使用<code>npx bottender messenger webhook set</code>就會幫我們把 localhost 串接到 Message 上，實在是太讚了！！！</p>\n</blockquote>\n<h1 id=\"部署注意事項\"><a href=\"#部署注意事項\" class=\"headerlink\" title=\"部署注意事項\"></a>部署注意事項</h1><p>我是使用 Heroku 當作我部署的環境，請服用這篇<a href=\"https://ithelp.ithome.com.tw/articles/10228055\" target=\"_blank\" rel=\"noopener\">Heroku 部署</a></p>\n<p>在本地端測試時會用到很多的環境變數，而 Dialogflow API json 的路徑我是透過環境變數去取得，在 Heroku 上會把專案的內容放在<code>/app</code>底下(不管你專案叫什麼名字)，因此環境變數<code>GOOGLE_APPLICATION_CREDENTIALS</code>需要輸入<code>/app/xx-ooo.json</code>這樣就會取到當前目錄下的檔案囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>經由這次試玩這個 project 讓我覺得 <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">bottender</a> 這個 chatbot 框架整合真的是厲害，幫開發者處理掉很多跨平台上的問題，我認為最酷的就是 console mode，在測試程式邏輯上可以不用每次都一直用手機開 LINE 或是 FB 來測試機器人狀態，而是在終端機就解決這件事，這是我開發機器人到目前為止覺得最酷的模式 👍！</p>\n<p>而在這個專案上我使用到 Dialogflow，除了參考的原文畫面 (GCP 頁面) 已有些許更動外，其實介接的速度是非常快的，此外我很認同原文作者的觀點，把 Dialogflow 接在程式後面才去處理這件事會增加很多彈性，畢竟當一個<strong>回應</strong>來的時候可能會想做其他不同的應用，此時若是模型就在前面先把訊息回覆掉，會增加很多開發上的問題(當然若簡單的功能單人沒問題 🤣)。</p>\n<p>總而言之～誠心推薦大家去玩玩 bottender，也許你會跟我一樣發現了新大陸 😎。</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://dialogflow.com\" target=\"_blank\" rel=\"noopener\">Dialogflow</a><br><a href=\"https://console.cloud.google.com/?hl=zh-TW\" target=\"_blank\" rel=\"noopener\">GCP</a><br><a href=\"https://ithelp.ithome.com.tw/articles/10216040\" target=\"_blank\" rel=\"noopener\">Bottneder 建立專案</a><br><a href=\"https://ithelp.ithome.com.tw/articles/10228055\" target=\"_blank\" rel=\"noopener\">Heroku 部署</a></p>\n"},{"title":"Day1 - serverless 介紹","abbrlink":879369769,"date":"2019-09-16T06:09:23.000Z","_content":"\n![](https://i.imgur.com/abW5lFB.jpg)\n\n# 前言\n\n那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)\n\n---\n\n# 為什麼要 Serverless\n\nServerless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。\n\n以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login-Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～\n\n但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！\n\nserverless.yaml 是該專案的設定檔，可以把它想像成是 CloudFormation 的 wrapper，事實上也的確是這樣，serverless 背後會把他轉成 CloudFormation 的 template 去發佈。這個設定檔是 serverless 的精髓所在，一切有關 API Gateway 和 Lambda 的設定都在這邊，而底層所需要的資源，他都幫你配置好了，不需要操心。 [ref](https://medium.com/kkstream/%E7%95%B6-aws-api-gateway-lambda-golang-%E9%81%87%E4%B8%8A-ci-cd-1a3b3334ebc)\n\n---\n\n# Cold start 問題\n\n依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。\n\n如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 ?，所以這部分就別擔新大力地給他用下去!\n\n![](https://i.imgur.com/hC1Dgz4.png)\n\n# AWS Lambda 限制\n\n![](https://i.imgur.com/mC7Y9XY.png)\n\n# 安裝與使用\n\n[serverless.yaml 的設定參考](https://serverless.com/framework/docs/providers/aws/guide/serverless.yml/)\n[serverless.yaml 的變數傳遞](https://serverless.com/framework/docs/providers/aws/guide/variables/)\n\n---\n\n# 結論\n\n接下來會是使用 Serverless 這個**框架**去實作的，使用的語言為 Python，至於為什麼會選它呢，最主要原因還是在官網上有很多 [plugin](https://serverless.com/plugins/) 可以用 ( NodeJS & Python )，開發時資源相對多，接著是 AWS Lambda 的 Code-start 最快的就屬於 NodeJS & Python 了，而我原本就是寫 Ruby 來的，自然就選一個寫法相近的語言啦(好像有點牽強)，如果說你想了解 runtimes 相關的問題的話可以參考[這篇](https://medium.com/the-theam-journey/benchmarking-aws-lambda-runtimes-in-2019-part-i-b1ee459a293d)。\n\n# 環境\n\n- MacOS 10.14.6\n- [npm](https://nodejs.org/zh-tw/download/) 6.9.0\n- [python](https://www.python.org/downloads/) 3.7.3\n- [Serverless 套件(框架)](https://github.com/serverless/serverless) 1.45.1\n\n# 參考\n\n- [Serverless wiki](https://zh.wikipedia.org/wiki/%E7%84%A1%E4%BC%BA%E6%9C%8D%E5%99%A8%E8%A8%88%E7%AE%97)\n- [Serverless 優缺點](https://denny.qollie.com/2016/05/22/serverless-simple-crud/)\n- [AWS Lambda 限制](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/limits.html)\n","source":"_posts/Day1-serverless-介紹.md","raw":"---\ntitle: Day1 - serverless 介紹\ntags:\n  - Serverless\n  - AWS\n  - Lambda\ncategories: 2019鐵人賽\nabbrlink: 879369769\ndate: 2019-09-16 14:09:23\n---\n\n![](https://i.imgur.com/abW5lFB.jpg)\n\n# 前言\n\n那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)\n\n---\n\n# 為什麼要 Serverless\n\nServerless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。\n\n以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login-Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～\n\n但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！\n\nserverless.yaml 是該專案的設定檔，可以把它想像成是 CloudFormation 的 wrapper，事實上也的確是這樣，serverless 背後會把他轉成 CloudFormation 的 template 去發佈。這個設定檔是 serverless 的精髓所在，一切有關 API Gateway 和 Lambda 的設定都在這邊，而底層所需要的資源，他都幫你配置好了，不需要操心。 [ref](https://medium.com/kkstream/%E7%95%B6-aws-api-gateway-lambda-golang-%E9%81%87%E4%B8%8A-ci-cd-1a3b3334ebc)\n\n---\n\n# Cold start 問題\n\n依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。\n\n如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 ?，所以這部分就別擔新大力地給他用下去!\n\n![](https://i.imgur.com/hC1Dgz4.png)\n\n# AWS Lambda 限制\n\n![](https://i.imgur.com/mC7Y9XY.png)\n\n# 安裝與使用\n\n[serverless.yaml 的設定參考](https://serverless.com/framework/docs/providers/aws/guide/serverless.yml/)\n[serverless.yaml 的變數傳遞](https://serverless.com/framework/docs/providers/aws/guide/variables/)\n\n---\n\n# 結論\n\n接下來會是使用 Serverless 這個**框架**去實作的，使用的語言為 Python，至於為什麼會選它呢，最主要原因還是在官網上有很多 [plugin](https://serverless.com/plugins/) 可以用 ( NodeJS & Python )，開發時資源相對多，接著是 AWS Lambda 的 Code-start 最快的就屬於 NodeJS & Python 了，而我原本就是寫 Ruby 來的，自然就選一個寫法相近的語言啦(好像有點牽強)，如果說你想了解 runtimes 相關的問題的話可以參考[這篇](https://medium.com/the-theam-journey/benchmarking-aws-lambda-runtimes-in-2019-part-i-b1ee459a293d)。\n\n# 環境\n\n- MacOS 10.14.6\n- [npm](https://nodejs.org/zh-tw/download/) 6.9.0\n- [python](https://www.python.org/downloads/) 3.7.3\n- [Serverless 套件(框架)](https://github.com/serverless/serverless) 1.45.1\n\n# 參考\n\n- [Serverless wiki](https://zh.wikipedia.org/wiki/%E7%84%A1%E4%BC%BA%E6%9C%8D%E5%99%A8%E8%A8%88%E7%AE%97)\n- [Serverless 優缺點](https://denny.qollie.com/2016/05/22/serverless-simple-crud/)\n- [AWS Lambda 限制](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/limits.html)\n","slug":"Day1-serverless-介紹","published":1,"updated":"2020-06-19T14:21:37.640Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31j6000n7critcvcddsy","content":"<p><img src=\"https://i.imgur.com/abW5lFB.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)</p>\n<hr>\n<h1 id=\"為什麼要-Serverless\"><a href=\"#為什麼要-Serverless\" class=\"headerlink\" title=\"為什麼要 Serverless\"></a>為什麼要 Serverless</h1><p>Serverless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。</p>\n<p>以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login-Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～</p>\n<p>但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！</p>\n<p>serverless.yaml 是該專案的設定檔，可以把它想像成是 CloudFormation 的 wrapper，事實上也的確是這樣，serverless 背後會把他轉成 CloudFormation 的 template 去發佈。這個設定檔是 serverless 的精髓所在，一切有關 API Gateway 和 Lambda 的設定都在這邊，而底層所需要的資源，他都幫你配置好了，不需要操心。 <a href=\"https://medium.com/kkstream/%E7%95%B6-aws-api-gateway-lambda-golang-%E9%81%87%E4%B8%8A-ci-cd-1a3b3334ebc\" target=\"_blank\" rel=\"noopener\">ref</a></p>\n<hr>\n<h1 id=\"Cold-start-問題\"><a href=\"#Cold-start-問題\" class=\"headerlink\" title=\"Cold start 問題\"></a>Cold start 問題</h1><p>依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。</p>\n<p>如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 ?，所以這部分就別擔新大力地給他用下去!</p>\n<p><img src=\"https://i.imgur.com/hC1Dgz4.png\" alt></p>\n<h1 id=\"AWS-Lambda-限制\"><a href=\"#AWS-Lambda-限制\" class=\"headerlink\" title=\"AWS Lambda 限制\"></a>AWS Lambda 限制</h1><p><img src=\"https://i.imgur.com/mC7Y9XY.png\" alt></p>\n<h1 id=\"安裝與使用\"><a href=\"#安裝與使用\" class=\"headerlink\" title=\"安裝與使用\"></a>安裝與使用</h1><p><a href=\"https://serverless.com/framework/docs/providers/aws/guide/serverless.yml/\" target=\"_blank\" rel=\"noopener\">serverless.yaml 的設定參考</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/guide/variables/\" target=\"_blank\" rel=\"noopener\">serverless.yaml 的變數傳遞</a></p>\n<hr>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>接下來會是使用 Serverless 這個<strong>框架</strong>去實作的，使用的語言為 Python，至於為什麼會選它呢，最主要原因還是在官網上有很多 <a href=\"https://serverless.com/plugins/\" target=\"_blank\" rel=\"noopener\">plugin</a> 可以用 ( NodeJS &amp; Python )，開發時資源相對多，接著是 AWS Lambda 的 Code-start 最快的就屬於 NodeJS &amp; Python 了，而我原本就是寫 Ruby 來的，自然就選一個寫法相近的語言啦(好像有點牽強)，如果說你想了解 runtimes 相關的問題的話可以參考<a href=\"https://medium.com/the-theam-journey/benchmarking-aws-lambda-runtimes-in-2019-part-i-b1ee459a293d\" target=\"_blank\" rel=\"noopener\">這篇</a>。</p>\n<h1 id=\"環境\"><a href=\"#環境\" class=\"headerlink\" title=\"環境\"></a>環境</h1><ul>\n<li>MacOS 10.14.6</li>\n<li><a href=\"https://nodejs.org/zh-tw/download/\" target=\"_blank\" rel=\"noopener\">npm</a> 6.9.0</li>\n<li><a href=\"https://www.python.org/downloads/\" target=\"_blank\" rel=\"noopener\">python</a> 3.7.3</li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless 套件(框架)</a> 1.45.1</li>\n</ul>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E7%84%A1%E4%BC%BA%E6%9C%8D%E5%99%A8%E8%A8%88%E7%AE%97\" target=\"_blank\" rel=\"noopener\">Serverless wiki</a></li>\n<li><a href=\"https://denny.qollie.com/2016/05/22/serverless-simple-crud/\" target=\"_blank\" rel=\"noopener\">Serverless 優缺點</a></li>\n<li><a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/limits.html\" target=\"_blank\" rel=\"noopener\">AWS Lambda 限制</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://i.imgur.com/abW5lFB.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)</p>\n<hr>\n<h1 id=\"為什麼要-Serverless\"><a href=\"#為什麼要-Serverless\" class=\"headerlink\" title=\"為什麼要 Serverless\"></a>為什麼要 Serverless</h1><p>Serverless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。</p>\n<p>以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login-Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～</p>\n<p>但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！</p>\n<p>serverless.yaml 是該專案的設定檔，可以把它想像成是 CloudFormation 的 wrapper，事實上也的確是這樣，serverless 背後會把他轉成 CloudFormation 的 template 去發佈。這個設定檔是 serverless 的精髓所在，一切有關 API Gateway 和 Lambda 的設定都在這邊，而底層所需要的資源，他都幫你配置好了，不需要操心。 <a href=\"https://medium.com/kkstream/%E7%95%B6-aws-api-gateway-lambda-golang-%E9%81%87%E4%B8%8A-ci-cd-1a3b3334ebc\" target=\"_blank\" rel=\"noopener\">ref</a></p>\n<hr>\n<h1 id=\"Cold-start-問題\"><a href=\"#Cold-start-問題\" class=\"headerlink\" title=\"Cold start 問題\"></a>Cold start 問題</h1><p>依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。</p>\n<p>如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 ?，所以這部分就別擔新大力地給他用下去!</p>\n<p><img src=\"https://i.imgur.com/hC1Dgz4.png\" alt></p>\n<h1 id=\"AWS-Lambda-限制\"><a href=\"#AWS-Lambda-限制\" class=\"headerlink\" title=\"AWS Lambda 限制\"></a>AWS Lambda 限制</h1><p><img src=\"https://i.imgur.com/mC7Y9XY.png\" alt></p>\n<h1 id=\"安裝與使用\"><a href=\"#安裝與使用\" class=\"headerlink\" title=\"安裝與使用\"></a>安裝與使用</h1><p><a href=\"https://serverless.com/framework/docs/providers/aws/guide/serverless.yml/\" target=\"_blank\" rel=\"noopener\">serverless.yaml 的設定參考</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/guide/variables/\" target=\"_blank\" rel=\"noopener\">serverless.yaml 的變數傳遞</a></p>\n<hr>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>接下來會是使用 Serverless 這個<strong>框架</strong>去實作的，使用的語言為 Python，至於為什麼會選它呢，最主要原因還是在官網上有很多 <a href=\"https://serverless.com/plugins/\" target=\"_blank\" rel=\"noopener\">plugin</a> 可以用 ( NodeJS &amp; Python )，開發時資源相對多，接著是 AWS Lambda 的 Code-start 最快的就屬於 NodeJS &amp; Python 了，而我原本就是寫 Ruby 來的，自然就選一個寫法相近的語言啦(好像有點牽強)，如果說你想了解 runtimes 相關的問題的話可以參考<a href=\"https://medium.com/the-theam-journey/benchmarking-aws-lambda-runtimes-in-2019-part-i-b1ee459a293d\" target=\"_blank\" rel=\"noopener\">這篇</a>。</p>\n<h1 id=\"環境\"><a href=\"#環境\" class=\"headerlink\" title=\"環境\"></a>環境</h1><ul>\n<li>MacOS 10.14.6</li>\n<li><a href=\"https://nodejs.org/zh-tw/download/\" target=\"_blank\" rel=\"noopener\">npm</a> 6.9.0</li>\n<li><a href=\"https://www.python.org/downloads/\" target=\"_blank\" rel=\"noopener\">python</a> 3.7.3</li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless 套件(框架)</a> 1.45.1</li>\n</ul>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E7%84%A1%E4%BC%BA%E6%9C%8D%E5%99%A8%E8%A8%88%E7%AE%97\" target=\"_blank\" rel=\"noopener\">Serverless wiki</a></li>\n<li><a href=\"https://denny.qollie.com/2016/05/22/serverless-simple-crud/\" target=\"_blank\" rel=\"noopener\">Serverless 優缺點</a></li>\n<li><a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/limits.html\" target=\"_blank\" rel=\"noopener\">AWS Lambda 限制</a></li>\n</ul>\n"},{"title":"Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹","abbrlink":1032560461,"date":"2019-09-24T12:36:40.000Z","_content":"\n## 簡介\n\nLINE 在 2016 年 9 月底發表了 Messaging API 功能，用戶可以透過 Messaging API 將自家的服務內容串聯到 LINE@ 上。\n\n接著在 2019/04/18 之後 LINE@ 2.0 正式上線，在 5/22 後有升級的選項並會陸續更新，升級完的官方帳號也可以申請專屬 ID、進行帳號認證。\n\n我認為比前一版本的最大的好處是在**好友無上限**的這部分，以前只能有 50 位好友，若一般開發者的機器人好不容易上線了並開放測試時被限制住，除了再開一隻機器人或是其他方法就超麻煩，現在好友無上限了，就不會有上述的問題了。\n\n> 若您以前有開發過的機器人到現在還沒升級的話，可以參考 -> [URL](http://at-blog.line.me/tw/archives/lineat_manual_upgrade_02.html)\n\n這邊需要注意 1 on 1 聊天與 Messaging API 是無法同時使用的，但可以在後台切換看要使用哪種模式與顧客互動。對話記錄也會保存在各自的模式下，若要查看完整的對話記錄的話會建議以固定模式與顧客進行互動哦！\n\n### 主要的功能環繞在以下兩點\n\n![](https://i.imgur.com/kqf5mo5.png)\n\n1. **Push mode:** 主動推播訊息給用戶，2.0 每個機器人都有 500 則免費推播則數，超過則數的話可以參考以下的價目表：\n\n![](https://i.imgur.com/7HJySLK.png)\n\n2. **Reply mode:** 這個模式是接受使用者的訊息並透過 webhook 打到伺服器上讓伺服器去做對應訊息的處理，重點是它是是免費、免費、免費的！所以若能引導使用者去輸入訊息的話用這個模式是不用錢的哦 🎉\n\nMessage API 支援以下格式\n\n- Text message\n- Sticker message\n- Image message\n- Video message\n- Audio message\n- Location message\n- Imagemap message\n- Template message\n- Flex message\n\n> 詳細內容可以參考 [LINE doc](https://developers.line.biz/en/docs/messaging-api/message-types/)\n\n![line sample 1](https://i.imgur.com/PLWylFy.png)\n![line sample 2](https://i.imgur.com/lInGVV0.png)\n\n## 回傳格式\n\nMessage API 回傳格式都是一個陣列的格式，一開始在接的時候都沒注意到一直瘋狂出錯，事實上這樣陣列對 Server 有個好處就是當一次需要送較多訊息時格式會比較統一，只是對於有潔癖的開發者來說每次都要多打`[0]`會覺得有點髒 🤣\n\n```\n{\n  'events': [{\n    'replyToken': '00000000000000000000000000000000',\n    'type': 'message',\n    'timestamp': 1568983962754,\n    'source': {\n      'type': 'user',\n      'userId': 'Udeadbeefdaaaaefdeadbeefdeadbeef'\n    },\n    'message': {\n      'id': '100001',\n      'type': 'text',\n      'text': 'Hello, world'\n    }\n  }, {\n    'replyToken': 'ffffffffffffffffffffffffffffffff',\n    'type': 'message',\n    'timestamp': 1568983962754,\n    'source': {\n      'type': 'user',\n      'userId': 'Udeadbeeaaaaefdeadbeefdeadbeef'\n    },\n    'message': {\n      'id': '100002',\n      'type': 'sticker',\n      'packageId': '1',\n      'stickerId': '1'\n    }\n  }]\n}\n```\n\n## 結論\n\n以前剛開始接 LINE Message API 的時候都覺得他的文件不太人性，更新到現在文件內容也越來完整，讓開發者在開發的過程中不用再為了找不到文件而放棄了(我以前就是 🤣)，下一篇將會帶來如何申請一隻機器人到如何建立一個 webhook API 到 AWS 上\n\n## 參考\n\n[功能介紹】Messaging API](http://at-blog.line.me/tw/messaging_api_intro)\n[LINE message template](https://developers.line.biz/en/docs/messaging-api/message-types/)\n","source":"_posts/Day10-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-1-介紹.md","raw":"---\ntitle: Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹\ntags:\n  - LINE\n  - Message API\n  - chatbot\ncategories: 2019鐵人賽\nabbrlink: 1032560461\ndate: 2019-09-24 20:36:40\n---\n\n## 簡介\n\nLINE 在 2016 年 9 月底發表了 Messaging API 功能，用戶可以透過 Messaging API 將自家的服務內容串聯到 LINE@ 上。\n\n接著在 2019/04/18 之後 LINE@ 2.0 正式上線，在 5/22 後有升級的選項並會陸續更新，升級完的官方帳號也可以申請專屬 ID、進行帳號認證。\n\n我認為比前一版本的最大的好處是在**好友無上限**的這部分，以前只能有 50 位好友，若一般開發者的機器人好不容易上線了並開放測試時被限制住，除了再開一隻機器人或是其他方法就超麻煩，現在好友無上限了，就不會有上述的問題了。\n\n> 若您以前有開發過的機器人到現在還沒升級的話，可以參考 -> [URL](http://at-blog.line.me/tw/archives/lineat_manual_upgrade_02.html)\n\n這邊需要注意 1 on 1 聊天與 Messaging API 是無法同時使用的，但可以在後台切換看要使用哪種模式與顧客互動。對話記錄也會保存在各自的模式下，若要查看完整的對話記錄的話會建議以固定模式與顧客進行互動哦！\n\n### 主要的功能環繞在以下兩點\n\n![](https://i.imgur.com/kqf5mo5.png)\n\n1. **Push mode:** 主動推播訊息給用戶，2.0 每個機器人都有 500 則免費推播則數，超過則數的話可以參考以下的價目表：\n\n![](https://i.imgur.com/7HJySLK.png)\n\n2. **Reply mode:** 這個模式是接受使用者的訊息並透過 webhook 打到伺服器上讓伺服器去做對應訊息的處理，重點是它是是免費、免費、免費的！所以若能引導使用者去輸入訊息的話用這個模式是不用錢的哦 🎉\n\nMessage API 支援以下格式\n\n- Text message\n- Sticker message\n- Image message\n- Video message\n- Audio message\n- Location message\n- Imagemap message\n- Template message\n- Flex message\n\n> 詳細內容可以參考 [LINE doc](https://developers.line.biz/en/docs/messaging-api/message-types/)\n\n![line sample 1](https://i.imgur.com/PLWylFy.png)\n![line sample 2](https://i.imgur.com/lInGVV0.png)\n\n## 回傳格式\n\nMessage API 回傳格式都是一個陣列的格式，一開始在接的時候都沒注意到一直瘋狂出錯，事實上這樣陣列對 Server 有個好處就是當一次需要送較多訊息時格式會比較統一，只是對於有潔癖的開發者來說每次都要多打`[0]`會覺得有點髒 🤣\n\n```\n{\n  'events': [{\n    'replyToken': '00000000000000000000000000000000',\n    'type': 'message',\n    'timestamp': 1568983962754,\n    'source': {\n      'type': 'user',\n      'userId': 'Udeadbeefdaaaaefdeadbeefdeadbeef'\n    },\n    'message': {\n      'id': '100001',\n      'type': 'text',\n      'text': 'Hello, world'\n    }\n  }, {\n    'replyToken': 'ffffffffffffffffffffffffffffffff',\n    'type': 'message',\n    'timestamp': 1568983962754,\n    'source': {\n      'type': 'user',\n      'userId': 'Udeadbeeaaaaefdeadbeefdeadbeef'\n    },\n    'message': {\n      'id': '100002',\n      'type': 'sticker',\n      'packageId': '1',\n      'stickerId': '1'\n    }\n  }]\n}\n```\n\n## 結論\n\n以前剛開始接 LINE Message API 的時候都覺得他的文件不太人性，更新到現在文件內容也越來完整，讓開發者在開發的過程中不用再為了找不到文件而放棄了(我以前就是 🤣)，下一篇將會帶來如何申請一隻機器人到如何建立一個 webhook API 到 AWS 上\n\n## 參考\n\n[功能介紹】Messaging API](http://at-blog.line.me/tw/messaging_api_intro)\n[LINE message template](https://developers.line.biz/en/docs/messaging-api/message-types/)\n","slug":"Day10-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-1-介紹","published":1,"updated":"2020-06-19T14:03:58.831Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31j7000r7criiy5p8vg9","content":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><p>LINE 在 2016 年 9 月底發表了 Messaging API 功能，用戶可以透過 Messaging API 將自家的服務內容串聯到 LINE@ 上。</p>\n<p>接著在 2019/04/18 之後 LINE@ 2.0 正式上線，在 5/22 後有升級的選項並會陸續更新，升級完的官方帳號也可以申請專屬 ID、進行帳號認證。</p>\n<p>我認為比前一版本的最大的好處是在<strong>好友無上限</strong>的這部分，以前只能有 50 位好友，若一般開發者的機器人好不容易上線了並開放測試時被限制住，除了再開一隻機器人或是其他方法就超麻煩，現在好友無上限了，就不會有上述的問題了。</p>\n<blockquote>\n<p>若您以前有開發過的機器人到現在還沒升級的話，可以參考 -&gt; <a href=\"http://at-blog.line.me/tw/archives/lineat_manual_upgrade_02.html\" target=\"_blank\" rel=\"noopener\">URL</a></p>\n</blockquote>\n<p>這邊需要注意 1 on 1 聊天與 Messaging API 是無法同時使用的，但可以在後台切換看要使用哪種模式與顧客互動。對話記錄也會保存在各自的模式下，若要查看完整的對話記錄的話會建議以固定模式與顧客進行互動哦！</p>\n<h3 id=\"主要的功能環繞在以下兩點\"><a href=\"#主要的功能環繞在以下兩點\" class=\"headerlink\" title=\"主要的功能環繞在以下兩點\"></a>主要的功能環繞在以下兩點</h3><p><img src=\"https://i.imgur.com/kqf5mo5.png\" alt></p>\n<ol>\n<li><strong>Push mode:</strong> 主動推播訊息給用戶，2.0 每個機器人都有 500 則免費推播則數，超過則數的話可以參考以下的價目表：</li>\n</ol>\n<p><img src=\"https://i.imgur.com/7HJySLK.png\" alt></p>\n<ol start=\"2\">\n<li><strong>Reply mode:</strong> 這個模式是接受使用者的訊息並透過 webhook 打到伺服器上讓伺服器去做對應訊息的處理，重點是它是是免費、免費、免費的！所以若能引導使用者去輸入訊息的話用這個模式是不用錢的哦 🎉</li>\n</ol>\n<p>Message API 支援以下格式</p>\n<ul>\n<li>Text message</li>\n<li>Sticker message</li>\n<li>Image message</li>\n<li>Video message</li>\n<li>Audio message</li>\n<li>Location message</li>\n<li>Imagemap message</li>\n<li>Template message</li>\n<li>Flex message</li>\n</ul>\n<blockquote>\n<p>詳細內容可以參考 <a href=\"https://developers.line.biz/en/docs/messaging-api/message-types/\" target=\"_blank\" rel=\"noopener\">LINE doc</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/PLWylFy.png\" alt=\"line sample 1\"><br><img src=\"https://i.imgur.com/lInGVV0.png\" alt=\"line sample 2\"></p>\n<h2 id=\"回傳格式\"><a href=\"#回傳格式\" class=\"headerlink\" title=\"回傳格式\"></a>回傳格式</h2><p>Message API 回傳格式都是一個陣列的格式，一開始在接的時候都沒注意到一直瘋狂出錯，事實上這樣陣列對 Server 有個好處就是當一次需要送較多訊息時格式會比較統一，只是對於有潔癖的開發者來說每次都要多打<code>[0]</code>會覺得有點髒 🤣</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &apos;events&apos;: [&#123;</span><br><span class=\"line\">    &apos;replyToken&apos;: &apos;00000000000000000000000000000000&apos;,</span><br><span class=\"line\">    &apos;type&apos;: &apos;message&apos;,</span><br><span class=\"line\">    &apos;timestamp&apos;: 1568983962754,</span><br><span class=\"line\">    &apos;source&apos;: &#123;</span><br><span class=\"line\">      &apos;type&apos;: &apos;user&apos;,</span><br><span class=\"line\">      &apos;userId&apos;: &apos;Udeadbeefdaaaaefdeadbeefdeadbeef&apos;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &apos;message&apos;: &#123;</span><br><span class=\"line\">      &apos;id&apos;: &apos;100001&apos;,</span><br><span class=\"line\">      &apos;type&apos;: &apos;text&apos;,</span><br><span class=\"line\">      &apos;text&apos;: &apos;Hello, world&apos;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;, &#123;</span><br><span class=\"line\">    &apos;replyToken&apos;: &apos;ffffffffffffffffffffffffffffffff&apos;,</span><br><span class=\"line\">    &apos;type&apos;: &apos;message&apos;,</span><br><span class=\"line\">    &apos;timestamp&apos;: 1568983962754,</span><br><span class=\"line\">    &apos;source&apos;: &#123;</span><br><span class=\"line\">      &apos;type&apos;: &apos;user&apos;,</span><br><span class=\"line\">      &apos;userId&apos;: &apos;Udeadbeeaaaaefdeadbeefdeadbeef&apos;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &apos;message&apos;: &#123;</span><br><span class=\"line\">      &apos;id&apos;: &apos;100002&apos;,</span><br><span class=\"line\">      &apos;type&apos;: &apos;sticker&apos;,</span><br><span class=\"line\">      &apos;packageId&apos;: &apos;1&apos;,</span><br><span class=\"line\">      &apos;stickerId&apos;: &apos;1&apos;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以前剛開始接 LINE Message API 的時候都覺得他的文件不太人性，更新到現在文件內容也越來完整，讓開發者在開發的過程中不用再為了找不到文件而放棄了(我以前就是 🤣)，下一篇將會帶來如何申請一隻機器人到如何建立一個 webhook API 到 AWS 上</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"http://at-blog.line.me/tw/messaging_api_intro\" target=\"_blank\" rel=\"noopener\">功能介紹】Messaging API</a><br><a href=\"https://developers.line.biz/en/docs/messaging-api/message-types/\" target=\"_blank\" rel=\"noopener\">LINE message template</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><p>LINE 在 2016 年 9 月底發表了 Messaging API 功能，用戶可以透過 Messaging API 將自家的服務內容串聯到 LINE@ 上。</p>\n<p>接著在 2019/04/18 之後 LINE@ 2.0 正式上線，在 5/22 後有升級的選項並會陸續更新，升級完的官方帳號也可以申請專屬 ID、進行帳號認證。</p>\n<p>我認為比前一版本的最大的好處是在<strong>好友無上限</strong>的這部分，以前只能有 50 位好友，若一般開發者的機器人好不容易上線了並開放測試時被限制住，除了再開一隻機器人或是其他方法就超麻煩，現在好友無上限了，就不會有上述的問題了。</p>\n<blockquote>\n<p>若您以前有開發過的機器人到現在還沒升級的話，可以參考 -&gt; <a href=\"http://at-blog.line.me/tw/archives/lineat_manual_upgrade_02.html\" target=\"_blank\" rel=\"noopener\">URL</a></p>\n</blockquote>\n<p>這邊需要注意 1 on 1 聊天與 Messaging API 是無法同時使用的，但可以在後台切換看要使用哪種模式與顧客互動。對話記錄也會保存在各自的模式下，若要查看完整的對話記錄的話會建議以固定模式與顧客進行互動哦！</p>\n<h3 id=\"主要的功能環繞在以下兩點\"><a href=\"#主要的功能環繞在以下兩點\" class=\"headerlink\" title=\"主要的功能環繞在以下兩點\"></a>主要的功能環繞在以下兩點</h3><p><img src=\"https://i.imgur.com/kqf5mo5.png\" alt></p>\n<ol>\n<li><strong>Push mode:</strong> 主動推播訊息給用戶，2.0 每個機器人都有 500 則免費推播則數，超過則數的話可以參考以下的價目表：</li>\n</ol>\n<p><img src=\"https://i.imgur.com/7HJySLK.png\" alt></p>\n<ol start=\"2\">\n<li><strong>Reply mode:</strong> 這個模式是接受使用者的訊息並透過 webhook 打到伺服器上讓伺服器去做對應訊息的處理，重點是它是是免費、免費、免費的！所以若能引導使用者去輸入訊息的話用這個模式是不用錢的哦 🎉</li>\n</ol>\n<p>Message API 支援以下格式</p>\n<ul>\n<li>Text message</li>\n<li>Sticker message</li>\n<li>Image message</li>\n<li>Video message</li>\n<li>Audio message</li>\n<li>Location message</li>\n<li>Imagemap message</li>\n<li>Template message</li>\n<li>Flex message</li>\n</ul>\n<blockquote>\n<p>詳細內容可以參考 <a href=\"https://developers.line.biz/en/docs/messaging-api/message-types/\" target=\"_blank\" rel=\"noopener\">LINE doc</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/PLWylFy.png\" alt=\"line sample 1\"><br><img src=\"https://i.imgur.com/lInGVV0.png\" alt=\"line sample 2\"></p>\n<h2 id=\"回傳格式\"><a href=\"#回傳格式\" class=\"headerlink\" title=\"回傳格式\"></a>回傳格式</h2><p>Message API 回傳格式都是一個陣列的格式，一開始在接的時候都沒注意到一直瘋狂出錯，事實上這樣陣列對 Server 有個好處就是當一次需要送較多訊息時格式會比較統一，只是對於有潔癖的開發者來說每次都要多打<code>[0]</code>會覺得有點髒 🤣</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &apos;events&apos;: [&#123;</span><br><span class=\"line\">    &apos;replyToken&apos;: &apos;00000000000000000000000000000000&apos;,</span><br><span class=\"line\">    &apos;type&apos;: &apos;message&apos;,</span><br><span class=\"line\">    &apos;timestamp&apos;: 1568983962754,</span><br><span class=\"line\">    &apos;source&apos;: &#123;</span><br><span class=\"line\">      &apos;type&apos;: &apos;user&apos;,</span><br><span class=\"line\">      &apos;userId&apos;: &apos;Udeadbeefdaaaaefdeadbeefdeadbeef&apos;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &apos;message&apos;: &#123;</span><br><span class=\"line\">      &apos;id&apos;: &apos;100001&apos;,</span><br><span class=\"line\">      &apos;type&apos;: &apos;text&apos;,</span><br><span class=\"line\">      &apos;text&apos;: &apos;Hello, world&apos;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;, &#123;</span><br><span class=\"line\">    &apos;replyToken&apos;: &apos;ffffffffffffffffffffffffffffffff&apos;,</span><br><span class=\"line\">    &apos;type&apos;: &apos;message&apos;,</span><br><span class=\"line\">    &apos;timestamp&apos;: 1568983962754,</span><br><span class=\"line\">    &apos;source&apos;: &#123;</span><br><span class=\"line\">      &apos;type&apos;: &apos;user&apos;,</span><br><span class=\"line\">      &apos;userId&apos;: &apos;Udeadbeeaaaaefdeadbeefdeadbeef&apos;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &apos;message&apos;: &#123;</span><br><span class=\"line\">      &apos;id&apos;: &apos;100002&apos;,</span><br><span class=\"line\">      &apos;type&apos;: &apos;sticker&apos;,</span><br><span class=\"line\">      &apos;packageId&apos;: &apos;1&apos;,</span><br><span class=\"line\">      &apos;stickerId&apos;: &apos;1&apos;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以前剛開始接 LINE Message API 的時候都覺得他的文件不太人性，更新到現在文件內容也越來完整，讓開發者在開發的過程中不用再為了找不到文件而放棄了(我以前就是 🤣)，下一篇將會帶來如何申請一隻機器人到如何建立一個 webhook API 到 AWS 上</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"http://at-blog.line.me/tw/messaging_api_intro\" target=\"_blank\" rel=\"noopener\">功能介紹】Messaging API</a><br><a href=\"https://developers.line.biz/en/docs/messaging-api/message-types/\" target=\"_blank\" rel=\"noopener\">LINE message template</a></p>\n"},{"title":"Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步","abbrlink":2397270806,"date":"2019-09-25T12:38:18.000Z","_content":"\n## 前言\n\n今天會帶大家如何一步一步的建立 Message api 以及需要注意設定的地方。\n\n## 實作\n\n1. 首先先到 https://developers.line.biz/zh-hant/ ，點選右上角的大頭貼並選擇 `Add new provider`\n   ![](https://i.imgur.com/ZDumwCq.jpg)\n2. 接著在 Provider name 填上自己的想要的名稱\n   ![](https://i.imgur.com/JrSgcQO.png)\n3. 再次確認\n   ![](https://i.imgur.com/D86u1mQ.png)\n4. 選擇想要使用那種服務，這邊我們就選擇`Message API`並按下`Create Channel`\n   ![](https://i.imgur.com/8WA1uER.png)\n5. 接著就開始填寫自己的機器人(channel)所需要的資訊嚕！\n   ![](https://i.imgur.com/VQWPJtn.png)\n6. 這邊我們需要填寫的內容為\n   6.1. 大頭貼(option)\n   6.2. 名稱 App name (required)\n   6.3. 描述 app description (required)\n   6.4. 類別與子類別 Catagory (required)\n   6.5. 信箱 Email address (required)\n   6.6. 政策網址 Policy URL (option)\n   6.7. 服務條款網址 Term of use URL (option)\n\n![](https://i.imgur.com/0Wj570j.png)\n![](https://i.imgur.com/7TW5dzU.png)\n\n---\n\n7. 當填寫完之後的寫一步最後會需要勾兩個服務說明確認的選項並按下 Create\n   ![](https://i.imgur.com/VsLYgJK.png)\n8. 如此一來就看到自己百般折騰建立出來的 Message api 啦\n   ![](https://i.imgur.com/6tBdbEa.png)\n9. 滑到最下面，首先掃描 QR code 加入自己機器人的好友讓接下來好測試，接著按下圖篇右手邊的 Set message 進入調整頁面\n   ![](https://i.imgur.com/wTxU7FM.png)\n10. 進入之後到下面，將**歡迎訊息** & **自動回應** `停用`，並將 **Webhook** 打開，讓之後的串接可以透過 Webhook 打到 Serverless 上，若是前兩個回應的選項沒有關的話即使 Webhook 有啟動也會因為優先權問題被擋下來哦！\n    ![](https://i.imgur.com/gS2k9ZP.png)\n","source":"_posts/Day11-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-2-申請一步步.md","raw":"---\ntitle: Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步\ntags:\n  - LINE\n  - chatbot\n  - Message api\ncategories: 2019鐵人賽\nabbrlink: 2397270806\ndate: 2019-09-25 20:38:18\n---\n\n## 前言\n\n今天會帶大家如何一步一步的建立 Message api 以及需要注意設定的地方。\n\n## 實作\n\n1. 首先先到 https://developers.line.biz/zh-hant/ ，點選右上角的大頭貼並選擇 `Add new provider`\n   ![](https://i.imgur.com/ZDumwCq.jpg)\n2. 接著在 Provider name 填上自己的想要的名稱\n   ![](https://i.imgur.com/JrSgcQO.png)\n3. 再次確認\n   ![](https://i.imgur.com/D86u1mQ.png)\n4. 選擇想要使用那種服務，這邊我們就選擇`Message API`並按下`Create Channel`\n   ![](https://i.imgur.com/8WA1uER.png)\n5. 接著就開始填寫自己的機器人(channel)所需要的資訊嚕！\n   ![](https://i.imgur.com/VQWPJtn.png)\n6. 這邊我們需要填寫的內容為\n   6.1. 大頭貼(option)\n   6.2. 名稱 App name (required)\n   6.3. 描述 app description (required)\n   6.4. 類別與子類別 Catagory (required)\n   6.5. 信箱 Email address (required)\n   6.6. 政策網址 Policy URL (option)\n   6.7. 服務條款網址 Term of use URL (option)\n\n![](https://i.imgur.com/0Wj570j.png)\n![](https://i.imgur.com/7TW5dzU.png)\n\n---\n\n7. 當填寫完之後的寫一步最後會需要勾兩個服務說明確認的選項並按下 Create\n   ![](https://i.imgur.com/VsLYgJK.png)\n8. 如此一來就看到自己百般折騰建立出來的 Message api 啦\n   ![](https://i.imgur.com/6tBdbEa.png)\n9. 滑到最下面，首先掃描 QR code 加入自己機器人的好友讓接下來好測試，接著按下圖篇右手邊的 Set message 進入調整頁面\n   ![](https://i.imgur.com/wTxU7FM.png)\n10. 進入之後到下面，將**歡迎訊息** & **自動回應** `停用`，並將 **Webhook** 打開，讓之後的串接可以透過 Webhook 打到 Serverless 上，若是前兩個回應的選項沒有關的話即使 Webhook 有啟動也會因為優先權問題被擋下來哦！\n    ![](https://i.imgur.com/gS2k9ZP.png)\n","slug":"Day11-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-2-申請一步步","published":1,"updated":"2020-06-19T14:03:58.833Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31j9000v7crivp63kehw","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>今天會帶大家如何一步一步的建立 Message api 以及需要注意設定的地方。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><ol>\n<li>首先先到 <a href=\"https://developers.line.biz/zh-hant/\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/zh-hant/</a> ，點選右上角的大頭貼並選擇 <code>Add new provider</code><br><img src=\"https://i.imgur.com/ZDumwCq.jpg\" alt></li>\n<li>接著在 Provider name 填上自己的想要的名稱<br><img src=\"https://i.imgur.com/JrSgcQO.png\" alt></li>\n<li>再次確認<br><img src=\"https://i.imgur.com/D86u1mQ.png\" alt></li>\n<li>選擇想要使用那種服務，這邊我們就選擇<code>Message API</code>並按下<code>Create Channel</code><br><img src=\"https://i.imgur.com/8WA1uER.png\" alt></li>\n<li>接著就開始填寫自己的機器人(channel)所需要的資訊嚕！<br><img src=\"https://i.imgur.com/VQWPJtn.png\" alt></li>\n<li>這邊我們需要填寫的內容為<br>6.1. 大頭貼(option)<br>6.2. 名稱 App name (required)<br>6.3. 描述 app description (required)<br>6.4. 類別與子類別 Catagory (required)<br>6.5. 信箱 Email address (required)<br>6.6. 政策網址 Policy URL (option)<br>6.7. 服務條款網址 Term of use URL (option)</li>\n</ol>\n<p><img src=\"https://i.imgur.com/0Wj570j.png\" alt><br><img src=\"https://i.imgur.com/7TW5dzU.png\" alt></p>\n<hr>\n<ol start=\"7\">\n<li>當填寫完之後的寫一步最後會需要勾兩個服務說明確認的選項並按下 Create<br><img src=\"https://i.imgur.com/VsLYgJK.png\" alt></li>\n<li>如此一來就看到自己百般折騰建立出來的 Message api 啦<br><img src=\"https://i.imgur.com/6tBdbEa.png\" alt></li>\n<li>滑到最下面，首先掃描 QR code 加入自己機器人的好友讓接下來好測試，接著按下圖篇右手邊的 Set message 進入調整頁面<br><img src=\"https://i.imgur.com/wTxU7FM.png\" alt></li>\n<li>進入之後到下面，將<strong>歡迎訊息</strong> &amp; <strong>自動回應</strong> <code>停用</code>，並將 <strong>Webhook</strong> 打開，讓之後的串接可以透過 Webhook 打到 Serverless 上，若是前兩個回應的選項沒有關的話即使 Webhook 有啟動也會因為優先權問題被擋下來哦！<br><img src=\"https://i.imgur.com/gS2k9ZP.png\" alt></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>今天會帶大家如何一步一步的建立 Message api 以及需要注意設定的地方。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><ol>\n<li>首先先到 <a href=\"https://developers.line.biz/zh-hant/\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/zh-hant/</a> ，點選右上角的大頭貼並選擇 <code>Add new provider</code><br><img src=\"https://i.imgur.com/ZDumwCq.jpg\" alt></li>\n<li>接著在 Provider name 填上自己的想要的名稱<br><img src=\"https://i.imgur.com/JrSgcQO.png\" alt></li>\n<li>再次確認<br><img src=\"https://i.imgur.com/D86u1mQ.png\" alt></li>\n<li>選擇想要使用那種服務，這邊我們就選擇<code>Message API</code>並按下<code>Create Channel</code><br><img src=\"https://i.imgur.com/8WA1uER.png\" alt></li>\n<li>接著就開始填寫自己的機器人(channel)所需要的資訊嚕！<br><img src=\"https://i.imgur.com/VQWPJtn.png\" alt></li>\n<li>這邊我們需要填寫的內容為<br>6.1. 大頭貼(option)<br>6.2. 名稱 App name (required)<br>6.3. 描述 app description (required)<br>6.4. 類別與子類別 Catagory (required)<br>6.5. 信箱 Email address (required)<br>6.6. 政策網址 Policy URL (option)<br>6.7. 服務條款網址 Term of use URL (option)</li>\n</ol>\n<p><img src=\"https://i.imgur.com/0Wj570j.png\" alt><br><img src=\"https://i.imgur.com/7TW5dzU.png\" alt></p>\n<hr>\n<ol start=\"7\">\n<li>當填寫完之後的寫一步最後會需要勾兩個服務說明確認的選項並按下 Create<br><img src=\"https://i.imgur.com/VsLYgJK.png\" alt></li>\n<li>如此一來就看到自己百般折騰建立出來的 Message api 啦<br><img src=\"https://i.imgur.com/6tBdbEa.png\" alt></li>\n<li>滑到最下面，首先掃描 QR code 加入自己機器人的好友讓接下來好測試，接著按下圖篇右手邊的 Set message 進入調整頁面<br><img src=\"https://i.imgur.com/wTxU7FM.png\" alt></li>\n<li>進入之後到下面，將<strong>歡迎訊息</strong> &amp; <strong>自動回應</strong> <code>停用</code>，並將 <strong>Webhook</strong> 打開，讓之後的串接可以透過 Webhook 打到 Serverless 上，若是前兩個回應的選項沒有關的話即使 Webhook 有啟動也會因為優先權問題被擋下來哦！<br><img src=\"https://i.imgur.com/gS2k9ZP.png\" alt></li>\n</ol>\n"},{"title":"Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作","abbrlink":1739126467,"date":"2019-09-26T12:39:32.000Z","_content":"\n## 實作\n\n新增兩個 LINE Channel key 至 `.env`\n\n```\nLINE_CHANNEL_TOKEN=\nLINE_CHANNEL_SECRET_KEY=\n```\n\n接著加入 LINE 的 python SDK 至 requirements.txt\n\n```\nline-bot-sdk==1.12.1\n```\n\n透過 pip 安裝一下\n\n```\npip install -r requirements.txt --user\n```\n\n在 controller/ 底下新增一個 message_api_controller.py 並輸入以下程式\n\n```python\nfrom flask import Flask, request, abort\nfrom flask_restful import Resource\nimport json\nimport os\nfrom linebot import (\n    LineBotApi, WebhookHandler\n)\nfrom linebot.exceptions import (\n    InvalidSignatureError\n)\nfrom linebot.models import (\n    MessageEvent, TextMessage, TextSendMessage,\n)\n\n\nclass LineMessageApiWebhookController(Resource):\n    def post(self):\n        line_bot_api = LineBotApi(os.getenv('LINE_CHANNEL_TOKEN'))\n        handler = WebhookHandler(os.getenv('LINE_CHANNEL_SECRET_KEY'))\n\n        # get X-Line-Signature header value\n        signature = request.headers['X-Line-Signature']\n\n        body = request.get_data(as_text=True)\n        event = json.loads(body)\n        print(event)\n        try:\n            handler.handle(body, signature)\n        except InvalidSignatureError:\n            print(\n                \"Invalid signature. Please check your channel access token/channel secret.\")\n            abort(400)\n\n        token = event['events'][0]['replyToken']\n        if token == \"00000000000000000000000000000000\":\n            pass\n        else:\n            line_bot_api.reply_message(token, TextSendMessage(\n                text=event['events'][0]['message']['text']))\n        return 'OK'\n```\n\n用任何語言都會看到回傳會有 200, 'OK'...回傳的成功訊息，在內部系統的部分在處理時要考慮到回傳時間的問題，一般來說如果回傳的時間大於 1 秒的話就有可能失效，或許有些朋友有測試過大於 1 秒也可以，但最好還是於時間內回覆哦！\n\n> 以下圖片來自 https://engineering.linecorp.com/zh-hant/blog/line-device-10/\n\n![https://engineering.linecorp.com/zh-hant/blog/line-device-10/](https://i.imgur.com/nrJl2XM.png)\n\n接著在 api.py 加入下面兩段 code，新增一個`webhook`的路由\n\n```python\nfrom controller.message_api_controller import LineMessageApiWebhookController\napi.add_resource(LineMessageApiWebhookController, '/webhook')\n```\n\n這邊可以使用`sls wsgi serve` + `ngrok`去搭配做測試\n\n接著就部署啦\n\n```\nsls deploy\n```\n\n> 現在在接這種第三方的 API 時最好都使用 `https`，而使用 Serverless 的好處就是 AWS 在部署完之後會送你一個含有 SSL 的網址～\n\n把網址貼到 `webhook URL` 上並在尾端加上 `/webhook`\n![](https://i.imgur.com/uoiU96f.png)\n\n測試結果如下\n![](https://i.imgur.com/9wPNuma.png)\n\n## 結論\n\n這次整合了以前寫的 [Repo](https://github.com/louis70109/aws-line-wsgi-python)，加入了`.env`讓我在抓下來使用時也更方便，也整合成 Restful 格式讓之後有需要的人在看 code 時可以更容易理解了～\n\n專案也會持續更新，更多詳情可以 follow 我的專案 [aws-python-line-api](https://github.com/louis70109/aws-python-line-api)。\n","source":"_posts/Day12-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-3-應聲蟲實作.md","raw":"---\ntitle: Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作\ntags:\n  - LINE\n  - chatbot\n  - Message api\ncategories: 2019鐵人賽\nabbrlink: 1739126467\ndate: 2019-09-26 20:39:32\n---\n\n## 實作\n\n新增兩個 LINE Channel key 至 `.env`\n\n```\nLINE_CHANNEL_TOKEN=\nLINE_CHANNEL_SECRET_KEY=\n```\n\n接著加入 LINE 的 python SDK 至 requirements.txt\n\n```\nline-bot-sdk==1.12.1\n```\n\n透過 pip 安裝一下\n\n```\npip install -r requirements.txt --user\n```\n\n在 controller/ 底下新增一個 message_api_controller.py 並輸入以下程式\n\n```python\nfrom flask import Flask, request, abort\nfrom flask_restful import Resource\nimport json\nimport os\nfrom linebot import (\n    LineBotApi, WebhookHandler\n)\nfrom linebot.exceptions import (\n    InvalidSignatureError\n)\nfrom linebot.models import (\n    MessageEvent, TextMessage, TextSendMessage,\n)\n\n\nclass LineMessageApiWebhookController(Resource):\n    def post(self):\n        line_bot_api = LineBotApi(os.getenv('LINE_CHANNEL_TOKEN'))\n        handler = WebhookHandler(os.getenv('LINE_CHANNEL_SECRET_KEY'))\n\n        # get X-Line-Signature header value\n        signature = request.headers['X-Line-Signature']\n\n        body = request.get_data(as_text=True)\n        event = json.loads(body)\n        print(event)\n        try:\n            handler.handle(body, signature)\n        except InvalidSignatureError:\n            print(\n                \"Invalid signature. Please check your channel access token/channel secret.\")\n            abort(400)\n\n        token = event['events'][0]['replyToken']\n        if token == \"00000000000000000000000000000000\":\n            pass\n        else:\n            line_bot_api.reply_message(token, TextSendMessage(\n                text=event['events'][0]['message']['text']))\n        return 'OK'\n```\n\n用任何語言都會看到回傳會有 200, 'OK'...回傳的成功訊息，在內部系統的部分在處理時要考慮到回傳時間的問題，一般來說如果回傳的時間大於 1 秒的話就有可能失效，或許有些朋友有測試過大於 1 秒也可以，但最好還是於時間內回覆哦！\n\n> 以下圖片來自 https://engineering.linecorp.com/zh-hant/blog/line-device-10/\n\n![https://engineering.linecorp.com/zh-hant/blog/line-device-10/](https://i.imgur.com/nrJl2XM.png)\n\n接著在 api.py 加入下面兩段 code，新增一個`webhook`的路由\n\n```python\nfrom controller.message_api_controller import LineMessageApiWebhookController\napi.add_resource(LineMessageApiWebhookController, '/webhook')\n```\n\n這邊可以使用`sls wsgi serve` + `ngrok`去搭配做測試\n\n接著就部署啦\n\n```\nsls deploy\n```\n\n> 現在在接這種第三方的 API 時最好都使用 `https`，而使用 Serverless 的好處就是 AWS 在部署完之後會送你一個含有 SSL 的網址～\n\n把網址貼到 `webhook URL` 上並在尾端加上 `/webhook`\n![](https://i.imgur.com/uoiU96f.png)\n\n測試結果如下\n![](https://i.imgur.com/9wPNuma.png)\n\n## 結論\n\n這次整合了以前寫的 [Repo](https://github.com/louis70109/aws-line-wsgi-python)，加入了`.env`讓我在抓下來使用時也更方便，也整合成 Restful 格式讓之後有需要的人在看 code 時可以更容易理解了～\n\n專案也會持續更新，更多詳情可以 follow 我的專案 [aws-python-line-api](https://github.com/louis70109/aws-python-line-api)。\n","slug":"Day12-LINE-的服務都玩了，怎麼能忘了-Message-api-Bot-呢？-3-應聲蟲實作","published":1,"updated":"2020-06-19T14:03:58.837Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ja000x7cri44yh3ot8","content":"<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>新增兩個 LINE Channel key 至 <code>.env</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LINE_CHANNEL_TOKEN=</span><br><span class=\"line\">LINE_CHANNEL_SECRET_KEY=</span><br></pre></td></tr></table></figure>\n\n<p>接著加入 LINE 的 python SDK 至 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">line-bot-sdk==1.12.1</span><br></pre></td></tr></table></figure>\n\n<p>透過 pip 安裝一下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requirements.txt --user</span><br></pre></td></tr></table></figure>\n\n<p>在 controller/ 底下新增一個 message_api_controller.py 並輸入以下程式</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, request, abort</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    LineBotApi, WebhookHandler</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.exceptions <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    InvalidSignatureError</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    MessageEvent, TextMessage, TextSendMessage,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LineMessageApiWebhookController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        line_bot_api = LineBotApi(os.getenv(<span class=\"string\">'LINE_CHANNEL_TOKEN'</span>))</span><br><span class=\"line\">        handler = WebhookHandler(os.getenv(<span class=\"string\">'LINE_CHANNEL_SECRET_KEY'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># get X-Line-Signature header value</span></span><br><span class=\"line\">        signature = request.headers[<span class=\"string\">'X-Line-Signature'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        body = request.get_data(as_text=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        event = json.loads(body)</span><br><span class=\"line\">        print(event)</span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            handler.handle(body, signature)</span><br><span class=\"line\">        <span class=\"keyword\">except</span> InvalidSignatureError:</span><br><span class=\"line\">            print(</span><br><span class=\"line\">                <span class=\"string\">\"Invalid signature. Please check your channel access token/channel secret.\"</span>)</span><br><span class=\"line\">            abort(<span class=\"number\">400</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        token = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'replyToken'</span>]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> token == <span class=\"string\">\"00000000000000000000000000000000\"</span>:</span><br><span class=\"line\">            <span class=\"keyword\">pass</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            line_bot_api.reply_message(token, TextSendMessage(</span><br><span class=\"line\">                text=event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'OK'</span></span><br></pre></td></tr></table></figure>\n\n<p>用任何語言都會看到回傳會有 200, ‘OK’…回傳的成功訊息，在內部系統的部分在處理時要考慮到回傳時間的問題，一般來說如果回傳的時間大於 1 秒的話就有可能失效，或許有些朋友有測試過大於 1 秒也可以，但最好還是於時間內回覆哦！</p>\n<blockquote>\n<p>以下圖片來自 <a href=\"https://engineering.linecorp.com/zh-hant/blog/line-device-10/\" target=\"_blank\" rel=\"noopener\">https://engineering.linecorp.com/zh-hant/blog/line-device-10/</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/nrJl2XM.png\" alt=\"https://engineering.linecorp.com/zh-hant/blog/line-device-10/\"></p>\n<p>接著在 api.py 加入下面兩段 code，新增一個<code>webhook</code>的路由</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> controller.message_api_controller <span class=\"keyword\">import</span> LineMessageApiWebhookController</span><br><span class=\"line\">api.add_resource(LineMessageApiWebhookController, <span class=\"string\">'/webhook'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>這邊可以使用<code>sls wsgi serve</code> + <code>ngrok</code>去搭配做測試</p>\n<p>接著就部署啦</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>現在在接這種第三方的 API 時最好都使用 <code>https</code>，而使用 Serverless 的好處就是 AWS 在部署完之後會送你一個含有 SSL 的網址～</p>\n</blockquote>\n<p>把網址貼到 <code>webhook URL</code> 上並在尾端加上 <code>/webhook</code><br><img src=\"https://i.imgur.com/uoiU96f.png\" alt></p>\n<p>測試結果如下<br><img src=\"https://i.imgur.com/9wPNuma.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>這次整合了以前寫的 <a href=\"https://github.com/louis70109/aws-line-wsgi-python\" target=\"_blank\" rel=\"noopener\">Repo</a>，加入了<code>.env</code>讓我在抓下來使用時也更方便，也整合成 Restful 格式讓之後有需要的人在看 code 時可以更容易理解了～</p>\n<p>專案也會持續更新，更多詳情可以 follow 我的專案 <a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">aws-python-line-api</a>。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>新增兩個 LINE Channel key 至 <code>.env</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LINE_CHANNEL_TOKEN=</span><br><span class=\"line\">LINE_CHANNEL_SECRET_KEY=</span><br></pre></td></tr></table></figure>\n\n<p>接著加入 LINE 的 python SDK 至 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">line-bot-sdk==1.12.1</span><br></pre></td></tr></table></figure>\n\n<p>透過 pip 安裝一下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requirements.txt --user</span><br></pre></td></tr></table></figure>\n\n<p>在 controller/ 底下新增一個 message_api_controller.py 並輸入以下程式</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, request, abort</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    LineBotApi, WebhookHandler</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.exceptions <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    InvalidSignatureError</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    MessageEvent, TextMessage, TextSendMessage,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LineMessageApiWebhookController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        line_bot_api = LineBotApi(os.getenv(<span class=\"string\">'LINE_CHANNEL_TOKEN'</span>))</span><br><span class=\"line\">        handler = WebhookHandler(os.getenv(<span class=\"string\">'LINE_CHANNEL_SECRET_KEY'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># get X-Line-Signature header value</span></span><br><span class=\"line\">        signature = request.headers[<span class=\"string\">'X-Line-Signature'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        body = request.get_data(as_text=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        event = json.loads(body)</span><br><span class=\"line\">        print(event)</span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            handler.handle(body, signature)</span><br><span class=\"line\">        <span class=\"keyword\">except</span> InvalidSignatureError:</span><br><span class=\"line\">            print(</span><br><span class=\"line\">                <span class=\"string\">\"Invalid signature. Please check your channel access token/channel secret.\"</span>)</span><br><span class=\"line\">            abort(<span class=\"number\">400</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        token = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'replyToken'</span>]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> token == <span class=\"string\">\"00000000000000000000000000000000\"</span>:</span><br><span class=\"line\">            <span class=\"keyword\">pass</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            line_bot_api.reply_message(token, TextSendMessage(</span><br><span class=\"line\">                text=event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'OK'</span></span><br></pre></td></tr></table></figure>\n\n<p>用任何語言都會看到回傳會有 200, ‘OK’…回傳的成功訊息，在內部系統的部分在處理時要考慮到回傳時間的問題，一般來說如果回傳的時間大於 1 秒的話就有可能失效，或許有些朋友有測試過大於 1 秒也可以，但最好還是於時間內回覆哦！</p>\n<blockquote>\n<p>以下圖片來自 <a href=\"https://engineering.linecorp.com/zh-hant/blog/line-device-10/\" target=\"_blank\" rel=\"noopener\">https://engineering.linecorp.com/zh-hant/blog/line-device-10/</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/nrJl2XM.png\" alt=\"https://engineering.linecorp.com/zh-hant/blog/line-device-10/\"></p>\n<p>接著在 api.py 加入下面兩段 code，新增一個<code>webhook</code>的路由</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> controller.message_api_controller <span class=\"keyword\">import</span> LineMessageApiWebhookController</span><br><span class=\"line\">api.add_resource(LineMessageApiWebhookController, <span class=\"string\">'/webhook'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>這邊可以使用<code>sls wsgi serve</code> + <code>ngrok</code>去搭配做測試</p>\n<p>接著就部署啦</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>現在在接這種第三方的 API 時最好都使用 <code>https</code>，而使用 Serverless 的好處就是 AWS 在部署完之後會送你一個含有 SSL 的網址～</p>\n</blockquote>\n<p>把網址貼到 <code>webhook URL</code> 上並在尾端加上 <code>/webhook</code><br><img src=\"https://i.imgur.com/uoiU96f.png\" alt></p>\n<p>測試結果如下<br><img src=\"https://i.imgur.com/9wPNuma.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>這次整合了以前寫的 <a href=\"https://github.com/louis70109/aws-line-wsgi-python\" target=\"_blank\" rel=\"noopener\">Repo</a>，加入了<code>.env</code>讓我在抓下來使用時也更方便，也整合成 Restful 格式讓之後有需要的人在看 code 時可以更容易理解了～</p>\n<p>專案也會持續更新，更多詳情可以 follow 我的專案 <a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">aws-python-line-api</a>。</p>\n"},{"title":"Day13 - 試玩 python SDK","abbrlink":4205642863,"date":"2019-09-27T12:41:31.000Z","_content":"\n## 前言\n\n以前從花落落的文件中找到一個方法，像是使用 push message\n![](https://i.imgur.com/ZZVg7mI.png)\n我都會笨笨的 call API 的方法去執行功能，殊不知 SDK 早就包好了，然後邊做邊罵自己為什麼要解這些 JSON (拍桌)\n到了現在比較會看文件，才知道原來以前是自己雷自己 (捶心肝)...接下來就試玩幾個我覺得常會用到的 method 好了不廢話了，來簡單介紹一下一些常用的方法 😎\n\n## get_profile\n\n回傳使用者的個人狀態，可以透過每次的 reply 去拿到使用者的資訊，一般使用的話都話把它存下來，等之後有介接其他服務時方便使用 userId 去判斷使用者。\n\n```python\nprofile = line_bot_api.get_profile(event['events'][0]['source']['userId'])\n\ntry:\n    with Database() as db, db.connect() as conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n        cur.execute(\n            f\"INSERT INTO users(id, name, picture) VALUES ('{id}', '{name}', '{picture}')\")\nexcept:\n    pass # 這邊簡單處理相同 id 的問題(id我有設 Private key 哦！)\nstate = f\"Hello 👉 `{profile.display_name}` 👈\"\nline_bot_api.reply_message(token, [\n  TextSendMessage(text=state),\n  ImageSendMessage(original_content_url=profile.picture_url, preview_image_url=profile.picture_url)\n  ])\n```\n\n這邊搭配 `ImageSendMessage` 來幫忙發送圖片，他主要是透過 original_content_url 以及 preview_image_url 這兩個參數來幫忙轉成圖片\n\n- original 就是讓使用者看到的圖片\n- preview 在還沒載入時的樣子\n\n## push_message\n\n既然都取到使用者的 id 了，下一步就是推訊息給使用者啦!\n\n建立一個 GET 的路由在 /webhook 上，收到 query string 的 msg 的值並找到所有使用者的 id 並逐一推送訊息。\n\n```python\nline_bot_api = LineBotApi(os.getenv('LINE_CHANNEL_TOKEN'))\nhandler = WebhookHandler(os.getenv('LINE_CHANNEL_SECRET_KEY'))\n\ndef get(self):\n    msg = request.args.get('msg')\n    with Database() as db, db.connect() as conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n        cur.execute(\"SELECT * FROM users\")\n        fetch = cur.fetchall()\n    for user in fetch:\n        self.line_bot_api.push_message(\n            user['id'], TextSendMessage(text=msg))\n    return {'message': msg}, 200\n```\n\n![](https://i.imgur.com/MHfYmlZ.png)\n\n---\n\n![](https://i.imgur.com/x7fgvhY.png)\n\n## Reply Mode\n\n### LocationSendMessage\n\n這邊直接拿 SDK 的範例來用，若是有在做商家功能的機器人可以使用這個方式讓使用者接收到商家訊息～\n\n```python\nself.line_bot_api.reply_message(token, LocationSendMessage(\n    title='my location',\n    address='Tokyo',\n    latitude=35.65910807942215,\n    longitude=139.70372892916203\n))\n```\n\n### StickerSendMessage\n\n這個方法可以搭配使用，讓整個回應看起來跟真實吧！\n\n> 不知道清單能用什麼可以[參考](https://developers.line.biz/media/messaging-api/sticker_list.pdf)，\n\n```python\nself.line_bot_api.reply_message(token, StickerSendMessage(package_id='1',sticker_id='1'))\n```\n\n### Button Template\n\n```python\nbuttons_template_message = TemplateSendMessage(\n    alt_text='Buttons template',\n    template=ButtonsTemplate(\n        thumbnail_image_url=f'{picture}.jpg',\n        title='Menu',\n        text='Please select',\n        actions=[\n            PostbackAction(\n                label='postback',\n                display_text='postback text',\n                data='action=buy&itemid=1'\n            ),\n            MessageAction(\n                label='message',\n                text='message text'\n            ),\n            URIAction(\n                label='uri',\n                uri='http://example.com/'\n            )\n        ]\n    )\n)\nself.line_bot_api.reply_message(token, buttons_template_message)\n```\n\n![](https://i.imgur.com/T30NNHt.png)\n\n## 結論\n\n簡單玩了幾個 API，大概就這幾個比較常搭配著使用，用過之後才知道其實有好多 API 我都還不是很清楚用法 🤣\n而 LINE 最近更新了他們文件的功能，多了一個`Try`的按鈕提供使用者可以線上直接測 API，只是像是 push messages 這個就剛好沒有 😓，但至少有很多 API 不用通靈去測試，直接拿著 Token 在網頁上測試嚕！\n[Doc Sample](https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages)\n![](https://i.imgur.com/xfk13a3.png)\n\nCode is [here](https://github.com/louis70109/aws-python-line-api/blob/master/controller/message_api_controller.py)\n\n## 參考\n\n[LINE develop page](https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages)\n","source":"_posts/Day13-試玩-python-SDK.md","raw":"---\ntitle: Day13 - 試玩 python SDK\ntags:\n  - python\n  - LINE SDK\ncategories: 2019鐵人賽\nabbrlink: 4205642863\ndate: 2019-09-27 20:41:31\n---\n\n## 前言\n\n以前從花落落的文件中找到一個方法，像是使用 push message\n![](https://i.imgur.com/ZZVg7mI.png)\n我都會笨笨的 call API 的方法去執行功能，殊不知 SDK 早就包好了，然後邊做邊罵自己為什麼要解這些 JSON (拍桌)\n到了現在比較會看文件，才知道原來以前是自己雷自己 (捶心肝)...接下來就試玩幾個我覺得常會用到的 method 好了不廢話了，來簡單介紹一下一些常用的方法 😎\n\n## get_profile\n\n回傳使用者的個人狀態，可以透過每次的 reply 去拿到使用者的資訊，一般使用的話都話把它存下來，等之後有介接其他服務時方便使用 userId 去判斷使用者。\n\n```python\nprofile = line_bot_api.get_profile(event['events'][0]['source']['userId'])\n\ntry:\n    with Database() as db, db.connect() as conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n        cur.execute(\n            f\"INSERT INTO users(id, name, picture) VALUES ('{id}', '{name}', '{picture}')\")\nexcept:\n    pass # 這邊簡單處理相同 id 的問題(id我有設 Private key 哦！)\nstate = f\"Hello 👉 `{profile.display_name}` 👈\"\nline_bot_api.reply_message(token, [\n  TextSendMessage(text=state),\n  ImageSendMessage(original_content_url=profile.picture_url, preview_image_url=profile.picture_url)\n  ])\n```\n\n這邊搭配 `ImageSendMessage` 來幫忙發送圖片，他主要是透過 original_content_url 以及 preview_image_url 這兩個參數來幫忙轉成圖片\n\n- original 就是讓使用者看到的圖片\n- preview 在還沒載入時的樣子\n\n## push_message\n\n既然都取到使用者的 id 了，下一步就是推訊息給使用者啦!\n\n建立一個 GET 的路由在 /webhook 上，收到 query string 的 msg 的值並找到所有使用者的 id 並逐一推送訊息。\n\n```python\nline_bot_api = LineBotApi(os.getenv('LINE_CHANNEL_TOKEN'))\nhandler = WebhookHandler(os.getenv('LINE_CHANNEL_SECRET_KEY'))\n\ndef get(self):\n    msg = request.args.get('msg')\n    with Database() as db, db.connect() as conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n        cur.execute(\"SELECT * FROM users\")\n        fetch = cur.fetchall()\n    for user in fetch:\n        self.line_bot_api.push_message(\n            user['id'], TextSendMessage(text=msg))\n    return {'message': msg}, 200\n```\n\n![](https://i.imgur.com/MHfYmlZ.png)\n\n---\n\n![](https://i.imgur.com/x7fgvhY.png)\n\n## Reply Mode\n\n### LocationSendMessage\n\n這邊直接拿 SDK 的範例來用，若是有在做商家功能的機器人可以使用這個方式讓使用者接收到商家訊息～\n\n```python\nself.line_bot_api.reply_message(token, LocationSendMessage(\n    title='my location',\n    address='Tokyo',\n    latitude=35.65910807942215,\n    longitude=139.70372892916203\n))\n```\n\n### StickerSendMessage\n\n這個方法可以搭配使用，讓整個回應看起來跟真實吧！\n\n> 不知道清單能用什麼可以[參考](https://developers.line.biz/media/messaging-api/sticker_list.pdf)，\n\n```python\nself.line_bot_api.reply_message(token, StickerSendMessage(package_id='1',sticker_id='1'))\n```\n\n### Button Template\n\n```python\nbuttons_template_message = TemplateSendMessage(\n    alt_text='Buttons template',\n    template=ButtonsTemplate(\n        thumbnail_image_url=f'{picture}.jpg',\n        title='Menu',\n        text='Please select',\n        actions=[\n            PostbackAction(\n                label='postback',\n                display_text='postback text',\n                data='action=buy&itemid=1'\n            ),\n            MessageAction(\n                label='message',\n                text='message text'\n            ),\n            URIAction(\n                label='uri',\n                uri='http://example.com/'\n            )\n        ]\n    )\n)\nself.line_bot_api.reply_message(token, buttons_template_message)\n```\n\n![](https://i.imgur.com/T30NNHt.png)\n\n## 結論\n\n簡單玩了幾個 API，大概就這幾個比較常搭配著使用，用過之後才知道其實有好多 API 我都還不是很清楚用法 🤣\n而 LINE 最近更新了他們文件的功能，多了一個`Try`的按鈕提供使用者可以線上直接測 API，只是像是 push messages 這個就剛好沒有 😓，但至少有很多 API 不用通靈去測試，直接拿著 Token 在網頁上測試嚕！\n[Doc Sample](https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages)\n![](https://i.imgur.com/xfk13a3.png)\n\nCode is [here](https://github.com/louis70109/aws-python-line-api/blob/master/controller/message_api_controller.py)\n\n## 參考\n\n[LINE develop page](https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages)\n","slug":"Day13-試玩-python-SDK","published":1,"updated":"2020-06-19T14:03:58.837Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jf00107cri9rrrth4i","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>以前從花落落的文件中找到一個方法，像是使用 push message<br><img src=\"https://i.imgur.com/ZZVg7mI.png\" alt><br>我都會笨笨的 call API 的方法去執行功能，殊不知 SDK 早就包好了，然後邊做邊罵自己為什麼要解這些 JSON (拍桌)<br>到了現在比較會看文件，才知道原來以前是自己雷自己 (捶心肝)…接下來就試玩幾個我覺得常會用到的 method 好了不廢話了，來簡單介紹一下一些常用的方法 😎</p>\n<h2 id=\"get-profile\"><a href=\"#get-profile\" class=\"headerlink\" title=\"get_profile\"></a>get_profile</h2><p>回傳使用者的個人狀態，可以透過每次的 reply 去拿到使用者的資訊，一般使用的話都話把它存下來，等之後有介接其他服務時方便使用 userId 去判斷使用者。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">profile = line_bot_api.get_profile(event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'source'</span>][<span class=\"string\">'userId'</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">        cur.execute(</span><br><span class=\"line\">            <span class=\"string\">f\"INSERT INTO users(id, name, picture) VALUES ('<span class=\"subst\">&#123;id&#125;</span>', '<span class=\"subst\">&#123;name&#125;</span>', '<span class=\"subst\">&#123;picture&#125;</span>')\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">except</span>:</span><br><span class=\"line\">    <span class=\"keyword\">pass</span> <span class=\"comment\"># 這邊簡單處理相同 id 的問題(id我有設 Private key 哦！)</span></span><br><span class=\"line\">state = <span class=\"string\">f\"Hello 👉 `<span class=\"subst\">&#123;profile.display_name&#125;</span>` 👈\"</span></span><br><span class=\"line\">line_bot_api.reply_message(token, [</span><br><span class=\"line\">  TextSendMessage(text=state),</span><br><span class=\"line\">  ImageSendMessage(original_content_url=profile.picture_url, preview_image_url=profile.picture_url)</span><br><span class=\"line\">  ])</span><br></pre></td></tr></table></figure>\n\n<p>這邊搭配 <code>ImageSendMessage</code> 來幫忙發送圖片，他主要是透過 original_content_url 以及 preview_image_url 這兩個參數來幫忙轉成圖片</p>\n<ul>\n<li>original 就是讓使用者看到的圖片</li>\n<li>preview 在還沒載入時的樣子</li>\n</ul>\n<h2 id=\"push-message\"><a href=\"#push-message\" class=\"headerlink\" title=\"push_message\"></a>push_message</h2><p>既然都取到使用者的 id 了，下一步就是推訊息給使用者啦!</p>\n<p>建立一個 GET 的路由在 /webhook 上，收到 query string 的 msg 的值並找到所有使用者的 id 並逐一推送訊息。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">line_bot_api = LineBotApi(os.getenv(<span class=\"string\">'LINE_CHANNEL_TOKEN'</span>))</span><br><span class=\"line\">handler = WebhookHandler(os.getenv(<span class=\"string\">'LINE_CHANNEL_SECRET_KEY'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    msg = request.args.get(<span class=\"string\">'msg'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">        cur.execute(<span class=\"string\">\"SELECT * FROM users\"</span>)</span><br><span class=\"line\">        fetch = cur.fetchall()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">        self.line_bot_api.push_message(</span><br><span class=\"line\">            user[<span class=\"string\">'id'</span>], TextSendMessage(text=msg))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;<span class=\"string\">'message'</span>: msg&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/MHfYmlZ.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/x7fgvhY.png\" alt></p>\n<h2 id=\"Reply-Mode\"><a href=\"#Reply-Mode\" class=\"headerlink\" title=\"Reply Mode\"></a>Reply Mode</h2><h3 id=\"LocationSendMessage\"><a href=\"#LocationSendMessage\" class=\"headerlink\" title=\"LocationSendMessage\"></a>LocationSendMessage</h3><p>這邊直接拿 SDK 的範例來用，若是有在做商家功能的機器人可以使用這個方式讓使用者接收到商家訊息～</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.line_bot_api.reply_message(token, LocationSendMessage(</span><br><span class=\"line\">    title=<span class=\"string\">'my location'</span>,</span><br><span class=\"line\">    address=<span class=\"string\">'Tokyo'</span>,</span><br><span class=\"line\">    latitude=<span class=\"number\">35.65910807942215</span>,</span><br><span class=\"line\">    longitude=<span class=\"number\">139.70372892916203</span></span><br><span class=\"line\">))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"StickerSendMessage\"><a href=\"#StickerSendMessage\" class=\"headerlink\" title=\"StickerSendMessage\"></a>StickerSendMessage</h3><p>這個方法可以搭配使用，讓整個回應看起來跟真實吧！</p>\n<blockquote>\n<p>不知道清單能用什麼可以<a href=\"https://developers.line.biz/media/messaging-api/sticker_list.pdf\" target=\"_blank\" rel=\"noopener\">參考</a>，</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.line_bot_api.reply_message(token, StickerSendMessage(package_id=<span class=\"string\">'1'</span>,sticker_id=<span class=\"string\">'1'</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Button-Template\"><a href=\"#Button-Template\" class=\"headerlink\" title=\"Button Template\"></a>Button Template</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buttons_template_message = TemplateSendMessage(</span><br><span class=\"line\">    alt_text=<span class=\"string\">'Buttons template'</span>,</span><br><span class=\"line\">    template=ButtonsTemplate(</span><br><span class=\"line\">        thumbnail_image_url=<span class=\"string\">f'<span class=\"subst\">&#123;picture&#125;</span>.jpg'</span>,</span><br><span class=\"line\">        title=<span class=\"string\">'Menu'</span>,</span><br><span class=\"line\">        text=<span class=\"string\">'Please select'</span>,</span><br><span class=\"line\">        actions=[</span><br><span class=\"line\">            PostbackAction(</span><br><span class=\"line\">                label=<span class=\"string\">'postback'</span>,</span><br><span class=\"line\">                display_text=<span class=\"string\">'postback text'</span>,</span><br><span class=\"line\">                data=<span class=\"string\">'action=buy&amp;itemid=1'</span></span><br><span class=\"line\">            ),</span><br><span class=\"line\">            MessageAction(</span><br><span class=\"line\">                label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                text=<span class=\"string\">'message text'</span></span><br><span class=\"line\">            ),</span><br><span class=\"line\">            URIAction(</span><br><span class=\"line\">                label=<span class=\"string\">'uri'</span>,</span><br><span class=\"line\">                uri=<span class=\"string\">'http://example.com/'</span></span><br><span class=\"line\">            )</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    )</span><br><span class=\"line\">)</span><br><span class=\"line\">self.line_bot_api.reply_message(token, buttons_template_message)</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/T30NNHt.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>簡單玩了幾個 API，大概就這幾個比較常搭配著使用，用過之後才知道其實有好多 API 我都還不是很清楚用法 🤣<br>而 LINE 最近更新了他們文件的功能，多了一個<code>Try</code>的按鈕提供使用者可以線上直接測 API，只是像是 push messages 這個就剛好沒有 😓，但至少有很多 API 不用通靈去測試，直接拿著 Token 在網頁上測試嚕！<br><a href=\"https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages\" target=\"_blank\" rel=\"noopener\">Doc Sample</a><br><img src=\"https://i.imgur.com/xfk13a3.png\" alt></p>\n<p>Code is <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/message_api_controller.py\" target=\"_blank\" rel=\"noopener\">here</a></p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages\" target=\"_blank\" rel=\"noopener\">LINE develop page</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>以前從花落落的文件中找到一個方法，像是使用 push message<br><img src=\"https://i.imgur.com/ZZVg7mI.png\" alt><br>我都會笨笨的 call API 的方法去執行功能，殊不知 SDK 早就包好了，然後邊做邊罵自己為什麼要解這些 JSON (拍桌)<br>到了現在比較會看文件，才知道原來以前是自己雷自己 (捶心肝)…接下來就試玩幾個我覺得常會用到的 method 好了不廢話了，來簡單介紹一下一些常用的方法 😎</p>\n<h2 id=\"get-profile\"><a href=\"#get-profile\" class=\"headerlink\" title=\"get_profile\"></a>get_profile</h2><p>回傳使用者的個人狀態，可以透過每次的 reply 去拿到使用者的資訊，一般使用的話都話把它存下來，等之後有介接其他服務時方便使用 userId 去判斷使用者。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">profile = line_bot_api.get_profile(event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'source'</span>][<span class=\"string\">'userId'</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">        cur.execute(</span><br><span class=\"line\">            <span class=\"string\">f\"INSERT INTO users(id, name, picture) VALUES ('<span class=\"subst\">&#123;id&#125;</span>', '<span class=\"subst\">&#123;name&#125;</span>', '<span class=\"subst\">&#123;picture&#125;</span>')\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">except</span>:</span><br><span class=\"line\">    <span class=\"keyword\">pass</span> <span class=\"comment\"># 這邊簡單處理相同 id 的問題(id我有設 Private key 哦！)</span></span><br><span class=\"line\">state = <span class=\"string\">f\"Hello 👉 `<span class=\"subst\">&#123;profile.display_name&#125;</span>` 👈\"</span></span><br><span class=\"line\">line_bot_api.reply_message(token, [</span><br><span class=\"line\">  TextSendMessage(text=state),</span><br><span class=\"line\">  ImageSendMessage(original_content_url=profile.picture_url, preview_image_url=profile.picture_url)</span><br><span class=\"line\">  ])</span><br></pre></td></tr></table></figure>\n\n<p>這邊搭配 <code>ImageSendMessage</code> 來幫忙發送圖片，他主要是透過 original_content_url 以及 preview_image_url 這兩個參數來幫忙轉成圖片</p>\n<ul>\n<li>original 就是讓使用者看到的圖片</li>\n<li>preview 在還沒載入時的樣子</li>\n</ul>\n<h2 id=\"push-message\"><a href=\"#push-message\" class=\"headerlink\" title=\"push_message\"></a>push_message</h2><p>既然都取到使用者的 id 了，下一步就是推訊息給使用者啦!</p>\n<p>建立一個 GET 的路由在 /webhook 上，收到 query string 的 msg 的值並找到所有使用者的 id 並逐一推送訊息。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">line_bot_api = LineBotApi(os.getenv(<span class=\"string\">'LINE_CHANNEL_TOKEN'</span>))</span><br><span class=\"line\">handler = WebhookHandler(os.getenv(<span class=\"string\">'LINE_CHANNEL_SECRET_KEY'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    msg = request.args.get(<span class=\"string\">'msg'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn, conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">        cur.execute(<span class=\"string\">\"SELECT * FROM users\"</span>)</span><br><span class=\"line\">        fetch = cur.fetchall()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">        self.line_bot_api.push_message(</span><br><span class=\"line\">            user[<span class=\"string\">'id'</span>], TextSendMessage(text=msg))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;<span class=\"string\">'message'</span>: msg&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/MHfYmlZ.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/x7fgvhY.png\" alt></p>\n<h2 id=\"Reply-Mode\"><a href=\"#Reply-Mode\" class=\"headerlink\" title=\"Reply Mode\"></a>Reply Mode</h2><h3 id=\"LocationSendMessage\"><a href=\"#LocationSendMessage\" class=\"headerlink\" title=\"LocationSendMessage\"></a>LocationSendMessage</h3><p>這邊直接拿 SDK 的範例來用，若是有在做商家功能的機器人可以使用這個方式讓使用者接收到商家訊息～</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.line_bot_api.reply_message(token, LocationSendMessage(</span><br><span class=\"line\">    title=<span class=\"string\">'my location'</span>,</span><br><span class=\"line\">    address=<span class=\"string\">'Tokyo'</span>,</span><br><span class=\"line\">    latitude=<span class=\"number\">35.65910807942215</span>,</span><br><span class=\"line\">    longitude=<span class=\"number\">139.70372892916203</span></span><br><span class=\"line\">))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"StickerSendMessage\"><a href=\"#StickerSendMessage\" class=\"headerlink\" title=\"StickerSendMessage\"></a>StickerSendMessage</h3><p>這個方法可以搭配使用，讓整個回應看起來跟真實吧！</p>\n<blockquote>\n<p>不知道清單能用什麼可以<a href=\"https://developers.line.biz/media/messaging-api/sticker_list.pdf\" target=\"_blank\" rel=\"noopener\">參考</a>，</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.line_bot_api.reply_message(token, StickerSendMessage(package_id=<span class=\"string\">'1'</span>,sticker_id=<span class=\"string\">'1'</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Button-Template\"><a href=\"#Button-Template\" class=\"headerlink\" title=\"Button Template\"></a>Button Template</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buttons_template_message = TemplateSendMessage(</span><br><span class=\"line\">    alt_text=<span class=\"string\">'Buttons template'</span>,</span><br><span class=\"line\">    template=ButtonsTemplate(</span><br><span class=\"line\">        thumbnail_image_url=<span class=\"string\">f'<span class=\"subst\">&#123;picture&#125;</span>.jpg'</span>,</span><br><span class=\"line\">        title=<span class=\"string\">'Menu'</span>,</span><br><span class=\"line\">        text=<span class=\"string\">'Please select'</span>,</span><br><span class=\"line\">        actions=[</span><br><span class=\"line\">            PostbackAction(</span><br><span class=\"line\">                label=<span class=\"string\">'postback'</span>,</span><br><span class=\"line\">                display_text=<span class=\"string\">'postback text'</span>,</span><br><span class=\"line\">                data=<span class=\"string\">'action=buy&amp;itemid=1'</span></span><br><span class=\"line\">            ),</span><br><span class=\"line\">            MessageAction(</span><br><span class=\"line\">                label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                text=<span class=\"string\">'message text'</span></span><br><span class=\"line\">            ),</span><br><span class=\"line\">            URIAction(</span><br><span class=\"line\">                label=<span class=\"string\">'uri'</span>,</span><br><span class=\"line\">                uri=<span class=\"string\">'http://example.com/'</span></span><br><span class=\"line\">            )</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    )</span><br><span class=\"line\">)</span><br><span class=\"line\">self.line_bot_api.reply_message(token, buttons_template_message)</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/T30NNHt.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>簡單玩了幾個 API，大概就這幾個比較常搭配著使用，用過之後才知道其實有好多 API 我都還不是很清楚用法 🤣<br>而 LINE 最近更新了他們文件的功能，多了一個<code>Try</code>的按鈕提供使用者可以線上直接測 API，只是像是 push messages 這個就剛好沒有 😓，但至少有很多 API 不用通靈去測試，直接拿著 Token 在網頁上測試嚕！<br><a href=\"https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages\" target=\"_blank\" rel=\"noopener\">Doc Sample</a><br><img src=\"https://i.imgur.com/xfk13a3.png\" alt></p>\n<p>Code is <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/message_api_controller.py\" target=\"_blank\" rel=\"noopener\">here</a></p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://developers.line.biz/en/reference/messaging-api/?fbclid=IwAR3gExZwTJjXUudorqkIo-cHVk9yoONen7hnDlh4okntWyveLBYHXzZWJ00#get-number-of-push-messages\" target=\"_blank\" rel=\"noopener\">LINE develop page</a></p>\n"},{"title":"Day14 - LINE Richmenu 介紹","abbrlink":772162306,"date":"2019-09-28T12:42:52.000Z","_content":"\nRich menu 是一個 LINE 提供給 chatbot 的圖文選單，可以再上面設定很多各式各樣的功能，下圖為一個範例\n![](https://i.imgur.com/AkZnaWs.png)\n\n## 優點\n\n- 擁有長板 & 短板的圖片支援，讓一張圖片不再是一張圖片，機器人看起來可以更有品牌風格，根據 User 喜好、訂閱功能或是下一頁 Menu(即時切換)等等不同創意巧思，且可以客製化圖片讓機器人看起來有更不一樣的特色，也讓對話是互動並不限於對話，而圖片來讓使用者可以更直觀地去使用機器人。\n- 一個 Chatbot 可以設定 1000 組的功能選單\n- 針對不同 user ID 顯示不同功能選單\n  Rich menu 可以自己設計圖片並上傳，再透過 JSON 的樣式去設定圖片區間要進行各種用途，這邊使用 Youbike 小幫手為範例，設定很多相關的設計，並設計上下頁的選單提供像是 APP 的操作。\n  ![](https://i.imgur.com/kp3aYTWl.jpg)\n\n## 限制\n\n- 圖片格式: JPEG、PNG\n- 圖片尺寸: 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270\n- 圖片大小: 1 MB\n\n## 步驟\n\n1. 先準備一個圖片\n2. 對這個 API 下圖片每個位置要做什麼事 https://api.line.me/v2/bot/richmenu\n3. 接著上傳圖片給 LINE https://api.line.me/v2/bot/richmenu/richmenu-{id}/content\n4. 設定預設 https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}\n\n## 結論\n\n有很多的文章都有介紹過類似的功能，這邊簡介一下限制以及下篇要做的步驟～\n\n- [設計一個功能選單](https://medium.com/%E6%89%BE%E5%88%B0%E4%BC%AF%E7%89%B9-find-your-bot/line-bot%E7%B3%BB%E5%88%97-%E8%A8%AD%E8%A8%88%E4%B8%80%E5%80%8B%E5%8A%9F%E8%83%BD%E9%81%B8%E5%96%AE-ea5f1d7cde94)\n- [LINE 官方文件](https://developers.line.biz/en/docs/messaging-api/using-rich-menus/)\n\n---\n\n![](https://i.imgur.com/JlsLphHl.jpg)\n","source":"_posts/Day14-LINE-Richmenu-介紹.md","raw":"---\ntitle: Day14 - LINE Richmenu 介紹\ntags:\n  - Richmenu\n  - LINE\n  - chatbot\ncategories: 2019鐵人賽\nabbrlink: 772162306\ndate: 2019-09-28 20:42:52\n---\n\nRich menu 是一個 LINE 提供給 chatbot 的圖文選單，可以再上面設定很多各式各樣的功能，下圖為一個範例\n![](https://i.imgur.com/AkZnaWs.png)\n\n## 優點\n\n- 擁有長板 & 短板的圖片支援，讓一張圖片不再是一張圖片，機器人看起來可以更有品牌風格，根據 User 喜好、訂閱功能或是下一頁 Menu(即時切換)等等不同創意巧思，且可以客製化圖片讓機器人看起來有更不一樣的特色，也讓對話是互動並不限於對話，而圖片來讓使用者可以更直觀地去使用機器人。\n- 一個 Chatbot 可以設定 1000 組的功能選單\n- 針對不同 user ID 顯示不同功能選單\n  Rich menu 可以自己設計圖片並上傳，再透過 JSON 的樣式去設定圖片區間要進行各種用途，這邊使用 Youbike 小幫手為範例，設定很多相關的設計，並設計上下頁的選單提供像是 APP 的操作。\n  ![](https://i.imgur.com/kp3aYTWl.jpg)\n\n## 限制\n\n- 圖片格式: JPEG、PNG\n- 圖片尺寸: 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270\n- 圖片大小: 1 MB\n\n## 步驟\n\n1. 先準備一個圖片\n2. 對這個 API 下圖片每個位置要做什麼事 https://api.line.me/v2/bot/richmenu\n3. 接著上傳圖片給 LINE https://api.line.me/v2/bot/richmenu/richmenu-{id}/content\n4. 設定預設 https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}\n\n## 結論\n\n有很多的文章都有介紹過類似的功能，這邊簡介一下限制以及下篇要做的步驟～\n\n- [設計一個功能選單](https://medium.com/%E6%89%BE%E5%88%B0%E4%BC%AF%E7%89%B9-find-your-bot/line-bot%E7%B3%BB%E5%88%97-%E8%A8%AD%E8%A8%88%E4%B8%80%E5%80%8B%E5%8A%9F%E8%83%BD%E9%81%B8%E5%96%AE-ea5f1d7cde94)\n- [LINE 官方文件](https://developers.line.biz/en/docs/messaging-api/using-rich-menus/)\n\n---\n\n![](https://i.imgur.com/JlsLphHl.jpg)\n","slug":"Day14-LINE-Richmenu-介紹","published":1,"updated":"2020-06-19T14:03:58.834Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jg00127cri463vtr6d","content":"<p>Rich menu 是一個 LINE 提供給 chatbot 的圖文選單，可以再上面設定很多各式各樣的功能，下圖為一個範例<br><img src=\"https://i.imgur.com/AkZnaWs.png\" alt></p>\n<h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2><ul>\n<li>擁有長板 &amp; 短板的圖片支援，讓一張圖片不再是一張圖片，機器人看起來可以更有品牌風格，根據 User 喜好、訂閱功能或是下一頁 Menu(即時切換)等等不同創意巧思，且可以客製化圖片讓機器人看起來有更不一樣的特色，也讓對話是互動並不限於對話，而圖片來讓使用者可以更直觀地去使用機器人。</li>\n<li>一個 Chatbot 可以設定 1000 組的功能選單</li>\n<li>針對不同 user ID 顯示不同功能選單<br>Rich menu 可以自己設計圖片並上傳，再透過 JSON 的樣式去設定圖片區間要進行各種用途，這邊使用 Youbike 小幫手為範例，設定很多相關的設計，並設計上下頁的選單提供像是 APP 的操作。<br><img src=\"https://i.imgur.com/kp3aYTWl.jpg\" alt></li>\n</ul>\n<h2 id=\"限制\"><a href=\"#限制\" class=\"headerlink\" title=\"限制\"></a>限制</h2><ul>\n<li>圖片格式: JPEG、PNG</li>\n<li>圖片尺寸: 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270</li>\n<li>圖片大小: 1 MB</li>\n</ul>\n<h2 id=\"步驟\"><a href=\"#步驟\" class=\"headerlink\" title=\"步驟\"></a>步驟</h2><ol>\n<li>先準備一個圖片</li>\n<li>對這個 API 下圖片每個位置要做什麼事 <a href=\"https://api.line.me/v2/bot/richmenu\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/richmenu</a></li>\n<li>接著上傳圖片給 LINE <a href=\"https://api.line.me/v2/bot/richmenu/richmenu-{id}/content\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/richmenu/richmenu-{id}/content</a></li>\n<li>設定預設 <a href=\"https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}</a></li>\n</ol>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>有很多的文章都有介紹過類似的功能，這邊簡介一下限制以及下篇要做的步驟～</p>\n<ul>\n<li><a href=\"https://medium.com/%E6%89%BE%E5%88%B0%E4%BC%AF%E7%89%B9-find-your-bot/line-bot%E7%B3%BB%E5%88%97-%E8%A8%AD%E8%A8%88%E4%B8%80%E5%80%8B%E5%8A%9F%E8%83%BD%E9%81%B8%E5%96%AE-ea5f1d7cde94\" target=\"_blank\" rel=\"noopener\">設計一個功能選單</a></li>\n<li><a href=\"https://developers.line.biz/en/docs/messaging-api/using-rich-menus/\" target=\"_blank\" rel=\"noopener\">LINE 官方文件</a></li>\n</ul>\n<hr>\n<p><img src=\"https://i.imgur.com/JlsLphHl.jpg\" alt></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Rich menu 是一個 LINE 提供給 chatbot 的圖文選單，可以再上面設定很多各式各樣的功能，下圖為一個範例<br><img src=\"https://i.imgur.com/AkZnaWs.png\" alt></p>\n<h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2><ul>\n<li>擁有長板 &amp; 短板的圖片支援，讓一張圖片不再是一張圖片，機器人看起來可以更有品牌風格，根據 User 喜好、訂閱功能或是下一頁 Menu(即時切換)等等不同創意巧思，且可以客製化圖片讓機器人看起來有更不一樣的特色，也讓對話是互動並不限於對話，而圖片來讓使用者可以更直觀地去使用機器人。</li>\n<li>一個 Chatbot 可以設定 1000 組的功能選單</li>\n<li>針對不同 user ID 顯示不同功能選單<br>Rich menu 可以自己設計圖片並上傳，再透過 JSON 的樣式去設定圖片區間要進行各種用途，這邊使用 Youbike 小幫手為範例，設定很多相關的設計，並設計上下頁的選單提供像是 APP 的操作。<br><img src=\"https://i.imgur.com/kp3aYTWl.jpg\" alt></li>\n</ul>\n<h2 id=\"限制\"><a href=\"#限制\" class=\"headerlink\" title=\"限制\"></a>限制</h2><ul>\n<li>圖片格式: JPEG、PNG</li>\n<li>圖片尺寸: 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270</li>\n<li>圖片大小: 1 MB</li>\n</ul>\n<h2 id=\"步驟\"><a href=\"#步驟\" class=\"headerlink\" title=\"步驟\"></a>步驟</h2><ol>\n<li>先準備一個圖片</li>\n<li>對這個 API 下圖片每個位置要做什麼事 <a href=\"https://api.line.me/v2/bot/richmenu\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/richmenu</a></li>\n<li>接著上傳圖片給 LINE <a href=\"https://api.line.me/v2/bot/richmenu/richmenu-{id}/content\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/richmenu/richmenu-{id}/content</a></li>\n<li>設定預設 <a href=\"https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}\" target=\"_blank\" rel=\"noopener\">https://api.line.me/v2/bot/user/all/richmenu/richmenu-{id}</a></li>\n</ol>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>有很多的文章都有介紹過類似的功能，這邊簡介一下限制以及下篇要做的步驟～</p>\n<ul>\n<li><a href=\"https://medium.com/%E6%89%BE%E5%88%B0%E4%BC%AF%E7%89%B9-find-your-bot/line-bot%E7%B3%BB%E5%88%97-%E8%A8%AD%E8%A8%88%E4%B8%80%E5%80%8B%E5%8A%9F%E8%83%BD%E9%81%B8%E5%96%AE-ea5f1d7cde94\" target=\"_blank\" rel=\"noopener\">設計一個功能選單</a></li>\n<li><a href=\"https://developers.line.biz/en/docs/messaging-api/using-rich-menus/\" target=\"_blank\" rel=\"noopener\">LINE 官方文件</a></li>\n</ul>\n<hr>\n<p><img src=\"https://i.imgur.com/JlsLphHl.jpg\" alt></p>\n"},{"title":"Day15 - 串接 LINE Richmenu API","abbrlink":2470435375,"date":"2019-09-29T12:46:24.000Z","_content":"\n## 前言\n\n之前我在使用時都是直接在 Postman 上直接打 API，本來是打算自己刻 接 Richmenu API 的，但剛剛看到[Python SDK](https://github.com/line/line-bot-sdk-python) 很佛心的也提供 Richmenu 相關的 SDK，如此一來就不用自己包一包了。\n\n> 注意 Richmenu 圖片的方向是 由上到下、由左到右 哦！算位置記得別算錯ＸＤ\n\n## 實作\n\n### 設定座標\n\n首先先使用 `create_rich_menu(self, rich_menu, timeout=None)`告訴 LINE 說你的 Richmenu 的基本設定是什麼，格式區域什麼個別要做什麼對應的事情，\n\nCreates a rich menu. You must upload a rich menu image and link the rich menu to a user for the rich menu to be displayed. You can create up to 10 rich menus for one bot.\n\nhttps://developers.line.biz/en/reference/messaging-api/#create-rich-menu\n\n```python\nif usage == 'create':\n    rich_menu_to_create = RichMenu(\n        size=RichMenuSize(width=2500, height=843),\n        selected=False,\n        name=\"Nice richmenu\",  # display name\n        chat_bar_text=\"我是測試使用\",\n        areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n            bounds=RichMenuBounds(x=0, y=0, width=2500, height=843),\n            action=URIAction(label='Go to line.me', uri='https://line.me'))]\n    )\n    rich_menu_id = self.line_bot_api.create_rich_menu(\n        rich_menu=rich_menu_to_create)\n    print(rich_menu_id)\n    return {'id': rich_menu_id}, 200\n```\n\n## set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)\n\n上面設定完圖片裡每個座標區間要幹嘛了，接著就可以自己弄圖片或是下載官網提供的[圖片](https://developers.line.biz/media/messaging-api/rich-menu/controller-rich-menu-image-e1734c7d.jpg)\n\n### MAC 用戶的小技巧\n\n這邊教大家一個小技巧，可以點選想使用的照片，在預覽程式裡的選擇工具->調整大小\n![](https://i.imgur.com/OqsDU20.jpg)\n接著看到這畫面，把依比例縮放的勾勾取消，然後把長寬調到對應的大小後就完成圖片大小的設定嚕！\n![](https://i.imgur.com/OH1tYUl.png)\n\nhttps://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image\n\n![](https://i.imgur.com/iA2xMJd.png)\n\n```\nelif usage == 'upload':\n    file = request.files['the_file'].read()\n    rich_menu_id = request.form['richmenu_id']\n    content_type = \"image/png\"\n    try:\n        self.line_bot_api.set_rich_menu_image(\n            rich_menu_id, content_type, file)\n    except Exception as e:\n        print(\"===Upload Exception===\")\n        raise BadRequest(e)\n    return {'result': 'upload ok'}, 200\n```\n\n## set_default_rich_menu(self, rich_menu_id, timeout=None)\n\n設定完了之後要幹嘛？就是要把他設定`default`啦！\n不囉唆， show you the code.\n\n> Sets the default rich menu.\n> https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu\n\n```\nelif usage == 'set':\n    rich_menu_id = request.form['richmenu_id']\n    try:\n        self.line_bot_api.set_default_rich_menu(rich_menu_id)\n    except:\n        raise BadRequest(\"Maybe your richmenu id error.\")\n    return {'result': 'set default ok!'}, 200\n```\n\n## get_default_rich_menu(self, timeout=None)\n\n糟糕，我好像瘋狂建立卻不知道有幾組？用這個就對了！\n\n> Gets the ID of the default rich menu set with the Messaging API.\n> https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id\n\n```\nelif usage == 'get':\n    rich_menu_list = self.line_bot_api.get_rich_menu_list()\n    total = []\n    for rich_menu in rich_menu_list:\n        total.append(rich_menu.rich_menu_id)\n    return {'result': total}, 200\n```\n\n## delete_rich_menu(rich_menu_id)\n\n不行，我弄的座標什麼全錯怎麼辦？有時候上傳的圖片可能不是自己想的那樣？，透過這個方法來刪掉它\n\n> Deletes a rich menu.\n> https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu\n\n```\nelif usage == 'delete':\n    rich_menu_id = request.form['richmenu_id']\n    try:\n        self.line_bot_api.delete_rich_menu(rich_menu_id)\n    except:\n        raise BadRequest(\"Maybe your richmenu id error.\")\n    return {'result': f'{rich_menu_id} is delete!'}, 200\n```\n\n## 結論\n\n我都把 `raise` 打成 `rails` (大誤)，LINE 幫忙做的 SDK 真的是好用，透過這次練習我也多學了好多不一樣的用法，順便把自己的腦袋也整理一下 😃，程式碼同步在這邊哦 [URL](https://github.com/louis70109/aws-python-line-api/blob/master/controller/richmenu_api_controller.py)。\n","source":"_posts/Day15-串接-LINE-Richmenu-API.md","raw":"---\ntitle: Day15 - 串接 LINE Richmenu API\ntags:\n  - LINE\n  - LINE SDK\n  - Richmenu\ncategories: 2019鐵人賽\nabbrlink: 2470435375\ndate: 2019-09-29 20:46:24\n---\n\n## 前言\n\n之前我在使用時都是直接在 Postman 上直接打 API，本來是打算自己刻 接 Richmenu API 的，但剛剛看到[Python SDK](https://github.com/line/line-bot-sdk-python) 很佛心的也提供 Richmenu 相關的 SDK，如此一來就不用自己包一包了。\n\n> 注意 Richmenu 圖片的方向是 由上到下、由左到右 哦！算位置記得別算錯ＸＤ\n\n## 實作\n\n### 設定座標\n\n首先先使用 `create_rich_menu(self, rich_menu, timeout=None)`告訴 LINE 說你的 Richmenu 的基本設定是什麼，格式區域什麼個別要做什麼對應的事情，\n\nCreates a rich menu. You must upload a rich menu image and link the rich menu to a user for the rich menu to be displayed. You can create up to 10 rich menus for one bot.\n\nhttps://developers.line.biz/en/reference/messaging-api/#create-rich-menu\n\n```python\nif usage == 'create':\n    rich_menu_to_create = RichMenu(\n        size=RichMenuSize(width=2500, height=843),\n        selected=False,\n        name=\"Nice richmenu\",  # display name\n        chat_bar_text=\"我是測試使用\",\n        areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n            bounds=RichMenuBounds(x=0, y=0, width=2500, height=843),\n            action=URIAction(label='Go to line.me', uri='https://line.me'))]\n    )\n    rich_menu_id = self.line_bot_api.create_rich_menu(\n        rich_menu=rich_menu_to_create)\n    print(rich_menu_id)\n    return {'id': rich_menu_id}, 200\n```\n\n## set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)\n\n上面設定完圖片裡每個座標區間要幹嘛了，接著就可以自己弄圖片或是下載官網提供的[圖片](https://developers.line.biz/media/messaging-api/rich-menu/controller-rich-menu-image-e1734c7d.jpg)\n\n### MAC 用戶的小技巧\n\n這邊教大家一個小技巧，可以點選想使用的照片，在預覽程式裡的選擇工具->調整大小\n![](https://i.imgur.com/OqsDU20.jpg)\n接著看到這畫面，把依比例縮放的勾勾取消，然後把長寬調到對應的大小後就完成圖片大小的設定嚕！\n![](https://i.imgur.com/OH1tYUl.png)\n\nhttps://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image\n\n![](https://i.imgur.com/iA2xMJd.png)\n\n```\nelif usage == 'upload':\n    file = request.files['the_file'].read()\n    rich_menu_id = request.form['richmenu_id']\n    content_type = \"image/png\"\n    try:\n        self.line_bot_api.set_rich_menu_image(\n            rich_menu_id, content_type, file)\n    except Exception as e:\n        print(\"===Upload Exception===\")\n        raise BadRequest(e)\n    return {'result': 'upload ok'}, 200\n```\n\n## set_default_rich_menu(self, rich_menu_id, timeout=None)\n\n設定完了之後要幹嘛？就是要把他設定`default`啦！\n不囉唆， show you the code.\n\n> Sets the default rich menu.\n> https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu\n\n```\nelif usage == 'set':\n    rich_menu_id = request.form['richmenu_id']\n    try:\n        self.line_bot_api.set_default_rich_menu(rich_menu_id)\n    except:\n        raise BadRequest(\"Maybe your richmenu id error.\")\n    return {'result': 'set default ok!'}, 200\n```\n\n## get_default_rich_menu(self, timeout=None)\n\n糟糕，我好像瘋狂建立卻不知道有幾組？用這個就對了！\n\n> Gets the ID of the default rich menu set with the Messaging API.\n> https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id\n\n```\nelif usage == 'get':\n    rich_menu_list = self.line_bot_api.get_rich_menu_list()\n    total = []\n    for rich_menu in rich_menu_list:\n        total.append(rich_menu.rich_menu_id)\n    return {'result': total}, 200\n```\n\n## delete_rich_menu(rich_menu_id)\n\n不行，我弄的座標什麼全錯怎麼辦？有時候上傳的圖片可能不是自己想的那樣？，透過這個方法來刪掉它\n\n> Deletes a rich menu.\n> https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu\n\n```\nelif usage == 'delete':\n    rich_menu_id = request.form['richmenu_id']\n    try:\n        self.line_bot_api.delete_rich_menu(rich_menu_id)\n    except:\n        raise BadRequest(\"Maybe your richmenu id error.\")\n    return {'result': f'{rich_menu_id} is delete!'}, 200\n```\n\n## 結論\n\n我都把 `raise` 打成 `rails` (大誤)，LINE 幫忙做的 SDK 真的是好用，透過這次練習我也多學了好多不一樣的用法，順便把自己的腦袋也整理一下 😃，程式碼同步在這邊哦 [URL](https://github.com/louis70109/aws-python-line-api/blob/master/controller/richmenu_api_controller.py)。\n","slug":"Day15-串接-LINE-Richmenu-API","published":1,"updated":"2020-06-19T14:03:58.838Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jh00157cri1favswta","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>之前我在使用時都是直接在 Postman 上直接打 API，本來是打算自己刻 接 Richmenu API 的，但剛剛看到<a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">Python SDK</a> 很佛心的也提供 Richmenu 相關的 SDK，如此一來就不用自己包一包了。</p>\n<blockquote>\n<p>注意 Richmenu 圖片的方向是 由上到下、由左到右 哦！算位置記得別算錯ＸＤ</p>\n</blockquote>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><h3 id=\"設定座標\"><a href=\"#設定座標\" class=\"headerlink\" title=\"設定座標\"></a>設定座標</h3><p>首先先使用 <code>create_rich_menu(self, rich_menu, timeout=None)</code>告訴 LINE 說你的 Richmenu 的基本設定是什麼，格式區域什麼個別要做什麼對應的事情，</p>\n<p>Creates a rich menu. You must upload a rich menu image and link the rich menu to a user for the rich menu to be displayed. You can create up to 10 rich menus for one bot.</p>\n<p><a href=\"https://developers.line.biz/en/reference/messaging-api/#create-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#create-rich-menu</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> usage == <span class=\"string\">'create'</span>:</span><br><span class=\"line\">    rich_menu_to_create = RichMenu(</span><br><span class=\"line\">        size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">        selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">        name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">        chat_bar_text=<span class=\"string\">\"我是測試使用\"</span>,</span><br><span class=\"line\">        areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">            bounds=RichMenuBounds(x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">            action=URIAction(label=<span class=\"string\">'Go to line.me'</span>, uri=<span class=\"string\">'https://line.me'</span>))]</span><br><span class=\"line\">    )</span><br><span class=\"line\">    rich_menu_id = self.line_bot_api.create_rich_menu(</span><br><span class=\"line\">        rich_menu=rich_menu_to_create)</span><br><span class=\"line\">    print(rich_menu_id)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;<span class=\"string\">'id'</span>: rich_menu_id&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"set-rich-menu-image-self-rich-menu-id-content-type-content-timeout-None\"><a href=\"#set-rich-menu-image-self-rich-menu-id-content-type-content-timeout-None\" class=\"headerlink\" title=\"set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)\"></a>set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)</h2><p>上面設定完圖片裡每個座標區間要幹嘛了，接著就可以自己弄圖片或是下載官網提供的<a href=\"https://developers.line.biz/media/messaging-api/rich-menu/controller-rich-menu-image-e1734c7d.jpg\" target=\"_blank\" rel=\"noopener\">圖片</a></p>\n<h3 id=\"MAC-用戶的小技巧\"><a href=\"#MAC-用戶的小技巧\" class=\"headerlink\" title=\"MAC 用戶的小技巧\"></a>MAC 用戶的小技巧</h3><p>這邊教大家一個小技巧，可以點選想使用的照片，在預覽程式裡的選擇工具-&gt;調整大小<br><img src=\"https://i.imgur.com/OqsDU20.jpg\" alt><br>接著看到這畫面，把依比例縮放的勾勾取消，然後把長寬調到對應的大小後就完成圖片大小的設定嚕！<br><img src=\"https://i.imgur.com/OH1tYUl.png\" alt></p>\n<p><a href=\"https://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image</a></p>\n<p><img src=\"https://i.imgur.com/iA2xMJd.png\" alt></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;upload&apos;:</span><br><span class=\"line\">    file = request.files[&apos;the_file&apos;].read()</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    content_type = &quot;image/png&quot;</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.set_rich_menu_image(</span><br><span class=\"line\">            rich_menu_id, content_type, file)</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        print(&quot;===Upload Exception===&quot;)</span><br><span class=\"line\">        raise BadRequest(e)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: &apos;upload ok&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"set-default-rich-menu-self-rich-menu-id-timeout-None\"><a href=\"#set-default-rich-menu-self-rich-menu-id-timeout-None\" class=\"headerlink\" title=\"set_default_rich_menu(self, rich_menu_id, timeout=None)\"></a>set_default_rich_menu(self, rich_menu_id, timeout=None)</h2><p>設定完了之後要幹嘛？就是要把他設定<code>default</code>啦！<br>不囉唆， show you the code.</p>\n<blockquote>\n<p>Sets the default rich menu.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;set&apos;:</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.set_default_rich_menu(rich_menu_id)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        raise BadRequest(&quot;Maybe your richmenu id error.&quot;)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: &apos;set default ok!&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"get-default-rich-menu-self-timeout-None\"><a href=\"#get-default-rich-menu-self-timeout-None\" class=\"headerlink\" title=\"get_default_rich_menu(self, timeout=None)\"></a>get_default_rich_menu(self, timeout=None)</h2><p>糟糕，我好像瘋狂建立卻不知道有幾組？用這個就對了！</p>\n<blockquote>\n<p>Gets the ID of the default rich menu set with the Messaging API.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;get&apos;:</span><br><span class=\"line\">    rich_menu_list = self.line_bot_api.get_rich_menu_list()</span><br><span class=\"line\">    total = []</span><br><span class=\"line\">    for rich_menu in rich_menu_list:</span><br><span class=\"line\">        total.append(rich_menu.rich_menu_id)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: total&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"delete-rich-menu-rich-menu-id\"><a href=\"#delete-rich-menu-rich-menu-id\" class=\"headerlink\" title=\"delete_rich_menu(rich_menu_id)\"></a>delete_rich_menu(rich_menu_id)</h2><p>不行，我弄的座標什麼全錯怎麼辦？有時候上傳的圖片可能不是自己想的那樣？，透過這個方法來刪掉它</p>\n<blockquote>\n<p>Deletes a rich menu.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;delete&apos;:</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.delete_rich_menu(rich_menu_id)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        raise BadRequest(&quot;Maybe your richmenu id error.&quot;)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: f&apos;&#123;rich_menu_id&#125; is delete!&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>我都把 <code>raise</code> 打成 <code>rails</code> (大誤)，LINE 幫忙做的 SDK 真的是好用，透過這次練習我也多學了好多不一樣的用法，順便把自己的腦袋也整理一下 😃，程式碼同步在這邊哦 <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/richmenu_api_controller.py\" target=\"_blank\" rel=\"noopener\">URL</a>。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>之前我在使用時都是直接在 Postman 上直接打 API，本來是打算自己刻 接 Richmenu API 的，但剛剛看到<a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">Python SDK</a> 很佛心的也提供 Richmenu 相關的 SDK，如此一來就不用自己包一包了。</p>\n<blockquote>\n<p>注意 Richmenu 圖片的方向是 由上到下、由左到右 哦！算位置記得別算錯ＸＤ</p>\n</blockquote>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><h3 id=\"設定座標\"><a href=\"#設定座標\" class=\"headerlink\" title=\"設定座標\"></a>設定座標</h3><p>首先先使用 <code>create_rich_menu(self, rich_menu, timeout=None)</code>告訴 LINE 說你的 Richmenu 的基本設定是什麼，格式區域什麼個別要做什麼對應的事情，</p>\n<p>Creates a rich menu. You must upload a rich menu image and link the rich menu to a user for the rich menu to be displayed. You can create up to 10 rich menus for one bot.</p>\n<p><a href=\"https://developers.line.biz/en/reference/messaging-api/#create-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#create-rich-menu</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> usage == <span class=\"string\">'create'</span>:</span><br><span class=\"line\">    rich_menu_to_create = RichMenu(</span><br><span class=\"line\">        size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">        selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">        name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">        chat_bar_text=<span class=\"string\">\"我是測試使用\"</span>,</span><br><span class=\"line\">        areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">            bounds=RichMenuBounds(x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">            action=URIAction(label=<span class=\"string\">'Go to line.me'</span>, uri=<span class=\"string\">'https://line.me'</span>))]</span><br><span class=\"line\">    )</span><br><span class=\"line\">    rich_menu_id = self.line_bot_api.create_rich_menu(</span><br><span class=\"line\">        rich_menu=rich_menu_to_create)</span><br><span class=\"line\">    print(rich_menu_id)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;<span class=\"string\">'id'</span>: rich_menu_id&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"set-rich-menu-image-self-rich-menu-id-content-type-content-timeout-None\"><a href=\"#set-rich-menu-image-self-rich-menu-id-content-type-content-timeout-None\" class=\"headerlink\" title=\"set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)\"></a>set_rich_menu_image(self, rich_menu_id, content_type, content, timeout=None)</h2><p>上面設定完圖片裡每個座標區間要幹嘛了，接著就可以自己弄圖片或是下載官網提供的<a href=\"https://developers.line.biz/media/messaging-api/rich-menu/controller-rich-menu-image-e1734c7d.jpg\" target=\"_blank\" rel=\"noopener\">圖片</a></p>\n<h3 id=\"MAC-用戶的小技巧\"><a href=\"#MAC-用戶的小技巧\" class=\"headerlink\" title=\"MAC 用戶的小技巧\"></a>MAC 用戶的小技巧</h3><p>這邊教大家一個小技巧，可以點選想使用的照片，在預覽程式裡的選擇工具-&gt;調整大小<br><img src=\"https://i.imgur.com/OqsDU20.jpg\" alt><br>接著看到這畫面，把依比例縮放的勾勾取消，然後把長寬調到對應的大小後就完成圖片大小的設定嚕！<br><img src=\"https://i.imgur.com/OH1tYUl.png\" alt></p>\n<p><a href=\"https://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#upload-rich-menu-image</a></p>\n<p><img src=\"https://i.imgur.com/iA2xMJd.png\" alt></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;upload&apos;:</span><br><span class=\"line\">    file = request.files[&apos;the_file&apos;].read()</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    content_type = &quot;image/png&quot;</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.set_rich_menu_image(</span><br><span class=\"line\">            rich_menu_id, content_type, file)</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        print(&quot;===Upload Exception===&quot;)</span><br><span class=\"line\">        raise BadRequest(e)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: &apos;upload ok&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"set-default-rich-menu-self-rich-menu-id-timeout-None\"><a href=\"#set-default-rich-menu-self-rich-menu-id-timeout-None\" class=\"headerlink\" title=\"set_default_rich_menu(self, rich_menu_id, timeout=None)\"></a>set_default_rich_menu(self, rich_menu_id, timeout=None)</h2><p>設定完了之後要幹嘛？就是要把他設定<code>default</code>啦！<br>不囉唆， show you the code.</p>\n<blockquote>\n<p>Sets the default rich menu.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#set-default-rich-menu</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;set&apos;:</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.set_default_rich_menu(rich_menu_id)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        raise BadRequest(&quot;Maybe your richmenu id error.&quot;)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: &apos;set default ok!&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"get-default-rich-menu-self-timeout-None\"><a href=\"#get-default-rich-menu-self-timeout-None\" class=\"headerlink\" title=\"get_default_rich_menu(self, timeout=None)\"></a>get_default_rich_menu(self, timeout=None)</h2><p>糟糕，我好像瘋狂建立卻不知道有幾組？用這個就對了！</p>\n<blockquote>\n<p>Gets the ID of the default rich menu set with the Messaging API.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#get-default-rich-menu-id</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;get&apos;:</span><br><span class=\"line\">    rich_menu_list = self.line_bot_api.get_rich_menu_list()</span><br><span class=\"line\">    total = []</span><br><span class=\"line\">    for rich_menu in rich_menu_list:</span><br><span class=\"line\">        total.append(rich_menu.rich_menu_id)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: total&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"delete-rich-menu-rich-menu-id\"><a href=\"#delete-rich-menu-rich-menu-id\" class=\"headerlink\" title=\"delete_rich_menu(rich_menu_id)\"></a>delete_rich_menu(rich_menu_id)</h2><p>不行，我弄的座標什麼全錯怎麼辦？有時候上傳的圖片可能不是自己想的那樣？，透過這個方法來刪掉它</p>\n<blockquote>\n<p>Deletes a rich menu.<br><a href=\"https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu\" target=\"_blank\" rel=\"noopener\">https://developers.line.biz/en/reference/messaging-api/#delete-rich-menu</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elif usage == &apos;delete&apos;:</span><br><span class=\"line\">    rich_menu_id = request.form[&apos;richmenu_id&apos;]</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        self.line_bot_api.delete_rich_menu(rich_menu_id)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        raise BadRequest(&quot;Maybe your richmenu id error.&quot;)</span><br><span class=\"line\">    return &#123;&apos;result&apos;: f&apos;&#123;rich_menu_id&#125; is delete!&apos;&#125;, 200</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>我都把 <code>raise</code> 打成 <code>rails</code> (大誤)，LINE 幫忙做的 SDK 真的是好用，透過這次練習我也多學了好多不一樣的用法，順便把自己的腦袋也整理一下 😃，程式碼同步在這邊哦 <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/richmenu_api_controller.py\" target=\"_blank\" rel=\"noopener\">URL</a>。</p>\n"},{"title":"Day16 - 實作一個上下頁的 richmenu","abbrlink":2636963893,"date":"2019-09-30T12:47:37.000Z","_content":"\n## 前言\n\n看著很多人的機器人都有上下頁的功能就心癢癢，一直沒有實際去操作，雖然看起來好像不難，但身為一個肥宅就是只有懶，到了現在才把他實作出來(羞)，以下就帶大家來做嚕！\n\n## 事前準備\n\n首先我做了兩個超級陽春的圖片，來展示一下上下一頁的樣子(超弱)\n(1)\n![](https://i.imgur.com/Rs5jnJ8.png)\n\n---\n\n(2)\n![](https://i.imgur.com/97XG3mv.png)\n\n## 實作\n\n我把上一篇的 richmenu_api_controller.py 的 create 部分改編了一下，\n增加了讀 `state` Query string 的一個參數，用`up`&`down`來簡單判斷上傳的內容要傳什麼\n\n```python\nif usage == 'create':\n            rich_menu_to_create = None\n            if request.args.get('state') == 'up':\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是第一頁\",\n                    areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=MessageAction(\n                            label='message',\n                            text='下一頁'\n                        ))]\n                )\n            elif request.args.get('state') == 'down':\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是第二頁\",\n                    areas=[RichMenuArea(\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=MessageAction(\n                            label='message',\n                            text='上一頁'\n                        ))]\n                )\n            else:\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是測試使用\",\n                    areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=URIAction(label='Go to line.me', uri='https://line.me'))]\n                )\n            rich_menu_id = self.line_bot_api.create_rich_menu(\n                rich_menu=rich_menu_to_create)\n            print(rich_menu_id)\n            return {'id': rich_menu_id}, 200\n```\n\n接著回到 `message_api_controller.py` 把前幾篇的 reply SDK code 先註解掉，並加入以下的 code\n\n```python\nmessage = event['events'][0]['message']['text']\nif message == \"上一頁\" or message == \"下一頁\":\n    try:\n        rich_menu_id = self.line_bot_api.get_rich_menu_id_of_user(id)\n    except:\n        # link default rich menu\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-269cc28b8e8497d76c2df062b274a2ce\")\n\n    if rich_menu_id == \"richmenu-269cc28b8e8497d76c2df062b274a2ce\":\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-e31be74ad7e577b4752ab70c9c2a3fba\")\n    else:\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-269cc28b8e8497d76c2df062b274a2ce\")\nelse:\n    self.line_bot_api.reply_message(token, TextSendMessage(text=message))\n```\n\n這邊簡單判斷讀取使用者回應來進入控制的程式碼，透過`get_rich_menu_id_of_user`來抓取當前使用者的 rich menu，但因為他是會返回 Error response，所以這邊就使用`try` `except`來包\nexcept 部分就是透過`link_rich_menu_to_user`來設定當前使用者為第一張圖片的 `richmenu id`，下面的判斷式就是讓他互換成對應的 rich menu id 來換頁。\n\n> Richmenu 那邊事實上是要用 `postback`，因為要 demo 的關係我就弄成一般的文字格式，因為這個上下頁字串的理論上是不該讓使用者看到的，只要用圖片來引導使用者就好。\n\n## Demo\n\n![](https://i.imgur.com/QL3m90U.png)\n![](https://i.imgur.com/DhBRsyT.png)\n\n## 結論\n\n透過這次練習大概把 LINE SDK 玩得差不多了(`message api` & `richmenu api`)，寫到了今天真的是苦讀 LINE 的文件啊，都要以防萬一我這狗眼沒有看錯而寫出錯誤的程式碼 XD，到這打完收工，繼續期待下一篇～\n","source":"_posts/Day16-實作一個上下頁的-richmenu.md","raw":"---\ntitle: Day16 - 實作一個上下頁的 richmenu\ntags:\n  - LINE\n  - Richmenu\n  - chatbot\ncategories: 2019鐵人賽\nabbrlink: 2636963893\ndate: 2019-09-30 20:47:37\n---\n\n## 前言\n\n看著很多人的機器人都有上下頁的功能就心癢癢，一直沒有實際去操作，雖然看起來好像不難，但身為一個肥宅就是只有懶，到了現在才把他實作出來(羞)，以下就帶大家來做嚕！\n\n## 事前準備\n\n首先我做了兩個超級陽春的圖片，來展示一下上下一頁的樣子(超弱)\n(1)\n![](https://i.imgur.com/Rs5jnJ8.png)\n\n---\n\n(2)\n![](https://i.imgur.com/97XG3mv.png)\n\n## 實作\n\n我把上一篇的 richmenu_api_controller.py 的 create 部分改編了一下，\n增加了讀 `state` Query string 的一個參數，用`up`&`down`來簡單判斷上傳的內容要傳什麼\n\n```python\nif usage == 'create':\n            rich_menu_to_create = None\n            if request.args.get('state') == 'up':\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是第一頁\",\n                    areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=MessageAction(\n                            label='message',\n                            text='下一頁'\n                        ))]\n                )\n            elif request.args.get('state') == 'down':\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是第二頁\",\n                    areas=[RichMenuArea(\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=MessageAction(\n                            label='message',\n                            text='上一頁'\n                        ))]\n                )\n            else:\n                rich_menu_to_create = RichMenu(\n                    size=RichMenuSize(width=2500, height=843),\n                    selected=False,\n                    name=\"Nice richmenu\",  # display name\n                    chat_bar_text=\"我是測試使用\",\n                    areas=[RichMenuArea(  # 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能\n                        bounds=RichMenuBounds(\n                            x=0, y=0, width=2500, height=843),\n                        action=URIAction(label='Go to line.me', uri='https://line.me'))]\n                )\n            rich_menu_id = self.line_bot_api.create_rich_menu(\n                rich_menu=rich_menu_to_create)\n            print(rich_menu_id)\n            return {'id': rich_menu_id}, 200\n```\n\n接著回到 `message_api_controller.py` 把前幾篇的 reply SDK code 先註解掉，並加入以下的 code\n\n```python\nmessage = event['events'][0]['message']['text']\nif message == \"上一頁\" or message == \"下一頁\":\n    try:\n        rich_menu_id = self.line_bot_api.get_rich_menu_id_of_user(id)\n    except:\n        # link default rich menu\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-269cc28b8e8497d76c2df062b274a2ce\")\n\n    if rich_menu_id == \"richmenu-269cc28b8e8497d76c2df062b274a2ce\":\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-e31be74ad7e577b4752ab70c9c2a3fba\")\n    else:\n        self.line_bot_api.link_rich_menu_to_user(id, \"richmenu-269cc28b8e8497d76c2df062b274a2ce\")\nelse:\n    self.line_bot_api.reply_message(token, TextSendMessage(text=message))\n```\n\n這邊簡單判斷讀取使用者回應來進入控制的程式碼，透過`get_rich_menu_id_of_user`來抓取當前使用者的 rich menu，但因為他是會返回 Error response，所以這邊就使用`try` `except`來包\nexcept 部分就是透過`link_rich_menu_to_user`來設定當前使用者為第一張圖片的 `richmenu id`，下面的判斷式就是讓他互換成對應的 rich menu id 來換頁。\n\n> Richmenu 那邊事實上是要用 `postback`，因為要 demo 的關係我就弄成一般的文字格式，因為這個上下頁字串的理論上是不該讓使用者看到的，只要用圖片來引導使用者就好。\n\n## Demo\n\n![](https://i.imgur.com/QL3m90U.png)\n![](https://i.imgur.com/DhBRsyT.png)\n\n## 結論\n\n透過這次練習大概把 LINE SDK 玩得差不多了(`message api` & `richmenu api`)，寫到了今天真的是苦讀 LINE 的文件啊，都要以防萬一我這狗眼沒有看錯而寫出錯誤的程式碼 XD，到這打完收工，繼續期待下一篇～\n","slug":"Day16-實作一個上下頁的-richmenu","published":1,"updated":"2020-06-19T14:03:58.838Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ji00177cri4xz0anac","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>看著很多人的機器人都有上下頁的功能就心癢癢，一直沒有實際去操作，雖然看起來好像不難，但身為一個肥宅就是只有懶，到了現在才把他實作出來(羞)，以下就帶大家來做嚕！</p>\n<h2 id=\"事前準備\"><a href=\"#事前準備\" class=\"headerlink\" title=\"事前準備\"></a>事前準備</h2><p>首先我做了兩個超級陽春的圖片，來展示一下上下一頁的樣子(超弱)<br>(1)<br><img src=\"https://i.imgur.com/Rs5jnJ8.png\" alt></p>\n<hr>\n<p>(2)<br><img src=\"https://i.imgur.com/97XG3mv.png\" alt></p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>我把上一篇的 richmenu_api_controller.py 的 create 部分改編了一下，<br>增加了讀 <code>state</code> Query string 的一個參數，用<code>up</code>&amp;<code>down</code>來簡單判斷上傳的內容要傳什麼</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> usage == <span class=\"string\">'create'</span>:</span><br><span class=\"line\">            rich_menu_to_create = <span class=\"literal\">None</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> request.args.get(<span class=\"string\">'state'</span>) == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是第一頁\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=MessageAction(</span><br><span class=\"line\">                            label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                            text=<span class=\"string\">'下一頁'</span></span><br><span class=\"line\">                        ))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> request.args.get(<span class=\"string\">'state'</span>) == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是第二頁\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(</span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=MessageAction(</span><br><span class=\"line\">                            label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                            text=<span class=\"string\">'上一頁'</span></span><br><span class=\"line\">                        ))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是測試使用\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=URIAction(label=<span class=\"string\">'Go to line.me'</span>, uri=<span class=\"string\">'https://line.me'</span>))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            rich_menu_id = self.line_bot_api.create_rich_menu(</span><br><span class=\"line\">                rich_menu=rich_menu_to_create)</span><br><span class=\"line\">            print(rich_menu_id)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'id'</span>: rich_menu_id&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>接著回到 <code>message_api_controller.py</code> 把前幾篇的 reply SDK code 先註解掉，並加入以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">message = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> message == <span class=\"string\">\"上一頁\"</span> <span class=\"keyword\">or</span> message == <span class=\"string\">\"下一頁\"</span>:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        rich_menu_id = self.line_bot_api.get_rich_menu_id_of_user(id)</span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        <span class=\"comment\"># link default rich menu</span></span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> rich_menu_id == <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>:</span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-e31be74ad7e577b4752ab70c9c2a3fba\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    self.line_bot_api.reply_message(token, TextSendMessage(text=message))</span><br></pre></td></tr></table></figure>\n\n<p>這邊簡單判斷讀取使用者回應來進入控制的程式碼，透過<code>get_rich_menu_id_of_user</code>來抓取當前使用者的 rich menu，但因為他是會返回 Error response，所以這邊就使用<code>try</code> <code>except</code>來包<br>except 部分就是透過<code>link_rich_menu_to_user</code>來設定當前使用者為第一張圖片的 <code>richmenu id</code>，下面的判斷式就是讓他互換成對應的 rich menu id 來換頁。</p>\n<blockquote>\n<p>Richmenu 那邊事實上是要用 <code>postback</code>，因為要 demo 的關係我就弄成一般的文字格式，因為這個上下頁字串的理論上是不該讓使用者看到的，只要用圖片來引導使用者就好。</p>\n</blockquote>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p><img src=\"https://i.imgur.com/QL3m90U.png\" alt><br><img src=\"https://i.imgur.com/DhBRsyT.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>透過這次練習大概把 LINE SDK 玩得差不多了(<code>message api</code> &amp; <code>richmenu api</code>)，寫到了今天真的是苦讀 LINE 的文件啊，都要以防萬一我這狗眼沒有看錯而寫出錯誤的程式碼 XD，到這打完收工，繼續期待下一篇～</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>看著很多人的機器人都有上下頁的功能就心癢癢，一直沒有實際去操作，雖然看起來好像不難，但身為一個肥宅就是只有懶，到了現在才把他實作出來(羞)，以下就帶大家來做嚕！</p>\n<h2 id=\"事前準備\"><a href=\"#事前準備\" class=\"headerlink\" title=\"事前準備\"></a>事前準備</h2><p>首先我做了兩個超級陽春的圖片，來展示一下上下一頁的樣子(超弱)<br>(1)<br><img src=\"https://i.imgur.com/Rs5jnJ8.png\" alt></p>\n<hr>\n<p>(2)<br><img src=\"https://i.imgur.com/97XG3mv.png\" alt></p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>我把上一篇的 richmenu_api_controller.py 的 create 部分改編了一下，<br>增加了讀 <code>state</code> Query string 的一個參數，用<code>up</code>&amp;<code>down</code>來簡單判斷上傳的內容要傳什麼</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> usage == <span class=\"string\">'create'</span>:</span><br><span class=\"line\">            rich_menu_to_create = <span class=\"literal\">None</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> request.args.get(<span class=\"string\">'state'</span>) == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是第一頁\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=MessageAction(</span><br><span class=\"line\">                            label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                            text=<span class=\"string\">'下一頁'</span></span><br><span class=\"line\">                        ))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> request.args.get(<span class=\"string\">'state'</span>) == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是第二頁\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(</span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=MessageAction(</span><br><span class=\"line\">                            label=<span class=\"string\">'message'</span>,</span><br><span class=\"line\">                            text=<span class=\"string\">'上一頁'</span></span><br><span class=\"line\">                        ))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                rich_menu_to_create = RichMenu(</span><br><span class=\"line\">                    size=RichMenuSize(width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                    selected=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                    name=<span class=\"string\">\"Nice richmenu\"</span>,  <span class=\"comment\"># display name</span></span><br><span class=\"line\">                    chat_bar_text=<span class=\"string\">\"我是測試使用\"</span>,</span><br><span class=\"line\">                    areas=[RichMenuArea(  <span class=\"comment\"># 這邊是陣列的格式，可以動態設定自己要的區域想要有什麼功能</span></span><br><span class=\"line\">                        bounds=RichMenuBounds(</span><br><span class=\"line\">                            x=<span class=\"number\">0</span>, y=<span class=\"number\">0</span>, width=<span class=\"number\">2500</span>, height=<span class=\"number\">843</span>),</span><br><span class=\"line\">                        action=URIAction(label=<span class=\"string\">'Go to line.me'</span>, uri=<span class=\"string\">'https://line.me'</span>))]</span><br><span class=\"line\">                )</span><br><span class=\"line\">            rich_menu_id = self.line_bot_api.create_rich_menu(</span><br><span class=\"line\">                rich_menu=rich_menu_to_create)</span><br><span class=\"line\">            print(rich_menu_id)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'id'</span>: rich_menu_id&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>接著回到 <code>message_api_controller.py</code> 把前幾篇的 reply SDK code 先註解掉，並加入以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">message = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> message == <span class=\"string\">\"上一頁\"</span> <span class=\"keyword\">or</span> message == <span class=\"string\">\"下一頁\"</span>:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        rich_menu_id = self.line_bot_api.get_rich_menu_id_of_user(id)</span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        <span class=\"comment\"># link default rich menu</span></span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> rich_menu_id == <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>:</span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-e31be74ad7e577b4752ab70c9c2a3fba\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        self.line_bot_api.link_rich_menu_to_user(id, <span class=\"string\">\"richmenu-269cc28b8e8497d76c2df062b274a2ce\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    self.line_bot_api.reply_message(token, TextSendMessage(text=message))</span><br></pre></td></tr></table></figure>\n\n<p>這邊簡單判斷讀取使用者回應來進入控制的程式碼，透過<code>get_rich_menu_id_of_user</code>來抓取當前使用者的 rich menu，但因為他是會返回 Error response，所以這邊就使用<code>try</code> <code>except</code>來包<br>except 部分就是透過<code>link_rich_menu_to_user</code>來設定當前使用者為第一張圖片的 <code>richmenu id</code>，下面的判斷式就是讓他互換成對應的 rich menu id 來換頁。</p>\n<blockquote>\n<p>Richmenu 那邊事實上是要用 <code>postback</code>，因為要 demo 的關係我就弄成一般的文字格式，因為這個上下頁字串的理論上是不該讓使用者看到的，只要用圖片來引導使用者就好。</p>\n</blockquote>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p><img src=\"https://i.imgur.com/QL3m90U.png\" alt><br><img src=\"https://i.imgur.com/DhBRsyT.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>透過這次練習大概把 LINE SDK 玩得差不多了(<code>message api</code> &amp; <code>richmenu api</code>)，寫到了今天真的是苦讀 LINE 的文件啊，都要以防萬一我這狗眼沒有看錯而寫出錯誤的程式碼 XD，到這打完收工，繼續期待下一篇～</p>\n"},{"title":"Day17 - 看一下自己寫的東西都去哪了","abbrlink":3898416250,"date":"2019-10-01T12:49:05.000Z","_content":"\n## 前言\n\n用 Serverless 用得這麼爽，也是時候來看一下他的資源在哪，距離我上次自己手動上傳 python 檔已經是 N 個月之前的事了(遠望)，當時也沒用過什麼`Api Gateway`相關的服務，以下就帶大家來介紹一下嚕！\n\n## 介紹\n\n### CloudFormation\n\nCloudFormation 是一個 AWS 所提供的 JSON-base 服務，主要是用來讓使用者能夠快速建立 AWS 的服務。\n\n> 這邊也不用擔心設定的問題，Serverless 再 deploy 的過程中會幫忙 CloudFormation 的 json 檔\n\n![](https://i.imgur.com/mK9lYCD.png)\n透過 CloudFormation 建立 JSON-based 的 template 你可以快速建立所需要的資源堆疊（stack）。\n\n![](https://i.imgur.com/GzHh65j.jpg)\n按下`Template`後如下圖所示，他會顯示你已經有建立的服務 Map，整個線牽起來看起來就很爽 XD\n![](https://i.imgur.com/bcg1f0a.png)\n\n### Api Gateway\n\nServerless 建立過程中也會透過 CloudFormation 幫忙建立 Api Gateway，因為我們是用 `WSGI`，所以只會看到兩個`ANY`的路由。\n點進去後就可以看到 Client 是怎麼進出的，最右邊是打到 AWS Lambda 上，可以點選上面的字進入 Lambda 所在地。\n![](https://i.imgur.com/GPVXsc9.jpg)\n\n### Lambda\n\n點選進來之後可以看到 Lambda 接了什麼服務，以我到目前的程式就會有`API Gateway`、`SQS`以及預設的`CloudWatch`(都是透過這個來看 log)\n![](https://i.imgur.com/0MYquqC.png)\n接著往下會看到之前設定的`環境變數`以及`STAGE`，這些都是托`Serverless`的福免去這些麻煩的設定\n![](https://i.imgur.com/nwKK3xb.png)\n\n### S3\n\nServerless 在過程中會在 S3 幫忙建立一個 Bucket，並在後面加個 hash key 以免 bucket 重複。\n![](https://i.imgur.com/flZtoFn.png)\n\n### Cloud Watch Log\n\n在開始測試後 AWS 會幫忙在這個地方輸出 Log，\n![](https://i.imgur.com/t3Ki0gi.png)\n\n### Serverless deploy 紀錄\n\n#### 這邊使用 `Serverless deploy --verbose` 就可以看到所有部署中的基本資訊了\n\n首先因為我們有使用`.env`，所以在一開始時會先設定環境變數，接著就是把相依套件的東西都放進去，再去啟動 CloudFormation\n![](https://i.imgur.com/yMKZfAQ.png)\n\n---\n\n接著會建立一個 S3 的 Bucket，將程式透過 CloudFormation 處理成 `zip`的檔案格式並上傳到 S3 上面\n![](https://i.imgur.com/NDh2rU8.png)\n\n---\n\n接著就會部署到 `Lambda` 以及 `Api Gateway` 上，並做對應 CloudFormation JSON 檔的設定\n![](https://i.imgur.com/7D4v9qS.png)\n\n---\n\n在最後部署完之後就可以看到所有的基本資訊，物件名稱、部署階段、區域、網域以及 Function 們(因為 Lambda 是 Function-base 的服務)等等的基本資訊都會在此\n![](https://i.imgur.com/wCBixvO.png)\n\n## 結論\n\n以目前的架構基本上到這麼基本資訊都顯示出來了，若是有使用像是`Route 53`、`CloudFront`等等的服務它就會顯示在這邊了。雖然說 CloudFormation 在設定上已經很方便了，但不得不說 Serverless 真的幫忙做了很多事，讓開發者又更能專注在打 Code 上了～\n\n## 參考\n\n[使用 CloudFormation 快速部署 AWS 資源](https://medium.com/@chihsuan/cloudformation-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-aws-%E8%B3%87%E6%BA%90-d3378b096249)\n","source":"_posts/Day17-看一下自己寫的東西都去哪了.md","raw":"---\ntitle: Day17 - 看一下自己寫的東西都去哪了\ntags:\n  - Serverless\n  - CloudFormation\n  - Lambda\n  - S3\n  - API gateway\ncategories: 2019鐵人賽\nabbrlink: 3898416250\ndate: 2019-10-01 20:49:05\n---\n\n## 前言\n\n用 Serverless 用得這麼爽，也是時候來看一下他的資源在哪，距離我上次自己手動上傳 python 檔已經是 N 個月之前的事了(遠望)，當時也沒用過什麼`Api Gateway`相關的服務，以下就帶大家來介紹一下嚕！\n\n## 介紹\n\n### CloudFormation\n\nCloudFormation 是一個 AWS 所提供的 JSON-base 服務，主要是用來讓使用者能夠快速建立 AWS 的服務。\n\n> 這邊也不用擔心設定的問題，Serverless 再 deploy 的過程中會幫忙 CloudFormation 的 json 檔\n\n![](https://i.imgur.com/mK9lYCD.png)\n透過 CloudFormation 建立 JSON-based 的 template 你可以快速建立所需要的資源堆疊（stack）。\n\n![](https://i.imgur.com/GzHh65j.jpg)\n按下`Template`後如下圖所示，他會顯示你已經有建立的服務 Map，整個線牽起來看起來就很爽 XD\n![](https://i.imgur.com/bcg1f0a.png)\n\n### Api Gateway\n\nServerless 建立過程中也會透過 CloudFormation 幫忙建立 Api Gateway，因為我們是用 `WSGI`，所以只會看到兩個`ANY`的路由。\n點進去後就可以看到 Client 是怎麼進出的，最右邊是打到 AWS Lambda 上，可以點選上面的字進入 Lambda 所在地。\n![](https://i.imgur.com/GPVXsc9.jpg)\n\n### Lambda\n\n點選進來之後可以看到 Lambda 接了什麼服務，以我到目前的程式就會有`API Gateway`、`SQS`以及預設的`CloudWatch`(都是透過這個來看 log)\n![](https://i.imgur.com/0MYquqC.png)\n接著往下會看到之前設定的`環境變數`以及`STAGE`，這些都是托`Serverless`的福免去這些麻煩的設定\n![](https://i.imgur.com/nwKK3xb.png)\n\n### S3\n\nServerless 在過程中會在 S3 幫忙建立一個 Bucket，並在後面加個 hash key 以免 bucket 重複。\n![](https://i.imgur.com/flZtoFn.png)\n\n### Cloud Watch Log\n\n在開始測試後 AWS 會幫忙在這個地方輸出 Log，\n![](https://i.imgur.com/t3Ki0gi.png)\n\n### Serverless deploy 紀錄\n\n#### 這邊使用 `Serverless deploy --verbose` 就可以看到所有部署中的基本資訊了\n\n首先因為我們有使用`.env`，所以在一開始時會先設定環境變數，接著就是把相依套件的東西都放進去，再去啟動 CloudFormation\n![](https://i.imgur.com/yMKZfAQ.png)\n\n---\n\n接著會建立一個 S3 的 Bucket，將程式透過 CloudFormation 處理成 `zip`的檔案格式並上傳到 S3 上面\n![](https://i.imgur.com/NDh2rU8.png)\n\n---\n\n接著就會部署到 `Lambda` 以及 `Api Gateway` 上，並做對應 CloudFormation JSON 檔的設定\n![](https://i.imgur.com/7D4v9qS.png)\n\n---\n\n在最後部署完之後就可以看到所有的基本資訊，物件名稱、部署階段、區域、網域以及 Function 們(因為 Lambda 是 Function-base 的服務)等等的基本資訊都會在此\n![](https://i.imgur.com/wCBixvO.png)\n\n## 結論\n\n以目前的架構基本上到這麼基本資訊都顯示出來了，若是有使用像是`Route 53`、`CloudFront`等等的服務它就會顯示在這邊了。雖然說 CloudFormation 在設定上已經很方便了，但不得不說 Serverless 真的幫忙做了很多事，讓開發者又更能專注在打 Code 上了～\n\n## 參考\n\n[使用 CloudFormation 快速部署 AWS 資源](https://medium.com/@chihsuan/cloudformation-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-aws-%E8%B3%87%E6%BA%90-d3378b096249)\n","slug":"Day17-看一下自己寫的東西都去哪了","published":1,"updated":"2020-06-19T14:03:58.835Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jj00197crif5kavgbh","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>用 Serverless 用得這麼爽，也是時候來看一下他的資源在哪，距離我上次自己手動上傳 python 檔已經是 N 個月之前的事了(遠望)，當時也沒用過什麼<code>Api Gateway</code>相關的服務，以下就帶大家來介紹一下嚕！</p>\n<h2 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h2><h3 id=\"CloudFormation\"><a href=\"#CloudFormation\" class=\"headerlink\" title=\"CloudFormation\"></a>CloudFormation</h3><p>CloudFormation 是一個 AWS 所提供的 JSON-base 服務，主要是用來讓使用者能夠快速建立 AWS 的服務。</p>\n<blockquote>\n<p>這邊也不用擔心設定的問題，Serverless 再 deploy 的過程中會幫忙 CloudFormation 的 json 檔</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/mK9lYCD.png\" alt><br>透過 CloudFormation 建立 JSON-based 的 template 你可以快速建立所需要的資源堆疊（stack）。</p>\n<p><img src=\"https://i.imgur.com/GzHh65j.jpg\" alt><br>按下<code>Template</code>後如下圖所示，他會顯示你已經有建立的服務 Map，整個線牽起來看起來就很爽 XD<br><img src=\"https://i.imgur.com/bcg1f0a.png\" alt></p>\n<h3 id=\"Api-Gateway\"><a href=\"#Api-Gateway\" class=\"headerlink\" title=\"Api Gateway\"></a>Api Gateway</h3><p>Serverless 建立過程中也會透過 CloudFormation 幫忙建立 Api Gateway，因為我們是用 <code>WSGI</code>，所以只會看到兩個<code>ANY</code>的路由。<br>點進去後就可以看到 Client 是怎麼進出的，最右邊是打到 AWS Lambda 上，可以點選上面的字進入 Lambda 所在地。<br><img src=\"https://i.imgur.com/GPVXsc9.jpg\" alt></p>\n<h3 id=\"Lambda\"><a href=\"#Lambda\" class=\"headerlink\" title=\"Lambda\"></a>Lambda</h3><p>點選進來之後可以看到 Lambda 接了什麼服務，以我到目前的程式就會有<code>API Gateway</code>、<code>SQS</code>以及預設的<code>CloudWatch</code>(都是透過這個來看 log)<br><img src=\"https://i.imgur.com/0MYquqC.png\" alt><br>接著往下會看到之前設定的<code>環境變數</code>以及<code>STAGE</code>，這些都是托<code>Serverless</code>的福免去這些麻煩的設定<br><img src=\"https://i.imgur.com/nwKK3xb.png\" alt></p>\n<h3 id=\"S3\"><a href=\"#S3\" class=\"headerlink\" title=\"S3\"></a>S3</h3><p>Serverless 在過程中會在 S3 幫忙建立一個 Bucket，並在後面加個 hash key 以免 bucket 重複。<br><img src=\"https://i.imgur.com/flZtoFn.png\" alt></p>\n<h3 id=\"Cloud-Watch-Log\"><a href=\"#Cloud-Watch-Log\" class=\"headerlink\" title=\"Cloud Watch Log\"></a>Cloud Watch Log</h3><p>在開始測試後 AWS 會幫忙在這個地方輸出 Log，<br><img src=\"https://i.imgur.com/t3Ki0gi.png\" alt></p>\n<h3 id=\"Serverless-deploy-紀錄\"><a href=\"#Serverless-deploy-紀錄\" class=\"headerlink\" title=\"Serverless deploy 紀錄\"></a>Serverless deploy 紀錄</h3><h4 id=\"這邊使用-Serverless-deploy-verbose-就可以看到所有部署中的基本資訊了\"><a href=\"#這邊使用-Serverless-deploy-verbose-就可以看到所有部署中的基本資訊了\" class=\"headerlink\" title=\"這邊使用 Serverless deploy --verbose 就可以看到所有部署中的基本資訊了\"></a>這邊使用 <code>Serverless deploy --verbose</code> 就可以看到所有部署中的基本資訊了</h4><p>首先因為我們有使用<code>.env</code>，所以在一開始時會先設定環境變數，接著就是把相依套件的東西都放進去，再去啟動 CloudFormation<br><img src=\"https://i.imgur.com/yMKZfAQ.png\" alt></p>\n<hr>\n<p>接著會建立一個 S3 的 Bucket，將程式透過 CloudFormation 處理成 <code>zip</code>的檔案格式並上傳到 S3 上面<br><img src=\"https://i.imgur.com/NDh2rU8.png\" alt></p>\n<hr>\n<p>接著就會部署到 <code>Lambda</code> 以及 <code>Api Gateway</code> 上，並做對應 CloudFormation JSON 檔的設定<br><img src=\"https://i.imgur.com/7D4v9qS.png\" alt></p>\n<hr>\n<p>在最後部署完之後就可以看到所有的基本資訊，物件名稱、部署階段、區域、網域以及 Function 們(因為 Lambda 是 Function-base 的服務)等等的基本資訊都會在此<br><img src=\"https://i.imgur.com/wCBixvO.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以目前的架構基本上到這麼基本資訊都顯示出來了，若是有使用像是<code>Route 53</code>、<code>CloudFront</code>等等的服務它就會顯示在這邊了。雖然說 CloudFormation 在設定上已經很方便了，但不得不說 Serverless 真的幫忙做了很多事，讓開發者又更能專注在打 Code 上了～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://medium.com/@chihsuan/cloudformation-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-aws-%E8%B3%87%E6%BA%90-d3378b096249\" target=\"_blank\" rel=\"noopener\">使用 CloudFormation 快速部署 AWS 資源</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>用 Serverless 用得這麼爽，也是時候來看一下他的資源在哪，距離我上次自己手動上傳 python 檔已經是 N 個月之前的事了(遠望)，當時也沒用過什麼<code>Api Gateway</code>相關的服務，以下就帶大家來介紹一下嚕！</p>\n<h2 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h2><h3 id=\"CloudFormation\"><a href=\"#CloudFormation\" class=\"headerlink\" title=\"CloudFormation\"></a>CloudFormation</h3><p>CloudFormation 是一個 AWS 所提供的 JSON-base 服務，主要是用來讓使用者能夠快速建立 AWS 的服務。</p>\n<blockquote>\n<p>這邊也不用擔心設定的問題，Serverless 再 deploy 的過程中會幫忙 CloudFormation 的 json 檔</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/mK9lYCD.png\" alt><br>透過 CloudFormation 建立 JSON-based 的 template 你可以快速建立所需要的資源堆疊（stack）。</p>\n<p><img src=\"https://i.imgur.com/GzHh65j.jpg\" alt><br>按下<code>Template</code>後如下圖所示，他會顯示你已經有建立的服務 Map，整個線牽起來看起來就很爽 XD<br><img src=\"https://i.imgur.com/bcg1f0a.png\" alt></p>\n<h3 id=\"Api-Gateway\"><a href=\"#Api-Gateway\" class=\"headerlink\" title=\"Api Gateway\"></a>Api Gateway</h3><p>Serverless 建立過程中也會透過 CloudFormation 幫忙建立 Api Gateway，因為我們是用 <code>WSGI</code>，所以只會看到兩個<code>ANY</code>的路由。<br>點進去後就可以看到 Client 是怎麼進出的，最右邊是打到 AWS Lambda 上，可以點選上面的字進入 Lambda 所在地。<br><img src=\"https://i.imgur.com/GPVXsc9.jpg\" alt></p>\n<h3 id=\"Lambda\"><a href=\"#Lambda\" class=\"headerlink\" title=\"Lambda\"></a>Lambda</h3><p>點選進來之後可以看到 Lambda 接了什麼服務，以我到目前的程式就會有<code>API Gateway</code>、<code>SQS</code>以及預設的<code>CloudWatch</code>(都是透過這個來看 log)<br><img src=\"https://i.imgur.com/0MYquqC.png\" alt><br>接著往下會看到之前設定的<code>環境變數</code>以及<code>STAGE</code>，這些都是托<code>Serverless</code>的福免去這些麻煩的設定<br><img src=\"https://i.imgur.com/nwKK3xb.png\" alt></p>\n<h3 id=\"S3\"><a href=\"#S3\" class=\"headerlink\" title=\"S3\"></a>S3</h3><p>Serverless 在過程中會在 S3 幫忙建立一個 Bucket，並在後面加個 hash key 以免 bucket 重複。<br><img src=\"https://i.imgur.com/flZtoFn.png\" alt></p>\n<h3 id=\"Cloud-Watch-Log\"><a href=\"#Cloud-Watch-Log\" class=\"headerlink\" title=\"Cloud Watch Log\"></a>Cloud Watch Log</h3><p>在開始測試後 AWS 會幫忙在這個地方輸出 Log，<br><img src=\"https://i.imgur.com/t3Ki0gi.png\" alt></p>\n<h3 id=\"Serverless-deploy-紀錄\"><a href=\"#Serverless-deploy-紀錄\" class=\"headerlink\" title=\"Serverless deploy 紀錄\"></a>Serverless deploy 紀錄</h3><h4 id=\"這邊使用-Serverless-deploy-verbose-就可以看到所有部署中的基本資訊了\"><a href=\"#這邊使用-Serverless-deploy-verbose-就可以看到所有部署中的基本資訊了\" class=\"headerlink\" title=\"這邊使用 Serverless deploy --verbose 就可以看到所有部署中的基本資訊了\"></a>這邊使用 <code>Serverless deploy --verbose</code> 就可以看到所有部署中的基本資訊了</h4><p>首先因為我們有使用<code>.env</code>，所以在一開始時會先設定環境變數，接著就是把相依套件的東西都放進去，再去啟動 CloudFormation<br><img src=\"https://i.imgur.com/yMKZfAQ.png\" alt></p>\n<hr>\n<p>接著會建立一個 S3 的 Bucket，將程式透過 CloudFormation 處理成 <code>zip</code>的檔案格式並上傳到 S3 上面<br><img src=\"https://i.imgur.com/NDh2rU8.png\" alt></p>\n<hr>\n<p>接著就會部署到 <code>Lambda</code> 以及 <code>Api Gateway</code> 上，並做對應 CloudFormation JSON 檔的設定<br><img src=\"https://i.imgur.com/7D4v9qS.png\" alt></p>\n<hr>\n<p>在最後部署完之後就可以看到所有的基本資訊，物件名稱、部署階段、區域、網域以及 Function 們(因為 Lambda 是 Function-base 的服務)等等的基本資訊都會在此<br><img src=\"https://i.imgur.com/wCBixvO.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以目前的架構基本上到這麼基本資訊都顯示出來了，若是有使用像是<code>Route 53</code>、<code>CloudFront</code>等等的服務它就會顯示在這邊了。雖然說 CloudFormation 在設定上已經很方便了，但不得不說 Serverless 真的幫忙做了很多事，讓開發者又更能專注在打 Code 上了～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://medium.com/@chihsuan/cloudformation-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-aws-%E8%B3%87%E6%BA%90-d3378b096249\" target=\"_blank\" rel=\"noopener\">使用 CloudFormation 快速部署 AWS 資源</a></p>\n"},{"title":"Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧","abbrlink":4233874228,"date":"2019-10-02T12:55:35.000Z","_content":"\n## 前言\n\n過往寫了這麼多的 api，總是會有特定的功能會需要輪詢資料庫或是監聽某些事件，以前還要到弄個虛擬機寫腳本用 crontab，這時候 Lambda 的用處就來啦！不只可以處理 api 的事情，還可以設定排程做事，太舒服啦，以下就來介紹一下～\n\n## 實作\n\n首先在 `consumer` 資料夾下`line_bot_alert.py`，再寫一段需要定時跑的程式，這邊我去抓中央氣象局的資料，大概簡單判斷一下區域以及算出他的範圍：\n\n```python\nimport json\nimport requests\n\ndef alert_handler(event, context):\n    air = requests.get(\n        'http://opendata.epa.gov.tw/webapi/Data/REWIQA/?$orderby=SiteName&$skip=0&$top=1000&format=json')\n    air_body = json.loads(air.text)\n    air_status = [\"良好\",\t\"普通\",\t\"對敏感族群不健康\",\t\"對所有族群不健康\",\t\"非常不健康\",\t\"危害\", \"資料有誤\"]\n    total, count = 0, 0\n    for fetch in air_body:\n        if (fetch['County'] == \"臺中市\" and (fetch['SiteName'] == \"西屯\" or fetch['SiteName'] == \"沙鹿\")):\n            count += 1\n            if fetch['AQI'] != 0:\n                total = total + int(fetch['AQI'])\n    switch = 0\n    pm = int(total / count)\n    print(pm)\n    if pm in range(0, 50):\n        switch = 0\n    elif pm in range(51, 100):\n        switch = 1\n    elif pm in range(101, 150):\n        switch = 2\n    elif pm in range(151, 200):\n        switch = 3\n    elif pm in range(201, 250):\n        switch = 4\n    elif pm in range(251, 300):\n        switch = 5\n    else:\n        switch = 6\n    payload = f\"\\n空氣品質: {air_status[switch]}\"\n    r = requests.post('https://1uv2o723o4.execute-api.us-east-1.amazonaws.com/dev/notify/sqs',\n                      data={'message': payload})\n    print(r)\n```\n\n在`serverless.yml`的 function 下面加入 Lambda，handler 就是 `資料夾/檔案.類別`，設定事件(event)排程一分鐘一次\n\n```yaml\nfunction:\n  line_bot_alert:\n    handler: consumer/line_bot_alert_handler.alert_handler\n    events:\n      - schedule: rate(1 minute)\n```\n\n> AWS Lambda 有兩種設定排程的方法，`rate`以及`cron`，若是比較固定時建議用`rate`，比較複雜的排程就可以讓`cron`來，下面兩張圖分別是來自 [AWS](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html) > ![](https://i.imgur.com/r9ZaBhO.png)\n\n---\n\n![](https://i.imgur.com/BLrbUPP.png)\n\n下`sls deploy`部署之後就會看到剛剛做`line_bot_alert`的`function`，他每分鐘都在跑，若玩完之後不想用了可以下`sls remove`把上面有的東西刪掉嚕！\n![](https://i.imgur.com/0tpDSdf.png)\n\n## 結論\n\n其實還有很多應用可以實作排程，像是有朋友就用 GCP 的來定時發文 🤣，而且可以把腳本寫得像是 api 一樣，讓整個靈活性都增加了不少，下一篇就帶大家來做 LINE Login 嚕！\n\n## 參考\n\n[AWS document](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html)\n","source":"_posts/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧.md","raw":"---\ntitle: Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧\ntags:\n  - Serverless\n  - Lambda\n  - LINE\n  - Schedule\ncategories: 2019鐵人賽\nabbrlink: 4233874228\ndate: 2019-10-02 20:55:35\n---\n\n## 前言\n\n過往寫了這麼多的 api，總是會有特定的功能會需要輪詢資料庫或是監聽某些事件，以前還要到弄個虛擬機寫腳本用 crontab，這時候 Lambda 的用處就來啦！不只可以處理 api 的事情，還可以設定排程做事，太舒服啦，以下就來介紹一下～\n\n## 實作\n\n首先在 `consumer` 資料夾下`line_bot_alert.py`，再寫一段需要定時跑的程式，這邊我去抓中央氣象局的資料，大概簡單判斷一下區域以及算出他的範圍：\n\n```python\nimport json\nimport requests\n\ndef alert_handler(event, context):\n    air = requests.get(\n        'http://opendata.epa.gov.tw/webapi/Data/REWIQA/?$orderby=SiteName&$skip=0&$top=1000&format=json')\n    air_body = json.loads(air.text)\n    air_status = [\"良好\",\t\"普通\",\t\"對敏感族群不健康\",\t\"對所有族群不健康\",\t\"非常不健康\",\t\"危害\", \"資料有誤\"]\n    total, count = 0, 0\n    for fetch in air_body:\n        if (fetch['County'] == \"臺中市\" and (fetch['SiteName'] == \"西屯\" or fetch['SiteName'] == \"沙鹿\")):\n            count += 1\n            if fetch['AQI'] != 0:\n                total = total + int(fetch['AQI'])\n    switch = 0\n    pm = int(total / count)\n    print(pm)\n    if pm in range(0, 50):\n        switch = 0\n    elif pm in range(51, 100):\n        switch = 1\n    elif pm in range(101, 150):\n        switch = 2\n    elif pm in range(151, 200):\n        switch = 3\n    elif pm in range(201, 250):\n        switch = 4\n    elif pm in range(251, 300):\n        switch = 5\n    else:\n        switch = 6\n    payload = f\"\\n空氣品質: {air_status[switch]}\"\n    r = requests.post('https://1uv2o723o4.execute-api.us-east-1.amazonaws.com/dev/notify/sqs',\n                      data={'message': payload})\n    print(r)\n```\n\n在`serverless.yml`的 function 下面加入 Lambda，handler 就是 `資料夾/檔案.類別`，設定事件(event)排程一分鐘一次\n\n```yaml\nfunction:\n  line_bot_alert:\n    handler: consumer/line_bot_alert_handler.alert_handler\n    events:\n      - schedule: rate(1 minute)\n```\n\n> AWS Lambda 有兩種設定排程的方法，`rate`以及`cron`，若是比較固定時建議用`rate`，比較複雜的排程就可以讓`cron`來，下面兩張圖分別是來自 [AWS](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html) > ![](https://i.imgur.com/r9ZaBhO.png)\n\n---\n\n![](https://i.imgur.com/BLrbUPP.png)\n\n下`sls deploy`部署之後就會看到剛剛做`line_bot_alert`的`function`，他每分鐘都在跑，若玩完之後不想用了可以下`sls remove`把上面有的東西刪掉嚕！\n![](https://i.imgur.com/0tpDSdf.png)\n\n## 結論\n\n其實還有很多應用可以實作排程，像是有朋友就用 GCP 的來定時發文 🤣，而且可以把腳本寫得像是 api 一樣，讓整個靈活性都增加了不少，下一篇就帶大家來做 LINE Login 嚕！\n\n## 參考\n\n[AWS document](https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html)\n","slug":"Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧","published":1,"updated":"2020-06-19T14:03:58.836Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jk001b7cric1qhjuu1","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>過往寫了這麼多的 api，總是會有特定的功能會需要輪詢資料庫或是監聽某些事件，以前還要到弄個虛擬機寫腳本用 crontab，這時候 Lambda 的用處就來啦！不只可以處理 api 的事情，還可以設定排程做事，太舒服啦，以下就來介紹一下～</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>首先在 <code>consumer</code> 資料夾下<code>line_bot_alert.py</code>，再寫一段需要定時跑的程式，這邊我去抓中央氣象局的資料，大概簡單判斷一下區域以及算出他的範圍：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">alert_handler</span><span class=\"params\">(event, context)</span>:</span></span><br><span class=\"line\">    air = requests.get(</span><br><span class=\"line\">        <span class=\"string\">'http://opendata.epa.gov.tw/webapi/Data/REWIQA/?$orderby=SiteName&amp;$skip=0&amp;$top=1000&amp;format=json'</span>)</span><br><span class=\"line\">    air_body = json.loads(air.text)</span><br><span class=\"line\">    air_status = [<span class=\"string\">\"良好\"</span>,\t<span class=\"string\">\"普通\"</span>,\t<span class=\"string\">\"對敏感族群不健康\"</span>,\t<span class=\"string\">\"對所有族群不健康\"</span>,\t<span class=\"string\">\"非常不健康\"</span>,\t<span class=\"string\">\"危害\"</span>, <span class=\"string\">\"資料有誤\"</span>]</span><br><span class=\"line\">    total, count = <span class=\"number\">0</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> fetch <span class=\"keyword\">in</span> air_body:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fetch[<span class=\"string\">'County'</span>] == <span class=\"string\">\"臺中市\"</span> <span class=\"keyword\">and</span> (fetch[<span class=\"string\">'SiteName'</span>] == <span class=\"string\">\"西屯\"</span> <span class=\"keyword\">or</span> fetch[<span class=\"string\">'SiteName'</span>] == <span class=\"string\">\"沙鹿\"</span>)):</span><br><span class=\"line\">            count += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> fetch[<span class=\"string\">'AQI'</span>] != <span class=\"number\">0</span>:</span><br><span class=\"line\">                total = total + int(fetch[<span class=\"string\">'AQI'</span>])</span><br><span class=\"line\">    switch = <span class=\"number\">0</span></span><br><span class=\"line\">    pm = int(total / count)</span><br><span class=\"line\">    print(pm)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">50</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">51</span>, <span class=\"number\">100</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">101</span>, <span class=\"number\">150</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">151</span>, <span class=\"number\">200</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">3</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">201</span>, <span class=\"number\">250</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">4</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">251</span>, <span class=\"number\">300</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">5</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        switch = <span class=\"number\">6</span></span><br><span class=\"line\">    payload = <span class=\"string\">f\"\\n空氣品質: <span class=\"subst\">&#123;air_status[switch]&#125;</span>\"</span></span><br><span class=\"line\">    r = requests.post(<span class=\"string\">'https://1uv2o723o4.execute-api.us-east-1.amazonaws.com/dev/notify/sqs'</span>,</span><br><span class=\"line\">                      data=&#123;<span class=\"string\">'message'</span>: payload&#125;)</span><br><span class=\"line\">    print(r)</span><br></pre></td></tr></table></figure>\n\n<p>在<code>serverless.yml</code>的 function 下面加入 Lambda，handler 就是 <code>資料夾/檔案.類別</code>，設定事件(event)排程一分鐘一次</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">function:</span></span><br><span class=\"line\"><span class=\"attr\">  line_bot_alert:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">consumer/line_bot_alert_handler.alert_handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - schedule:</span> <span class=\"string\">rate(1</span> <span class=\"string\">minute)</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>AWS Lambda 有兩種設定排程的方法，<code>rate</code>以及<code>cron</code>，若是比較固定時建議用<code>rate</code>，比較複雜的排程就可以讓<code>cron</code>來，下面兩張圖分別是來自 <a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html\" target=\"_blank\" rel=\"noopener\">AWS</a> &gt; <img src=\"https://i.imgur.com/r9ZaBhO.png\" alt></p>\n</blockquote>\n<hr>\n<p><img src=\"https://i.imgur.com/BLrbUPP.png\" alt></p>\n<p>下<code>sls deploy</code>部署之後就會看到剛剛做<code>line_bot_alert</code>的<code>function</code>，他每分鐘都在跑，若玩完之後不想用了可以下<code>sls remove</code>把上面有的東西刪掉嚕！<br><img src=\"https://i.imgur.com/0tpDSdf.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>其實還有很多應用可以實作排程，像是有朋友就用 GCP 的來定時發文 🤣，而且可以把腳本寫得像是 api 一樣，讓整個靈活性都增加了不少，下一篇就帶大家來做 LINE Login 嚕！</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html\" target=\"_blank\" rel=\"noopener\">AWS document</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>過往寫了這麼多的 api，總是會有特定的功能會需要輪詢資料庫或是監聽某些事件，以前還要到弄個虛擬機寫腳本用 crontab，這時候 Lambda 的用處就來啦！不只可以處理 api 的事情，還可以設定排程做事，太舒服啦，以下就來介紹一下～</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>首先在 <code>consumer</code> 資料夾下<code>line_bot_alert.py</code>，再寫一段需要定時跑的程式，這邊我去抓中央氣象局的資料，大概簡單判斷一下區域以及算出他的範圍：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">alert_handler</span><span class=\"params\">(event, context)</span>:</span></span><br><span class=\"line\">    air = requests.get(</span><br><span class=\"line\">        <span class=\"string\">'http://opendata.epa.gov.tw/webapi/Data/REWIQA/?$orderby=SiteName&amp;$skip=0&amp;$top=1000&amp;format=json'</span>)</span><br><span class=\"line\">    air_body = json.loads(air.text)</span><br><span class=\"line\">    air_status = [<span class=\"string\">\"良好\"</span>,\t<span class=\"string\">\"普通\"</span>,\t<span class=\"string\">\"對敏感族群不健康\"</span>,\t<span class=\"string\">\"對所有族群不健康\"</span>,\t<span class=\"string\">\"非常不健康\"</span>,\t<span class=\"string\">\"危害\"</span>, <span class=\"string\">\"資料有誤\"</span>]</span><br><span class=\"line\">    total, count = <span class=\"number\">0</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> fetch <span class=\"keyword\">in</span> air_body:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fetch[<span class=\"string\">'County'</span>] == <span class=\"string\">\"臺中市\"</span> <span class=\"keyword\">and</span> (fetch[<span class=\"string\">'SiteName'</span>] == <span class=\"string\">\"西屯\"</span> <span class=\"keyword\">or</span> fetch[<span class=\"string\">'SiteName'</span>] == <span class=\"string\">\"沙鹿\"</span>)):</span><br><span class=\"line\">            count += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> fetch[<span class=\"string\">'AQI'</span>] != <span class=\"number\">0</span>:</span><br><span class=\"line\">                total = total + int(fetch[<span class=\"string\">'AQI'</span>])</span><br><span class=\"line\">    switch = <span class=\"number\">0</span></span><br><span class=\"line\">    pm = int(total / count)</span><br><span class=\"line\">    print(pm)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">50</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">51</span>, <span class=\"number\">100</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">101</span>, <span class=\"number\">150</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">151</span>, <span class=\"number\">200</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">3</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">201</span>, <span class=\"number\">250</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">4</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> pm <span class=\"keyword\">in</span> range(<span class=\"number\">251</span>, <span class=\"number\">300</span>):</span><br><span class=\"line\">        switch = <span class=\"number\">5</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        switch = <span class=\"number\">6</span></span><br><span class=\"line\">    payload = <span class=\"string\">f\"\\n空氣品質: <span class=\"subst\">&#123;air_status[switch]&#125;</span>\"</span></span><br><span class=\"line\">    r = requests.post(<span class=\"string\">'https://1uv2o723o4.execute-api.us-east-1.amazonaws.com/dev/notify/sqs'</span>,</span><br><span class=\"line\">                      data=&#123;<span class=\"string\">'message'</span>: payload&#125;)</span><br><span class=\"line\">    print(r)</span><br></pre></td></tr></table></figure>\n\n<p>在<code>serverless.yml</code>的 function 下面加入 Lambda，handler 就是 <code>資料夾/檔案.類別</code>，設定事件(event)排程一分鐘一次</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">function:</span></span><br><span class=\"line\"><span class=\"attr\">  line_bot_alert:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">consumer/line_bot_alert_handler.alert_handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - schedule:</span> <span class=\"string\">rate(1</span> <span class=\"string\">minute)</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>AWS Lambda 有兩種設定排程的方法，<code>rate</code>以及<code>cron</code>，若是比較固定時建議用<code>rate</code>，比較複雜的排程就可以讓<code>cron</code>來，下面兩張圖分別是來自 <a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html\" target=\"_blank\" rel=\"noopener\">AWS</a> &gt; <img src=\"https://i.imgur.com/r9ZaBhO.png\" alt></p>\n</blockquote>\n<hr>\n<p><img src=\"https://i.imgur.com/BLrbUPP.png\" alt></p>\n<p>下<code>sls deploy</code>部署之後就會看到剛剛做<code>line_bot_alert</code>的<code>function</code>，他每分鐘都在跑，若玩完之後不想用了可以下<code>sls remove</code>把上面有的東西刪掉嚕！<br><img src=\"https://i.imgur.com/0tpDSdf.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>其實還有很多應用可以實作排程，像是有朋友就用 GCP 的來定時發文 🤣，而且可以把腳本寫得像是 api 一樣，讓整個靈活性都增加了不少，下一篇就帶大家來做 LINE Login 嚕！</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html\" target=\"_blank\" rel=\"noopener\">AWS document</a></p>\n"},{"title":"Day19 - LINE LOGIN 介紹","abbrlink":3255201689,"date":"2019-10-03T12:58:22.000Z","_content":"\n## 前言\n\nLINE 中文版也上線啦 [URL](https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE)\n去某些網站登入你可能會有像下面這樣\n![](https://i.imgur.com/GNSYfYX.png)\n或者是你有玩過 LINE Rangers (怎麼感覺我好老)，就會看到他們登入畫面有個登入鈕，按下去按確認後就登入，使用者不用輸入帳號密碼。\n![](https://i.imgur.com/tbOfUET.jpg)\n這個機制被稱為 SSO (single sign-on)，它是透過 OAuth2 的機制來做認證，因為不儲存密碼除了可以降低儲存第三方網站的風險，以及使用者不需要記憶各種不同的密碼所帶來困擾，像是 Facebook、Google、LINE...都有相關的機制可以串連 SSO 的服務。\n\n以下會介紹 LINE Login 的流程。\n\n## 流程\n\n這裡我使用 LINE Login\n![](https://i.imgur.com/jouHzB0.png)\n\n1. 服務要引導使用者到 LINE 認證頁面並帶著必填的欄位。\n2. LINE 會在瀏覽器上打開認證頁面，使用者必須按下同意才會進行認證。\n3. LINE 會透過設定過的 `redirect_uri` 還給你一個 `authorization code` 以及 `state` 在 Query string 上。\n4. 你的服務需要將 `authorization code` 打到`https://api.line.me/oauth2/v2.1/token`\n5. LINE 確認完之後就會送你一個 `access token` 嚕！\n   > 可以拿透過 [social API](https://developers.line.biz/en/reference/social-api/) 去拿到相關資訊\n\n## 結論\n\n下一篇再帶著大家申請一個 LINE Login 的服務並建立一個簡單的註冊頁面～\n\n## 參考\n\n[OAuth wiki](https://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E6%8E%88%E6%9D%83)\n[LINE overview](https://developers.line.biz/en/docs/line-login/web/integrate-line-login/)\n[LINE 中文文件](https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE)\n","source":"_posts/Day19-LINE-LOGIN-介紹.md","raw":"---\ntitle: Day19 - LINE LOGIN 介紹\ntags:\n  - LINE\n  - LINE Login\ncategories: 2019鐵人賽\nabbrlink: 3255201689\ndate: 2019-10-03 20:58:22\n---\n\n## 前言\n\nLINE 中文版也上線啦 [URL](https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE)\n去某些網站登入你可能會有像下面這樣\n![](https://i.imgur.com/GNSYfYX.png)\n或者是你有玩過 LINE Rangers (怎麼感覺我好老)，就會看到他們登入畫面有個登入鈕，按下去按確認後就登入，使用者不用輸入帳號密碼。\n![](https://i.imgur.com/tbOfUET.jpg)\n這個機制被稱為 SSO (single sign-on)，它是透過 OAuth2 的機制來做認證，因為不儲存密碼除了可以降低儲存第三方網站的風險，以及使用者不需要記憶各種不同的密碼所帶來困擾，像是 Facebook、Google、LINE...都有相關的機制可以串連 SSO 的服務。\n\n以下會介紹 LINE Login 的流程。\n\n## 流程\n\n這裡我使用 LINE Login\n![](https://i.imgur.com/jouHzB0.png)\n\n1. 服務要引導使用者到 LINE 認證頁面並帶著必填的欄位。\n2. LINE 會在瀏覽器上打開認證頁面，使用者必須按下同意才會進行認證。\n3. LINE 會透過設定過的 `redirect_uri` 還給你一個 `authorization code` 以及 `state` 在 Query string 上。\n4. 你的服務需要將 `authorization code` 打到`https://api.line.me/oauth2/v2.1/token`\n5. LINE 確認完之後就會送你一個 `access token` 嚕！\n   > 可以拿透過 [social API](https://developers.line.biz/en/reference/social-api/) 去拿到相關資訊\n\n## 結論\n\n下一篇再帶著大家申請一個 LINE Login 的服務並建立一個簡單的註冊頁面～\n\n## 參考\n\n[OAuth wiki](https://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E6%8E%88%E6%9D%83)\n[LINE overview](https://developers.line.biz/en/docs/line-login/web/integrate-line-login/)\n[LINE 中文文件](https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE)\n","slug":"Day19-LINE-LOGIN-介紹","published":1,"updated":"2020-06-19T14:03:58.839Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jm001d7cria1ofi71c","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>LINE 中文版也上線啦 <a href=\"https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE\" target=\"_blank\" rel=\"noopener\">URL</a><br>去某些網站登入你可能會有像下面這樣<br><img src=\"https://i.imgur.com/GNSYfYX.png\" alt><br>或者是你有玩過 LINE Rangers (怎麼感覺我好老)，就會看到他們登入畫面有個登入鈕，按下去按確認後就登入，使用者不用輸入帳號密碼。<br><img src=\"https://i.imgur.com/tbOfUET.jpg\" alt><br>這個機制被稱為 SSO (single sign-on)，它是透過 OAuth2 的機制來做認證，因為不儲存密碼除了可以降低儲存第三方網站的風險，以及使用者不需要記憶各種不同的密碼所帶來困擾，像是 Facebook、Google、LINE…都有相關的機制可以串連 SSO 的服務。</p>\n<p>以下會介紹 LINE Login 的流程。</p>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p>這裡我使用 LINE Login<br><img src=\"https://i.imgur.com/jouHzB0.png\" alt></p>\n<ol>\n<li>服務要引導使用者到 LINE 認證頁面並帶著必填的欄位。</li>\n<li>LINE 會在瀏覽器上打開認證頁面，使用者必須按下同意才會進行認證。</li>\n<li>LINE 會透過設定過的 <code>redirect_uri</code> 還給你一個 <code>authorization code</code> 以及 <code>state</code> 在 Query string 上。</li>\n<li>你的服務需要將 <code>authorization code</code> 打到<code>https://api.line.me/oauth2/v2.1/token</code></li>\n<li>LINE 確認完之後就會送你一個 <code>access token</code> 嚕！<blockquote>\n<p>可以拿透過 <a href=\"https://developers.line.biz/en/reference/social-api/\" target=\"_blank\" rel=\"noopener\">social API</a> 去拿到相關資訊</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>下一篇再帶著大家申請一個 LINE Login 的服務並建立一個簡單的註冊頁面～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E6%8E%88%E6%9D%83\" target=\"_blank\" rel=\"noopener\">OAuth wiki</a><br><a href=\"https://developers.line.biz/en/docs/line-login/web/integrate-line-login/\" target=\"_blank\" rel=\"noopener\">LINE overview</a><br><a href=\"https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE\" target=\"_blank\" rel=\"noopener\">LINE 中文文件</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>LINE 中文版也上線啦 <a href=\"https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE\" target=\"_blank\" rel=\"noopener\">URL</a><br>去某些網站登入你可能會有像下面這樣<br><img src=\"https://i.imgur.com/GNSYfYX.png\" alt><br>或者是你有玩過 LINE Rangers (怎麼感覺我好老)，就會看到他們登入畫面有個登入鈕，按下去按確認後就登入，使用者不用輸入帳號密碼。<br><img src=\"https://i.imgur.com/tbOfUET.jpg\" alt><br>這個機制被稱為 SSO (single sign-on)，它是透過 OAuth2 的機制來做認證，因為不儲存密碼除了可以降低儲存第三方網站的風險，以及使用者不需要記憶各種不同的密碼所帶來困擾，像是 Facebook、Google、LINE…都有相關的機制可以串連 SSO 的服務。</p>\n<p>以下會介紹 LINE Login 的流程。</p>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p>這裡我使用 LINE Login<br><img src=\"https://i.imgur.com/jouHzB0.png\" alt></p>\n<ol>\n<li>服務要引導使用者到 LINE 認證頁面並帶著必填的欄位。</li>\n<li>LINE 會在瀏覽器上打開認證頁面，使用者必須按下同意才會進行認證。</li>\n<li>LINE 會透過設定過的 <code>redirect_uri</code> 還給你一個 <code>authorization code</code> 以及 <code>state</code> 在 Query string 上。</li>\n<li>你的服務需要將 <code>authorization code</code> 打到<code>https://api.line.me/oauth2/v2.1/token</code></li>\n<li>LINE 確認完之後就會送你一個 <code>access token</code> 嚕！<blockquote>\n<p>可以拿透過 <a href=\"https://developers.line.biz/en/reference/social-api/\" target=\"_blank\" rel=\"noopener\">social API</a> 去拿到相關資訊</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>下一篇再帶著大家申請一個 LINE Login 的服務並建立一個簡單的註冊頁面～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E6%8E%88%E6%9D%83\" target=\"_blank\" rel=\"noopener\">OAuth wiki</a><br><a href=\"https://developers.line.biz/en/docs/line-login/web/integrate-line-login/\" target=\"_blank\" rel=\"noopener\">LINE overview</a><br><a href=\"https://developers.line.biz/zh-hant/docs/line-login/overview/?fbclid=IwAR2I2VWF8Z1xS5wdSKlkWQiMFJphdjH3Qi_RnoJaCynQUG2GBM-PDiWJEjE\" target=\"_blank\" rel=\"noopener\">LINE 中文文件</a></p>\n"},{"title":"Day2 - 安裝並使用 wsgi & flask 建立第一個 Serverless 的專案","abbrlink":3320746320,"date":"2019-09-17T06:17:01.000Z","_content":"\n透過 npm 全域安裝 serverless 指令\n\n```bash=\nnpm install serverless -g\n```\n\n> 因為我是用 python3 在 AWS 上實作\n\n- `--template`可以選擇你想要的模板 ([參考](https://serverless.com/framework/docs/providers/aws/cli-reference/create/))\n- `name` service 的名稱\n- `--path` 專案路徑，若找不到資料夾時會自動新增\n\n```bash=\nserverless create --template aws-python3 --name aws-wsgi-flask --path aws-wsgi-flask\n```\n\n![](https://i.imgur.com/6GZVQNo.png)\n\n# 加入套件\n\n接著後面會需要使用套件，而 python 這邊會認得 requirements.txt 這個檔案，因此我們需要用 serverless 的 plugin 幫我們處理，讓專案在 deploy 上去之後會透過 requirements.txt 去安裝套件。\n\n而接下來我們會需要一個介面幫我們處理一些麻煩事，這邊就選用 wsgi 來處理。[詳細參考](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/362704/)\n\n```bash=\nsls plugin install -n serverless-python-requirements\nsls plugin install -n serverless-wsgi\n```\n\n接著去看 serverless.yml 檔案最後出現下面這樣就成功安裝了。\n\n```yaml=\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n然後新增一個 setup.cfg 並加入以下內容：\n\n```bash=\n[install]\nprefix=\n```\n\n> 由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 `pip install -t . -r requirements.txt` 時會需要 setup.cfg。\n\n接著選用 Flask 框架作我們開發的\n\n```bash=\necho \"Flask==1.0.2\" > requirements.txt\npip install -r requirements.txt -—user\n```\n\n> serverless-python-requirements 同樣也支持 pipenv 哦，如果想完全擋掉的話可以[參考](https://www.npmjs.com/package/serverless-python-requirements#pipenv-support-sparklescakesparkles)\n\n# 更改設定檔\n\n置換以下內容至 serverless.yml，讓 WSGI 去處理路由。\n\n```yaml=\nservice: aws-wsgi-flask\nprovider:\n  name: aws\n  runtime: python3.7\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\ncustom:\n  wsgi:\n    app: api.app\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n# 測試 wsgi\n\n因為我們不是單純只用 python 架設，所以要將 handler.py 替換成 api.py，並加入以下內容\n\n```python=\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route(\"/\", methods=['GET'])\ndef handler():\n    return 'hello world'\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n到這邊基礎設施都弄好了，但總不能部署才測試吧，所以這時候我們就出動\n\n```bash=\nserverless wsgi serve\n```\n\n透過 wsgi 去幫忙起一個 local server 供使用者可以測試，而且每次儲存都重新整理一次哦！詳細用法請[參考](https://github.com/logandk/serverless-wsgi)\n![](https://i.imgur.com/S4CQJxI.png)\n\n接著用 postman 來測試一下\n![](https://i.imgur.com/ci26g4O.png)\n\n燈燈，hello world 出來了～\n\n最後也是最重要的一個步驟『部署』\n只是說部署前需要有 AWS 的 secret key & token\n\n# 建立 AWS 存取金鑰\n\n首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！\n![](https://i.imgur.com/JOgIjXQ.png)\n如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！\n![](https://i.imgur.com/A34OlY5.png)\n如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。\n接著就將這兩個參數加入環境變數中：\n\n```bash=\nexport AWS_ACCESS_KEY_ID=<your-key-here>\nexport AWS_SECRET_ACCESS_KEY=<your-secret-key-here>\n```\n\n或是藉由 serverless 指令來幫忙加入參數：\n\n```\nserverless config credentials --provider aws --key <your-key-here> --secret <your-secret-key-here>\n```\n\n> 這步驟很重要哦，不然 AWS 不認識你就不給你上傳了 ?\n\n最後就是下 `serverlesss deploy`進行部署\n![](https://i.imgur.com/MK8Yks7.png)\n\n這邊 AWS 幫忙建立一個含有 SSL 的 domain，可以直接對這個網址下\n\n```yaml=\nendpoints: ANY - https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev\n  ANY - https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev/{proxy+}\n```\n\n接著把網址丟到瀏覽器上來試試看\n![](https://i.imgur.com/tptNSd4.png)\n出現 `hello world`就成功囉！\n\n# 參考\n\n- [使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot](https://medium.com/@nijia.lin/%E4%BD%BF%E7%94%A8-serverless-line-message-api-%E5%9C%A8-aws-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-echo-bot-1e3e785a2a01)\n- [sls cli 相關參數](https://serverless.com/framework/docs/providers/aws/cli-reference/)\n- [Serverless](https://serverless.com/)\n- [Serverless Github](https://github.com/serverless/serverless)\n- [serverless install](https://serverless.com/framework/docs/providers/aws/guide/quick-start/)\n- [serverless wsgi](https://serverless.com/plugins/serverless-wsgi/)\n- [requirements.txt](https://serverless.com/plugins/serverless-python-requirements/)\n","source":"_posts/Day2-安裝並使用 wsgi & flask 建立第一個 Serverless 的專案.md","raw":"---\ntitle: Day2 - 安裝並使用 wsgi & flask 建立第一個 Serverless 的專案\ntags:\n  - Serverless\n  - python\ncategories: 2019鐵人賽\nabbrlink: 3320746320\ndate: 2019-09-17 14:17:01\n---\n\n透過 npm 全域安裝 serverless 指令\n\n```bash=\nnpm install serverless -g\n```\n\n> 因為我是用 python3 在 AWS 上實作\n\n- `--template`可以選擇你想要的模板 ([參考](https://serverless.com/framework/docs/providers/aws/cli-reference/create/))\n- `name` service 的名稱\n- `--path` 專案路徑，若找不到資料夾時會自動新增\n\n```bash=\nserverless create --template aws-python3 --name aws-wsgi-flask --path aws-wsgi-flask\n```\n\n![](https://i.imgur.com/6GZVQNo.png)\n\n# 加入套件\n\n接著後面會需要使用套件，而 python 這邊會認得 requirements.txt 這個檔案，因此我們需要用 serverless 的 plugin 幫我們處理，讓專案在 deploy 上去之後會透過 requirements.txt 去安裝套件。\n\n而接下來我們會需要一個介面幫我們處理一些麻煩事，這邊就選用 wsgi 來處理。[詳細參考](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/362704/)\n\n```bash=\nsls plugin install -n serverless-python-requirements\nsls plugin install -n serverless-wsgi\n```\n\n接著去看 serverless.yml 檔案最後出現下面這樣就成功安裝了。\n\n```yaml=\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n然後新增一個 setup.cfg 並加入以下內容：\n\n```bash=\n[install]\nprefix=\n```\n\n> 由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 `pip install -t . -r requirements.txt` 時會需要 setup.cfg。\n\n接著選用 Flask 框架作我們開發的\n\n```bash=\necho \"Flask==1.0.2\" > requirements.txt\npip install -r requirements.txt -—user\n```\n\n> serverless-python-requirements 同樣也支持 pipenv 哦，如果想完全擋掉的話可以[參考](https://www.npmjs.com/package/serverless-python-requirements#pipenv-support-sparklescakesparkles)\n\n# 更改設定檔\n\n置換以下內容至 serverless.yml，讓 WSGI 去處理路由。\n\n```yaml=\nservice: aws-wsgi-flask\nprovider:\n  name: aws\n  runtime: python3.7\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\ncustom:\n  wsgi:\n    app: api.app\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n# 測試 wsgi\n\n因為我們不是單純只用 python 架設，所以要將 handler.py 替換成 api.py，並加入以下內容\n\n```python=\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route(\"/\", methods=['GET'])\ndef handler():\n    return 'hello world'\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n到這邊基礎設施都弄好了，但總不能部署才測試吧，所以這時候我們就出動\n\n```bash=\nserverless wsgi serve\n```\n\n透過 wsgi 去幫忙起一個 local server 供使用者可以測試，而且每次儲存都重新整理一次哦！詳細用法請[參考](https://github.com/logandk/serverless-wsgi)\n![](https://i.imgur.com/S4CQJxI.png)\n\n接著用 postman 來測試一下\n![](https://i.imgur.com/ci26g4O.png)\n\n燈燈，hello world 出來了～\n\n最後也是最重要的一個步驟『部署』\n只是說部署前需要有 AWS 的 secret key & token\n\n# 建立 AWS 存取金鑰\n\n首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！\n![](https://i.imgur.com/JOgIjXQ.png)\n如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！\n![](https://i.imgur.com/A34OlY5.png)\n如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。\n接著就將這兩個參數加入環境變數中：\n\n```bash=\nexport AWS_ACCESS_KEY_ID=<your-key-here>\nexport AWS_SECRET_ACCESS_KEY=<your-secret-key-here>\n```\n\n或是藉由 serverless 指令來幫忙加入參數：\n\n```\nserverless config credentials --provider aws --key <your-key-here> --secret <your-secret-key-here>\n```\n\n> 這步驟很重要哦，不然 AWS 不認識你就不給你上傳了 ?\n\n最後就是下 `serverlesss deploy`進行部署\n![](https://i.imgur.com/MK8Yks7.png)\n\n這邊 AWS 幫忙建立一個含有 SSL 的 domain，可以直接對這個網址下\n\n```yaml=\nendpoints: ANY - https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev\n  ANY - https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev/{proxy+}\n```\n\n接著把網址丟到瀏覽器上來試試看\n![](https://i.imgur.com/tptNSd4.png)\n出現 `hello world`就成功囉！\n\n# 參考\n\n- [使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot](https://medium.com/@nijia.lin/%E4%BD%BF%E7%94%A8-serverless-line-message-api-%E5%9C%A8-aws-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-echo-bot-1e3e785a2a01)\n- [sls cli 相關參數](https://serverless.com/framework/docs/providers/aws/cli-reference/)\n- [Serverless](https://serverless.com/)\n- [Serverless Github](https://github.com/serverless/serverless)\n- [serverless install](https://serverless.com/framework/docs/providers/aws/guide/quick-start/)\n- [serverless wsgi](https://serverless.com/plugins/serverless-wsgi/)\n- [requirements.txt](https://serverless.com/plugins/serverless-python-requirements/)\n","slug":"Day2-安裝並使用 wsgi & flask 建立第一個 Serverless 的專案","published":1,"updated":"2020-06-19T14:21:32.955Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jn001g7criqqt8l11o","content":"<p>透過 npm 全域安裝 serverless 指令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless -g</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>因為我是用 python3 在 AWS 上實作</p>\n</blockquote>\n<ul>\n<li><code>--template</code>可以選擇你想要的模板 (<a href=\"https://serverless.com/framework/docs/providers/aws/cli-reference/create/\" target=\"_blank\" rel=\"noopener\">參考</a>)</li>\n<li><code>name</code> service 的名稱</li>\n<li><code>--path</code> 專案路徑，若找不到資料夾時會自動新增</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless create --template aws-python3 --name aws-wsgi-flask --path aws-wsgi-flask</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/6GZVQNo.png\" alt></p>\n<h1 id=\"加入套件\"><a href=\"#加入套件\" class=\"headerlink\" title=\"加入套件\"></a>加入套件</h1><p>接著後面會需要使用套件，而 python 這邊會認得 requirements.txt 這個檔案，因此我們需要用 serverless 的 plugin 幫我們處理，讓專案在 deploy 上去之後會透過 requirements.txt 去安裝套件。</p>\n<p>而接下來我們會需要一個介面幫我們處理一些麻煩事，這邊就選用 wsgi 來處理。<a href=\"https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/362704/\" target=\"_blank\" rel=\"noopener\">詳細參考</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls plugin install -n serverless-python-requirements</span><br><span class=\"line\">sls plugin install -n serverless-wsgi</span><br></pre></td></tr></table></figure>\n\n<p>接著去看 serverless.yml 檔案最後出現下面這樣就成功安裝了。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<p>然後新增一個 setup.cfg 並加入以下內容：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[install]</span><br><span class=\"line\">prefix=</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 <code>pip install -t . -r requirements.txt</code> 時會需要 setup.cfg。</p>\n</blockquote>\n<p>接著選用 Flask 框架作我們開發的</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Flask==1.0.2\"</span> &gt; requirements.txt</span><br><span class=\"line\">pip install -r requirements.txt -—user</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>serverless-python-requirements 同樣也支持 pipenv 哦，如果想完全擋掉的話可以<a href=\"https://www.npmjs.com/package/serverless-python-requirements#pipenv-support-sparklescakesparkles\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<h1 id=\"更改設定檔\"><a href=\"#更改設定檔\" class=\"headerlink\" title=\"更改設定檔\"></a>更改設定檔</h1><p>置換以下內容至 serverless.yml，讓 WSGI 去處理路由。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">service:</span> <span class=\"string\">aws-wsgi-flask</span></span><br><span class=\"line\"><span class=\"attr\">provider:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">aws</span></span><br><span class=\"line\"><span class=\"attr\">  runtime:</span> <span class=\"string\">python3.7</span></span><br><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  wsgi:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">api.app</span></span><br><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"測試-wsgi\"><a href=\"#測試-wsgi\" class=\"headerlink\" title=\"測試 wsgi\"></a>測試 wsgi</h1><p>因為我們不是單純只用 python 架設，所以要將 handler.py 替換成 api.py，並加入以下內容</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/\", methods=['GET'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">handler</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'hello world'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>到這邊基礎設施都弄好了，但總不能部署才測試吧，所以這時候我們就出動</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>透過 wsgi 去幫忙起一個 local server 供使用者可以測試，而且每次儲存都重新整理一次哦！詳細用法請<a href=\"https://github.com/logandk/serverless-wsgi\" target=\"_blank\" rel=\"noopener\">參考</a><br><img src=\"https://i.imgur.com/S4CQJxI.png\" alt></p>\n<p>接著用 postman 來測試一下<br><img src=\"https://i.imgur.com/ci26g4O.png\" alt></p>\n<p>燈燈，hello world 出來了～</p>\n<p>最後也是最重要的一個步驟『部署』<br>只是說部署前需要有 AWS 的 secret key &amp; token</p>\n<h1 id=\"建立-AWS-存取金鑰\"><a href=\"#建立-AWS-存取金鑰\" class=\"headerlink\" title=\"建立 AWS 存取金鑰\"></a>建立 AWS 存取金鑰</h1><p>首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！<br><img src=\"https://i.imgur.com/JOgIjXQ.png\" alt><br>如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！<br><img src=\"https://i.imgur.com/A34OlY5.png\" alt><br>如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。<br>接著就將這兩個參數加入環境變數中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> AWS_ACCESS_KEY_ID=&lt;your-key-here&gt;</span><br><span class=\"line\"><span class=\"built_in\">export</span> AWS_SECRET_ACCESS_KEY=&lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<p>或是藉由 serverless 指令來幫忙加入參數：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless config credentials --provider aws --key &lt;your-key-here&gt; --secret &lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>這步驟很重要哦，不然 AWS 不認識你就不給你上傳了 ?</p>\n</blockquote>\n<p>最後就是下 <code>serverlesss deploy</code>進行部署<br><img src=\"https://i.imgur.com/MK8Yks7.png\" alt></p>\n<p>這邊 AWS 幫忙建立一個含有 SSL 的 domain，可以直接對這個網址下</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">endpoints:</span> <span class=\"string\">ANY</span> <span class=\"bullet\">-</span> <span class=\"attr\">https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev</span></span><br><span class=\"line\">  <span class=\"string\">ANY</span> <span class=\"bullet\">-</span> <span class=\"attr\">https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev/&#123;proxy+&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著把網址丟到瀏覽器上來試試看<br><img src=\"https://i.imgur.com/tptNSd4.png\" alt><br>出現 <code>hello world</code>就成功囉！</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://medium.com/@nijia.lin/%E4%BD%BF%E7%94%A8-serverless-line-message-api-%E5%9C%A8-aws-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-echo-bot-1e3e785a2a01\" target=\"_blank\" rel=\"noopener\">使用 Serverless &amp; LINE Message API 在 AWS 上打造一個 Echo bot</a></li>\n<li><a href=\"https://serverless.com/framework/docs/providers/aws/cli-reference/\" target=\"_blank\" rel=\"noopener\">sls cli 相關參數</a></li>\n<li><a href=\"https://serverless.com/\" target=\"_blank\" rel=\"noopener\">Serverless</a></li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless Github</a></li>\n<li><a href=\"https://serverless.com/framework/docs/providers/aws/guide/quick-start/\" target=\"_blank\" rel=\"noopener\">serverless install</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-wsgi/\" target=\"_blank\" rel=\"noopener\">serverless wsgi</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-python-requirements/\" target=\"_blank\" rel=\"noopener\">requirements.txt</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>透過 npm 全域安裝 serverless 指令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless -g</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>因為我是用 python3 在 AWS 上實作</p>\n</blockquote>\n<ul>\n<li><code>--template</code>可以選擇你想要的模板 (<a href=\"https://serverless.com/framework/docs/providers/aws/cli-reference/create/\" target=\"_blank\" rel=\"noopener\">參考</a>)</li>\n<li><code>name</code> service 的名稱</li>\n<li><code>--path</code> 專案路徑，若找不到資料夾時會自動新增</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless create --template aws-python3 --name aws-wsgi-flask --path aws-wsgi-flask</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/6GZVQNo.png\" alt></p>\n<h1 id=\"加入套件\"><a href=\"#加入套件\" class=\"headerlink\" title=\"加入套件\"></a>加入套件</h1><p>接著後面會需要使用套件，而 python 這邊會認得 requirements.txt 這個檔案，因此我們需要用 serverless 的 plugin 幫我們處理，讓專案在 deploy 上去之後會透過 requirements.txt 去安裝套件。</p>\n<p>而接下來我們會需要一個介面幫我們處理一些麻煩事，這邊就選用 wsgi 來處理。<a href=\"https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/362704/\" target=\"_blank\" rel=\"noopener\">詳細參考</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls plugin install -n serverless-python-requirements</span><br><span class=\"line\">sls plugin install -n serverless-wsgi</span><br></pre></td></tr></table></figure>\n\n<p>接著去看 serverless.yml 檔案最後出現下面這樣就成功安裝了。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<p>然後新增一個 setup.cfg 並加入以下內容：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[install]</span><br><span class=\"line\">prefix=</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 <code>pip install -t . -r requirements.txt</code> 時會需要 setup.cfg。</p>\n</blockquote>\n<p>接著選用 Flask 框架作我們開發的</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Flask==1.0.2\"</span> &gt; requirements.txt</span><br><span class=\"line\">pip install -r requirements.txt -—user</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>serverless-python-requirements 同樣也支持 pipenv 哦，如果想完全擋掉的話可以<a href=\"https://www.npmjs.com/package/serverless-python-requirements#pipenv-support-sparklescakesparkles\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<h1 id=\"更改設定檔\"><a href=\"#更改設定檔\" class=\"headerlink\" title=\"更改設定檔\"></a>更改設定檔</h1><p>置換以下內容至 serverless.yml，讓 WSGI 去處理路由。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">service:</span> <span class=\"string\">aws-wsgi-flask</span></span><br><span class=\"line\"><span class=\"attr\">provider:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">aws</span></span><br><span class=\"line\"><span class=\"attr\">  runtime:</span> <span class=\"string\">python3.7</span></span><br><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  wsgi:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">api.app</span></span><br><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"測試-wsgi\"><a href=\"#測試-wsgi\" class=\"headerlink\" title=\"測試 wsgi\"></a>測試 wsgi</h1><p>因為我們不是單純只用 python 架設，所以要將 handler.py 替換成 api.py，並加入以下內容</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/\", methods=['GET'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">handler</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'hello world'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>到這邊基礎設施都弄好了，但總不能部署才測試吧，所以這時候我們就出動</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>透過 wsgi 去幫忙起一個 local server 供使用者可以測試，而且每次儲存都重新整理一次哦！詳細用法請<a href=\"https://github.com/logandk/serverless-wsgi\" target=\"_blank\" rel=\"noopener\">參考</a><br><img src=\"https://i.imgur.com/S4CQJxI.png\" alt></p>\n<p>接著用 postman 來測試一下<br><img src=\"https://i.imgur.com/ci26g4O.png\" alt></p>\n<p>燈燈，hello world 出來了～</p>\n<p>最後也是最重要的一個步驟『部署』<br>只是說部署前需要有 AWS 的 secret key &amp; token</p>\n<h1 id=\"建立-AWS-存取金鑰\"><a href=\"#建立-AWS-存取金鑰\" class=\"headerlink\" title=\"建立 AWS 存取金鑰\"></a>建立 AWS 存取金鑰</h1><p>首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！<br><img src=\"https://i.imgur.com/JOgIjXQ.png\" alt><br>如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！<br><img src=\"https://i.imgur.com/A34OlY5.png\" alt><br>如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。<br>接著就將這兩個參數加入環境變數中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> AWS_ACCESS_KEY_ID=&lt;your-key-here&gt;</span><br><span class=\"line\"><span class=\"built_in\">export</span> AWS_SECRET_ACCESS_KEY=&lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<p>或是藉由 serverless 指令來幫忙加入參數：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless config credentials --provider aws --key &lt;your-key-here&gt; --secret &lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>這步驟很重要哦，不然 AWS 不認識你就不給你上傳了 ?</p>\n</blockquote>\n<p>最後就是下 <code>serverlesss deploy</code>進行部署<br><img src=\"https://i.imgur.com/MK8Yks7.png\" alt></p>\n<p>這邊 AWS 幫忙建立一個含有 SSL 的 domain，可以直接對這個網址下</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">endpoints:</span> <span class=\"string\">ANY</span> <span class=\"bullet\">-</span> <span class=\"attr\">https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev</span></span><br><span class=\"line\">  <span class=\"string\">ANY</span> <span class=\"bullet\">-</span> <span class=\"attr\">https://4omvn4z7re.execute-api.us-east-1.amazonaws.com/dev/&#123;proxy+&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著把網址丟到瀏覽器上來試試看<br><img src=\"https://i.imgur.com/tptNSd4.png\" alt><br>出現 <code>hello world</code>就成功囉！</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://medium.com/@nijia.lin/%E4%BD%BF%E7%94%A8-serverless-line-message-api-%E5%9C%A8-aws-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-echo-bot-1e3e785a2a01\" target=\"_blank\" rel=\"noopener\">使用 Serverless &amp; LINE Message API 在 AWS 上打造一個 Echo bot</a></li>\n<li><a href=\"https://serverless.com/framework/docs/providers/aws/cli-reference/\" target=\"_blank\" rel=\"noopener\">sls cli 相關參數</a></li>\n<li><a href=\"https://serverless.com/\" target=\"_blank\" rel=\"noopener\">Serverless</a></li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless Github</a></li>\n<li><a href=\"https://serverless.com/framework/docs/providers/aws/guide/quick-start/\" target=\"_blank\" rel=\"noopener\">serverless install</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-wsgi/\" target=\"_blank\" rel=\"noopener\">serverless wsgi</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-python-requirements/\" target=\"_blank\" rel=\"noopener\">requirements.txt</a></li>\n</ul>\n"},{"title":"Day20 - LINE Login 申請與基本頁面","abbrlink":864807826,"date":"2019-10-04T12:59:09.000Z","_content":"\n## 前言\n\n上篇介紹了好多了，這邊就不廢話了，直接就帶大家申請一個 LINE Login 的服務。\n\n## 實作\n\n首先到自己的開發者頁面按`+`，並選擇最左邊的選項\n![](https://i.imgur.com/c9JI0vX.jpg)\n接著輸入`App name`(服務名稱)、`App description`(服務簡介)，因為我們是實作 API ，所以選擇`Use WEB`的選項，接著再輸入`email`\n![](https://i.imgur.com/AA8NiF8.png)\n把該填的填完之後按下送出就會看到有一個新的服務嚕！\n![](https://i.imgur.com/RBM1HdJ.jpg)\n點進去後往下滑，可以看到有個 `link to this channel` 的選項，這邊選擇一開始建立的那隻機器人，綁定之後就變它的形狀啦(?)\n![](https://i.imgur.com/ES4wcHn.png)\n接著再往下會看到 Email 的狀態是 Unapplied，然後按下右邊的`Submit`\n![](https://i.imgur.com/SHgQYsU.png)\n會看到這樣子的一個框框，把兩個框框打勾並選擇一張圖片上傳，這部分就算是申請帳號下面的同意服務條款一樣，圖片就上傳自己希望當使用者到你頁面的時候想看到的圖片 🤣，送出之後就會看到狀態改成 `Applied` 了\n![](https://i.imgur.com/da7zYPg.jpg)\n\n## 結論\n\n很多時候實作對我們來說已經不是什麼問題了，重點是在找不到服務要怎麼去申請 😓，這篇也算是記錄一下申請的步驟細節，接下來會實作個簡單的認證頁面以及 API，打完收工嚕！\n","source":"_posts/Day20-LINE-Login-申請與基本頁面.md","raw":"---\ntitle: Day20 - LINE Login 申請與基本頁面\ntags:\n  - LINE\n  - LINE Login\ncategories: 2019鐵人賽\nabbrlink: 864807826\ndate: 2019-10-04 20:59:09\n---\n\n## 前言\n\n上篇介紹了好多了，這邊就不廢話了，直接就帶大家申請一個 LINE Login 的服務。\n\n## 實作\n\n首先到自己的開發者頁面按`+`，並選擇最左邊的選項\n![](https://i.imgur.com/c9JI0vX.jpg)\n接著輸入`App name`(服務名稱)、`App description`(服務簡介)，因為我們是實作 API ，所以選擇`Use WEB`的選項，接著再輸入`email`\n![](https://i.imgur.com/AA8NiF8.png)\n把該填的填完之後按下送出就會看到有一個新的服務嚕！\n![](https://i.imgur.com/RBM1HdJ.jpg)\n點進去後往下滑，可以看到有個 `link to this channel` 的選項，這邊選擇一開始建立的那隻機器人，綁定之後就變它的形狀啦(?)\n![](https://i.imgur.com/ES4wcHn.png)\n接著再往下會看到 Email 的狀態是 Unapplied，然後按下右邊的`Submit`\n![](https://i.imgur.com/SHgQYsU.png)\n會看到這樣子的一個框框，把兩個框框打勾並選擇一張圖片上傳，這部分就算是申請帳號下面的同意服務條款一樣，圖片就上傳自己希望當使用者到你頁面的時候想看到的圖片 🤣，送出之後就會看到狀態改成 `Applied` 了\n![](https://i.imgur.com/da7zYPg.jpg)\n\n## 結論\n\n很多時候實作對我們來說已經不是什麼問題了，重點是在找不到服務要怎麼去申請 😓，這篇也算是記錄一下申請的步驟細節，接下來會實作個簡單的認證頁面以及 API，打完收工嚕！\n","slug":"Day20-LINE-Login-申請與基本頁面","published":1,"updated":"2020-06-19T14:03:58.839Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jo001j7crifcs6m9z2","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上篇介紹了好多了，這邊就不廢話了，直接就帶大家申請一個 LINE Login 的服務。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>首先到自己的開發者頁面按<code>+</code>，並選擇最左邊的選項<br><img src=\"https://i.imgur.com/c9JI0vX.jpg\" alt><br>接著輸入<code>App name</code>(服務名稱)、<code>App description</code>(服務簡介)，因為我們是實作 API ，所以選擇<code>Use WEB</code>的選項，接著再輸入<code>email</code><br><img src=\"https://i.imgur.com/AA8NiF8.png\" alt><br>把該填的填完之後按下送出就會看到有一個新的服務嚕！<br><img src=\"https://i.imgur.com/RBM1HdJ.jpg\" alt><br>點進去後往下滑，可以看到有個 <code>link to this channel</code> 的選項，這邊選擇一開始建立的那隻機器人，綁定之後就變它的形狀啦(?)<br><img src=\"https://i.imgur.com/ES4wcHn.png\" alt><br>接著再往下會看到 Email 的狀態是 Unapplied，然後按下右邊的<code>Submit</code><br><img src=\"https://i.imgur.com/SHgQYsU.png\" alt><br>會看到這樣子的一個框框，把兩個框框打勾並選擇一張圖片上傳，這部分就算是申請帳號下面的同意服務條款一樣，圖片就上傳自己希望當使用者到你頁面的時候想看到的圖片 🤣，送出之後就會看到狀態改成 <code>Applied</code> 了<br><img src=\"https://i.imgur.com/da7zYPg.jpg\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>很多時候實作對我們來說已經不是什麼問題了，重點是在找不到服務要怎麼去申請 😓，這篇也算是記錄一下申請的步驟細節，接下來會實作個簡單的認證頁面以及 API，打完收工嚕！</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上篇介紹了好多了，這邊就不廢話了，直接就帶大家申請一個 LINE Login 的服務。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>首先到自己的開發者頁面按<code>+</code>，並選擇最左邊的選項<br><img src=\"https://i.imgur.com/c9JI0vX.jpg\" alt><br>接著輸入<code>App name</code>(服務名稱)、<code>App description</code>(服務簡介)，因為我們是實作 API ，所以選擇<code>Use WEB</code>的選項，接著再輸入<code>email</code><br><img src=\"https://i.imgur.com/AA8NiF8.png\" alt><br>把該填的填完之後按下送出就會看到有一個新的服務嚕！<br><img src=\"https://i.imgur.com/RBM1HdJ.jpg\" alt><br>點進去後往下滑，可以看到有個 <code>link to this channel</code> 的選項，這邊選擇一開始建立的那隻機器人，綁定之後就變它的形狀啦(?)<br><img src=\"https://i.imgur.com/ES4wcHn.png\" alt><br>接著再往下會看到 Email 的狀態是 Unapplied，然後按下右邊的<code>Submit</code><br><img src=\"https://i.imgur.com/SHgQYsU.png\" alt><br>會看到這樣子的一個框框，把兩個框框打勾並選擇一張圖片上傳，這部分就算是申請帳號下面的同意服務條款一樣，圖片就上傳自己希望當使用者到你頁面的時候想看到的圖片 🤣，送出之後就會看到狀態改成 <code>Applied</code> 了<br><img src=\"https://i.imgur.com/da7zYPg.jpg\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>很多時候實作對我們來說已經不是什麼問題了，重點是在找不到服務要怎麼去申請 😓，這篇也算是記錄一下申請的步驟細節，接下來會實作個簡單的認證頁面以及 API，打完收工嚕！</p>\n"},{"title":"Day21 - LINE Login 實作","abbrlink":4163822350,"date":"2019-10-05T12:59:50.000Z","_content":"\n## 前言\n\n現在有規模的平台提供商基本上都會提供 Single Sign On (SSO)的登入機制，藉由他們的平台讓一般小網站可以讓使用者免密碼登入，雖然有很多種 Oauth2 的套件，不過我還是喜歡自己打 🤣，下面就開始嚕！\n\n## 實作\n\n在`views/`建立一個`\b\b\b\b\b\bline_login_auth.html`，填入以下內容，主要是實作一個按鈕並透過 javascript 來互叫 api 並導向到 LINE 頁面\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>LINE Login</title>\n  </head>\n  <body>\n    <button class=\"auth\" onclick=\"auth()\">LINE LOGIN</button>\n  </body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n  <script>\n    function auth() {\n      $.ajax({\n        url: 'https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth',\n        method: 'POST',\n        success: function(data) {\n          window.location.replace(data.result);\n        },\n      });\n    }\n  </script>\n</html>\n```\n\n接著我們在`.env`加入 LINE Login 的環境變數並輸入對應的參數\n\n```yaml\nLINE_LOGIN_CLIENT_ID=\nLINE_LOGIN_SECRET=\nLINE_LOGIN_URI=https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth\n```\n\n最後就是我們最重要的部分了，實作 GET a& POST 的 api，這邊我先從 POST 講起，這邊主要是把環境變數組在網址中回傳給前端，這邊需要注意的是`state`他是在回傳回來的 JWT 需要解碼時所使用的，這邊我簡單打個字串，然而實際上會隨機產個變數，確保解碼的安全。\n\nGET 則是負責處理從 LINE 回來的參數們，這邊我只用回傳回來的`state`把`id_token`解開，拿到裡面的使用者的參數，後續可以參照應用把資訊存下來，放入 session 並告知前端已登入。\n\n```python\nfrom flask import request\nfrom flask_restful import Resource\nimport requests\nimport webbrowser\nimport os\nimport jwt\nimport json\n\n\nclass LineLoginController(Resource):\n\tdef get(self):\n\t\tr = requests.post(\n\t\t\t\"https://api.line.me/oauth2/v2.1/token\",\n\t\t\tdata={\n\t\t\t\t\"grant_type\": \"authorization_code\",\n\t\t\t\t\"code\": request.args.get('CODE'),\n\t\t\t\t\"redirect_uri\": os.environ.get('LINE_LOGIN_URI'),\n\t\t\t\t\"client_id\": os.environ.get('LINE_LOGIN_CLIENT_ID'),\n\t\t\t\t\"client_secret\": os.environ.get('LINE_LOGIN_SECRET'),\n\t\t\t}, headers={\"Content-Type\": \"application/x-www-form-urlencoded\"})\n\t\tpayload = json.loads(r.text)\n\t\tprint(payload)\n\t\ttoken = payload.get(\"id_token\")\n\t\tif token is None:\n\t\t\treturn {'result': payload['error_description']}, 400\n\n\t\tstate = request.args.get('state')\n\t\ttoken = token.encode()\n\t\tdt = jwt.decode(token, state, None, algorithms=['HS256'])\n\t\tif dt:\n\t\t\treturn {'result': dt}, 200\n\n\tdef post(self):\n\t\tr_uri = os.environ.get(\"LINE_LOGIN_URI\")\n\t\tclient = os.environ.get(\"LINE_LOGIN_CLIENT_ID\")\n\t\tstate = \"nostate\" # it will be random value\n\t\turi = f\"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id={client}&redirect_uri={r_uri}&scope=profile%20openid%20email&state={state}\"\n\t\treturn {'result': uri}\n```\n\nJWT 解開的參數如下，`sub`就是 LINE 的唯一值 ID，一般拿到這個就可以知道是來自 LINE 的使用者了。\n\n```json\n{\n  \"result\": {\n    \"iss\": \"https://access.line.me\",\n    \"sub\": \"Ud6ab866a67xxxxxxxxb12b0baffb8ac\",\n    \"aud\": \"1622939248\",\n    \"exp\": 1569925548,\n    \"iat\": 1569921948,\n    \"amr\": [\"linesso\"],\n    \"name\": \"NiJia Lin\",\n    \"picture\": \"https://profile.line-scdn.net/0hKvTocMuLFFlpFj9HpKdrDlVTGjxxxxxxxxx1YHACMOPRtEHmkWJVIKUyUJNkQWGT0X\",\n    \"email\": \"loxxxxx09@gmail.com\"\n  }\n}\n```\n\n最後別忘了要在`api.py`加入路由才會被導出去ㄛ\n\n```python\nfrom controller.line_login_controller import LineLoginController\napi.add_resource(LineLoginController, '/line/auth')\n```\n\n## 結論\n\n在實作的時候不知道為什麼一直不能讓 python 去幫我把用戶導去 LINE 認證的頁面，我記得之前寫 Ruby 可以啊(?)，最後只好讓前端去幫我把使用者導出去，這邊就帶大家做到這嚕！\n","source":"_posts/Day21-LINE-Login-實作.md","raw":"---\ntitle: Day21 - LINE Login 實作\ntags:\n  - LINE\n  - LINE Login\n  - S3\ncategories: 2019鐵人賽\nabbrlink: 4163822350\ndate: 2019-10-05 20:59:50\n---\n\n## 前言\n\n現在有規模的平台提供商基本上都會提供 Single Sign On (SSO)的登入機制，藉由他們的平台讓一般小網站可以讓使用者免密碼登入，雖然有很多種 Oauth2 的套件，不過我還是喜歡自己打 🤣，下面就開始嚕！\n\n## 實作\n\n在`views/`建立一個`\b\b\b\b\b\bline_login_auth.html`，填入以下內容，主要是實作一個按鈕並透過 javascript 來互叫 api 並導向到 LINE 頁面\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>LINE Login</title>\n  </head>\n  <body>\n    <button class=\"auth\" onclick=\"auth()\">LINE LOGIN</button>\n  </body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n  <script>\n    function auth() {\n      $.ajax({\n        url: 'https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth',\n        method: 'POST',\n        success: function(data) {\n          window.location.replace(data.result);\n        },\n      });\n    }\n  </script>\n</html>\n```\n\n接著我們在`.env`加入 LINE Login 的環境變數並輸入對應的參數\n\n```yaml\nLINE_LOGIN_CLIENT_ID=\nLINE_LOGIN_SECRET=\nLINE_LOGIN_URI=https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth\n```\n\n最後就是我們最重要的部分了，實作 GET a& POST 的 api，這邊我先從 POST 講起，這邊主要是把環境變數組在網址中回傳給前端，這邊需要注意的是`state`他是在回傳回來的 JWT 需要解碼時所使用的，這邊我簡單打個字串，然而實際上會隨機產個變數，確保解碼的安全。\n\nGET 則是負責處理從 LINE 回來的參數們，這邊我只用回傳回來的`state`把`id_token`解開，拿到裡面的使用者的參數，後續可以參照應用把資訊存下來，放入 session 並告知前端已登入。\n\n```python\nfrom flask import request\nfrom flask_restful import Resource\nimport requests\nimport webbrowser\nimport os\nimport jwt\nimport json\n\n\nclass LineLoginController(Resource):\n\tdef get(self):\n\t\tr = requests.post(\n\t\t\t\"https://api.line.me/oauth2/v2.1/token\",\n\t\t\tdata={\n\t\t\t\t\"grant_type\": \"authorization_code\",\n\t\t\t\t\"code\": request.args.get('CODE'),\n\t\t\t\t\"redirect_uri\": os.environ.get('LINE_LOGIN_URI'),\n\t\t\t\t\"client_id\": os.environ.get('LINE_LOGIN_CLIENT_ID'),\n\t\t\t\t\"client_secret\": os.environ.get('LINE_LOGIN_SECRET'),\n\t\t\t}, headers={\"Content-Type\": \"application/x-www-form-urlencoded\"})\n\t\tpayload = json.loads(r.text)\n\t\tprint(payload)\n\t\ttoken = payload.get(\"id_token\")\n\t\tif token is None:\n\t\t\treturn {'result': payload['error_description']}, 400\n\n\t\tstate = request.args.get('state')\n\t\ttoken = token.encode()\n\t\tdt = jwt.decode(token, state, None, algorithms=['HS256'])\n\t\tif dt:\n\t\t\treturn {'result': dt}, 200\n\n\tdef post(self):\n\t\tr_uri = os.environ.get(\"LINE_LOGIN_URI\")\n\t\tclient = os.environ.get(\"LINE_LOGIN_CLIENT_ID\")\n\t\tstate = \"nostate\" # it will be random value\n\t\turi = f\"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id={client}&redirect_uri={r_uri}&scope=profile%20openid%20email&state={state}\"\n\t\treturn {'result': uri}\n```\n\nJWT 解開的參數如下，`sub`就是 LINE 的唯一值 ID，一般拿到這個就可以知道是來自 LINE 的使用者了。\n\n```json\n{\n  \"result\": {\n    \"iss\": \"https://access.line.me\",\n    \"sub\": \"Ud6ab866a67xxxxxxxxb12b0baffb8ac\",\n    \"aud\": \"1622939248\",\n    \"exp\": 1569925548,\n    \"iat\": 1569921948,\n    \"amr\": [\"linesso\"],\n    \"name\": \"NiJia Lin\",\n    \"picture\": \"https://profile.line-scdn.net/0hKvTocMuLFFlpFj9HpKdrDlVTGjxxxxxxxxx1YHACMOPRtEHmkWJVIKUyUJNkQWGT0X\",\n    \"email\": \"loxxxxx09@gmail.com\"\n  }\n}\n```\n\n最後別忘了要在`api.py`加入路由才會被導出去ㄛ\n\n```python\nfrom controller.line_login_controller import LineLoginController\napi.add_resource(LineLoginController, '/line/auth')\n```\n\n## 結論\n\n在實作的時候不知道為什麼一直不能讓 python 去幫我把用戶導去 LINE 認證的頁面，我記得之前寫 Ruby 可以啊(?)，最後只好讓前端去幫我把使用者導出去，這邊就帶大家做到這嚕！\n","slug":"Day21-LINE-Login-實作","published":1,"updated":"2020-06-19T14:03:58.841Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jp001m7cripcnrb7cl","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>現在有規模的平台提供商基本上都會提供 Single Sign On (SSO)的登入機制，藉由他們的平台讓一般小網站可以讓使用者免密碼登入，雖然有很多種 Oauth2 的套件，不過我還是喜歡自己打 🤣，下面就開始嚕！</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>在<code>views/</code>建立一個<code>\b\b\b\b\b\bline_login_auth.html</code>，填入以下內容，主要是實作一個按鈕並透過 javascript 來互叫 api 並導向到 LINE 頁面</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>LINE Login<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"auth\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"auth()\"</span>&gt;</span>LINE LOGIN<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">auth</span><span class=\"params\">()</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">      $.ajax(&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">        url: <span class=\"string\">'https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">        method: <span class=\"string\">'POST'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">        success: <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">          <span class=\"built_in\">window</span>.location.replace(data.result);</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著我們在<code>.env</code>加入 LINE Login 的環境變數並輸入對應的參數</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">LINE_LOGIN_CLIENT_ID=</span></span><br><span class=\"line\"><span class=\"string\">LINE_LOGIN_SECRET=</span></span><br><span class=\"line\"><span class=\"string\">LINE_LOGIN_URI=https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth</span></span><br></pre></td></tr></table></figure>\n\n<p>最後就是我們最重要的部分了，實作 GET a&amp; POST 的 api，這邊我先從 POST 講起，這邊主要是把環境變數組在網址中回傳給前端，這邊需要注意的是<code>state</code>他是在回傳回來的 JWT 需要解碼時所使用的，這邊我簡單打個字串，然而實際上會隨機產個變數，確保解碼的安全。</p>\n<p>GET 則是負責處理從 LINE 回來的參數們，這邊我只用回傳回來的<code>state</code>把<code>id_token</code>解開，拿到裡面的使用者的參數，後續可以參照應用把資訊存下來，放入 session 並告知前端已登入。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> request</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> webbrowser</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> jwt</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LineLoginController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\tr = requests.post(</span><br><span class=\"line\">\t\t\t<span class=\"string\">\"https://api.line.me/oauth2/v2.1/token\"</span>,</span><br><span class=\"line\">\t\t\tdata=&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"grant_type\"</span>: <span class=\"string\">\"authorization_code\"</span>,</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"code\"</span>: request.args.get(<span class=\"string\">'CODE'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"redirect_uri\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_URI'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"client_id\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_CLIENT_ID'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"client_secret\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_SECRET'</span>),</span><br><span class=\"line\">\t\t\t&#125;, headers=&#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/x-www-form-urlencoded\"</span>&#125;)</span><br><span class=\"line\">\t\tpayload = json.loads(r.text)</span><br><span class=\"line\">\t\tprint(payload)</span><br><span class=\"line\">\t\ttoken = payload.get(<span class=\"string\">\"id_token\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> token <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: payload[<span class=\"string\">'error_description'</span>]&#125;, <span class=\"number\">400</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate = request.args.get(<span class=\"string\">'state'</span>)</span><br><span class=\"line\">\t\ttoken = token.encode()</span><br><span class=\"line\">\t\tdt = jwt.decode(token, state, <span class=\"literal\">None</span>, algorithms=[<span class=\"string\">'HS256'</span>])</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> dt:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: dt&#125;, <span class=\"number\">200</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\tr_uri = os.environ.get(<span class=\"string\">\"LINE_LOGIN_URI\"</span>)</span><br><span class=\"line\">\t\tclient = os.environ.get(<span class=\"string\">\"LINE_LOGIN_CLIENT_ID\"</span>)</span><br><span class=\"line\">\t\tstate = <span class=\"string\">\"nostate\"</span> <span class=\"comment\"># it will be random value</span></span><br><span class=\"line\">\t\turi = <span class=\"string\">f\"https://access.line.me/oauth2/v2.1/authorize?response_type=code&amp;client_id=<span class=\"subst\">&#123;client&#125;</span>&amp;redirect_uri=<span class=\"subst\">&#123;r_uri&#125;</span>&amp;scope=profile%20openid%20email&amp;state=<span class=\"subst\">&#123;state&#125;</span>\"</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: uri&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JWT 解開的參數如下，<code>sub</code>就是 LINE 的唯一值 ID，一般拿到這個就可以知道是來自 LINE 的使用者了。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"result\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"iss\"</span>: <span class=\"string\">\"https://access.line.me\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sub\"</span>: <span class=\"string\">\"Ud6ab866a67xxxxxxxxb12b0baffb8ac\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"aud\"</span>: <span class=\"string\">\"1622939248\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"exp\"</span>: <span class=\"number\">1569925548</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"iat\"</span>: <span class=\"number\">1569921948</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"amr\"</span>: [<span class=\"string\">\"linesso\"</span>],</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"NiJia Lin\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"picture\"</span>: <span class=\"string\">\"https://profile.line-scdn.net/0hKvTocMuLFFlpFj9HpKdrDlVTGjxxxxxxxxx1YHACMOPRtEHmkWJVIKUyUJNkQWGT0X\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"email\"</span>: <span class=\"string\">\"loxxxxx09@gmail.com\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>最後別忘了要在<code>api.py</code>加入路由才會被導出去ㄛ</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> controller.line_login_controller <span class=\"keyword\">import</span> LineLoginController</span><br><span class=\"line\">api.add_resource(LineLoginController, <span class=\"string\">'/line/auth'</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>在實作的時候不知道為什麼一直不能讓 python 去幫我把用戶導去 LINE 認證的頁面，我記得之前寫 Ruby 可以啊(?)，最後只好讓前端去幫我把使用者導出去，這邊就帶大家做到這嚕！</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>現在有規模的平台提供商基本上都會提供 Single Sign On (SSO)的登入機制，藉由他們的平台讓一般小網站可以讓使用者免密碼登入，雖然有很多種 Oauth2 的套件，不過我還是喜歡自己打 🤣，下面就開始嚕！</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>在<code>views/</code>建立一個<code>\b\b\b\b\b\bline_login_auth.html</code>，填入以下內容，主要是實作一個按鈕並透過 javascript 來互叫 api 並導向到 LINE 頁面</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>LINE Login<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"auth\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"auth()\"</span>&gt;</span>LINE LOGIN<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">auth</span><span class=\"params\">()</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">      $.ajax(&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">        url: <span class=\"string\">'https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">        method: <span class=\"string\">'POST'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">        success: <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">          <span class=\"built_in\">window</span>.location.replace(data.result);</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著我們在<code>.env</code>加入 LINE Login 的環境變數並輸入對應的參數</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">LINE_LOGIN_CLIENT_ID=</span></span><br><span class=\"line\"><span class=\"string\">LINE_LOGIN_SECRET=</span></span><br><span class=\"line\"><span class=\"string\">LINE_LOGIN_URI=https://YOUR_SERVERLESS_DOMAIN.amazonaws.com/dev/line/auth</span></span><br></pre></td></tr></table></figure>\n\n<p>最後就是我們最重要的部分了，實作 GET a&amp; POST 的 api，這邊我先從 POST 講起，這邊主要是把環境變數組在網址中回傳給前端，這邊需要注意的是<code>state</code>他是在回傳回來的 JWT 需要解碼時所使用的，這邊我簡單打個字串，然而實際上會隨機產個變數，確保解碼的安全。</p>\n<p>GET 則是負責處理從 LINE 回來的參數們，這邊我只用回傳回來的<code>state</code>把<code>id_token</code>解開，拿到裡面的使用者的參數，後續可以參照應用把資訊存下來，放入 session 並告知前端已登入。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> request</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> webbrowser</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> jwt</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LineLoginController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\tr = requests.post(</span><br><span class=\"line\">\t\t\t<span class=\"string\">\"https://api.line.me/oauth2/v2.1/token\"</span>,</span><br><span class=\"line\">\t\t\tdata=&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"grant_type\"</span>: <span class=\"string\">\"authorization_code\"</span>,</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"code\"</span>: request.args.get(<span class=\"string\">'CODE'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"redirect_uri\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_URI'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"client_id\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_CLIENT_ID'</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">\"client_secret\"</span>: os.environ.get(<span class=\"string\">'LINE_LOGIN_SECRET'</span>),</span><br><span class=\"line\">\t\t\t&#125;, headers=&#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/x-www-form-urlencoded\"</span>&#125;)</span><br><span class=\"line\">\t\tpayload = json.loads(r.text)</span><br><span class=\"line\">\t\tprint(payload)</span><br><span class=\"line\">\t\ttoken = payload.get(<span class=\"string\">\"id_token\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> token <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: payload[<span class=\"string\">'error_description'</span>]&#125;, <span class=\"number\">400</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate = request.args.get(<span class=\"string\">'state'</span>)</span><br><span class=\"line\">\t\ttoken = token.encode()</span><br><span class=\"line\">\t\tdt = jwt.decode(token, state, <span class=\"literal\">None</span>, algorithms=[<span class=\"string\">'HS256'</span>])</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> dt:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: dt&#125;, <span class=\"number\">200</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\tr_uri = os.environ.get(<span class=\"string\">\"LINE_LOGIN_URI\"</span>)</span><br><span class=\"line\">\t\tclient = os.environ.get(<span class=\"string\">\"LINE_LOGIN_CLIENT_ID\"</span>)</span><br><span class=\"line\">\t\tstate = <span class=\"string\">\"nostate\"</span> <span class=\"comment\"># it will be random value</span></span><br><span class=\"line\">\t\turi = <span class=\"string\">f\"https://access.line.me/oauth2/v2.1/authorize?response_type=code&amp;client_id=<span class=\"subst\">&#123;client&#125;</span>&amp;redirect_uri=<span class=\"subst\">&#123;r_uri&#125;</span>&amp;scope=profile%20openid%20email&amp;state=<span class=\"subst\">&#123;state&#125;</span>\"</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: uri&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JWT 解開的參數如下，<code>sub</code>就是 LINE 的唯一值 ID，一般拿到這個就可以知道是來自 LINE 的使用者了。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"result\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"iss\"</span>: <span class=\"string\">\"https://access.line.me\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sub\"</span>: <span class=\"string\">\"Ud6ab866a67xxxxxxxxb12b0baffb8ac\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"aud\"</span>: <span class=\"string\">\"1622939248\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"exp\"</span>: <span class=\"number\">1569925548</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"iat\"</span>: <span class=\"number\">1569921948</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"amr\"</span>: [<span class=\"string\">\"linesso\"</span>],</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"NiJia Lin\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"picture\"</span>: <span class=\"string\">\"https://profile.line-scdn.net/0hKvTocMuLFFlpFj9HpKdrDlVTGjxxxxxxxxx1YHACMOPRtEHmkWJVIKUyUJNkQWGT0X\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"email\"</span>: <span class=\"string\">\"loxxxxx09@gmail.com\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>最後別忘了要在<code>api.py</code>加入路由才會被導出去ㄛ</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> controller.line_login_controller <span class=\"keyword\">import</span> LineLoginController</span><br><span class=\"line\">api.add_resource(LineLoginController, <span class=\"string\">'/line/auth'</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>在實作的時候不知道為什麼一直不能讓 python 去幫我把用戶導去 LINE 認證的頁面，我記得之前寫 Ruby 可以啊(?)，最後只好讓前端去幫我把使用者導出去，這邊就帶大家做到這嚕！</p>\n"},{"title":"Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號","abbrlink":4225183620,"date":"2019-10-06T13:01:02.000Z","_content":"\n## 前言\n\n在第 Day 13 Python SDK 試玩的時候使用過 get_profile，當時使用時就是在每次訊息來的時候才去 SQL 儲存使用者資訊，若只是單純想要使用者資訊的話這樣用好像有點多餘 😓，以下就帶各位簡單的實作。\n\n## 實作\n\n我們要將上篇的前端頁面(line_login_auth.html)改造一下\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>LINE Login</title>\n  </head>\n  <body></body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n  <script>\n    $.ajax({\n      url: \"https://YOUR_SLS_DOMAIN.us-east-1.amazonaws.com/dev/line/auth\",\n      method: \"POST\",\n      success: function(data) {\n        window.location.replace(data.result);\n      }\n    });\n  </script>\n</html>\n```\n\n這邊我將 button 的 onclick 事件以及 button 本身移除掉，目的是要讓使用者一到這個頁面之後就直接透過 AJAX call api\n\n到了這裡應該有感應到什麼了吧！接著就是把這個 html 檔的 S3 路徑網址使用 QR code 包起來，讓他看起來像是 LINE bot 的 QR code\n\n到了這邊基本上已經快完成了，參考 LINE 的[好友說明](https://developers.line.biz/en/docs/messaging-api/using-line-url-scheme/?fbclid=IwAR25G73QmKIGm1l7kPNFzDIpMwBKQRQVxPP8ZpPzp3p-FSES2fnWcVCue_c)或下圖\n![](https://i.imgur.com/fEEzOsy.png)\n\n接著到機器人的開發者頁面，並且往下滑會看到自己機器人的 QR code 以及 Bot 的 ID，把他複製下來並製作機器人的加好友網址\n![](https://i.imgur.com/Mn3RG26.png)\n\n像是這樣子\n\n```\nhttps://line.me/R/@1234\n```\n\n接著到 `controller/line_login_controller.py`的`def get(self)`最後一行，原本我們這邊做的是回傳 JSON\n\n```python\nif dt:\n\t\t\treturn {'result': dt}, 200\n```\n\n改用\n\n```python\nfrom flask import redirect\nif dt:\n \t\treturn redirect(\"https://line.me/R/ti/p//@127ojvgz\", code=302)\n```\n\n如此一來在登入驗證完之後就會把使用者導向到加好友的頁面，在手機上若已經加過好友則會直接導到機器人對話窗上，如此一來就可以讓使用者在加入好友的同時也綁定完帳號，在未來使用的時候 api 這邊也比較好控管使用者的權限問題。\n\n## 結論\n\n像是我自己做的健身記錄機器人，就是以這個方法下去實作，有聽過一些朋友跟我反應這樣的方法多此一舉，但我認為若是有網頁的話也是套用 LINE SSO 來實作，就可以讓兩個入口去統一，在狀態流上就能比較好控制了。\n![](https://i.imgur.com/8fKlsAt.jpg)\n","source":"_posts/Day22-最常用的搭配-使用-Login-Message-API-讓使用者在掃描加入好友時就綁定帳號.md","raw":"---\ntitle: Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號\ntags:\n  - LINE\n  - LINE Login\n  - Message api\n  - chatbot\ncategories: 2019鐵人賽\nabbrlink: 4225183620\ndate: 2019-10-06 21:01:02\n---\n\n## 前言\n\n在第 Day 13 Python SDK 試玩的時候使用過 get_profile，當時使用時就是在每次訊息來的時候才去 SQL 儲存使用者資訊，若只是單純想要使用者資訊的話這樣用好像有點多餘 😓，以下就帶各位簡單的實作。\n\n## 實作\n\n我們要將上篇的前端頁面(line_login_auth.html)改造一下\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>LINE Login</title>\n  </head>\n  <body></body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n  <script>\n    $.ajax({\n      url: \"https://YOUR_SLS_DOMAIN.us-east-1.amazonaws.com/dev/line/auth\",\n      method: \"POST\",\n      success: function(data) {\n        window.location.replace(data.result);\n      }\n    });\n  </script>\n</html>\n```\n\n這邊我將 button 的 onclick 事件以及 button 本身移除掉，目的是要讓使用者一到這個頁面之後就直接透過 AJAX call api\n\n到了這裡應該有感應到什麼了吧！接著就是把這個 html 檔的 S3 路徑網址使用 QR code 包起來，讓他看起來像是 LINE bot 的 QR code\n\n到了這邊基本上已經快完成了，參考 LINE 的[好友說明](https://developers.line.biz/en/docs/messaging-api/using-line-url-scheme/?fbclid=IwAR25G73QmKIGm1l7kPNFzDIpMwBKQRQVxPP8ZpPzp3p-FSES2fnWcVCue_c)或下圖\n![](https://i.imgur.com/fEEzOsy.png)\n\n接著到機器人的開發者頁面，並且往下滑會看到自己機器人的 QR code 以及 Bot 的 ID，把他複製下來並製作機器人的加好友網址\n![](https://i.imgur.com/Mn3RG26.png)\n\n像是這樣子\n\n```\nhttps://line.me/R/@1234\n```\n\n接著到 `controller/line_login_controller.py`的`def get(self)`最後一行，原本我們這邊做的是回傳 JSON\n\n```python\nif dt:\n\t\t\treturn {'result': dt}, 200\n```\n\n改用\n\n```python\nfrom flask import redirect\nif dt:\n \t\treturn redirect(\"https://line.me/R/ti/p//@127ojvgz\", code=302)\n```\n\n如此一來在登入驗證完之後就會把使用者導向到加好友的頁面，在手機上若已經加過好友則會直接導到機器人對話窗上，如此一來就可以讓使用者在加入好友的同時也綁定完帳號，在未來使用的時候 api 這邊也比較好控管使用者的權限問題。\n\n## 結論\n\n像是我自己做的健身記錄機器人，就是以這個方法下去實作，有聽過一些朋友跟我反應這樣的方法多此一舉，但我認為若是有網頁的話也是套用 LINE SSO 來實作，就可以讓兩個入口去統一，在狀態流上就能比較好控制了。\n![](https://i.imgur.com/8fKlsAt.jpg)\n","slug":"Day22-最常用的搭配-使用-Login-Message-API-讓使用者在掃描加入好友時就綁定帳號","published":1,"updated":"2020-06-19T14:03:58.840Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jr001p7criezmsb8xs","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在第 Day 13 Python SDK 試玩的時候使用過 get_profile，當時使用時就是在每次訊息來的時候才去 SQL 儲存使用者資訊，若只是單純想要使用者資訊的話這樣用好像有點多餘 😓，以下就帶各位簡單的實作。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>我們要將上篇的前端頁面(line_login_auth.html)改造一下</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>LINE Login<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">    $.ajax(&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">      url: <span class=\"string\">\"https://YOUR_SLS_DOMAIN.us-east-1.amazonaws.com/dev/line/auth\"</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">      method: <span class=\"string\">\"POST\"</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">      success: <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.location.replace(data.result);</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>這邊我將 button 的 onclick 事件以及 button 本身移除掉，目的是要讓使用者一到這個頁面之後就直接透過 AJAX call api</p>\n<p>到了這裡應該有感應到什麼了吧！接著就是把這個 html 檔的 S3 路徑網址使用 QR code 包起來，讓他看起來像是 LINE bot 的 QR code</p>\n<p>到了這邊基本上已經快完成了，參考 LINE 的<a href=\"https://developers.line.biz/en/docs/messaging-api/using-line-url-scheme/?fbclid=IwAR25G73QmKIGm1l7kPNFzDIpMwBKQRQVxPP8ZpPzp3p-FSES2fnWcVCue_c\" target=\"_blank\" rel=\"noopener\">好友說明</a>或下圖<br><img src=\"https://i.imgur.com/fEEzOsy.png\" alt></p>\n<p>接著到機器人的開發者頁面，並且往下滑會看到自己機器人的 QR code 以及 Bot 的 ID，把他複製下來並製作機器人的加好友網址<br><img src=\"https://i.imgur.com/Mn3RG26.png\" alt></p>\n<p>像是這樣子</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://line.me/R/@1234</span><br></pre></td></tr></table></figure>\n\n<p>接著到 <code>controller/line_login_controller.py</code>的<code>def get(self)</code>最後一行，原本我們這邊做的是回傳 JSON</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> dt:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: dt&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>改用</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> redirect</span><br><span class=\"line\"><span class=\"keyword\">if</span> dt:</span><br><span class=\"line\"> \t\t<span class=\"keyword\">return</span> redirect(<span class=\"string\">\"https://line.me/R/ti/p//@127ojvgz\"</span>, code=<span class=\"number\">302</span>)</span><br></pre></td></tr></table></figure>\n\n<p>如此一來在登入驗證完之後就會把使用者導向到加好友的頁面，在手機上若已經加過好友則會直接導到機器人對話窗上，如此一來就可以讓使用者在加入好友的同時也綁定完帳號，在未來使用的時候 api 這邊也比較好控管使用者的權限問題。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>像是我自己做的健身記錄機器人，就是以這個方法下去實作，有聽過一些朋友跟我反應這樣的方法多此一舉，但我認為若是有網頁的話也是套用 LINE SSO 來實作，就可以讓兩個入口去統一，在狀態流上就能比較好控制了。<br><img src=\"https://i.imgur.com/8fKlsAt.jpg\" alt></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在第 Day 13 Python SDK 試玩的時候使用過 get_profile，當時使用時就是在每次訊息來的時候才去 SQL 儲存使用者資訊，若只是單純想要使用者資訊的話這樣用好像有點多餘 😓，以下就帶各位簡單的實作。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>我們要將上篇的前端頁面(line_login_auth.html)改造一下</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>LINE Login<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">    $.ajax(&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">      url: <span class=\"string\">\"https://YOUR_SLS_DOMAIN.us-east-1.amazonaws.com/dev/line/auth\"</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">      method: <span class=\"string\">\"POST\"</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">      success: <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.location.replace(data.result);</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>這邊我將 button 的 onclick 事件以及 button 本身移除掉，目的是要讓使用者一到這個頁面之後就直接透過 AJAX call api</p>\n<p>到了這裡應該有感應到什麼了吧！接著就是把這個 html 檔的 S3 路徑網址使用 QR code 包起來，讓他看起來像是 LINE bot 的 QR code</p>\n<p>到了這邊基本上已經快完成了，參考 LINE 的<a href=\"https://developers.line.biz/en/docs/messaging-api/using-line-url-scheme/?fbclid=IwAR25G73QmKIGm1l7kPNFzDIpMwBKQRQVxPP8ZpPzp3p-FSES2fnWcVCue_c\" target=\"_blank\" rel=\"noopener\">好友說明</a>或下圖<br><img src=\"https://i.imgur.com/fEEzOsy.png\" alt></p>\n<p>接著到機器人的開發者頁面，並且往下滑會看到自己機器人的 QR code 以及 Bot 的 ID，把他複製下來並製作機器人的加好友網址<br><img src=\"https://i.imgur.com/Mn3RG26.png\" alt></p>\n<p>像是這樣子</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://line.me/R/@1234</span><br></pre></td></tr></table></figure>\n\n<p>接著到 <code>controller/line_login_controller.py</code>的<code>def get(self)</code>最後一行，原本我們這邊做的是回傳 JSON</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> dt:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: dt&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>改用</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> redirect</span><br><span class=\"line\"><span class=\"keyword\">if</span> dt:</span><br><span class=\"line\"> \t\t<span class=\"keyword\">return</span> redirect(<span class=\"string\">\"https://line.me/R/ti/p//@127ojvgz\"</span>, code=<span class=\"number\">302</span>)</span><br></pre></td></tr></table></figure>\n\n<p>如此一來在登入驗證完之後就會把使用者導向到加好友的頁面，在手機上若已經加過好友則會直接導到機器人對話窗上，如此一來就可以讓使用者在加入好友的同時也綁定完帳號，在未來使用的時候 api 這邊也比較好控管使用者的權限問題。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>像是我自己做的健身記錄機器人，就是以這個方法下去實作，有聽過一些朋友跟我反應這樣的方法多此一舉，但我認為若是有網頁的話也是套用 LINE SSO 來實作，就可以讓兩個入口去統一，在狀態流上就能比較好控制了。<br><img src=\"https://i.imgur.com/8fKlsAt.jpg\" alt></p>\n"},{"title":"Day23 - LIFF(LINE Front-end Framework) 簡介","abbrlink":615916051,"date":"2019-10-07T13:01:58.000Z","_content":"\n## 介紹\n\nLIFF (LINE Front-end Framework)顧名思義就是 LINE 開發在 LINE 這個通訊軟體裡面的 Web view(好饒舌)，他是一個很精簡的內建瀏覽器，主要是能夠讓開發者可以使用 HTML & Javascript 可以去處理一些在 bot 不好實現的功能，也讓開發者可以透過使用 JS SDK 去拉使用者的資訊，藉此可以做出更多種的應用。\n\n網址的樣式都像是這樣`line://app/ZZZZZ-AAAAAAA`，透過 deep link 的方法讓 LINE 本身可以認得這個藉此去導向設定對應的網站，畢竟做平台的公司內部要互相溝通也是，就透過這種方法去讓不同部門的工程師可以互相使用好像也是不錯(?)\n\n它也可以搭配在之前做的 LINE 服務上，Notify、Message api 上都可以串上去搭配不同種應用，而這個簡易的 Web view 有下面三種的顯示格式可以使用，開發者可以搭配不同應用場景去做搭配。\n![](https://i.imgur.com/Z1TfxbN.png)\n\n一開始都只能使用 curl 來增加項目，使用方法可以參考[這篇](https://medium.com/@danielkao/%E5%88%9D%E6%8E%A2-line-message-api-%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD-liff-51d5e7ff1a6a)，現在可以直接在 LINE Developer 頁面線上新增，像下圖片在這個頁面就可以新增了\n\n```bash\ncurl -X POST \\\n-H \"Authorization: Bearer YOUR_CHANNEL_TOKEN\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"view\": {\n        \"type\": \"LIFF_SIZE\",\n        \"url\": \"URL_OF_YOUR_APPLICATION\"\n    }\n}' \\\nhttps://api.line.me/liff/v1/apps\n```\n\n![](https://i.imgur.com/t5G9gXh.png)\n\n這邊推薦一個 [kamiliff](https://github.com/etrex/kamiliff)，卡米哥就用一個路由帶著 query string 來判斷，再轉打去其他 controller，如此一來就不需要為了每個頁面去獨立建立 LIFF，如此一來測試跟上線都很好管理，推薦大家去參考卡米哥的 kamiliff 的實作方法～\n\n> 這個功能最大的好處就是可以在 LINE 裡面就可以直接用，若是把使用者導出頁面基本上**轉換率**以及**使用者體驗**一定會變很差，所以若是有在開發 LINE Bot 的話很推薦使用這個。\n\n## 結論\n\n以前我曾嘗試過使用 LIFF 使用 websocket 去跟 MQTT 溝通( IoT 裝置常常使用的通訊格式)，只是他的 websocket 似乎有開，但是總是沒有收到數值，這部分實作也是年初時使用，現在這時候就不知道能不能用了 🤣，若不行就期待哪天他能提供出這個服務了～\n\n## 參考\n\n[LIFF overview](https://developers.line.biz/en/docs/liff/overview/)\n","source":"_posts/Day23-LIFF-LINE-Front-end-Framework-簡介.md","raw":"---\ntitle: Day23 - LIFF(LINE Front-end Framework) 簡介\ntags:\n  - LINE\n  - LIFF\ncategories: 2019鐵人賽\nabbrlink: 615916051\ndate: 2019-10-07 21:01:58\n---\n\n## 介紹\n\nLIFF (LINE Front-end Framework)顧名思義就是 LINE 開發在 LINE 這個通訊軟體裡面的 Web view(好饒舌)，他是一個很精簡的內建瀏覽器，主要是能夠讓開發者可以使用 HTML & Javascript 可以去處理一些在 bot 不好實現的功能，也讓開發者可以透過使用 JS SDK 去拉使用者的資訊，藉此可以做出更多種的應用。\n\n網址的樣式都像是這樣`line://app/ZZZZZ-AAAAAAA`，透過 deep link 的方法讓 LINE 本身可以認得這個藉此去導向設定對應的網站，畢竟做平台的公司內部要互相溝通也是，就透過這種方法去讓不同部門的工程師可以互相使用好像也是不錯(?)\n\n它也可以搭配在之前做的 LINE 服務上，Notify、Message api 上都可以串上去搭配不同種應用，而這個簡易的 Web view 有下面三種的顯示格式可以使用，開發者可以搭配不同應用場景去做搭配。\n![](https://i.imgur.com/Z1TfxbN.png)\n\n一開始都只能使用 curl 來增加項目，使用方法可以參考[這篇](https://medium.com/@danielkao/%E5%88%9D%E6%8E%A2-line-message-api-%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD-liff-51d5e7ff1a6a)，現在可以直接在 LINE Developer 頁面線上新增，像下圖片在這個頁面就可以新增了\n\n```bash\ncurl -X POST \\\n-H \"Authorization: Bearer YOUR_CHANNEL_TOKEN\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"view\": {\n        \"type\": \"LIFF_SIZE\",\n        \"url\": \"URL_OF_YOUR_APPLICATION\"\n    }\n}' \\\nhttps://api.line.me/liff/v1/apps\n```\n\n![](https://i.imgur.com/t5G9gXh.png)\n\n這邊推薦一個 [kamiliff](https://github.com/etrex/kamiliff)，卡米哥就用一個路由帶著 query string 來判斷，再轉打去其他 controller，如此一來就不需要為了每個頁面去獨立建立 LIFF，如此一來測試跟上線都很好管理，推薦大家去參考卡米哥的 kamiliff 的實作方法～\n\n> 這個功能最大的好處就是可以在 LINE 裡面就可以直接用，若是把使用者導出頁面基本上**轉換率**以及**使用者體驗**一定會變很差，所以若是有在開發 LINE Bot 的話很推薦使用這個。\n\n## 結論\n\n以前我曾嘗試過使用 LIFF 使用 websocket 去跟 MQTT 溝通( IoT 裝置常常使用的通訊格式)，只是他的 websocket 似乎有開，但是總是沒有收到數值，這部分實作也是年初時使用，現在這時候就不知道能不能用了 🤣，若不行就期待哪天他能提供出這個服務了～\n\n## 參考\n\n[LIFF overview](https://developers.line.biz/en/docs/liff/overview/)\n","slug":"Day23-LIFF-LINE-Front-end-Framework-簡介","published":1,"updated":"2020-06-19T14:03:58.841Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31js001t7crio2prjrph","content":"<h2 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h2><p>LIFF (LINE Front-end Framework)顧名思義就是 LINE 開發在 LINE 這個通訊軟體裡面的 Web view(好饒舌)，他是一個很精簡的內建瀏覽器，主要是能夠讓開發者可以使用 HTML &amp; Javascript 可以去處理一些在 bot 不好實現的功能，也讓開發者可以透過使用 JS SDK 去拉使用者的資訊，藉此可以做出更多種的應用。</p>\n<p>網址的樣式都像是這樣<code>line://app/ZZZZZ-AAAAAAA</code>，透過 deep link 的方法讓 LINE 本身可以認得這個藉此去導向設定對應的網站，畢竟做平台的公司內部要互相溝通也是，就透過這種方法去讓不同部門的工程師可以互相使用好像也是不錯(?)</p>\n<p>它也可以搭配在之前做的 LINE 服務上，Notify、Message api 上都可以串上去搭配不同種應用，而這個簡易的 Web view 有下面三種的顯示格式可以使用，開發者可以搭配不同應用場景去做搭配。<br><img src=\"https://i.imgur.com/Z1TfxbN.png\" alt></p>\n<p>一開始都只能使用 curl 來增加項目，使用方法可以參考<a href=\"https://medium.com/@danielkao/%E5%88%9D%E6%8E%A2-line-message-api-%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD-liff-51d5e7ff1a6a\" target=\"_blank\" rel=\"noopener\">這篇</a>，現在可以直接在 LINE Developer 頁面線上新增，像下圖片在這個頁面就可以新增了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST \\</span><br><span class=\"line\">-H <span class=\"string\">\"Authorization: Bearer YOUR_CHANNEL_TOKEN\"</span> \\</span><br><span class=\"line\">-H <span class=\"string\">\"Content-Type: application/json\"</span> \\</span><br><span class=\"line\">-d <span class=\"string\">'&#123;</span></span><br><span class=\"line\"><span class=\"string\">    \"view\": &#123;</span></span><br><span class=\"line\"><span class=\"string\">        \"type\": \"LIFF_SIZE\",</span></span><br><span class=\"line\"><span class=\"string\">        \"url\": \"URL_OF_YOUR_APPLICATION\"</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">&#125;'</span> \\</span><br><span class=\"line\">https://api.line.me/liff/v1/apps</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/t5G9gXh.png\" alt></p>\n<p>這邊推薦一個 <a href=\"https://github.com/etrex/kamiliff\" target=\"_blank\" rel=\"noopener\">kamiliff</a>，卡米哥就用一個路由帶著 query string 來判斷，再轉打去其他 controller，如此一來就不需要為了每個頁面去獨立建立 LIFF，如此一來測試跟上線都很好管理，推薦大家去參考卡米哥的 kamiliff 的實作方法～</p>\n<blockquote>\n<p>這個功能最大的好處就是可以在 LINE 裡面就可以直接用，若是把使用者導出頁面基本上<strong>轉換率</strong>以及<strong>使用者體驗</strong>一定會變很差，所以若是有在開發 LINE Bot 的話很推薦使用這個。</p>\n</blockquote>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以前我曾嘗試過使用 LIFF 使用 websocket 去跟 MQTT 溝通( IoT 裝置常常使用的通訊格式)，只是他的 websocket 似乎有開，但是總是沒有收到數值，這部分實作也是年初時使用，現在這時候就不知道能不能用了 🤣，若不行就期待哪天他能提供出這個服務了～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://developers.line.biz/en/docs/liff/overview/\" target=\"_blank\" rel=\"noopener\">LIFF overview</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h2><p>LIFF (LINE Front-end Framework)顧名思義就是 LINE 開發在 LINE 這個通訊軟體裡面的 Web view(好饒舌)，他是一個很精簡的內建瀏覽器，主要是能夠讓開發者可以使用 HTML &amp; Javascript 可以去處理一些在 bot 不好實現的功能，也讓開發者可以透過使用 JS SDK 去拉使用者的資訊，藉此可以做出更多種的應用。</p>\n<p>網址的樣式都像是這樣<code>line://app/ZZZZZ-AAAAAAA</code>，透過 deep link 的方法讓 LINE 本身可以認得這個藉此去導向設定對應的網站，畢竟做平台的公司內部要互相溝通也是，就透過這種方法去讓不同部門的工程師可以互相使用好像也是不錯(?)</p>\n<p>它也可以搭配在之前做的 LINE 服務上，Notify、Message api 上都可以串上去搭配不同種應用，而這個簡易的 Web view 有下面三種的顯示格式可以使用，開發者可以搭配不同應用場景去做搭配。<br><img src=\"https://i.imgur.com/Z1TfxbN.png\" alt></p>\n<p>一開始都只能使用 curl 來增加項目，使用方法可以參考<a href=\"https://medium.com/@danielkao/%E5%88%9D%E6%8E%A2-line-message-api-%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD-liff-51d5e7ff1a6a\" target=\"_blank\" rel=\"noopener\">這篇</a>，現在可以直接在 LINE Developer 頁面線上新增，像下圖片在這個頁面就可以新增了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST \\</span><br><span class=\"line\">-H <span class=\"string\">\"Authorization: Bearer YOUR_CHANNEL_TOKEN\"</span> \\</span><br><span class=\"line\">-H <span class=\"string\">\"Content-Type: application/json\"</span> \\</span><br><span class=\"line\">-d <span class=\"string\">'&#123;</span></span><br><span class=\"line\"><span class=\"string\">    \"view\": &#123;</span></span><br><span class=\"line\"><span class=\"string\">        \"type\": \"LIFF_SIZE\",</span></span><br><span class=\"line\"><span class=\"string\">        \"url\": \"URL_OF_YOUR_APPLICATION\"</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">&#125;'</span> \\</span><br><span class=\"line\">https://api.line.me/liff/v1/apps</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/t5G9gXh.png\" alt></p>\n<p>這邊推薦一個 <a href=\"https://github.com/etrex/kamiliff\" target=\"_blank\" rel=\"noopener\">kamiliff</a>，卡米哥就用一個路由帶著 query string 來判斷，再轉打去其他 controller，如此一來就不需要為了每個頁面去獨立建立 LIFF，如此一來測試跟上線都很好管理，推薦大家去參考卡米哥的 kamiliff 的實作方法～</p>\n<blockquote>\n<p>這個功能最大的好處就是可以在 LINE 裡面就可以直接用，若是把使用者導出頁面基本上<strong>轉換率</strong>以及<strong>使用者體驗</strong>一定會變很差，所以若是有在開發 LINE Bot 的話很推薦使用這個。</p>\n</blockquote>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>以前我曾嘗試過使用 LIFF 使用 websocket 去跟 MQTT 溝通( IoT 裝置常常使用的通訊格式)，只是他的 websocket 似乎有開，但是總是沒有收到數值，這部分實作也是年初時使用，現在這時候就不知道能不能用了 🤣，若不行就期待哪天他能提供出這個服務了～</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://developers.line.biz/en/docs/liff/overview/\" target=\"_blank\" rel=\"noopener\">LIFF overview</a></p>\n"},{"title":"Day24 - 簡單使用 LINE LIFF API","abbrlink":1083757629,"date":"2019-10-08T13:02:58.000Z","_content":"\n## 前言\n\n以下就為大家帶來簡單的實作以及如何去使用它。\n\n## 實作\n\n在`views/`下新增一個`liff_test.html`並加入以下內容\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"\n    />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>Document</title>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n    <script src=\"https://d.line-scdn.net/liff/1.0/sdk.js\"></script>\n    <script>\n      function initializeApp(data) {\n        $(\"#userid\").val(data.context.userId);\n      }\n\n      $(function() {\n        liff.init(function(data) {\n          initializeApp(data);\n        });\n\n        $(\"#ButtonGetProfile\").click(function() {\n          liff.getProfile().then(profile => {\n            $(\"#UserInfo\").val(profile.displayName);\n            alert(\"done\");\n          });\n        });\n\n        $(\"#ButtonSendMsg\").click(function() {\n          liff\n            .sendMessages([\n              {\n                type: \"text\",\n                text: $(\"#msg\").val()\n              }\n            ])\n            .then(() => {\n              alert(\"done\");\n              liff.closeWindow(); // 關掉頁面\n            });\n        });\n      });\n    </script>\n  </head>\n  <body>\n    <button class=\"liff_btn\">Get user profile</button>\n    <label>user id:</label>\n    <input class=\"form-control\" type=\"text\" id=\"userid\" /> <br />\n    <button class=\"btn btn-primary\" id=\"ButtonGetProfile\">Get Profile</button>\n    <input class=\"form-control\" type=\"text\" id=\"UserInfo\" /><br />\n    <label>要傳送的訊息:</label>\n    <input class=\"form-control\" type=\"text\" id=\"msg\" value=\"測試\" /><br />\n    <button class=\"btn btn-primary\" id=\"ButtonSendMsg\">要傳送的訊息</button>\n  </body>\n</html>\n```\n\n> 以上參考來自[董老師的部落格](http://studyhost.blogspot.com/2018/06/linebot23-line-liff-app.html)\n\n> 詳細的 LIFF API 文件可以[參考](https://developers.line.biz/en/reference/liff/)\n\n接下來按著之前做過的一樣把這個檔案送到`S3`裡，接著它的網址複製起來\n![](https://i.imgur.com/wgVJ9js.png)\n\n接著來去之前建立機器人的開發者頁面裡按下最右邊的`LIFF`\n![](https://i.imgur.com/B593Hdt.png)\n按下去之後呢，再來按下`add`\n![](https://i.imgur.com/5dNr9G7.png)\n跑出這個頁面後，`Name`好辨認為主、`Size`選擇滿版(Full)、`Endpoint URL`就把剛剛複製起來的 S3 網址放進去後按`Confirm`\n![](https://i.imgur.com/NQD9Mwv.png)\n大概內容會長得像這樣\n![](https://i.imgur.com/WoTYxpv.png)\n建立成功後往下滑會看到 LINE 給你一個屬於他們的網址，接著可以把它貼到你的機器人上(或者任何聊天室)\n![](https://i.imgur.com/wN69WDJ.png)\n點下去之後就會看到來自 LIFF 的 Webview 囉！\n![](https://i.imgur.com/aYztzUi.jpg)\n接下來就可以開始玩裡面的功能了 🤣\n\n## 結論\n\nLIFF 整合的功能讓開發者在 Bot 裡不好實現的功能透過 Webview 的方式讓使用者可以到頁面上做邏輯處理，透過兩種的結合讓整體的應用就有更多的變化，這邊若要給使用者個話就把 `line://xxxoxx` 製作成 flex message 或者乾脆傳給使用者，引導他點選，如此就能讓使用者到自己設計的頁面上了。\n\n這邊額外補充一點，有看到程式碼裡面可以拉到`Query string`嗎？事實上可以透過`Query string`讓使用者帶些參數來做更多的判斷，像是卡米哥做的[Kamiliff](https://github.com/etrex/kamiliff)就是讓使用者在點選後判斷這個 LIFF 的 Size，在導去對應的路由去做處理，這樣子使用者在建立 LIFF 的時候就不用一個頁面弄一個，否則這樣在 dev 轉 prod 的時候應該會弄到很生氣 🤣。\n","source":"_posts/Day24-簡單使用-LINE-LIFF-API.md","raw":"---\ntitle: Day24 - 簡單使用 LINE LIFF API\ntags:\n  - LINE\n  - LIFF\n  - webview\ncategories: 2019鐵人賽\nabbrlink: 1083757629\ndate: 2019-10-08 21:02:58\n---\n\n## 前言\n\n以下就為大家帶來簡單的實作以及如何去使用它。\n\n## 實作\n\n在`views/`下新增一個`liff_test.html`並加入以下內容\n\n```html\n<html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"\n    />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>Document</title>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n    <script src=\"https://d.line-scdn.net/liff/1.0/sdk.js\"></script>\n    <script>\n      function initializeApp(data) {\n        $(\"#userid\").val(data.context.userId);\n      }\n\n      $(function() {\n        liff.init(function(data) {\n          initializeApp(data);\n        });\n\n        $(\"#ButtonGetProfile\").click(function() {\n          liff.getProfile().then(profile => {\n            $(\"#UserInfo\").val(profile.displayName);\n            alert(\"done\");\n          });\n        });\n\n        $(\"#ButtonSendMsg\").click(function() {\n          liff\n            .sendMessages([\n              {\n                type: \"text\",\n                text: $(\"#msg\").val()\n              }\n            ])\n            .then(() => {\n              alert(\"done\");\n              liff.closeWindow(); // 關掉頁面\n            });\n        });\n      });\n    </script>\n  </head>\n  <body>\n    <button class=\"liff_btn\">Get user profile</button>\n    <label>user id:</label>\n    <input class=\"form-control\" type=\"text\" id=\"userid\" /> <br />\n    <button class=\"btn btn-primary\" id=\"ButtonGetProfile\">Get Profile</button>\n    <input class=\"form-control\" type=\"text\" id=\"UserInfo\" /><br />\n    <label>要傳送的訊息:</label>\n    <input class=\"form-control\" type=\"text\" id=\"msg\" value=\"測試\" /><br />\n    <button class=\"btn btn-primary\" id=\"ButtonSendMsg\">要傳送的訊息</button>\n  </body>\n</html>\n```\n\n> 以上參考來自[董老師的部落格](http://studyhost.blogspot.com/2018/06/linebot23-line-liff-app.html)\n\n> 詳細的 LIFF API 文件可以[參考](https://developers.line.biz/en/reference/liff/)\n\n接下來按著之前做過的一樣把這個檔案送到`S3`裡，接著它的網址複製起來\n![](https://i.imgur.com/wgVJ9js.png)\n\n接著來去之前建立機器人的開發者頁面裡按下最右邊的`LIFF`\n![](https://i.imgur.com/B593Hdt.png)\n按下去之後呢，再來按下`add`\n![](https://i.imgur.com/5dNr9G7.png)\n跑出這個頁面後，`Name`好辨認為主、`Size`選擇滿版(Full)、`Endpoint URL`就把剛剛複製起來的 S3 網址放進去後按`Confirm`\n![](https://i.imgur.com/NQD9Mwv.png)\n大概內容會長得像這樣\n![](https://i.imgur.com/WoTYxpv.png)\n建立成功後往下滑會看到 LINE 給你一個屬於他們的網址，接著可以把它貼到你的機器人上(或者任何聊天室)\n![](https://i.imgur.com/wN69WDJ.png)\n點下去之後就會看到來自 LIFF 的 Webview 囉！\n![](https://i.imgur.com/aYztzUi.jpg)\n接下來就可以開始玩裡面的功能了 🤣\n\n## 結論\n\nLIFF 整合的功能讓開發者在 Bot 裡不好實現的功能透過 Webview 的方式讓使用者可以到頁面上做邏輯處理，透過兩種的結合讓整體的應用就有更多的變化，這邊若要給使用者個話就把 `line://xxxoxx` 製作成 flex message 或者乾脆傳給使用者，引導他點選，如此就能讓使用者到自己設計的頁面上了。\n\n這邊額外補充一點，有看到程式碼裡面可以拉到`Query string`嗎？事實上可以透過`Query string`讓使用者帶些參數來做更多的判斷，像是卡米哥做的[Kamiliff](https://github.com/etrex/kamiliff)就是讓使用者在點選後判斷這個 LIFF 的 Size，在導去對應的路由去做處理，這樣子使用者在建立 LIFF 的時候就不用一個頁面弄一個，否則這樣在 dev 轉 prod 的時候應該會弄到很生氣 🤣。\n","slug":"Day24-簡單使用-LINE-LIFF-API","published":1,"updated":"2020-06-19T14:03:58.843Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jv001x7crijeputllf","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>以下就為大家帶來簡單的實作以及如何去使用它。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>在<code>views/</code>下新增一個<code>liff_test.html</code>並加入以下內容</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://d.line-scdn.net/liff/1.0/sdk.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">      <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">initializeApp</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#userid\"</span>).val(data.context.userId);</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">      $(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">        liff.init(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\">          initializeApp(data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#ButtonGetProfile\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">          liff.getProfile().then(<span class=\"function\"><span class=\"params\">profile</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            $(<span class=\"string\">\"#UserInfo\"</span>).val(profile.displayName);</span></span><br><span class=\"line\"><span class=\"actionscript\">            alert(<span class=\"string\">\"done\"</span>);</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#ButtonSendMsg\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">          liff</span><br><span class=\"line\">            .sendMessages([</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\"><span class=\"actionscript\">                type: <span class=\"string\">\"text\"</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">                text: $(<span class=\"string\">\"#msg\"</span>).val()</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ])</span><br><span class=\"line\"><span class=\"javascript\">            .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">              alert(<span class=\"string\">\"done\"</span>);</span></span><br><span class=\"line\"><span class=\"actionscript\">              liff.closeWindow(); <span class=\"comment\">// 關掉頁面</span></span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"liff_btn\"</span>&gt;</span>Get user profile<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>user id:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userid\"</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"ButtonGetProfile\"</span>&gt;</span>Get Profile<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"UserInfo\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>要傳送的訊息:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"msg\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"測試\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"ButtonSendMsg\"</span>&gt;</span>要傳送的訊息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>以上參考來自<a href=\"http://studyhost.blogspot.com/2018/06/linebot23-line-liff-app.html\" target=\"_blank\" rel=\"noopener\">董老師的部落格</a></p>\n</blockquote>\n<blockquote>\n<p>詳細的 LIFF API 文件可以<a href=\"https://developers.line.biz/en/reference/liff/\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<p>接下來按著之前做過的一樣把這個檔案送到<code>S3</code>裡，接著它的網址複製起來<br><img src=\"https://i.imgur.com/wgVJ9js.png\" alt></p>\n<p>接著來去之前建立機器人的開發者頁面裡按下最右邊的<code>LIFF</code><br><img src=\"https://i.imgur.com/B593Hdt.png\" alt><br>按下去之後呢，再來按下<code>add</code><br><img src=\"https://i.imgur.com/5dNr9G7.png\" alt><br>跑出這個頁面後，<code>Name</code>好辨認為主、<code>Size</code>選擇滿版(Full)、<code>Endpoint URL</code>就把剛剛複製起來的 S3 網址放進去後按<code>Confirm</code><br><img src=\"https://i.imgur.com/NQD9Mwv.png\" alt><br>大概內容會長得像這樣<br><img src=\"https://i.imgur.com/WoTYxpv.png\" alt><br>建立成功後往下滑會看到 LINE 給你一個屬於他們的網址，接著可以把它貼到你的機器人上(或者任何聊天室)<br><img src=\"https://i.imgur.com/wN69WDJ.png\" alt><br>點下去之後就會看到來自 LIFF 的 Webview 囉！<br><img src=\"https://i.imgur.com/aYztzUi.jpg\" alt><br>接下來就可以開始玩裡面的功能了 🤣</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>LIFF 整合的功能讓開發者在 Bot 裡不好實現的功能透過 Webview 的方式讓使用者可以到頁面上做邏輯處理，透過兩種的結合讓整體的應用就有更多的變化，這邊若要給使用者個話就把 <code>line://xxxoxx</code> 製作成 flex message 或者乾脆傳給使用者，引導他點選，如此就能讓使用者到自己設計的頁面上了。</p>\n<p>這邊額外補充一點，有看到程式碼裡面可以拉到<code>Query string</code>嗎？事實上可以透過<code>Query string</code>讓使用者帶些參數來做更多的判斷，像是卡米哥做的<a href=\"https://github.com/etrex/kamiliff\" target=\"_blank\" rel=\"noopener\">Kamiliff</a>就是讓使用者在點選後判斷這個 LIFF 的 Size，在導去對應的路由去做處理，這樣子使用者在建立 LIFF 的時候就不用一個頁面弄一個，否則這樣在 dev 轉 prod 的時候應該會弄到很生氣 🤣。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>以下就為大家帶來簡單的實作以及如何去使用它。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>在<code>views/</code>下新增一個<code>liff_test.html</code>並加入以下內容</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"ie=edge\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://d.line-scdn.net/liff/1.0/sdk.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">      <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">initializeApp</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#userid\"</span>).val(data.context.userId);</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">      $(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">        liff.init(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>&#123;</span></span><br><span class=\"line\">          initializeApp(data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#ButtonGetProfile\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">          liff.getProfile().then(<span class=\"function\"><span class=\"params\">profile</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            $(<span class=\"string\">\"#UserInfo\"</span>).val(profile.displayName);</span></span><br><span class=\"line\"><span class=\"actionscript\">            alert(<span class=\"string\">\"done\"</span>);</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        $(<span class=\"string\">\"#ButtonSendMsg\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">          liff</span><br><span class=\"line\">            .sendMessages([</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\"><span class=\"actionscript\">                type: <span class=\"string\">\"text\"</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">                text: $(<span class=\"string\">\"#msg\"</span>).val()</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ])</span><br><span class=\"line\"><span class=\"javascript\">            .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">              alert(<span class=\"string\">\"done\"</span>);</span></span><br><span class=\"line\"><span class=\"actionscript\">              liff.closeWindow(); <span class=\"comment\">// 關掉頁面</span></span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"liff_btn\"</span>&gt;</span>Get user profile<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>user id:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userid\"</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"ButtonGetProfile\"</span>&gt;</span>Get Profile<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"UserInfo\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>要傳送的訊息:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"msg\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"測試\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"ButtonSendMsg\"</span>&gt;</span>要傳送的訊息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>以上參考來自<a href=\"http://studyhost.blogspot.com/2018/06/linebot23-line-liff-app.html\" target=\"_blank\" rel=\"noopener\">董老師的部落格</a></p>\n</blockquote>\n<blockquote>\n<p>詳細的 LIFF API 文件可以<a href=\"https://developers.line.biz/en/reference/liff/\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<p>接下來按著之前做過的一樣把這個檔案送到<code>S3</code>裡，接著它的網址複製起來<br><img src=\"https://i.imgur.com/wgVJ9js.png\" alt></p>\n<p>接著來去之前建立機器人的開發者頁面裡按下最右邊的<code>LIFF</code><br><img src=\"https://i.imgur.com/B593Hdt.png\" alt><br>按下去之後呢，再來按下<code>add</code><br><img src=\"https://i.imgur.com/5dNr9G7.png\" alt><br>跑出這個頁面後，<code>Name</code>好辨認為主、<code>Size</code>選擇滿版(Full)、<code>Endpoint URL</code>就把剛剛複製起來的 S3 網址放進去後按<code>Confirm</code><br><img src=\"https://i.imgur.com/NQD9Mwv.png\" alt><br>大概內容會長得像這樣<br><img src=\"https://i.imgur.com/WoTYxpv.png\" alt><br>建立成功後往下滑會看到 LINE 給你一個屬於他們的網址，接著可以把它貼到你的機器人上(或者任何聊天室)<br><img src=\"https://i.imgur.com/wN69WDJ.png\" alt><br>點下去之後就會看到來自 LIFF 的 Webview 囉！<br><img src=\"https://i.imgur.com/aYztzUi.jpg\" alt><br>接下來就可以開始玩裡面的功能了 🤣</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>LIFF 整合的功能讓開發者在 Bot 裡不好實現的功能透過 Webview 的方式讓使用者可以到頁面上做邏輯處理，透過兩種的結合讓整體的應用就有更多的變化，這邊若要給使用者個話就把 <code>line://xxxoxx</code> 製作成 flex message 或者乾脆傳給使用者，引導他點選，如此就能讓使用者到自己設計的頁面上了。</p>\n<p>這邊額外補充一點，有看到程式碼裡面可以拉到<code>Query string</code>嗎？事實上可以透過<code>Query string</code>讓使用者帶些參數來做更多的判斷，像是卡米哥做的<a href=\"https://github.com/etrex/kamiliff\" target=\"_blank\" rel=\"noopener\">Kamiliff</a>就是讓使用者在點選後判斷這個 LIFF 的 Size，在導去對應的路由去做處理，這樣子使用者在建立 LIFF 的時候就不用一個頁面弄一個，否則這樣在 dev 轉 prod 的時候應該會弄到很生氣 🤣。</p>\n"},{"title":"Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧","abbrlink":298345294,"date":"2019-10-09T13:04:36.000Z","_content":"\n## 前言\n\n本篇會介紹 npm 套件庫裡的 [Serverless-plugin-warmup](https://www.npmjs.com/package/serverless-plugin-warmup)，裡面介紹了很多參數可以使用，以下會簡介如何引入它。\n\n## 實作\n\n透過`npm`來安裝套件\n\n```bash\nnpm install --save-dev serverless-plugin-warmup\n```\n\n在`serverless.yml`的`plugin`加入套件\n\n```yaml\nplugins:\n  - serverless-plugin-warmup\n```\n\n在`custom`加入`warm up`的設定參數\n\n```yaml\ncustom:\n  warmup:\n    enabled: true\n    cleanFolder: false\n    memorySize: 128\n    name: \"LINE-warmup-pop\"\n    events:\n      - schedule: \"cron(0/5 0-12 ? * MON-FRI *)\"\n    timeout: 10\n```\n\n`.gitignore`加入以下兩個`_warmup/`以及`.requirements.zip`，他在部署前建立一個`_warp`的資料夾並放一個 Lambda 來打已建立的 api 以及 Lambda 們，部署後會建立`.requirements.zip`，所以這邊就加入這兩行來防止被 git 推上去。\n\n> 或許會有疑問不是`cleanFolder`設定 true 就可以，這邊我自己實測時在部署會因為 Size 過大而無法上傳，把這參數設定掉他才會乖乖的上傳成功，但這部分有待驗證。\n\n## 加入 decorator\n\n這邊我在`lib/`下新增一個`decorator.py`，加入以下的 code\n\n```python\nfrom functools import wraps\nfrom logging import Logger\n\ndef lambda_warm_up(func):\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        source = args[0].get('source')\n        if (source == 'serverless-plugin-warmup'):\n            Logger.info('WarmUp - Lambda is warm!')\n            return {}\n        return func(*args, **kwargs)\n    return wrapper\n```\n\n主要功能是透過 python decorator 的特性讓我們在 function 之前用個前綴符號就可以引用它，很像 po 文在 tag 別人一樣 🤣\nwarm-up 建立的 Lambda 會固定對其他的 Lambda 打`serverless-plugin-warmup`的字串，這邊就寫個判斷式判斷掉後直接 return\n\n你以為這樣就結束了？還有 IAM role 的問題呢，詳細問題已不可考，想試看看的可以把 IAM 拔掉再部署一次，問題就會出現了，以下為設定檔：\n\n```yaml\niamRoleStatements:\n  - Effect: \"Allow\"\n    Action:\n      - \"lambda:InvokeFunction\"\n    Resource:\n      - Fn::Join:\n          - \":\"\n          - - arn:aws:lambda\n            - Ref: AWS::Region\n            - Ref: AWS::AccountId\n            - function:*\n```\n\n如果你的目錄結構跟我一樣，或是跟到今天的實作，加入以下的 code，這邊主要是告訴你的 Lambda 要在每次的 warm-up 字串來的時候呼叫這個 decorator 來幫忙處理一下\n\n```python\nfrom lib.decorator import lambda_warm_up\n\n@lambda_warm_up\ndef xxx():\n    pass\n```\n\n我的 Lambda 都加了，那原本的 flask 建立的 api 我要加在哪？\n\n看看這個[網址](https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87)，serverless-wsgi 在實作的時候已經有考慮到這件事了，所以 api 這邊就不用管他，他自己會去把它處理掉！\n![](https://i.imgur.com/skMkdmg.png)\n\n## 結論\n\nWarm-up 的機制就是透過建立一個 Lambda 來打一個 flag 到其他 Lambda 來他們別進入睡眠模式，但總是會有人考慮費用的問題，可以參考下圖，若是你建立了一個簡單的服務然後上線了，AWS 給你了一百萬個請求的量，我覺得一個月的請求可以到 100 萬應該是服務有點規模的情況，一個月能到這個量相信你也有一定的能力養它 🤣，爾後每一百萬個請求才六塊台幣，可能比 GCP 還貴，但其實以我來說這樣已經很夠用，而且還扛得住\n![](https://i.imgur.com/LCJh98n.png)\n\n## 參考\n\n[serverless-wsgi Warm-up code](https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87)\n[Serverless-plugin-warmup](https://www.npmjs.com/package/serverless-plugin-warmup)\n","source":"_posts/Day25-Lambda-好像有時候一開始回應很久？用-warm-up-來熱機吧.md","raw":"---\ntitle: Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧\ntags:\n  - Serverless\n  - warm-up\n  - Lambda\ncategories: 2019鐵人賽\nabbrlink: 298345294\ndate: 2019-10-09 21:04:36\n---\n\n## 前言\n\n本篇會介紹 npm 套件庫裡的 [Serverless-plugin-warmup](https://www.npmjs.com/package/serverless-plugin-warmup)，裡面介紹了很多參數可以使用，以下會簡介如何引入它。\n\n## 實作\n\n透過`npm`來安裝套件\n\n```bash\nnpm install --save-dev serverless-plugin-warmup\n```\n\n在`serverless.yml`的`plugin`加入套件\n\n```yaml\nplugins:\n  - serverless-plugin-warmup\n```\n\n在`custom`加入`warm up`的設定參數\n\n```yaml\ncustom:\n  warmup:\n    enabled: true\n    cleanFolder: false\n    memorySize: 128\n    name: \"LINE-warmup-pop\"\n    events:\n      - schedule: \"cron(0/5 0-12 ? * MON-FRI *)\"\n    timeout: 10\n```\n\n`.gitignore`加入以下兩個`_warmup/`以及`.requirements.zip`，他在部署前建立一個`_warp`的資料夾並放一個 Lambda 來打已建立的 api 以及 Lambda 們，部署後會建立`.requirements.zip`，所以這邊就加入這兩行來防止被 git 推上去。\n\n> 或許會有疑問不是`cleanFolder`設定 true 就可以，這邊我自己實測時在部署會因為 Size 過大而無法上傳，把這參數設定掉他才會乖乖的上傳成功，但這部分有待驗證。\n\n## 加入 decorator\n\n這邊我在`lib/`下新增一個`decorator.py`，加入以下的 code\n\n```python\nfrom functools import wraps\nfrom logging import Logger\n\ndef lambda_warm_up(func):\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        source = args[0].get('source')\n        if (source == 'serverless-plugin-warmup'):\n            Logger.info('WarmUp - Lambda is warm!')\n            return {}\n        return func(*args, **kwargs)\n    return wrapper\n```\n\n主要功能是透過 python decorator 的特性讓我們在 function 之前用個前綴符號就可以引用它，很像 po 文在 tag 別人一樣 🤣\nwarm-up 建立的 Lambda 會固定對其他的 Lambda 打`serverless-plugin-warmup`的字串，這邊就寫個判斷式判斷掉後直接 return\n\n你以為這樣就結束了？還有 IAM role 的問題呢，詳細問題已不可考，想試看看的可以把 IAM 拔掉再部署一次，問題就會出現了，以下為設定檔：\n\n```yaml\niamRoleStatements:\n  - Effect: \"Allow\"\n    Action:\n      - \"lambda:InvokeFunction\"\n    Resource:\n      - Fn::Join:\n          - \":\"\n          - - arn:aws:lambda\n            - Ref: AWS::Region\n            - Ref: AWS::AccountId\n            - function:*\n```\n\n如果你的目錄結構跟我一樣，或是跟到今天的實作，加入以下的 code，這邊主要是告訴你的 Lambda 要在每次的 warm-up 字串來的時候呼叫這個 decorator 來幫忙處理一下\n\n```python\nfrom lib.decorator import lambda_warm_up\n\n@lambda_warm_up\ndef xxx():\n    pass\n```\n\n我的 Lambda 都加了，那原本的 flask 建立的 api 我要加在哪？\n\n看看這個[網址](https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87)，serverless-wsgi 在實作的時候已經有考慮到這件事了，所以 api 這邊就不用管他，他自己會去把它處理掉！\n![](https://i.imgur.com/skMkdmg.png)\n\n## 結論\n\nWarm-up 的機制就是透過建立一個 Lambda 來打一個 flag 到其他 Lambda 來他們別進入睡眠模式，但總是會有人考慮費用的問題，可以參考下圖，若是你建立了一個簡單的服務然後上線了，AWS 給你了一百萬個請求的量，我覺得一個月的請求可以到 100 萬應該是服務有點規模的情況，一個月能到這個量相信你也有一定的能力養它 🤣，爾後每一百萬個請求才六塊台幣，可能比 GCP 還貴，但其實以我來說這樣已經很夠用，而且還扛得住\n![](https://i.imgur.com/LCJh98n.png)\n\n## 參考\n\n[serverless-wsgi Warm-up code](https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87)\n[Serverless-plugin-warmup](https://www.npmjs.com/package/serverless-plugin-warmup)\n","slug":"Day25-Lambda-好像有時候一開始回應很久？用-warm-up-來熱機吧","published":1,"updated":"2020-06-19T14:03:58.842Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jw00217criqksancbr","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本篇會介紹 npm 套件庫裡的 <a href=\"https://www.npmjs.com/package/serverless-plugin-warmup\" target=\"_blank\" rel=\"noopener\">Serverless-plugin-warmup</a>，裡面介紹了很多參數可以使用，以下會簡介如何引入它。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>透過<code>npm</code>來安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev serverless-plugin-warmup</span><br></pre></td></tr></table></figure>\n\n<p>在<code>serverless.yml</code>的<code>plugin</code>加入套件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-plugin-warmup</span></span><br></pre></td></tr></table></figure>\n\n<p>在<code>custom</code>加入<code>warm up</code>的設定參數</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  warmup:</span></span><br><span class=\"line\"><span class=\"attr\">    enabled:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    cleanFolder:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    memorySize:</span> <span class=\"number\">128</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">\"LINE-warmup-pop\"</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - schedule:</span> <span class=\"string\">\"cron(0/5 0-12 ? * MON-FRI *)\"</span></span><br><span class=\"line\"><span class=\"attr\">    timeout:</span> <span class=\"number\">10</span></span><br></pre></td></tr></table></figure>\n\n<p><code>.gitignore</code>加入以下兩個<code>_warmup/</code>以及<code>.requirements.zip</code>，他在部署前建立一個<code>_warp</code>的資料夾並放一個 Lambda 來打已建立的 api 以及 Lambda 們，部署後會建立<code>.requirements.zip</code>，所以這邊就加入這兩行來防止被 git 推上去。</p>\n<blockquote>\n<p>或許會有疑問不是<code>cleanFolder</code>設定 true 就可以，這邊我自己實測時在部署會因為 Size 過大而無法上傳，把這參數設定掉他才會乖乖的上傳成功，但這部分有待驗證。</p>\n</blockquote>\n<h2 id=\"加入-decorator\"><a href=\"#加入-decorator\" class=\"headerlink\" title=\"加入 decorator\"></a>加入 decorator</h2><p>這邊我在<code>lib/</code>下新增一個<code>decorator.py</code>，加入以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"><span class=\"keyword\">from</span> logging <span class=\"keyword\">import</span> Logger</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">lambda_warm_up</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">    @wraps(func)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrapper</span><span class=\"params\">(*args, **kwargs)</span>:</span></span><br><span class=\"line\">        source = args[<span class=\"number\">0</span>].get(<span class=\"string\">'source'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (source == <span class=\"string\">'serverless-plugin-warmup'</span>):</span><br><span class=\"line\">            Logger.info(<span class=\"string\">'WarmUp - Lambda is warm!'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> func(*args, **kwargs)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrapper</span><br></pre></td></tr></table></figure>\n\n<p>主要功能是透過 python decorator 的特性讓我們在 function 之前用個前綴符號就可以引用它，很像 po 文在 tag 別人一樣 🤣<br>warm-up 建立的 Lambda 會固定對其他的 Lambda 打<code>serverless-plugin-warmup</code>的字串，這邊就寫個判斷式判斷掉後直接 return</p>\n<p>你以為這樣就結束了？還有 IAM role 的問題呢，詳細問題已不可考，想試看看的可以把 IAM 拔掉再部署一次，問題就會出現了，以下為設定檔：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">iamRoleStatements:</span></span><br><span class=\"line\"><span class=\"attr\">  - Effect:</span> <span class=\"string\">\"Allow\"</span></span><br><span class=\"line\"><span class=\"attr\">    Action:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">\"lambda:InvokeFunction\"</span></span><br><span class=\"line\"><span class=\"attr\">    Resource:</span></span><br><span class=\"line\"><span class=\"attr\">      - Fn:</span><span class=\"string\">:Join:</span></span><br><span class=\"line\"><span class=\"bullet\">          -</span> <span class=\"string\">\":\"</span></span><br><span class=\"line\"><span class=\"attr\">          - - arn:</span><span class=\"attr\">aws:lambda</span></span><br><span class=\"line\"><span class=\"attr\">            - Ref:</span> <span class=\"attr\">AWS::Region</span></span><br><span class=\"line\"><span class=\"attr\">            - Ref:</span> <span class=\"attr\">AWS::AccountId</span></span><br><span class=\"line\"><span class=\"attr\">            - function:</span><span class=\"string\">*</span></span><br></pre></td></tr></table></figure>\n\n<p>如果你的目錄結構跟我一樣，或是跟到今天的實作，加入以下的 code，這邊主要是告訴你的 Lambda 要在每次的 warm-up 字串來的時候呼叫這個 decorator 來幫忙處理一下</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> lib.decorator <span class=\"keyword\">import</span> lambda_warm_up</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@lambda_warm_up</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n\n<p>我的 Lambda 都加了，那原本的 flask 建立的 api 我要加在哪？</p>\n<p>看看這個<a href=\"https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87\" target=\"_blank\" rel=\"noopener\">網址</a>，serverless-wsgi 在實作的時候已經有考慮到這件事了，所以 api 這邊就不用管他，他自己會去把它處理掉！<br><img src=\"https://i.imgur.com/skMkdmg.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>Warm-up 的機制就是透過建立一個 Lambda 來打一個 flag 到其他 Lambda 來他們別進入睡眠模式，但總是會有人考慮費用的問題，可以參考下圖，若是你建立了一個簡單的服務然後上線了，AWS 給你了一百萬個請求的量，我覺得一個月的請求可以到 100 萬應該是服務有點規模的情況，一個月能到這個量相信你也有一定的能力養它 🤣，爾後每一百萬個請求才六塊台幣，可能比 GCP 還貴，但其實以我來說這樣已經很夠用，而且還扛得住<br><img src=\"https://i.imgur.com/LCJh98n.png\" alt></p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87\" target=\"_blank\" rel=\"noopener\">serverless-wsgi Warm-up code</a><br><a href=\"https://www.npmjs.com/package/serverless-plugin-warmup\" target=\"_blank\" rel=\"noopener\">Serverless-plugin-warmup</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本篇會介紹 npm 套件庫裡的 <a href=\"https://www.npmjs.com/package/serverless-plugin-warmup\" target=\"_blank\" rel=\"noopener\">Serverless-plugin-warmup</a>，裡面介紹了很多參數可以使用，以下會簡介如何引入它。</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>透過<code>npm</code>來安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev serverless-plugin-warmup</span><br></pre></td></tr></table></figure>\n\n<p>在<code>serverless.yml</code>的<code>plugin</code>加入套件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-plugin-warmup</span></span><br></pre></td></tr></table></figure>\n\n<p>在<code>custom</code>加入<code>warm up</code>的設定參數</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  warmup:</span></span><br><span class=\"line\"><span class=\"attr\">    enabled:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    cleanFolder:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    memorySize:</span> <span class=\"number\">128</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">\"LINE-warmup-pop\"</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - schedule:</span> <span class=\"string\">\"cron(0/5 0-12 ? * MON-FRI *)\"</span></span><br><span class=\"line\"><span class=\"attr\">    timeout:</span> <span class=\"number\">10</span></span><br></pre></td></tr></table></figure>\n\n<p><code>.gitignore</code>加入以下兩個<code>_warmup/</code>以及<code>.requirements.zip</code>，他在部署前建立一個<code>_warp</code>的資料夾並放一個 Lambda 來打已建立的 api 以及 Lambda 們，部署後會建立<code>.requirements.zip</code>，所以這邊就加入這兩行來防止被 git 推上去。</p>\n<blockquote>\n<p>或許會有疑問不是<code>cleanFolder</code>設定 true 就可以，這邊我自己實測時在部署會因為 Size 過大而無法上傳，把這參數設定掉他才會乖乖的上傳成功，但這部分有待驗證。</p>\n</blockquote>\n<h2 id=\"加入-decorator\"><a href=\"#加入-decorator\" class=\"headerlink\" title=\"加入 decorator\"></a>加入 decorator</h2><p>這邊我在<code>lib/</code>下新增一個<code>decorator.py</code>，加入以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"><span class=\"keyword\">from</span> logging <span class=\"keyword\">import</span> Logger</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">lambda_warm_up</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">    @wraps(func)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrapper</span><span class=\"params\">(*args, **kwargs)</span>:</span></span><br><span class=\"line\">        source = args[<span class=\"number\">0</span>].get(<span class=\"string\">'source'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (source == <span class=\"string\">'serverless-plugin-warmup'</span>):</span><br><span class=\"line\">            Logger.info(<span class=\"string\">'WarmUp - Lambda is warm!'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> func(*args, **kwargs)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrapper</span><br></pre></td></tr></table></figure>\n\n<p>主要功能是透過 python decorator 的特性讓我們在 function 之前用個前綴符號就可以引用它，很像 po 文在 tag 別人一樣 🤣<br>warm-up 建立的 Lambda 會固定對其他的 Lambda 打<code>serverless-plugin-warmup</code>的字串，這邊就寫個判斷式判斷掉後直接 return</p>\n<p>你以為這樣就結束了？還有 IAM role 的問題呢，詳細問題已不可考，想試看看的可以把 IAM 拔掉再部署一次，問題就會出現了，以下為設定檔：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">iamRoleStatements:</span></span><br><span class=\"line\"><span class=\"attr\">  - Effect:</span> <span class=\"string\">\"Allow\"</span></span><br><span class=\"line\"><span class=\"attr\">    Action:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">\"lambda:InvokeFunction\"</span></span><br><span class=\"line\"><span class=\"attr\">    Resource:</span></span><br><span class=\"line\"><span class=\"attr\">      - Fn:</span><span class=\"string\">:Join:</span></span><br><span class=\"line\"><span class=\"bullet\">          -</span> <span class=\"string\">\":\"</span></span><br><span class=\"line\"><span class=\"attr\">          - - arn:</span><span class=\"attr\">aws:lambda</span></span><br><span class=\"line\"><span class=\"attr\">            - Ref:</span> <span class=\"attr\">AWS::Region</span></span><br><span class=\"line\"><span class=\"attr\">            - Ref:</span> <span class=\"attr\">AWS::AccountId</span></span><br><span class=\"line\"><span class=\"attr\">            - function:</span><span class=\"string\">*</span></span><br></pre></td></tr></table></figure>\n\n<p>如果你的目錄結構跟我一樣，或是跟到今天的實作，加入以下的 code，這邊主要是告訴你的 Lambda 要在每次的 warm-up 字串來的時候呼叫這個 decorator 來幫忙處理一下</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> lib.decorator <span class=\"keyword\">import</span> lambda_warm_up</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@lambda_warm_up</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n\n<p>我的 Lambda 都加了，那原本的 flask 建立的 api 我要加在哪？</p>\n<p>看看這個<a href=\"https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87\" target=\"_blank\" rel=\"noopener\">網址</a>，serverless-wsgi 在實作的時候已經有考慮到這件事了，所以 api 這邊就不用管他，他自己會去把它處理掉！<br><img src=\"https://i.imgur.com/skMkdmg.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>Warm-up 的機制就是透過建立一個 Lambda 來打一個 flag 到其他 Lambda 來他們別進入睡眠模式，但總是會有人考慮費用的問題，可以參考下圖，若是你建立了一個簡單的服務然後上線了，AWS 給你了一百萬個請求的量，我覺得一個月的請求可以到 100 萬應該是服務有點規模的情況，一個月能到這個量相信你也有一定的能力養它 🤣，爾後每一百萬個請求才六塊台幣，可能比 GCP 還貴，但其實以我來說這樣已經很夠用，而且還扛得住<br><img src=\"https://i.imgur.com/LCJh98n.png\" alt></p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87\" target=\"_blank\" rel=\"noopener\">serverless-wsgi Warm-up code</a><br><a href=\"https://www.npmjs.com/package/serverless-plugin-warmup\" target=\"_blank\" rel=\"noopener\">Serverless-plugin-warmup</a></p>\n"},{"title":"Day26 - Use CDN (1) - 建立 Certificate 與 Domain","abbrlink":2081624252,"date":"2019-10-10T13:05:23.000Z","_content":"\n## 簡介\n\n繼上一篇 warm-up 機制之後來了解一下如何使用 AWS 的 CDN 服務 - cloudfont，CDN 顧名思義就是要讓使用者可以到最接近的主機上去拉到對應的資料，透過撒點的方式讓主機去挑選離自己近的服務據點，藉此加速服務。\n\n像我之前部署在 ohio，想想光網路的時間 + Cold start 的時間就已經去了一大半，即便我們有熱開機，服務沒有 Timeout 我該慶幸了，既然如此就不得不認識一下 CDN 服務，而 AWS 的 CDN 服務就是 cloudfont 啦！\n\n只是說原本的 domain 已經有 SSL 了，但是代理沒有這個東西，所以我們要 ban 出一個 Certificate，那在在建立 cloudfont 以前需要先到 Certificate Manager，接著會用圖片帶大家一步一步做\n\n![](https://i.imgur.com/vLLfKyr.png)\n\n## 開始之前\n\n我已經有先在 Route53 註冊了一個 `nijialin.com` 的 domain，`.com`大概 10 美金左右，若是有在其他地方註冊域名的話要找一下相關文章把它導進 Route53 哦！\n\n## 註冊 Certificate\n\n- 先來到 Certificate Manager 頁面，按下左下角的這個\n\n![](https://i.imgur.com/WVk2YFJ.png)\n\n- 接著就直接按右下角啦，但是要確定是不是 public\n\n![](https://i.imgur.com/sNxd3LG.png)\n\n- 這裡輸入你在 route53 註冊的 domain，這邊我是輸入 \\*.nijialin.com\n\n![](https://i.imgur.com/FXnknbj.png)\n\n- 到第四部之後就會看到申請的 SSL Pending\n\n![](https://i.imgur.com/WlY5PCf.png)\n\n- 最後回首頁之後就會看到 SSL 簽證正在送簽中\n  ![](https://i.imgur.com/kRRtvJ5.png)\n\n最後就等他完成嚕！將將\n![](https://i.imgur.com/495PjEw.png)\n接著我們到 API Gateway 找到左邊的 `Custom Domain Name`，我們要來建立屬於這個 API 的 Domain 了\n![](https://i.imgur.com/BzkvgUR.png)\n按下藍色的按鈕之後，輸入`Domain name`以及選擇剛剛註冊的 Certificate 後按下 `Save`\n![](https://i.imgur.com/xwBEC5O.png)\n他就會開始初始化剛剛的設定，這邊大概需要等 15 分鐘左右\n![](https://i.imgur.com/dLMaXrx.png)\n在此同時我們就去新增專案裡的套件 [Domain-Manager](https://www.npmjs.com/package/serverless-domain-manager)\n\n```Bash\nnpm install serverless-domain-manager --save-dev\n```\n\n並且在`plugin`下加入套件\n\n```yaml\nplugins:\n  - serverless-domain-manager\n```\n\n在`custom`底下加入\n\n```yaml\ncustom:\n  domainName:\n    default:\n      domainName: line.nijialin.com\n      certificateName: \"*.nijialin.com\"\n      createRoute53Record: true\n      endpointType: edge\n```\n\n等待前面初始化成功之後部署這個專案`sls deploy`之後就會看到剛剛註冊的域名啟動囉！\n![](https://i.imgur.com/Pn2TyMD.png)\n\n## 結論\n\n在建立 Certificate 那邊倒沒什麼問題，畢竟需要一個 SSL，只是到了建立 domain 這邊遇到了很怪的問題，一般來說使用 serverless 框架來跑的話只要照的文件裡說的 `serverless create_domain`就會幫忙註冊，而且可以依照自己開發環境去自動設定，在公司的專案中這樣使用是沒問題的，在是在寫這篇文章時卻只能使用以上的方法來替代使用，雖然結果是一樣的，但是用起來實在是很不符合邏輯，google 也沒找到類似的問題，或許這個問題還要多實測幾次才夠...😭\n","source":"_posts/Day26-Use-CDN-1-建立-Certificate-與-Domain.md","raw":"---\ntitle: Day26 - Use CDN (1) - 建立 Certificate 與 Domain\ntags:\n  - Serverless\n  - CDN\n  - Route 53\n  - Certificate Manager\ncategories: 2019鐵人賽\nabbrlink: 2081624252\ndate: 2019-10-10 21:05:23\n---\n\n## 簡介\n\n繼上一篇 warm-up 機制之後來了解一下如何使用 AWS 的 CDN 服務 - cloudfont，CDN 顧名思義就是要讓使用者可以到最接近的主機上去拉到對應的資料，透過撒點的方式讓主機去挑選離自己近的服務據點，藉此加速服務。\n\n像我之前部署在 ohio，想想光網路的時間 + Cold start 的時間就已經去了一大半，即便我們有熱開機，服務沒有 Timeout 我該慶幸了，既然如此就不得不認識一下 CDN 服務，而 AWS 的 CDN 服務就是 cloudfont 啦！\n\n只是說原本的 domain 已經有 SSL 了，但是代理沒有這個東西，所以我們要 ban 出一個 Certificate，那在在建立 cloudfont 以前需要先到 Certificate Manager，接著會用圖片帶大家一步一步做\n\n![](https://i.imgur.com/vLLfKyr.png)\n\n## 開始之前\n\n我已經有先在 Route53 註冊了一個 `nijialin.com` 的 domain，`.com`大概 10 美金左右，若是有在其他地方註冊域名的話要找一下相關文章把它導進 Route53 哦！\n\n## 註冊 Certificate\n\n- 先來到 Certificate Manager 頁面，按下左下角的這個\n\n![](https://i.imgur.com/WVk2YFJ.png)\n\n- 接著就直接按右下角啦，但是要確定是不是 public\n\n![](https://i.imgur.com/sNxd3LG.png)\n\n- 這裡輸入你在 route53 註冊的 domain，這邊我是輸入 \\*.nijialin.com\n\n![](https://i.imgur.com/FXnknbj.png)\n\n- 到第四部之後就會看到申請的 SSL Pending\n\n![](https://i.imgur.com/WlY5PCf.png)\n\n- 最後回首頁之後就會看到 SSL 簽證正在送簽中\n  ![](https://i.imgur.com/kRRtvJ5.png)\n\n最後就等他完成嚕！將將\n![](https://i.imgur.com/495PjEw.png)\n接著我們到 API Gateway 找到左邊的 `Custom Domain Name`，我們要來建立屬於這個 API 的 Domain 了\n![](https://i.imgur.com/BzkvgUR.png)\n按下藍色的按鈕之後，輸入`Domain name`以及選擇剛剛註冊的 Certificate 後按下 `Save`\n![](https://i.imgur.com/xwBEC5O.png)\n他就會開始初始化剛剛的設定，這邊大概需要等 15 分鐘左右\n![](https://i.imgur.com/dLMaXrx.png)\n在此同時我們就去新增專案裡的套件 [Domain-Manager](https://www.npmjs.com/package/serverless-domain-manager)\n\n```Bash\nnpm install serverless-domain-manager --save-dev\n```\n\n並且在`plugin`下加入套件\n\n```yaml\nplugins:\n  - serverless-domain-manager\n```\n\n在`custom`底下加入\n\n```yaml\ncustom:\n  domainName:\n    default:\n      domainName: line.nijialin.com\n      certificateName: \"*.nijialin.com\"\n      createRoute53Record: true\n      endpointType: edge\n```\n\n等待前面初始化成功之後部署這個專案`sls deploy`之後就會看到剛剛註冊的域名啟動囉！\n![](https://i.imgur.com/Pn2TyMD.png)\n\n## 結論\n\n在建立 Certificate 那邊倒沒什麼問題，畢竟需要一個 SSL，只是到了建立 domain 這邊遇到了很怪的問題，一般來說使用 serverless 框架來跑的話只要照的文件裡說的 `serverless create_domain`就會幫忙註冊，而且可以依照自己開發環境去自動設定，在公司的專案中這樣使用是沒問題的，在是在寫這篇文章時卻只能使用以上的方法來替代使用，雖然結果是一樣的，但是用起來實在是很不符合邏輯，google 也沒找到類似的問題，或許這個問題還要多實測幾次才夠...😭\n","slug":"Day26-Use-CDN-1-建立-Certificate-與-Domain","published":1,"updated":"2020-06-19T14:03:58.843Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jx00247crioct74x8d","content":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><p>繼上一篇 warm-up 機制之後來了解一下如何使用 AWS 的 CDN 服務 - cloudfont，CDN 顧名思義就是要讓使用者可以到最接近的主機上去拉到對應的資料，透過撒點的方式讓主機去挑選離自己近的服務據點，藉此加速服務。</p>\n<p>像我之前部署在 ohio，想想光網路的時間 + Cold start 的時間就已經去了一大半，即便我們有熱開機，服務沒有 Timeout 我該慶幸了，既然如此就不得不認識一下 CDN 服務，而 AWS 的 CDN 服務就是 cloudfont 啦！</p>\n<p>只是說原本的 domain 已經有 SSL 了，但是代理沒有這個東西，所以我們要 ban 出一個 Certificate，那在在建立 cloudfont 以前需要先到 Certificate Manager，接著會用圖片帶大家一步一步做</p>\n<p><img src=\"https://i.imgur.com/vLLfKyr.png\" alt></p>\n<h2 id=\"開始之前\"><a href=\"#開始之前\" class=\"headerlink\" title=\"開始之前\"></a>開始之前</h2><p>我已經有先在 Route53 註冊了一個 <code>nijialin.com</code> 的 domain，<code>.com</code>大概 10 美金左右，若是有在其他地方註冊域名的話要找一下相關文章把它導進 Route53 哦！</p>\n<h2 id=\"註冊-Certificate\"><a href=\"#註冊-Certificate\" class=\"headerlink\" title=\"註冊 Certificate\"></a>註冊 Certificate</h2><ul>\n<li>先來到 Certificate Manager 頁面，按下左下角的這個</li>\n</ul>\n<p><img src=\"https://i.imgur.com/WVk2YFJ.png\" alt></p>\n<ul>\n<li>接著就直接按右下角啦，但是要確定是不是 public</li>\n</ul>\n<p><img src=\"https://i.imgur.com/sNxd3LG.png\" alt></p>\n<ul>\n<li>這裡輸入你在 route53 註冊的 domain，這邊我是輸入 *.nijialin.com</li>\n</ul>\n<p><img src=\"https://i.imgur.com/FXnknbj.png\" alt></p>\n<ul>\n<li>到第四部之後就會看到申請的 SSL Pending</li>\n</ul>\n<p><img src=\"https://i.imgur.com/WlY5PCf.png\" alt></p>\n<ul>\n<li>最後回首頁之後就會看到 SSL 簽證正在送簽中<br><img src=\"https://i.imgur.com/kRRtvJ5.png\" alt></li>\n</ul>\n<p>最後就等他完成嚕！將將<br><img src=\"https://i.imgur.com/495PjEw.png\" alt><br>接著我們到 API Gateway 找到左邊的 <code>Custom Domain Name</code>，我們要來建立屬於這個 API 的 Domain 了<br><img src=\"https://i.imgur.com/BzkvgUR.png\" alt><br>按下藍色的按鈕之後，輸入<code>Domain name</code>以及選擇剛剛註冊的 Certificate 後按下 <code>Save</code><br><img src=\"https://i.imgur.com/xwBEC5O.png\" alt><br>他就會開始初始化剛剛的設定，這邊大概需要等 15 分鐘左右<br><img src=\"https://i.imgur.com/dLMaXrx.png\" alt><br>在此同時我們就去新增專案裡的套件 <a href=\"https://www.npmjs.com/package/serverless-domain-manager\" target=\"_blank\" rel=\"noopener\">Domain-Manager</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless-domain-manager --save-dev</span><br></pre></td></tr></table></figure>\n\n<p>並且在<code>plugin</code>下加入套件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-domain-manager</span></span><br></pre></td></tr></table></figure>\n\n<p>在<code>custom</code>底下加入</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  domainName:</span></span><br><span class=\"line\"><span class=\"attr\">    default:</span></span><br><span class=\"line\"><span class=\"attr\">      domainName:</span> <span class=\"string\">line.nijialin.com</span></span><br><span class=\"line\"><span class=\"attr\">      certificateName:</span> <span class=\"string\">\"*.nijialin.com\"</span></span><br><span class=\"line\"><span class=\"attr\">      createRoute53Record:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">      endpointType:</span> <span class=\"string\">edge</span></span><br></pre></td></tr></table></figure>\n\n<p>等待前面初始化成功之後部署這個專案<code>sls deploy</code>之後就會看到剛剛註冊的域名啟動囉！<br><img src=\"https://i.imgur.com/Pn2TyMD.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>在建立 Certificate 那邊倒沒什麼問題，畢竟需要一個 SSL，只是到了建立 domain 這邊遇到了很怪的問題，一般來說使用 serverless 框架來跑的話只要照的文件裡說的 <code>serverless create_domain</code>就會幫忙註冊，而且可以依照自己開發環境去自動設定，在公司的專案中這樣使用是沒問題的，在是在寫這篇文章時卻只能使用以上的方法來替代使用，雖然結果是一樣的，但是用起來實在是很不符合邏輯，google 也沒找到類似的問題，或許這個問題還要多實測幾次才夠…😭</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><p>繼上一篇 warm-up 機制之後來了解一下如何使用 AWS 的 CDN 服務 - cloudfont，CDN 顧名思義就是要讓使用者可以到最接近的主機上去拉到對應的資料，透過撒點的方式讓主機去挑選離自己近的服務據點，藉此加速服務。</p>\n<p>像我之前部署在 ohio，想想光網路的時間 + Cold start 的時間就已經去了一大半，即便我們有熱開機，服務沒有 Timeout 我該慶幸了，既然如此就不得不認識一下 CDN 服務，而 AWS 的 CDN 服務就是 cloudfont 啦！</p>\n<p>只是說原本的 domain 已經有 SSL 了，但是代理沒有這個東西，所以我們要 ban 出一個 Certificate，那在在建立 cloudfont 以前需要先到 Certificate Manager，接著會用圖片帶大家一步一步做</p>\n<p><img src=\"https://i.imgur.com/vLLfKyr.png\" alt></p>\n<h2 id=\"開始之前\"><a href=\"#開始之前\" class=\"headerlink\" title=\"開始之前\"></a>開始之前</h2><p>我已經有先在 Route53 註冊了一個 <code>nijialin.com</code> 的 domain，<code>.com</code>大概 10 美金左右，若是有在其他地方註冊域名的話要找一下相關文章把它導進 Route53 哦！</p>\n<h2 id=\"註冊-Certificate\"><a href=\"#註冊-Certificate\" class=\"headerlink\" title=\"註冊 Certificate\"></a>註冊 Certificate</h2><ul>\n<li>先來到 Certificate Manager 頁面，按下左下角的這個</li>\n</ul>\n<p><img src=\"https://i.imgur.com/WVk2YFJ.png\" alt></p>\n<ul>\n<li>接著就直接按右下角啦，但是要確定是不是 public</li>\n</ul>\n<p><img src=\"https://i.imgur.com/sNxd3LG.png\" alt></p>\n<ul>\n<li>這裡輸入你在 route53 註冊的 domain，這邊我是輸入 *.nijialin.com</li>\n</ul>\n<p><img src=\"https://i.imgur.com/FXnknbj.png\" alt></p>\n<ul>\n<li>到第四部之後就會看到申請的 SSL Pending</li>\n</ul>\n<p><img src=\"https://i.imgur.com/WlY5PCf.png\" alt></p>\n<ul>\n<li>最後回首頁之後就會看到 SSL 簽證正在送簽中<br><img src=\"https://i.imgur.com/kRRtvJ5.png\" alt></li>\n</ul>\n<p>最後就等他完成嚕！將將<br><img src=\"https://i.imgur.com/495PjEw.png\" alt><br>接著我們到 API Gateway 找到左邊的 <code>Custom Domain Name</code>，我們要來建立屬於這個 API 的 Domain 了<br><img src=\"https://i.imgur.com/BzkvgUR.png\" alt><br>按下藍色的按鈕之後，輸入<code>Domain name</code>以及選擇剛剛註冊的 Certificate 後按下 <code>Save</code><br><img src=\"https://i.imgur.com/xwBEC5O.png\" alt><br>他就會開始初始化剛剛的設定，這邊大概需要等 15 分鐘左右<br><img src=\"https://i.imgur.com/dLMaXrx.png\" alt><br>在此同時我們就去新增專案裡的套件 <a href=\"https://www.npmjs.com/package/serverless-domain-manager\" target=\"_blank\" rel=\"noopener\">Domain-Manager</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless-domain-manager --save-dev</span><br></pre></td></tr></table></figure>\n\n<p>並且在<code>plugin</code>下加入套件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-domain-manager</span></span><br></pre></td></tr></table></figure>\n\n<p>在<code>custom</code>底下加入</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  domainName:</span></span><br><span class=\"line\"><span class=\"attr\">    default:</span></span><br><span class=\"line\"><span class=\"attr\">      domainName:</span> <span class=\"string\">line.nijialin.com</span></span><br><span class=\"line\"><span class=\"attr\">      certificateName:</span> <span class=\"string\">\"*.nijialin.com\"</span></span><br><span class=\"line\"><span class=\"attr\">      createRoute53Record:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">      endpointType:</span> <span class=\"string\">edge</span></span><br></pre></td></tr></table></figure>\n\n<p>等待前面初始化成功之後部署這個專案<code>sls deploy</code>之後就會看到剛剛註冊的域名啟動囉！<br><img src=\"https://i.imgur.com/Pn2TyMD.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>在建立 Certificate 那邊倒沒什麼問題，畢竟需要一個 SSL，只是到了建立 domain 這邊遇到了很怪的問題，一般來說使用 serverless 框架來跑的話只要照的文件裡說的 <code>serverless create_domain</code>就會幫忙註冊，而且可以依照自己開發環境去自動設定，在公司的專案中這樣使用是沒問題的，在是在寫這篇文章時卻只能使用以上的方法來替代使用，雖然結果是一樣的，但是用起來實在是很不符合邏輯，google 也沒找到類似的問題，或許這個問題還要多實測幾次才夠…😭</p>\n"},{"title":"Day27 - Use CDN (2) - CloudFront","abbrlink":486052549,"date":"2019-10-11T13:06:26.000Z","_content":"\n## 前言\n\n不管是建立虛擬機(EC2)，又或是像我們建立 Serverless 的服務(Lambda)，總會挑選離自己家近的節點(東京)，又或者可能因為價錢的關係選擇相對便宜的地點，但不管機器在哪，對於在台灣的我們來說都是一樣跨海啊！但好險台灣擁有 CloudFront 的節點，透過快取讓使用者可以更快的取得服務器上的資源，可能第一次都會比較慢，但只要讓 CloudFront 看過一次就會幫忙快取起來，下次使用者在用的時候就不會那麼慢囉！\n\n## 建立 CDN\n\n首先我們先進去 CloudFront 的頁面，按下左欄的`Distribution`後並 `Create`的藍色按鈕\n![](https://i.imgur.com/WQ5o8rl.png)\n因為我們是做 Web API 相關的，這邊當然就是選 Web 囉！\n![](https://i.imgur.com/htzGaGA.png)\n到了這邊，AWS 很有心的在這些輸入框大多都有下拉式選單，這邊就選建立完的那個專案名稱\n![](https://i.imgur.com/ntJu1Cm.jpg)\n選完之後下面三個就照著這樣點選，Comment 會幫你自動填入\n![](https://i.imgur.com/XkbNkfz.png)\nCNAMEs 的部分這邊我填入我在 `serverless.yml`裡 create_domain 所設定的 `line.nijia.lin` 字串，SSL 就選擇上一篇所建立的 Certificate\n![](https://i.imgur.com/SdnaZhe.png)\n建立完成之後就會看到他 `In progress`，CloudFront 就開始撒點告訴其他節點有建立這個名為 `line.nijia.lin`，有看到他的時候記得幫他做個 Cache\n![](https://i.imgur.com/RibhSWw.png)\n等個大概 15 分鐘後他就部署完成啦～\n![](https://i.imgur.com/kHYSETU.png)\n點進來可以確認自己剛剛設定的資訊對不對，若有設定錯誤在按 Edit 來修正\n![](https://i.imgur.com/HdCn9ue.png)\n\n## 結論\n\n現在每個服務都很流行 CDN，若有在寫前端的朋友常常就會用到 jQuery、Bootstrap、Vue 等等可以再標頭檔就引入的 CDN 路徑，CDN 不僅加速我們平常在抓伺服器資料的速度，也便利了我們有時候需要寫一些簡單的靜態頁面時可以透過抓取 CDN 路徑來快速取得需要的資源，但是像是 AWS 他們都是收取流量費，用得很爽時別忘了看一下自己的帳單是不是在哀嚎 🤣\n","source":"_posts/Day27-Use-CDN-2-CloudFront.md","raw":"---\ntitle: Day27 - Use CDN (2) - CloudFront\ntags:\n  - Serverless\n  - CDN\n  - CloudFront\ncategories: 2019鐵人賽\nabbrlink: 486052549\ndate: 2019-10-11 21:06:26\n---\n\n## 前言\n\n不管是建立虛擬機(EC2)，又或是像我們建立 Serverless 的服務(Lambda)，總會挑選離自己家近的節點(東京)，又或者可能因為價錢的關係選擇相對便宜的地點，但不管機器在哪，對於在台灣的我們來說都是一樣跨海啊！但好險台灣擁有 CloudFront 的節點，透過快取讓使用者可以更快的取得服務器上的資源，可能第一次都會比較慢，但只要讓 CloudFront 看過一次就會幫忙快取起來，下次使用者在用的時候就不會那麼慢囉！\n\n## 建立 CDN\n\n首先我們先進去 CloudFront 的頁面，按下左欄的`Distribution`後並 `Create`的藍色按鈕\n![](https://i.imgur.com/WQ5o8rl.png)\n因為我們是做 Web API 相關的，這邊當然就是選 Web 囉！\n![](https://i.imgur.com/htzGaGA.png)\n到了這邊，AWS 很有心的在這些輸入框大多都有下拉式選單，這邊就選建立完的那個專案名稱\n![](https://i.imgur.com/ntJu1Cm.jpg)\n選完之後下面三個就照著這樣點選，Comment 會幫你自動填入\n![](https://i.imgur.com/XkbNkfz.png)\nCNAMEs 的部分這邊我填入我在 `serverless.yml`裡 create_domain 所設定的 `line.nijia.lin` 字串，SSL 就選擇上一篇所建立的 Certificate\n![](https://i.imgur.com/SdnaZhe.png)\n建立完成之後就會看到他 `In progress`，CloudFront 就開始撒點告訴其他節點有建立這個名為 `line.nijia.lin`，有看到他的時候記得幫他做個 Cache\n![](https://i.imgur.com/RibhSWw.png)\n等個大概 15 分鐘後他就部署完成啦～\n![](https://i.imgur.com/kHYSETU.png)\n點進來可以確認自己剛剛設定的資訊對不對，若有設定錯誤在按 Edit 來修正\n![](https://i.imgur.com/HdCn9ue.png)\n\n## 結論\n\n現在每個服務都很流行 CDN，若有在寫前端的朋友常常就會用到 jQuery、Bootstrap、Vue 等等可以再標頭檔就引入的 CDN 路徑，CDN 不僅加速我們平常在抓伺服器資料的速度，也便利了我們有時候需要寫一些簡單的靜態頁面時可以透過抓取 CDN 路徑來快速取得需要的資源，但是像是 AWS 他們都是收取流量費，用得很爽時別忘了看一下自己的帳單是不是在哀嚎 🤣\n","slug":"Day27-Use-CDN-2-CloudFront","published":1,"updated":"2020-06-19T14:03:58.844Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jy00297crifo9guy3a","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>不管是建立虛擬機(EC2)，又或是像我們建立 Serverless 的服務(Lambda)，總會挑選離自己家近的節點(東京)，又或者可能因為價錢的關係選擇相對便宜的地點，但不管機器在哪，對於在台灣的我們來說都是一樣跨海啊！但好險台灣擁有 CloudFront 的節點，透過快取讓使用者可以更快的取得服務器上的資源，可能第一次都會比較慢，但只要讓 CloudFront 看過一次就會幫忙快取起來，下次使用者在用的時候就不會那麼慢囉！</p>\n<h2 id=\"建立-CDN\"><a href=\"#建立-CDN\" class=\"headerlink\" title=\"建立 CDN\"></a>建立 CDN</h2><p>首先我們先進去 CloudFront 的頁面，按下左欄的<code>Distribution</code>後並 <code>Create</code>的藍色按鈕<br><img src=\"https://i.imgur.com/WQ5o8rl.png\" alt><br>因為我們是做 Web API 相關的，這邊當然就是選 Web 囉！<br><img src=\"https://i.imgur.com/htzGaGA.png\" alt><br>到了這邊，AWS 很有心的在這些輸入框大多都有下拉式選單，這邊就選建立完的那個專案名稱<br><img src=\"https://i.imgur.com/ntJu1Cm.jpg\" alt><br>選完之後下面三個就照著這樣點選，Comment 會幫你自動填入<br><img src=\"https://i.imgur.com/XkbNkfz.png\" alt><br>CNAMEs 的部分這邊我填入我在 <code>serverless.yml</code>裡 create_domain 所設定的 <code>line.nijia.lin</code> 字串，SSL 就選擇上一篇所建立的 Certificate<br><img src=\"https://i.imgur.com/SdnaZhe.png\" alt><br>建立完成之後就會看到他 <code>In progress</code>，CloudFront 就開始撒點告訴其他節點有建立這個名為 <code>line.nijia.lin</code>，有看到他的時候記得幫他做個 Cache<br><img src=\"https://i.imgur.com/RibhSWw.png\" alt><br>等個大概 15 分鐘後他就部署完成啦～<br><img src=\"https://i.imgur.com/kHYSETU.png\" alt><br>點進來可以確認自己剛剛設定的資訊對不對，若有設定錯誤在按 Edit 來修正<br><img src=\"https://i.imgur.com/HdCn9ue.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>現在每個服務都很流行 CDN，若有在寫前端的朋友常常就會用到 jQuery、Bootstrap、Vue 等等可以再標頭檔就引入的 CDN 路徑，CDN 不僅加速我們平常在抓伺服器資料的速度，也便利了我們有時候需要寫一些簡單的靜態頁面時可以透過抓取 CDN 路徑來快速取得需要的資源，但是像是 AWS 他們都是收取流量費，用得很爽時別忘了看一下自己的帳單是不是在哀嚎 🤣</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>不管是建立虛擬機(EC2)，又或是像我們建立 Serverless 的服務(Lambda)，總會挑選離自己家近的節點(東京)，又或者可能因為價錢的關係選擇相對便宜的地點，但不管機器在哪，對於在台灣的我們來說都是一樣跨海啊！但好險台灣擁有 CloudFront 的節點，透過快取讓使用者可以更快的取得服務器上的資源，可能第一次都會比較慢，但只要讓 CloudFront 看過一次就會幫忙快取起來，下次使用者在用的時候就不會那麼慢囉！</p>\n<h2 id=\"建立-CDN\"><a href=\"#建立-CDN\" class=\"headerlink\" title=\"建立 CDN\"></a>建立 CDN</h2><p>首先我們先進去 CloudFront 的頁面，按下左欄的<code>Distribution</code>後並 <code>Create</code>的藍色按鈕<br><img src=\"https://i.imgur.com/WQ5o8rl.png\" alt><br>因為我們是做 Web API 相關的，這邊當然就是選 Web 囉！<br><img src=\"https://i.imgur.com/htzGaGA.png\" alt><br>到了這邊，AWS 很有心的在這些輸入框大多都有下拉式選單，這邊就選建立完的那個專案名稱<br><img src=\"https://i.imgur.com/ntJu1Cm.jpg\" alt><br>選完之後下面三個就照著這樣點選，Comment 會幫你自動填入<br><img src=\"https://i.imgur.com/XkbNkfz.png\" alt><br>CNAMEs 的部分這邊我填入我在 <code>serverless.yml</code>裡 create_domain 所設定的 <code>line.nijia.lin</code> 字串，SSL 就選擇上一篇所建立的 Certificate<br><img src=\"https://i.imgur.com/SdnaZhe.png\" alt><br>建立完成之後就會看到他 <code>In progress</code>，CloudFront 就開始撒點告訴其他節點有建立這個名為 <code>line.nijia.lin</code>，有看到他的時候記得幫他做個 Cache<br><img src=\"https://i.imgur.com/RibhSWw.png\" alt><br>等個大概 15 分鐘後他就部署完成啦～<br><img src=\"https://i.imgur.com/kHYSETU.png\" alt><br>點進來可以確認自己剛剛設定的資訊對不對，若有設定錯誤在按 Edit 來修正<br><img src=\"https://i.imgur.com/HdCn9ue.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>現在每個服務都很流行 CDN，若有在寫前端的朋友常常就會用到 jQuery、Bootstrap、Vue 等等可以再標頭檔就引入的 CDN 路徑，CDN 不僅加速我們平常在抓伺服器資料的速度，也便利了我們有時候需要寫一些簡單的靜態頁面時可以透過抓取 CDN 路徑來快速取得需要的資源，但是像是 AWS 他們都是收取流量費，用得很爽時別忘了看一下自己的帳單是不是在哀嚎 🤣</p>\n"},{"title":"Day28 - 用 S3 幫忙轉址到原有的服務上","abbrlink":1405710804,"date":"2019-10-12T13:07:18.000Z","_content":"\n## 前言\n\n在之前的文章都有將 `Notify`、`LINE Login`所需要的靜態頁面放在 S3 上面，讓其他使用者去點，雖然把前端放在程式裡面用 render template 比較好，可是在求快的情況下我把靜態頁面寫完就扔上去了(被拖走)，其實也可以透過這個方法去幫忙轉址，不過接下來我會用我的臉書做個範例提供參考～\n\n## 實作\n\n照著之前的範例來建立一個名為 `facebook.nijialin.com` 來做 S3 轉址的範例\n![](https://i.imgur.com/BJyONqF.png)\n建立完之後因為我們需要把網址公開給其他使用者點選，在第三個分頁中先把第一個選項的 `Block all public access` 更換成 off 狀態\n![](https://i.imgur.com/FAoiCbt.png)\n到第二個按鈕選項選擇 `Public access`，暴力一點把所有選項都打開 🤣\n![](https://i.imgur.com/WhCoHl4.png)\n前面都已經把權限開完，選擇`Static Website hosting`這個選項，這個是 S3 提供來讓他有另一種功能，不過我是覺得這功能在這邊有點奇怪 XD\n![](https://i.imgur.com/yPv6nET.png)\n\n---\n\n接著就來到 `Route 53`，點選左欄的 `Hosted Zone`\n![](https://i.imgur.com/k1T8wIT.png)\n點選上面藍色的按鈕，右邊會出現輸入的地方讓你填\n![](https://i.imgur.com/szIVARy.png)\n這邊我會輸入跟 S3 bucket 的名字一樣，然後 `Alias` 選擇 Yes，下面輸入框點下去會看到自己剛剛輸入的 S3 website endpoints\n![](https://i.imgur.com/PVlFHJZ.png)\n建立完之後就可以在瀏覽器上輸入網址，他就會導去你預設的網站囉！向我這邊就是拿我的 facebook 來做示範。\n\n## 結論\n\n我透過這個方法幫我把 medium 的部落格網址重新導向，因為我想之後若是有獨立建立部落格的話網址會是一樣的，當有點粉絲的話至少他們認得的網址會是一樣的 😁。\n\n## 參考\n\n[Route 53+靜態網址](https://www.kilait.com/2015/09/08/route-53-%E9%9D%9C%E6%85%8B%E8%BD%89%E5%9D%80/)\n","source":"_posts/Day28-用-S3-幫忙轉址到原有的服務上.md","raw":"---\ntitle: Day28 - 用 S3 幫忙轉址到原有的服務上\ntags:\n  - AWS\n  - S3\n  - Route53\ncategories: 2019鐵人賽\nabbrlink: 1405710804\ndate: 2019-10-12 21:07:18\n---\n\n## 前言\n\n在之前的文章都有將 `Notify`、`LINE Login`所需要的靜態頁面放在 S3 上面，讓其他使用者去點，雖然把前端放在程式裡面用 render template 比較好，可是在求快的情況下我把靜態頁面寫完就扔上去了(被拖走)，其實也可以透過這個方法去幫忙轉址，不過接下來我會用我的臉書做個範例提供參考～\n\n## 實作\n\n照著之前的範例來建立一個名為 `facebook.nijialin.com` 來做 S3 轉址的範例\n![](https://i.imgur.com/BJyONqF.png)\n建立完之後因為我們需要把網址公開給其他使用者點選，在第三個分頁中先把第一個選項的 `Block all public access` 更換成 off 狀態\n![](https://i.imgur.com/FAoiCbt.png)\n到第二個按鈕選項選擇 `Public access`，暴力一點把所有選項都打開 🤣\n![](https://i.imgur.com/WhCoHl4.png)\n前面都已經把權限開完，選擇`Static Website hosting`這個選項，這個是 S3 提供來讓他有另一種功能，不過我是覺得這功能在這邊有點奇怪 XD\n![](https://i.imgur.com/yPv6nET.png)\n\n---\n\n接著就來到 `Route 53`，點選左欄的 `Hosted Zone`\n![](https://i.imgur.com/k1T8wIT.png)\n點選上面藍色的按鈕，右邊會出現輸入的地方讓你填\n![](https://i.imgur.com/szIVARy.png)\n這邊我會輸入跟 S3 bucket 的名字一樣，然後 `Alias` 選擇 Yes，下面輸入框點下去會看到自己剛剛輸入的 S3 website endpoints\n![](https://i.imgur.com/PVlFHJZ.png)\n建立完之後就可以在瀏覽器上輸入網址，他就會導去你預設的網站囉！向我這邊就是拿我的 facebook 來做示範。\n\n## 結論\n\n我透過這個方法幫我把 medium 的部落格網址重新導向，因為我想之後若是有獨立建立部落格的話網址會是一樣的，當有點粉絲的話至少他們認得的網址會是一樣的 😁。\n\n## 參考\n\n[Route 53+靜態網址](https://www.kilait.com/2015/09/08/route-53-%E9%9D%9C%E6%85%8B%E8%BD%89%E5%9D%80/)\n","slug":"Day28-用-S3-幫忙轉址到原有的服務上","published":1,"updated":"2020-06-19T14:03:58.845Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31jz002c7crihseqb7x1","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在之前的文章都有將 <code>Notify</code>、<code>LINE Login</code>所需要的靜態頁面放在 S3 上面，讓其他使用者去點，雖然把前端放在程式裡面用 render template 比較好，可是在求快的情況下我把靜態頁面寫完就扔上去了(被拖走)，其實也可以透過這個方法去幫忙轉址，不過接下來我會用我的臉書做個範例提供參考～</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>照著之前的範例來建立一個名為 <code>facebook.nijialin.com</code> 來做 S3 轉址的範例<br><img src=\"https://i.imgur.com/BJyONqF.png\" alt><br>建立完之後因為我們需要把網址公開給其他使用者點選，在第三個分頁中先把第一個選項的 <code>Block all public access</code> 更換成 off 狀態<br><img src=\"https://i.imgur.com/FAoiCbt.png\" alt><br>到第二個按鈕選項選擇 <code>Public access</code>，暴力一點把所有選項都打開 🤣<br><img src=\"https://i.imgur.com/WhCoHl4.png\" alt><br>前面都已經把權限開完，選擇<code>Static Website hosting</code>這個選項，這個是 S3 提供來讓他有另一種功能，不過我是覺得這功能在這邊有點奇怪 XD<br><img src=\"https://i.imgur.com/yPv6nET.png\" alt></p>\n<hr>\n<p>接著就來到 <code>Route 53</code>，點選左欄的 <code>Hosted Zone</code><br><img src=\"https://i.imgur.com/k1T8wIT.png\" alt><br>點選上面藍色的按鈕，右邊會出現輸入的地方讓你填<br><img src=\"https://i.imgur.com/szIVARy.png\" alt><br>這邊我會輸入跟 S3 bucket 的名字一樣，然後 <code>Alias</code> 選擇 Yes，下面輸入框點下去會看到自己剛剛輸入的 S3 website endpoints<br><img src=\"https://i.imgur.com/PVlFHJZ.png\" alt><br>建立完之後就可以在瀏覽器上輸入網址，他就會導去你預設的網站囉！向我這邊就是拿我的 facebook 來做示範。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>我透過這個方法幫我把 medium 的部落格網址重新導向，因為我想之後若是有獨立建立部落格的話網址會是一樣的，當有點粉絲的話至少他們認得的網址會是一樣的 😁。</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://www.kilait.com/2015/09/08/route-53-%E9%9D%9C%E6%85%8B%E8%BD%89%E5%9D%80/\" target=\"_blank\" rel=\"noopener\">Route 53+靜態網址</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在之前的文章都有將 <code>Notify</code>、<code>LINE Login</code>所需要的靜態頁面放在 S3 上面，讓其他使用者去點，雖然把前端放在程式裡面用 render template 比較好，可是在求快的情況下我把靜態頁面寫完就扔上去了(被拖走)，其實也可以透過這個方法去幫忙轉址，不過接下來我會用我的臉書做個範例提供參考～</p>\n<h2 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h2><p>照著之前的範例來建立一個名為 <code>facebook.nijialin.com</code> 來做 S3 轉址的範例<br><img src=\"https://i.imgur.com/BJyONqF.png\" alt><br>建立完之後因為我們需要把網址公開給其他使用者點選，在第三個分頁中先把第一個選項的 <code>Block all public access</code> 更換成 off 狀態<br><img src=\"https://i.imgur.com/FAoiCbt.png\" alt><br>到第二個按鈕選項選擇 <code>Public access</code>，暴力一點把所有選項都打開 🤣<br><img src=\"https://i.imgur.com/WhCoHl4.png\" alt><br>前面都已經把權限開完，選擇<code>Static Website hosting</code>這個選項，這個是 S3 提供來讓他有另一種功能，不過我是覺得這功能在這邊有點奇怪 XD<br><img src=\"https://i.imgur.com/yPv6nET.png\" alt></p>\n<hr>\n<p>接著就來到 <code>Route 53</code>，點選左欄的 <code>Hosted Zone</code><br><img src=\"https://i.imgur.com/k1T8wIT.png\" alt><br>點選上面藍色的按鈕，右邊會出現輸入的地方讓你填<br><img src=\"https://i.imgur.com/szIVARy.png\" alt><br>這邊我會輸入跟 S3 bucket 的名字一樣，然後 <code>Alias</code> 選擇 Yes，下面輸入框點下去會看到自己剛剛輸入的 S3 website endpoints<br><img src=\"https://i.imgur.com/PVlFHJZ.png\" alt><br>建立完之後就可以在瀏覽器上輸入網址，他就會導去你預設的網站囉！向我這邊就是拿我的 facebook 來做示範。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>我透過這個方法幫我把 medium 的部落格網址重新導向，因為我想之後若是有獨立建立部落格的話網址會是一樣的，當有點粉絲的話至少他們認得的網址會是一樣的 😁。</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://www.kilait.com/2015/09/08/route-53-%E9%9D%9C%E6%85%8B%E8%BD%89%E5%9D%80/\" target=\"_blank\" rel=\"noopener\">Route 53+靜態網址</a></p>\n"},{"title":"Day29 - LINE API 的使用心得","abbrlink":264701470,"date":"2019-10-13T13:08:19.000Z","_content":"\n- Imagemap\n  - 這邊以微股力為範例，這隻機器人會再回應的時候輸出一張圖片讓使用者看到股票的曲線圖，然後圖片下方做三個類似按鈕的圖片在上面，再藉由設定觸發訊息在座標上，當使用者按到的時候就很像再按按鈕，更多使用方法或是 UX 上的問題可以參考 [UX 三刀流](https://www.facebook.com/uxerlab/)。\n    ![](https://i.imgur.com/A0yDTJm.png)\n- Richmenu\n  - Richmenu 等於把 imagemap 活生生的塞在下面，讓使用者再進聊天室時就能馬上看到圖片並按下對應的區塊而不用再輸入指令把 Imagemap 叫出來，如此就少了個步驟了，並讓開發者可以有更多的發揮空間呢！\n- 設計工具\n\n  - [Bot designer](https://developers.line.biz/en/services/bot-designer/)\n    這個工具是桌面版，可以直接抓下來在本地端直接設計，\n    ![](https://i.imgur.com/dDMSCXu.png)\n    ![](https://i.imgur.com/c2pYpFx.png)\n  - [FLEX MESSAGE SIMULATOR [β]](https://developers.line.biz/console/fx-beta/)\n    它有提供[線上工具](https://developers.line.biz/console/fx-beta/)讓大家可以在線上直接測試樣板或是直接刻自己想要的樣板。\n    - 使用心得：因為寫 Rails 基本上就是在寫全端了，難免會碰到 CSS，身為一個後端工程師排版，一定要用 flex 這個超級毒品(\\吸起來/)，接著過了一段時間後接觸到 LINE bot，且 flex message 也是基於 [Flexbox](https://www.w3.org/TR/css-flexbox-1/) 的規格去實作的，所以很多排版上觀念都很像，也就不太會有障礙了 😁。\n      且在排版上還有表格告知你什麼 component 要在什麼區塊內才能用，多佛心啊～\n      ![](https://i.imgur.com/Fowpoyb.png)\n      ![](https://i.imgur.com/zELPSA0.png)\n\n- API 文件\n  - 在最近幾個月的時候 LINE 的文件有改版，讓某些 API 可以在線上就能測了，看起來是滿讚的，若在逛文件時碰巧想測試這些功能的話可以直接把相關參數放進去，在某些時候也是滿方便的。\n    ![](https://i.imgur.com/CuFdmcH.png)\n- LIFF (LINE Front-end Framework)\n\n  - 個人覺得他讓 Bot 的發揮功力又更上一層樓了，以前很多開發者都會覺得在與機器人對談中會有很多東西是不好做的，像是購物車的流程，若使用者在流程中按了上面的按鈕的話可能會發生無法預期的錯誤，且得用其他的服務去儲存操作狀態，在開發上就很麻煩，那 LIFF 就讓這個流程可以簡單許多，且能透過 SDK 在網頁上取得使用者的資訊，讓網站再被使用的同時還可以確認身份。\n\n- 推播 500 則\n  - 在今年 OAuth 2.0 釋出當中推播則數也跟改動了，改成 500 則後其實看到不少的使用者在跳腳怎麼改成這樣，或是另類的變貴收費，只能說 LINE 也是要找方法收點費用呀，不然很多功能爽爽用他們也沒有地方去收費，這部分因為我也是少用，推播功能就都交給 `LINE Notify` 嚕！\n- 客服與機器人的切換\n  - 參考 C.T Lin 大大的文章 [Day10](https://ithelp.ithome.com.tw/articles/10220717)，簡單來說 Messager 可以在機器人處理不來的時候將訊息轉丟給設定的那位管理員，讓他來回覆訊息，但 LINE 在機器人上只能透過網頁去切換機器人狀態，抑或是自己設計流程讓機器人在無法處理才通知管理員，這樣的話管理員很容易錯過黃金的第一時間，可能也會因此造成使用者的不便。\n- 個人的 mur mur 🤣\n\n  - 文件實在是太瀑布式了，雖然現在都懂的如何搜尋到相對應的功能，但若一般想開發的使用者在看到這個文件時瘋狂往下滑，結果發現還沒有滑到或是滑過頭，倒是找資料時氣得要死 😓，所以若是文件能夠分個頁籤什麼就更好了～\n\n## 結論\n\n當然整體來說還是很喜歡使用 LINE 這個平台(絕對不是因為熊大 🐻)，東西也不會像一開始在開發時什麼都找不太到，並且功能一直 release，讓服務可以透過不同的整合方法去達成目標，接下來 LINE 應該還會再繼續釋出不同的東西，就請大家拭目以待，或者...來參加[ chatbot 小聚](https://www.facebook.com/groups/chatbot.tw)直接問問 LINE 的傳教士如何呢 😁\n","source":"_posts/Day29-LINE-API-的使用心得.md","raw":"---\ntitle: Day29 - LINE API 的使用心得\ntags:\n  - LINE\n  - chatbot\n  - richmenu\ncategories: 2019鐵人賽\nabbrlink: 264701470\ndate: 2019-10-13 21:08:19\n---\n\n- Imagemap\n  - 這邊以微股力為範例，這隻機器人會再回應的時候輸出一張圖片讓使用者看到股票的曲線圖，然後圖片下方做三個類似按鈕的圖片在上面，再藉由設定觸發訊息在座標上，當使用者按到的時候就很像再按按鈕，更多使用方法或是 UX 上的問題可以參考 [UX 三刀流](https://www.facebook.com/uxerlab/)。\n    ![](https://i.imgur.com/A0yDTJm.png)\n- Richmenu\n  - Richmenu 等於把 imagemap 活生生的塞在下面，讓使用者再進聊天室時就能馬上看到圖片並按下對應的區塊而不用再輸入指令把 Imagemap 叫出來，如此就少了個步驟了，並讓開發者可以有更多的發揮空間呢！\n- 設計工具\n\n  - [Bot designer](https://developers.line.biz/en/services/bot-designer/)\n    這個工具是桌面版，可以直接抓下來在本地端直接設計，\n    ![](https://i.imgur.com/dDMSCXu.png)\n    ![](https://i.imgur.com/c2pYpFx.png)\n  - [FLEX MESSAGE SIMULATOR [β]](https://developers.line.biz/console/fx-beta/)\n    它有提供[線上工具](https://developers.line.biz/console/fx-beta/)讓大家可以在線上直接測試樣板或是直接刻自己想要的樣板。\n    - 使用心得：因為寫 Rails 基本上就是在寫全端了，難免會碰到 CSS，身為一個後端工程師排版，一定要用 flex 這個超級毒品(\\吸起來/)，接著過了一段時間後接觸到 LINE bot，且 flex message 也是基於 [Flexbox](https://www.w3.org/TR/css-flexbox-1/) 的規格去實作的，所以很多排版上觀念都很像，也就不太會有障礙了 😁。\n      且在排版上還有表格告知你什麼 component 要在什麼區塊內才能用，多佛心啊～\n      ![](https://i.imgur.com/Fowpoyb.png)\n      ![](https://i.imgur.com/zELPSA0.png)\n\n- API 文件\n  - 在最近幾個月的時候 LINE 的文件有改版，讓某些 API 可以在線上就能測了，看起來是滿讚的，若在逛文件時碰巧想測試這些功能的話可以直接把相關參數放進去，在某些時候也是滿方便的。\n    ![](https://i.imgur.com/CuFdmcH.png)\n- LIFF (LINE Front-end Framework)\n\n  - 個人覺得他讓 Bot 的發揮功力又更上一層樓了，以前很多開發者都會覺得在與機器人對談中會有很多東西是不好做的，像是購物車的流程，若使用者在流程中按了上面的按鈕的話可能會發生無法預期的錯誤，且得用其他的服務去儲存操作狀態，在開發上就很麻煩，那 LIFF 就讓這個流程可以簡單許多，且能透過 SDK 在網頁上取得使用者的資訊，讓網站再被使用的同時還可以確認身份。\n\n- 推播 500 則\n  - 在今年 OAuth 2.0 釋出當中推播則數也跟改動了，改成 500 則後其實看到不少的使用者在跳腳怎麼改成這樣，或是另類的變貴收費，只能說 LINE 也是要找方法收點費用呀，不然很多功能爽爽用他們也沒有地方去收費，這部分因為我也是少用，推播功能就都交給 `LINE Notify` 嚕！\n- 客服與機器人的切換\n  - 參考 C.T Lin 大大的文章 [Day10](https://ithelp.ithome.com.tw/articles/10220717)，簡單來說 Messager 可以在機器人處理不來的時候將訊息轉丟給設定的那位管理員，讓他來回覆訊息，但 LINE 在機器人上只能透過網頁去切換機器人狀態，抑或是自己設計流程讓機器人在無法處理才通知管理員，這樣的話管理員很容易錯過黃金的第一時間，可能也會因此造成使用者的不便。\n- 個人的 mur mur 🤣\n\n  - 文件實在是太瀑布式了，雖然現在都懂的如何搜尋到相對應的功能，但若一般想開發的使用者在看到這個文件時瘋狂往下滑，結果發現還沒有滑到或是滑過頭，倒是找資料時氣得要死 😓，所以若是文件能夠分個頁籤什麼就更好了～\n\n## 結論\n\n當然整體來說還是很喜歡使用 LINE 這個平台(絕對不是因為熊大 🐻)，東西也不會像一開始在開發時什麼都找不太到，並且功能一直 release，讓服務可以透過不同的整合方法去達成目標，接下來 LINE 應該還會再繼續釋出不同的東西，就請大家拭目以待，或者...來參加[ chatbot 小聚](https://www.facebook.com/groups/chatbot.tw)直接問問 LINE 的傳教士如何呢 😁\n","slug":"Day29-LINE-API-的使用心得","published":1,"updated":"2020-06-19T14:03:58.846Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k1002g7cric9porh1d","content":"<ul>\n<li><p>Imagemap</p>\n<ul>\n<li>這邊以微股力為範例，這隻機器人會再回應的時候輸出一張圖片讓使用者看到股票的曲線圖，然後圖片下方做三個類似按鈕的圖片在上面，再藉由設定觸發訊息在座標上，當使用者按到的時候就很像再按按鈕，更多使用方法或是 UX 上的問題可以參考 <a href=\"https://www.facebook.com/uxerlab/\" target=\"_blank\" rel=\"noopener\">UX 三刀流</a>。<br><img src=\"https://i.imgur.com/A0yDTJm.png\" alt></li>\n</ul>\n</li>\n<li><p>Richmenu</p>\n<ul>\n<li>Richmenu 等於把 imagemap 活生生的塞在下面，讓使用者再進聊天室時就能馬上看到圖片並按下對應的區塊而不用再輸入指令把 Imagemap 叫出來，如此就少了個步驟了，並讓開發者可以有更多的發揮空間呢！</li>\n</ul>\n</li>\n<li><p>設計工具</p>\n<ul>\n<li><a href=\"https://developers.line.biz/en/services/bot-designer/\" target=\"_blank\" rel=\"noopener\">Bot designer</a><br>這個工具是桌面版，可以直接抓下來在本地端直接設計，<br><img src=\"https://i.imgur.com/dDMSCXu.png\" alt><br><img src=\"https://i.imgur.com/c2pYpFx.png\" alt></li>\n<li><a href=\"https://developers.line.biz/console/fx-beta/\" target=\"_blank\" rel=\"noopener\">FLEX MESSAGE SIMULATOR [β]</a><br>它有提供<a href=\"https://developers.line.biz/console/fx-beta/\" target=\"_blank\" rel=\"noopener\">線上工具</a>讓大家可以在線上直接測試樣板或是直接刻自己想要的樣板。<ul>\n<li>使用心得：因為寫 Rails 基本上就是在寫全端了，難免會碰到 CSS，身為一個後端工程師排版，一定要用 flex 這個超級毒品(\\吸起來/)，接著過了一段時間後接觸到 LINE bot，且 flex message 也是基於 <a href=\"https://www.w3.org/TR/css-flexbox-1/\" target=\"_blank\" rel=\"noopener\">Flexbox</a> 的規格去實作的，所以很多排版上觀念都很像，也就不太會有障礙了 😁。<br>且在排版上還有表格告知你什麼 component 要在什麼區塊內才能用，多佛心啊～<br><img src=\"https://i.imgur.com/Fowpoyb.png\" alt><br><img src=\"https://i.imgur.com/zELPSA0.png\" alt></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>API 文件</p>\n<ul>\n<li>在最近幾個月的時候 LINE 的文件有改版，讓某些 API 可以在線上就能測了，看起來是滿讚的，若在逛文件時碰巧想測試這些功能的話可以直接把相關參數放進去，在某些時候也是滿方便的。<br><img src=\"https://i.imgur.com/CuFdmcH.png\" alt></li>\n</ul>\n</li>\n<li><p>LIFF (LINE Front-end Framework)</p>\n<ul>\n<li>個人覺得他讓 Bot 的發揮功力又更上一層樓了，以前很多開發者都會覺得在與機器人對談中會有很多東西是不好做的，像是購物車的流程，若使用者在流程中按了上面的按鈕的話可能會發生無法預期的錯誤，且得用其他的服務去儲存操作狀態，在開發上就很麻煩，那 LIFF 就讓這個流程可以簡單許多，且能透過 SDK 在網頁上取得使用者的資訊，讓網站再被使用的同時還可以確認身份。</li>\n</ul>\n</li>\n<li><p>推播 500 則</p>\n<ul>\n<li>在今年 OAuth 2.0 釋出當中推播則數也跟改動了，改成 500 則後其實看到不少的使用者在跳腳怎麼改成這樣，或是另類的變貴收費，只能說 LINE 也是要找方法收點費用呀，不然很多功能爽爽用他們也沒有地方去收費，這部分因為我也是少用，推播功能就都交給 <code>LINE Notify</code> 嚕！</li>\n</ul>\n</li>\n<li><p>客服與機器人的切換</p>\n<ul>\n<li>參考 C.T Lin 大大的文章 <a href=\"https://ithelp.ithome.com.tw/articles/10220717\" target=\"_blank\" rel=\"noopener\">Day10</a>，簡單來說 Messager 可以在機器人處理不來的時候將訊息轉丟給設定的那位管理員，讓他來回覆訊息，但 LINE 在機器人上只能透過網頁去切換機器人狀態，抑或是自己設計流程讓機器人在無法處理才通知管理員，這樣的話管理員很容易錯過黃金的第一時間，可能也會因此造成使用者的不便。</li>\n</ul>\n</li>\n<li><p>個人的 mur mur 🤣</p>\n<ul>\n<li>文件實在是太瀑布式了，雖然現在都懂的如何搜尋到相對應的功能，但若一般想開發的使用者在看到這個文件時瘋狂往下滑，結果發現還沒有滑到或是滑過頭，倒是找資料時氣得要死 😓，所以若是文件能夠分個頁籤什麼就更好了～</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>當然整體來說還是很喜歡使用 LINE 這個平台(絕對不是因為熊大 🐻)，東西也不會像一開始在開發時什麼都找不太到，並且功能一直 release，讓服務可以透過不同的整合方法去達成目標，接下來 LINE 應該還會再繼續釋出不同的東西，就請大家拭目以待，或者…來參加<a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\"> chatbot 小聚</a>直接問問 LINE 的傳教士如何呢 😁</p>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><p>Imagemap</p>\n<ul>\n<li>這邊以微股力為範例，這隻機器人會再回應的時候輸出一張圖片讓使用者看到股票的曲線圖，然後圖片下方做三個類似按鈕的圖片在上面，再藉由設定觸發訊息在座標上，當使用者按到的時候就很像再按按鈕，更多使用方法或是 UX 上的問題可以參考 <a href=\"https://www.facebook.com/uxerlab/\" target=\"_blank\" rel=\"noopener\">UX 三刀流</a>。<br><img src=\"https://i.imgur.com/A0yDTJm.png\" alt></li>\n</ul>\n</li>\n<li><p>Richmenu</p>\n<ul>\n<li>Richmenu 等於把 imagemap 活生生的塞在下面，讓使用者再進聊天室時就能馬上看到圖片並按下對應的區塊而不用再輸入指令把 Imagemap 叫出來，如此就少了個步驟了，並讓開發者可以有更多的發揮空間呢！</li>\n</ul>\n</li>\n<li><p>設計工具</p>\n<ul>\n<li><a href=\"https://developers.line.biz/en/services/bot-designer/\" target=\"_blank\" rel=\"noopener\">Bot designer</a><br>這個工具是桌面版，可以直接抓下來在本地端直接設計，<br><img src=\"https://i.imgur.com/dDMSCXu.png\" alt><br><img src=\"https://i.imgur.com/c2pYpFx.png\" alt></li>\n<li><a href=\"https://developers.line.biz/console/fx-beta/\" target=\"_blank\" rel=\"noopener\">FLEX MESSAGE SIMULATOR [β]</a><br>它有提供<a href=\"https://developers.line.biz/console/fx-beta/\" target=\"_blank\" rel=\"noopener\">線上工具</a>讓大家可以在線上直接測試樣板或是直接刻自己想要的樣板。<ul>\n<li>使用心得：因為寫 Rails 基本上就是在寫全端了，難免會碰到 CSS，身為一個後端工程師排版，一定要用 flex 這個超級毒品(\\吸起來/)，接著過了一段時間後接觸到 LINE bot，且 flex message 也是基於 <a href=\"https://www.w3.org/TR/css-flexbox-1/\" target=\"_blank\" rel=\"noopener\">Flexbox</a> 的規格去實作的，所以很多排版上觀念都很像，也就不太會有障礙了 😁。<br>且在排版上還有表格告知你什麼 component 要在什麼區塊內才能用，多佛心啊～<br><img src=\"https://i.imgur.com/Fowpoyb.png\" alt><br><img src=\"https://i.imgur.com/zELPSA0.png\" alt></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>API 文件</p>\n<ul>\n<li>在最近幾個月的時候 LINE 的文件有改版，讓某些 API 可以在線上就能測了，看起來是滿讚的，若在逛文件時碰巧想測試這些功能的話可以直接把相關參數放進去，在某些時候也是滿方便的。<br><img src=\"https://i.imgur.com/CuFdmcH.png\" alt></li>\n</ul>\n</li>\n<li><p>LIFF (LINE Front-end Framework)</p>\n<ul>\n<li>個人覺得他讓 Bot 的發揮功力又更上一層樓了，以前很多開發者都會覺得在與機器人對談中會有很多東西是不好做的，像是購物車的流程，若使用者在流程中按了上面的按鈕的話可能會發生無法預期的錯誤，且得用其他的服務去儲存操作狀態，在開發上就很麻煩，那 LIFF 就讓這個流程可以簡單許多，且能透過 SDK 在網頁上取得使用者的資訊，讓網站再被使用的同時還可以確認身份。</li>\n</ul>\n</li>\n<li><p>推播 500 則</p>\n<ul>\n<li>在今年 OAuth 2.0 釋出當中推播則數也跟改動了，改成 500 則後其實看到不少的使用者在跳腳怎麼改成這樣，或是另類的變貴收費，只能說 LINE 也是要找方法收點費用呀，不然很多功能爽爽用他們也沒有地方去收費，這部分因為我也是少用，推播功能就都交給 <code>LINE Notify</code> 嚕！</li>\n</ul>\n</li>\n<li><p>客服與機器人的切換</p>\n<ul>\n<li>參考 C.T Lin 大大的文章 <a href=\"https://ithelp.ithome.com.tw/articles/10220717\" target=\"_blank\" rel=\"noopener\">Day10</a>，簡單來說 Messager 可以在機器人處理不來的時候將訊息轉丟給設定的那位管理員，讓他來回覆訊息，但 LINE 在機器人上只能透過網頁去切換機器人狀態，抑或是自己設計流程讓機器人在無法處理才通知管理員，這樣的話管理員很容易錯過黃金的第一時間，可能也會因此造成使用者的不便。</li>\n</ul>\n</li>\n<li><p>個人的 mur mur 🤣</p>\n<ul>\n<li>文件實在是太瀑布式了，雖然現在都懂的如何搜尋到相對應的功能，但若一般想開發的使用者在看到這個文件時瘋狂往下滑，結果發現還沒有滑到或是滑過頭，倒是找資料時氣得要死 😓，所以若是文件能夠分個頁籤什麼就更好了～</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>當然整體來說還是很喜歡使用 LINE 這個平台(絕對不是因為熊大 🐻)，東西也不會像一開始在開發時什麼都找不太到，並且功能一直 release，讓服務可以透過不同的整合方法去達成目標，接下來 LINE 應該還會再繼續釋出不同的東西，就請大家拭目以待，或者…來參加<a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\"> chatbot 小聚</a>直接問問 LINE 的傳教士如何呢 😁</p>\n"},{"title":"Day3 - LINE Notify 介紹","abbrlink":2871688541,"date":"2019-09-18T06:21:37.000Z","_content":"\nLINE Notify 顧名思義就是通知屬性的服務，這個服務不是 LINE 的 Message API，千外別把這兩個搞在一起哦！\n\n在實作前要先認識一下在接的 api 服務原理\n首先先參考[LINE Notify 官網](https://notify-bot.line.me/doc/en/)\n開頭的介紹：\n\n> Overview: Becomes a provider based on OAuth2 (https://tools.ietf.org/html/rfc6749). The authentication method is authorization_code. The access token acquired here can only be used for notification services\n\n不負責任翻譯: 這個服務是基於 OAuth2 實作的，授權模式(grant_type)是 authorization_code [參考](https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html)\naccess_token 則是只能讓通知服務所使用的一個鑰匙\n\n```\n更詳細的流程可以參考 https://blog.yorkxin.org/2013/09/30/oauth2-4-1-auth-code-grant-flow.html\n```\n\n> The host name for authentication API endpoint is notify-bot.line.me.\n\n然後 API 的網址是 `notify-bot.line.me`\n\n接著我們來看看流程圖\n![https://notify-bot.line.me/doc/en/](https://i.imgur.com/kmt0zrV.png)\n\n- 當使用者拜訪你的網站時，會導向 LINE 請求認證\n- 認證過了之後會回傳一個名為 code 的參數\n- 接著網站需要持這個 code 在去找 LINE 討東西\n- 討成功後就會拿到一個 access_token\n- 網站就會知道這個 access_token = 來註冊的使用者\n- 然後就可以透過 access_token 發送通知給使用者了?\n\n# 事前準備\n\n首先就是要先加入他好友，如果之前有不小心**封鎖**的話要記得解除封鎖哦，不然後續會收不到消息。\n![https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png](https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png)\n\n下一篇會帶著時做出簡單的 index.html + 使用 Serverless 蓋我們第一個 API 來做認證。\n會使用到 LINE Notify 的 API 為以下三個，不清楚裡面實際上功能的朋友可以嗑一下[官網文件](https://notify-bot.line.me/doc/en/)\n\n```javascript=\nGET https: //notify-bot.line.me/oauth/authorize -> 前往認證拿到 code 參數\nPOST https://notify-bot.line.me/oauth/token -> 拿 code 參數換 access_token\nPOST https://notify-api.line.me/api/notify -> 發送訊息\n```\n\n# 其他\n\n今年中有帶著朝陽的學弟妹手把手實作 LINE Notify，如果只想自己用的話可以參考我之前[簡報](https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527)\n\n[LINE Notify](https://notify-bot.line.me/zh_TW/)\n[如何快速建置一個 LINE Notify 的服務](https://www.evanlin.com/go-line-notify/)\n","source":"_posts/Day3-LINE-Notify-介紹.md","raw":"---\ntitle: Day3 - LINE Notify 介紹\ntags:\n  - LINE\n  - Notify\ncategories: 2019鐵人賽\nabbrlink: 2871688541\ndate: 2019-09-18 14:21:37\n---\n\nLINE Notify 顧名思義就是通知屬性的服務，這個服務不是 LINE 的 Message API，千外別把這兩個搞在一起哦！\n\n在實作前要先認識一下在接的 api 服務原理\n首先先參考[LINE Notify 官網](https://notify-bot.line.me/doc/en/)\n開頭的介紹：\n\n> Overview: Becomes a provider based on OAuth2 (https://tools.ietf.org/html/rfc6749). The authentication method is authorization_code. The access token acquired here can only be used for notification services\n\n不負責任翻譯: 這個服務是基於 OAuth2 實作的，授權模式(grant_type)是 authorization_code [參考](https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html)\naccess_token 則是只能讓通知服務所使用的一個鑰匙\n\n```\n更詳細的流程可以參考 https://blog.yorkxin.org/2013/09/30/oauth2-4-1-auth-code-grant-flow.html\n```\n\n> The host name for authentication API endpoint is notify-bot.line.me.\n\n然後 API 的網址是 `notify-bot.line.me`\n\n接著我們來看看流程圖\n![https://notify-bot.line.me/doc/en/](https://i.imgur.com/kmt0zrV.png)\n\n- 當使用者拜訪你的網站時，會導向 LINE 請求認證\n- 認證過了之後會回傳一個名為 code 的參數\n- 接著網站需要持這個 code 在去找 LINE 討東西\n- 討成功後就會拿到一個 access_token\n- 網站就會知道這個 access_token = 來註冊的使用者\n- 然後就可以透過 access_token 發送通知給使用者了?\n\n# 事前準備\n\n首先就是要先加入他好友，如果之前有不小心**封鎖**的話要記得解除封鎖哦，不然後續會收不到消息。\n![https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png](https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png)\n\n下一篇會帶著時做出簡單的 index.html + 使用 Serverless 蓋我們第一個 API 來做認證。\n會使用到 LINE Notify 的 API 為以下三個，不清楚裡面實際上功能的朋友可以嗑一下[官網文件](https://notify-bot.line.me/doc/en/)\n\n```javascript=\nGET https: //notify-bot.line.me/oauth/authorize -> 前往認證拿到 code 參數\nPOST https://notify-bot.line.me/oauth/token -> 拿 code 參數換 access_token\nPOST https://notify-api.line.me/api/notify -> 發送訊息\n```\n\n# 其他\n\n今年中有帶著朝陽的學弟妹手把手實作 LINE Notify，如果只想自己用的話可以參考我之前[簡報](https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527)\n\n[LINE Notify](https://notify-bot.line.me/zh_TW/)\n[如何快速建置一個 LINE Notify 的服務](https://www.evanlin.com/go-line-notify/)\n","slug":"Day3-LINE-Notify-介紹","published":1,"updated":"2020-06-19T14:03:58.854Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k2002j7crijk9vvb1x","content":"<p>LINE Notify 顧名思義就是通知屬性的服務，這個服務不是 LINE 的 Message API，千外別把這兩個搞在一起哦！</p>\n<p>在實作前要先認識一下在接的 api 服務原理<br>首先先參考<a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">LINE Notify 官網</a><br>開頭的介紹：</p>\n<blockquote>\n<p>Overview: Becomes a provider based on OAuth2 (<a href=\"https://tools.ietf.org/html/rfc6749\" target=\"_blank\" rel=\"noopener\">https://tools.ietf.org/html/rfc6749</a>). The authentication method is authorization_code. The access token acquired here can only be used for notification services</p>\n</blockquote>\n<p>不負責任翻譯: 這個服務是基於 OAuth2 實作的，授權模式(grant_type)是 authorization_code <a href=\"https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\" target=\"_blank\" rel=\"noopener\">參考</a><br>access_token 則是只能讓通知服務所使用的一個鑰匙</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">更詳細的流程可以參考 https://blog.yorkxin.org/2013/09/30/oauth2-4-1-auth-code-grant-flow.html</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>The host name for authentication API endpoint is notify-bot.line.me.</p>\n</blockquote>\n<p>然後 API 的網址是 <code>notify-bot.line.me</code></p>\n<p>接著我們來看看流程圖<br><img src=\"https://i.imgur.com/kmt0zrV.png\" alt=\"https://notify-bot.line.me/doc/en/\"></p>\n<ul>\n<li>當使用者拜訪你的網站時，會導向 LINE 請求認證</li>\n<li>認證過了之後會回傳一個名為 code 的參數</li>\n<li>接著網站需要持這個 code 在去找 LINE 討東西</li>\n<li>討成功後就會拿到一個 access_token</li>\n<li>網站就會知道這個 access_token = 來註冊的使用者</li>\n<li>然後就可以透過 access_token 發送通知給使用者了?</li>\n</ul>\n<h1 id=\"事前準備\"><a href=\"#事前準備\" class=\"headerlink\" title=\"事前準備\"></a>事前準備</h1><p>首先就是要先加入他好友，如果之前有不小心<strong>封鎖</strong>的話要記得解除封鎖哦，不然後續會收不到消息。<br><img src=\"https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png\" alt=\"https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png\"></p>\n<p>下一篇會帶著時做出簡單的 index.html + 使用 Serverless 蓋我們第一個 API 來做認證。<br>會使用到 LINE Notify 的 API 為以下三個，不清楚裡面實際上功能的朋友可以嗑一下<a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">官網文件</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https: <span class=\"comment\">//notify-bot.line.me/oauth/authorize -&gt; 前往認證拿到 code 參數</span></span><br><span class=\"line\">POST https:<span class=\"comment\">//notify-bot.line.me/oauth/token -&gt; 拿 code 參數換 access_token</span></span><br><span class=\"line\">POST https:<span class=\"comment\">//notify-api.line.me/api/notify -&gt; 發送訊息</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h1><p>今年中有帶著朝陽的學弟妹手把手實作 LINE Notify，如果只想自己用的話可以參考我之前<a href=\"https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527\" target=\"_blank\" rel=\"noopener\">簡報</a></p>\n<p><a href=\"https://notify-bot.line.me/zh_TW/\" target=\"_blank\" rel=\"noopener\">LINE Notify</a><br><a href=\"https://www.evanlin.com/go-line-notify/\" target=\"_blank\" rel=\"noopener\">如何快速建置一個 LINE Notify 的服務</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>LINE Notify 顧名思義就是通知屬性的服務，這個服務不是 LINE 的 Message API，千外別把這兩個搞在一起哦！</p>\n<p>在實作前要先認識一下在接的 api 服務原理<br>首先先參考<a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">LINE Notify 官網</a><br>開頭的介紹：</p>\n<blockquote>\n<p>Overview: Becomes a provider based on OAuth2 (<a href=\"https://tools.ietf.org/html/rfc6749\" target=\"_blank\" rel=\"noopener\">https://tools.ietf.org/html/rfc6749</a>). The authentication method is authorization_code. The access token acquired here can only be used for notification services</p>\n</blockquote>\n<p>不負責任翻譯: 這個服務是基於 OAuth2 實作的，授權模式(grant_type)是 authorization_code <a href=\"https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\" target=\"_blank\" rel=\"noopener\">參考</a><br>access_token 則是只能讓通知服務所使用的一個鑰匙</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">更詳細的流程可以參考 https://blog.yorkxin.org/2013/09/30/oauth2-4-1-auth-code-grant-flow.html</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>The host name for authentication API endpoint is notify-bot.line.me.</p>\n</blockquote>\n<p>然後 API 的網址是 <code>notify-bot.line.me</code></p>\n<p>接著我們來看看流程圖<br><img src=\"https://i.imgur.com/kmt0zrV.png\" alt=\"https://notify-bot.line.me/doc/en/\"></p>\n<ul>\n<li>當使用者拜訪你的網站時，會導向 LINE 請求認證</li>\n<li>認證過了之後會回傳一個名為 code 的參數</li>\n<li>接著網站需要持這個 code 在去找 LINE 討東西</li>\n<li>討成功後就會拿到一個 access_token</li>\n<li>網站就會知道這個 access_token = 來註冊的使用者</li>\n<li>然後就可以透過 access_token 發送通知給使用者了?</li>\n</ul>\n<h1 id=\"事前準備\"><a href=\"#事前準備\" class=\"headerlink\" title=\"事前準備\"></a>事前準備</h1><p>首先就是要先加入他好友，如果之前有不小心<strong>封鎖</strong>的話要記得解除封鎖哦，不然後續會收不到消息。<br><img src=\"https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png\" alt=\"https://ithelp.ithome.com.tw/upload/images/20190903/20111481Zno98NSHwL.png\"></p>\n<p>下一篇會帶著時做出簡單的 index.html + 使用 Serverless 蓋我們第一個 API 來做認證。<br>會使用到 LINE Notify 的 API 為以下三個，不清楚裡面實際上功能的朋友可以嗑一下<a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">官網文件</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https: <span class=\"comment\">//notify-bot.line.me/oauth/authorize -&gt; 前往認證拿到 code 參數</span></span><br><span class=\"line\">POST https:<span class=\"comment\">//notify-bot.line.me/oauth/token -&gt; 拿 code 參數換 access_token</span></span><br><span class=\"line\">POST https:<span class=\"comment\">//notify-api.line.me/api/notify -&gt; 發送訊息</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h1><p>今年中有帶著朝陽的學弟妹手把手實作 LINE Notify，如果只想自己用的話可以參考我之前<a href=\"https://www.slideshare.net/JiaYuLin6/step-by-step-to-use-line-notify-20190527\" target=\"_blank\" rel=\"noopener\">簡報</a></p>\n<p><a href=\"https://notify-bot.line.me/zh_TW/\" target=\"_blank\" rel=\"noopener\">LINE Notify</a><br><a href=\"https://www.evanlin.com/go-line-notify/\" target=\"_blank\" rel=\"noopener\">如何快速建置一個 LINE Notify 的服務</a></p>\n"},{"title":"Day30 - 老是在吹 Serverless，他真的有那麼好？","abbrlink":840027886,"date":"2019-10-14T13:09:01.000Z","_content":"\n## Cold start\n\n其實個家園端平台多少都會有這問題，畢竟大家都是靠流量賺錢，自然會需要個方法限制使用者，不然免費爽爽用他們也不是做慈善的 🤣，像我最常用的 `Heroku`，只要 30 分鐘沒有使用他就會進入睡眠時間([參考](https://devcenter.heroku.com/articles/free-dyno-hours))，叫醒的時間需要 10~15 秒，不過對於我這個免費宅來說測試夠用了 🤣\n\n`AWS`以我實際測試起來大概 2 秒左右，回應時間看起來不會太差，其實[第一天](https://ithelp.ithome.com.tw/articles/10213431)就有提到這部分，需要的話可以參考。\n\n若是需要它隨時都在都活著的話就要搭配 [warm-up](https://ithelp.ithome.com.tw/articles/10226742)，抑或是搭配 crontab 去設定特定時間執行 warm-up。\n\n## Function as a Service\n\n在快速成長的前、中期是很適合這個服務的，\b\b\b 畢竟開發者只要將 `serverless.yml` 基本設定完之後就可以先好好開發，等到中期之後把設定檔稍微整理一下又是一尾活龍了，且平台大多都擁有 [auto-scaling](https://aws.amazon.com/tw/autoscaling/) 的功能，在服務快扛不住流量的時候只要錢拿出來平台就幫你解決。\n\n只是說當流量越來越大之後相對錢也會越付越多，或許當流量 > 10K 之後代表你的服務應該也有不少人使用了，自己架主機應該不會是什麼難事(?)\n\n> 幫忙推廣一下 Backend 大大的 [高流量心得雜談](https://github.com/TritonHo/slides/blob/master/Taipei%202019-10%20talk/concurrency.pdf?fbclid=IwAR3R67wIt5fXPjG3hZNHaVw3tuCVrpNJtIdecTTIiQz0dgT-bZwymIYLYiA)\n\n在 FaaS 架構下其實很適合 Chatbot 的服務，以概念來說實作時只需要一個路由**(Function)**即個完成，不需要額外太多的資源去處理 web server 的問題，像是這個系列的只要透過 `serverless` + `WSGI` 就可以馬上就可以進行本地測試，部署只要下 `sls deploy`，實在是超級快又輕鬆，不用像以前一樣還要去處理 Nginx 等等相關的問題 😁。\n\n且 AWS、Google 在使用 python 跟 nodejs 上支援度很高，也不用怕找不到資源使用。\n\n> 使用 Node JS 的朋友可以參考 C.T Lin 大大的[文章](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)，他們家的 bottender 超猛的！\n\n## Log\n\n在 Log 這部分我覺得 AWS 有點不太好的地方就是他們的 Cloud Watch 應該是獨立服務，當我的 Lambda 輸出紀錄時大概要過 10 秒才會印出來，不像以前自己架主機時只要進 server 就可以馬上切到目錄看紀錄抓蟲，在使用這雲端服務可能在抓蟲有一半的時間都在等 log 出來，有時候急的時候還真的會被氣死 😭。\n\n## SNS\n\n像是我前一陣子發的[一篇文章](https://medium.com/@nijia.lin/use-serverless-corn-to-execute-sns-getendpointattributes-returns-old-data-after-e7df7c09b45b)，SNS 被觸發事件之後回來的東西是舊的，那時候看到錯誤訊息真的是心很涼，就得用一個 Lambda 排程一直去抓 DB 的 updated_at 欄位有沒有變更時間而去更新狀態，這樣情況就會多浪費一個 Function 去處理這樣的事件，不得不說專門來支援 AWS 服務的 boto3 套件(python)在某些時候做的事不是那麼完善，得使用旁門做到的方法去完成這件事，讓整個開發體驗不是那麼好，若他們可以把一些 error handle 弄更好那就完美了。\n\n## 結論\n\n> ~~其實還有好多服務沒有玩到~~\n\n但其實使用 AWS 來實作 Serverless 的服務也是這一陣子加入新公司所學到的新技能，過程中總是會用舊的開發思維去想，但常常都因為這樣落坑 😓，但也因此讓我更了解像 AWS 這類的雲服務他們是如何開發每個服務並如何串接，同時也研究了 Serverless 相關的 plugins，看他們是如何支援雲平台讓開發者在開發時可以更像平常時在開發 web，也因為這樣我去貢獻了 example 到了 Serverless 的範例專案上面([參考](https://github.com/serverless/examples/pulls?q=is%3Apr+author%3Alouis70109+is%3Aclosed))，慶祝完成人生第一場鐵三十，跟自己的競賽也告一段落，發現趕著寫文章品質真的會差很多，看來是時候該整理一下，謝謝您的收看 <(\\_ \\_)>\n","source":"_posts/Day30-老是在吹-Serverless，他真的有那麼好？.md","raw":"---\ntitle: Day30 - 老是在吹 Serverless，他真的有那麼好？\ntags:\n  - AWS\ncategories: 2019鐵人賽\nabbrlink: 840027886\ndate: 2019-10-14 21:09:01\n---\n\n## Cold start\n\n其實個家園端平台多少都會有這問題，畢竟大家都是靠流量賺錢，自然會需要個方法限制使用者，不然免費爽爽用他們也不是做慈善的 🤣，像我最常用的 `Heroku`，只要 30 分鐘沒有使用他就會進入睡眠時間([參考](https://devcenter.heroku.com/articles/free-dyno-hours))，叫醒的時間需要 10~15 秒，不過對於我這個免費宅來說測試夠用了 🤣\n\n`AWS`以我實際測試起來大概 2 秒左右，回應時間看起來不會太差，其實[第一天](https://ithelp.ithome.com.tw/articles/10213431)就有提到這部分，需要的話可以參考。\n\n若是需要它隨時都在都活著的話就要搭配 [warm-up](https://ithelp.ithome.com.tw/articles/10226742)，抑或是搭配 crontab 去設定特定時間執行 warm-up。\n\n## Function as a Service\n\n在快速成長的前、中期是很適合這個服務的，\b\b\b 畢竟開發者只要將 `serverless.yml` 基本設定完之後就可以先好好開發，等到中期之後把設定檔稍微整理一下又是一尾活龍了，且平台大多都擁有 [auto-scaling](https://aws.amazon.com/tw/autoscaling/) 的功能，在服務快扛不住流量的時候只要錢拿出來平台就幫你解決。\n\n只是說當流量越來越大之後相對錢也會越付越多，或許當流量 > 10K 之後代表你的服務應該也有不少人使用了，自己架主機應該不會是什麼難事(?)\n\n> 幫忙推廣一下 Backend 大大的 [高流量心得雜談](https://github.com/TritonHo/slides/blob/master/Taipei%202019-10%20talk/concurrency.pdf?fbclid=IwAR3R67wIt5fXPjG3hZNHaVw3tuCVrpNJtIdecTTIiQz0dgT-bZwymIYLYiA)\n\n在 FaaS 架構下其實很適合 Chatbot 的服務，以概念來說實作時只需要一個路由**(Function)**即個完成，不需要額外太多的資源去處理 web server 的問題，像是這個系列的只要透過 `serverless` + `WSGI` 就可以馬上就可以進行本地測試，部署只要下 `sls deploy`，實在是超級快又輕鬆，不用像以前一樣還要去處理 Nginx 等等相關的問題 😁。\n\n且 AWS、Google 在使用 python 跟 nodejs 上支援度很高，也不用怕找不到資源使用。\n\n> 使用 Node JS 的朋友可以參考 C.T Lin 大大的[文章](https://ithelp.ithome.com.tw/users/20103630/ironman/2798)，他們家的 bottender 超猛的！\n\n## Log\n\n在 Log 這部分我覺得 AWS 有點不太好的地方就是他們的 Cloud Watch 應該是獨立服務，當我的 Lambda 輸出紀錄時大概要過 10 秒才會印出來，不像以前自己架主機時只要進 server 就可以馬上切到目錄看紀錄抓蟲，在使用這雲端服務可能在抓蟲有一半的時間都在等 log 出來，有時候急的時候還真的會被氣死 😭。\n\n## SNS\n\n像是我前一陣子發的[一篇文章](https://medium.com/@nijia.lin/use-serverless-corn-to-execute-sns-getendpointattributes-returns-old-data-after-e7df7c09b45b)，SNS 被觸發事件之後回來的東西是舊的，那時候看到錯誤訊息真的是心很涼，就得用一個 Lambda 排程一直去抓 DB 的 updated_at 欄位有沒有變更時間而去更新狀態，這樣情況就會多浪費一個 Function 去處理這樣的事件，不得不說專門來支援 AWS 服務的 boto3 套件(python)在某些時候做的事不是那麼完善，得使用旁門做到的方法去完成這件事，讓整個開發體驗不是那麼好，若他們可以把一些 error handle 弄更好那就完美了。\n\n## 結論\n\n> ~~其實還有好多服務沒有玩到~~\n\n但其實使用 AWS 來實作 Serverless 的服務也是這一陣子加入新公司所學到的新技能，過程中總是會用舊的開發思維去想，但常常都因為這樣落坑 😓，但也因此讓我更了解像 AWS 這類的雲服務他們是如何開發每個服務並如何串接，同時也研究了 Serverless 相關的 plugins，看他們是如何支援雲平台讓開發者在開發時可以更像平常時在開發 web，也因為這樣我去貢獻了 example 到了 Serverless 的範例專案上面([參考](https://github.com/serverless/examples/pulls?q=is%3Apr+author%3Alouis70109+is%3Aclosed))，慶祝完成人生第一場鐵三十，跟自己的競賽也告一段落，發現趕著寫文章品質真的會差很多，看來是時候該整理一下，謝謝您的收看 <(\\_ \\_)>\n","slug":"Day30-老是在吹-Serverless，他真的有那麼好？","published":1,"updated":"2020-06-19T14:03:58.848Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k4002n7crisglty9dg","content":"<h2 id=\"Cold-start\"><a href=\"#Cold-start\" class=\"headerlink\" title=\"Cold start\"></a>Cold start</h2><p>其實個家園端平台多少都會有這問題，畢竟大家都是靠流量賺錢，自然會需要個方法限制使用者，不然免費爽爽用他們也不是做慈善的 🤣，像我最常用的 <code>Heroku</code>，只要 30 分鐘沒有使用他就會進入睡眠時間(<a href=\"https://devcenter.heroku.com/articles/free-dyno-hours\" target=\"_blank\" rel=\"noopener\">參考</a>)，叫醒的時間需要 10~15 秒，不過對於我這個免費宅來說測試夠用了 🤣</p>\n<p><code>AWS</code>以我實際測試起來大概 2 秒左右，回應時間看起來不會太差，其實<a href=\"https://ithelp.ithome.com.tw/articles/10213431\" target=\"_blank\" rel=\"noopener\">第一天</a>就有提到這部分，需要的話可以參考。</p>\n<p>若是需要它隨時都在都活著的話就要搭配 <a href=\"https://ithelp.ithome.com.tw/articles/10226742\" target=\"_blank\" rel=\"noopener\">warm-up</a>，抑或是搭配 crontab 去設定特定時間執行 warm-up。</p>\n<h2 id=\"Function-as-a-Service\"><a href=\"#Function-as-a-Service\" class=\"headerlink\" title=\"Function as a Service\"></a>Function as a Service</h2><p>在快速成長的前、中期是很適合這個服務的，\b\b\b 畢竟開發者只要將 <code>serverless.yml</code> 基本設定完之後就可以先好好開發，等到中期之後把設定檔稍微整理一下又是一尾活龍了，且平台大多都擁有 <a href=\"https://aws.amazon.com/tw/autoscaling/\" target=\"_blank\" rel=\"noopener\">auto-scaling</a> 的功能，在服務快扛不住流量的時候只要錢拿出來平台就幫你解決。</p>\n<p>只是說當流量越來越大之後相對錢也會越付越多，或許當流量 &gt; 10K 之後代表你的服務應該也有不少人使用了，自己架主機應該不會是什麼難事(?)</p>\n<blockquote>\n<p>幫忙推廣一下 Backend 大大的 <a href=\"https://github.com/TritonHo/slides/blob/master/Taipei%202019-10%20talk/concurrency.pdf?fbclid=IwAR3R67wIt5fXPjG3hZNHaVw3tuCVrpNJtIdecTTIiQz0dgT-bZwymIYLYiA\" target=\"_blank\" rel=\"noopener\">高流量心得雜談</a></p>\n</blockquote>\n<p>在 FaaS 架構下其實很適合 Chatbot 的服務，以概念來說實作時只需要一個路由<strong>(Function)</strong>即個完成，不需要額外太多的資源去處理 web server 的問題，像是這個系列的只要透過 <code>serverless</code> + <code>WSGI</code> 就可以馬上就可以進行本地測試，部署只要下 <code>sls deploy</code>，實在是超級快又輕鬆，不用像以前一樣還要去處理 Nginx 等等相關的問題 😁。</p>\n<p>且 AWS、Google 在使用 python 跟 nodejs 上支援度很高，也不用怕找不到資源使用。</p>\n<blockquote>\n<p>使用 Node JS 的朋友可以參考 C.T Lin 大大的<a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">文章</a>，他們家的 bottender 超猛的！</p>\n</blockquote>\n<h2 id=\"Log\"><a href=\"#Log\" class=\"headerlink\" title=\"Log\"></a>Log</h2><p>在 Log 這部分我覺得 AWS 有點不太好的地方就是他們的 Cloud Watch 應該是獨立服務，當我的 Lambda 輸出紀錄時大概要過 10 秒才會印出來，不像以前自己架主機時只要進 server 就可以馬上切到目錄看紀錄抓蟲，在使用這雲端服務可能在抓蟲有一半的時間都在等 log 出來，有時候急的時候還真的會被氣死 😭。</p>\n<h2 id=\"SNS\"><a href=\"#SNS\" class=\"headerlink\" title=\"SNS\"></a>SNS</h2><p>像是我前一陣子發的<a href=\"https://medium.com/@nijia.lin/use-serverless-corn-to-execute-sns-getendpointattributes-returns-old-data-after-e7df7c09b45b\" target=\"_blank\" rel=\"noopener\">一篇文章</a>，SNS 被觸發事件之後回來的東西是舊的，那時候看到錯誤訊息真的是心很涼，就得用一個 Lambda 排程一直去抓 DB 的 updated_at 欄位有沒有變更時間而去更新狀態，這樣情況就會多浪費一個 Function 去處理這樣的事件，不得不說專門來支援 AWS 服務的 boto3 套件(python)在某些時候做的事不是那麼完善，得使用旁門做到的方法去完成這件事，讓整個開發體驗不是那麼好，若他們可以把一些 error handle 弄更好那就完美了。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><blockquote>\n<p><del>其實還有好多服務沒有玩到</del></p>\n</blockquote>\n<p>但其實使用 AWS 來實作 Serverless 的服務也是這一陣子加入新公司所學到的新技能，過程中總是會用舊的開發思維去想，但常常都因為這樣落坑 😓，但也因此讓我更了解像 AWS 這類的雲服務他們是如何開發每個服務並如何串接，同時也研究了 Serverless 相關的 plugins，看他們是如何支援雲平台讓開發者在開發時可以更像平常時在開發 web，也因為這樣我去貢獻了 example 到了 Serverless 的範例專案上面(<a href=\"https://github.com/serverless/examples/pulls?q=is%3Apr+author%3Alouis70109+is%3Aclosed\" target=\"_blank\" rel=\"noopener\">參考</a>)，慶祝完成人生第一場鐵三十，跟自己的競賽也告一段落，發現趕著寫文章品質真的會差很多，看來是時候該整理一下，謝謝您的收看 &lt;(_ _)&gt;</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Cold-start\"><a href=\"#Cold-start\" class=\"headerlink\" title=\"Cold start\"></a>Cold start</h2><p>其實個家園端平台多少都會有這問題，畢竟大家都是靠流量賺錢，自然會需要個方法限制使用者，不然免費爽爽用他們也不是做慈善的 🤣，像我最常用的 <code>Heroku</code>，只要 30 分鐘沒有使用他就會進入睡眠時間(<a href=\"https://devcenter.heroku.com/articles/free-dyno-hours\" target=\"_blank\" rel=\"noopener\">參考</a>)，叫醒的時間需要 10~15 秒，不過對於我這個免費宅來說測試夠用了 🤣</p>\n<p><code>AWS</code>以我實際測試起來大概 2 秒左右，回應時間看起來不會太差，其實<a href=\"https://ithelp.ithome.com.tw/articles/10213431\" target=\"_blank\" rel=\"noopener\">第一天</a>就有提到這部分，需要的話可以參考。</p>\n<p>若是需要它隨時都在都活著的話就要搭配 <a href=\"https://ithelp.ithome.com.tw/articles/10226742\" target=\"_blank\" rel=\"noopener\">warm-up</a>，抑或是搭配 crontab 去設定特定時間執行 warm-up。</p>\n<h2 id=\"Function-as-a-Service\"><a href=\"#Function-as-a-Service\" class=\"headerlink\" title=\"Function as a Service\"></a>Function as a Service</h2><p>在快速成長的前、中期是很適合這個服務的，\b\b\b 畢竟開發者只要將 <code>serverless.yml</code> 基本設定完之後就可以先好好開發，等到中期之後把設定檔稍微整理一下又是一尾活龍了，且平台大多都擁有 <a href=\"https://aws.amazon.com/tw/autoscaling/\" target=\"_blank\" rel=\"noopener\">auto-scaling</a> 的功能，在服務快扛不住流量的時候只要錢拿出來平台就幫你解決。</p>\n<p>只是說當流量越來越大之後相對錢也會越付越多，或許當流量 &gt; 10K 之後代表你的服務應該也有不少人使用了，自己架主機應該不會是什麼難事(?)</p>\n<blockquote>\n<p>幫忙推廣一下 Backend 大大的 <a href=\"https://github.com/TritonHo/slides/blob/master/Taipei%202019-10%20talk/concurrency.pdf?fbclid=IwAR3R67wIt5fXPjG3hZNHaVw3tuCVrpNJtIdecTTIiQz0dgT-bZwymIYLYiA\" target=\"_blank\" rel=\"noopener\">高流量心得雜談</a></p>\n</blockquote>\n<p>在 FaaS 架構下其實很適合 Chatbot 的服務，以概念來說實作時只需要一個路由<strong>(Function)</strong>即個完成，不需要額外太多的資源去處理 web server 的問題，像是這個系列的只要透過 <code>serverless</code> + <code>WSGI</code> 就可以馬上就可以進行本地測試，部署只要下 <code>sls deploy</code>，實在是超級快又輕鬆，不用像以前一樣還要去處理 Nginx 等等相關的問題 😁。</p>\n<p>且 AWS、Google 在使用 python 跟 nodejs 上支援度很高，也不用怕找不到資源使用。</p>\n<blockquote>\n<p>使用 Node JS 的朋友可以參考 C.T Lin 大大的<a href=\"https://ithelp.ithome.com.tw/users/20103630/ironman/2798\" target=\"_blank\" rel=\"noopener\">文章</a>，他們家的 bottender 超猛的！</p>\n</blockquote>\n<h2 id=\"Log\"><a href=\"#Log\" class=\"headerlink\" title=\"Log\"></a>Log</h2><p>在 Log 這部分我覺得 AWS 有點不太好的地方就是他們的 Cloud Watch 應該是獨立服務，當我的 Lambda 輸出紀錄時大概要過 10 秒才會印出來，不像以前自己架主機時只要進 server 就可以馬上切到目錄看紀錄抓蟲，在使用這雲端服務可能在抓蟲有一半的時間都在等 log 出來，有時候急的時候還真的會被氣死 😭。</p>\n<h2 id=\"SNS\"><a href=\"#SNS\" class=\"headerlink\" title=\"SNS\"></a>SNS</h2><p>像是我前一陣子發的<a href=\"https://medium.com/@nijia.lin/use-serverless-corn-to-execute-sns-getendpointattributes-returns-old-data-after-e7df7c09b45b\" target=\"_blank\" rel=\"noopener\">一篇文章</a>，SNS 被觸發事件之後回來的東西是舊的，那時候看到錯誤訊息真的是心很涼，就得用一個 Lambda 排程一直去抓 DB 的 updated_at 欄位有沒有變更時間而去更新狀態，這樣情況就會多浪費一個 Function 去處理這樣的事件，不得不說專門來支援 AWS 服務的 boto3 套件(python)在某些時候做的事不是那麼完善，得使用旁門做到的方法去完成這件事，讓整個開發體驗不是那麼好，若他們可以把一些 error handle 弄更好那就完美了。</p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><blockquote>\n<p><del>其實還有好多服務沒有玩到</del></p>\n</blockquote>\n<p>但其實使用 AWS 來實作 Serverless 的服務也是這一陣子加入新公司所學到的新技能，過程中總是會用舊的開發思維去想，但常常都因為這樣落坑 😓，但也因此讓我更了解像 AWS 這類的雲服務他們是如何開發每個服務並如何串接，同時也研究了 Serverless 相關的 plugins，看他們是如何支援雲平台讓開發者在開發時可以更像平常時在開發 web，也因為這樣我去貢獻了 example 到了 Serverless 的範例專案上面(<a href=\"https://github.com/serverless/examples/pulls?q=is%3Apr+author%3Alouis70109+is%3Aclosed\" target=\"_blank\" rel=\"noopener\">參考</a>)，慶祝完成人生第一場鐵三十，跟自己的競賽也告一段落，發現趕著寫文章品質真的會差很多，看來是時候該整理一下，謝謝您的收看 &lt;(_ _)&gt;</p>\n"},{"title":"Day4 - 認識與使用 S3 容器","abbrlink":931534491,"date":"2019-09-19T07:44:36.000Z","_content":"\n## 前言\n\nAmazon Simple Storage Service(簡稱 AWS S3)是 AWS 的一個線上儲存服務，用戶能夠輕易把檔案儲存到網路伺服器上，可能有些朋友會把它當成雲端硬碟看待，但其實還能像是傳靜態檔案上去，若有寫前端框架的朋友通常都會需要把程式碼打包成靜態檔案再部署，然而這邊把他打包送上去後，S3 會給一個名為 Object Url 的網址，可以透過這個網址去執行網頁裡面的內容(如 AJAX、Axios...)，並可以透過 cloudfont 去弄成 CDN(扯遠了)，簡單說他還有很多不一樣的功能應用等著大家去用～\n\n因為 serverless 只能放關於 API 的程式碼，因此我們需要把 html 靜態檔案放在 S3 裡，\n\n接下來就來建立一個公開的 S3 容器，這邊就不會提到權限如何控管哦！\n\n## 建立一個公開的 S3 容器\n\n建立一個名為`2019-it-30-bucket`的容器，地區就選與 Lambda 同樣的地區，直接按下左下角的`create`來建立。\n![](https://i.imgur.com/lfRsTDn.png)\n\n建立完會像這樣\n![](https://i.imgur.com/SgPTxsQ.png)\n接著點進去後在點到第三個選項會看到 Block of public access 是啟動的狀態，因為我們接下來需要讓我們的頁面可以外部使用\n![](https://i.imgur.com/M065zbI.png)\n就把 check box 的按掉，在按下 `Save`\n![](https://i.imgur.com/SjT0qY7.png)\n要輸入`confirm`就修改完成嚕\n![](https://i.imgur.com/qxquZI1.png)\n接著一樣點到第三個個選項，選到`Access Control List`，看到`Access for bucket owner`這個選項的`Canonical ID`，選項都全部打勾之後再來調整，這樣之後的 HTML 檔案外面就看得到了。\n![](https://i.imgur.com/uZfyrAQ.png)\n\n## 測試\n\n接著上傳一個`index.html`的檔案來測試\n\n```\n<html>\n<h1>Hello world</h1>\n</html>\n```\n\n上傳後下拉式選單選擇`public read`的選項，因為一個檔案在 S3 就算是一個 Object，所以一定要讓它能對外，然後按下左下的 Upload\n![](https://i.imgur.com/iO2R9aW.png)\n\n成功後點進這個檔案，並按下方的`Object URL`，看到 Hello World 的話就代表成功囉，這時可以開個無痕測一次，確認一下沒有錯誤 😃\n![](https://i.imgur.com/m1jC1E2.png)\n\n# 參考\n\n[AWS S3 wiki](https://zh.wikipedia.org/wiki/Amazon_S3)\n","source":"_posts/Day4-認識與使用-S3-容器.md","raw":"---\ntitle: Day4 - 認識與使用 S3 容器\ntags:\n  - AWS\n  - Serverless\n  - S3\ncategories: 2019鐵人賽\nabbrlink: 931534491\ndate: 2019-09-19 15:44:36\n---\n\n## 前言\n\nAmazon Simple Storage Service(簡稱 AWS S3)是 AWS 的一個線上儲存服務，用戶能夠輕易把檔案儲存到網路伺服器上，可能有些朋友會把它當成雲端硬碟看待，但其實還能像是傳靜態檔案上去，若有寫前端框架的朋友通常都會需要把程式碼打包成靜態檔案再部署，然而這邊把他打包送上去後，S3 會給一個名為 Object Url 的網址，可以透過這個網址去執行網頁裡面的內容(如 AJAX、Axios...)，並可以透過 cloudfont 去弄成 CDN(扯遠了)，簡單說他還有很多不一樣的功能應用等著大家去用～\n\n因為 serverless 只能放關於 API 的程式碼，因此我們需要把 html 靜態檔案放在 S3 裡，\n\n接下來就來建立一個公開的 S3 容器，這邊就不會提到權限如何控管哦！\n\n## 建立一個公開的 S3 容器\n\n建立一個名為`2019-it-30-bucket`的容器，地區就選與 Lambda 同樣的地區，直接按下左下角的`create`來建立。\n![](https://i.imgur.com/lfRsTDn.png)\n\n建立完會像這樣\n![](https://i.imgur.com/SgPTxsQ.png)\n接著點進去後在點到第三個選項會看到 Block of public access 是啟動的狀態，因為我們接下來需要讓我們的頁面可以外部使用\n![](https://i.imgur.com/M065zbI.png)\n就把 check box 的按掉，在按下 `Save`\n![](https://i.imgur.com/SjT0qY7.png)\n要輸入`confirm`就修改完成嚕\n![](https://i.imgur.com/qxquZI1.png)\n接著一樣點到第三個個選項，選到`Access Control List`，看到`Access for bucket owner`這個選項的`Canonical ID`，選項都全部打勾之後再來調整，這樣之後的 HTML 檔案外面就看得到了。\n![](https://i.imgur.com/uZfyrAQ.png)\n\n## 測試\n\n接著上傳一個`index.html`的檔案來測試\n\n```\n<html>\n<h1>Hello world</h1>\n</html>\n```\n\n上傳後下拉式選單選擇`public read`的選項，因為一個檔案在 S3 就算是一個 Object，所以一定要讓它能對外，然後按下左下的 Upload\n![](https://i.imgur.com/iO2R9aW.png)\n\n成功後點進這個檔案，並按下方的`Object URL`，看到 Hello World 的話就代表成功囉，這時可以開個無痕測一次，確認一下沒有錯誤 😃\n![](https://i.imgur.com/m1jC1E2.png)\n\n# 參考\n\n[AWS S3 wiki](https://zh.wikipedia.org/wiki/Amazon_S3)\n","slug":"Day4-認識與使用-S3-容器","published":1,"updated":"2020-06-19T14:03:58.847Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k5002p7cri7z307e4p","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Amazon Simple Storage Service(簡稱 AWS S3)是 AWS 的一個線上儲存服務，用戶能夠輕易把檔案儲存到網路伺服器上，可能有些朋友會把它當成雲端硬碟看待，但其實還能像是傳靜態檔案上去，若有寫前端框架的朋友通常都會需要把程式碼打包成靜態檔案再部署，然而這邊把他打包送上去後，S3 會給一個名為 Object Url 的網址，可以透過這個網址去執行網頁裡面的內容(如 AJAX、Axios…)，並可以透過 cloudfont 去弄成 CDN(扯遠了)，簡單說他還有很多不一樣的功能應用等著大家去用～</p>\n<p>因為 serverless 只能放關於 API 的程式碼，因此我們需要把 html 靜態檔案放在 S3 裡，</p>\n<p>接下來就來建立一個公開的 S3 容器，這邊就不會提到權限如何控管哦！</p>\n<h2 id=\"建立一個公開的-S3-容器\"><a href=\"#建立一個公開的-S3-容器\" class=\"headerlink\" title=\"建立一個公開的 S3 容器\"></a>建立一個公開的 S3 容器</h2><p>建立一個名為<code>2019-it-30-bucket</code>的容器，地區就選與 Lambda 同樣的地區，直接按下左下角的<code>create</code>來建立。<br><img src=\"https://i.imgur.com/lfRsTDn.png\" alt></p>\n<p>建立完會像這樣<br><img src=\"https://i.imgur.com/SgPTxsQ.png\" alt><br>接著點進去後在點到第三個選項會看到 Block of public access 是啟動的狀態，因為我們接下來需要讓我們的頁面可以外部使用<br><img src=\"https://i.imgur.com/M065zbI.png\" alt><br>就把 check box 的按掉，在按下 <code>Save</code><br><img src=\"https://i.imgur.com/SjT0qY7.png\" alt><br>要輸入<code>confirm</code>就修改完成嚕<br><img src=\"https://i.imgur.com/qxquZI1.png\" alt><br>接著一樣點到第三個個選項，選到<code>Access Control List</code>，看到<code>Access for bucket owner</code>這個選項的<code>Canonical ID</code>，選項都全部打勾之後再來調整，這樣之後的 HTML 檔案外面就看得到了。<br><img src=\"https://i.imgur.com/uZfyrAQ.png\" alt></p>\n<h2 id=\"測試\"><a href=\"#測試\" class=\"headerlink\" title=\"測試\"></a>測試</h2><p>接著上傳一個<code>index.html</code>的檔案來測試</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;h1&gt;Hello world&lt;/h1&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>上傳後下拉式選單選擇<code>public read</code>的選項，因為一個檔案在 S3 就算是一個 Object，所以一定要讓它能對外，然後按下左下的 Upload<br><img src=\"https://i.imgur.com/iO2R9aW.png\" alt></p>\n<p>成功後點進這個檔案，並按下方的<code>Object URL</code>，看到 Hello World 的話就代表成功囉，這時可以開個無痕測一次，確認一下沒有錯誤 😃<br><img src=\"https://i.imgur.com/m1jC1E2.png\" alt></p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://zh.wikipedia.org/wiki/Amazon_S3\" target=\"_blank\" rel=\"noopener\">AWS S3 wiki</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Amazon Simple Storage Service(簡稱 AWS S3)是 AWS 的一個線上儲存服務，用戶能夠輕易把檔案儲存到網路伺服器上，可能有些朋友會把它當成雲端硬碟看待，但其實還能像是傳靜態檔案上去，若有寫前端框架的朋友通常都會需要把程式碼打包成靜態檔案再部署，然而這邊把他打包送上去後，S3 會給一個名為 Object Url 的網址，可以透過這個網址去執行網頁裡面的內容(如 AJAX、Axios…)，並可以透過 cloudfont 去弄成 CDN(扯遠了)，簡單說他還有很多不一樣的功能應用等著大家去用～</p>\n<p>因為 serverless 只能放關於 API 的程式碼，因此我們需要把 html 靜態檔案放在 S3 裡，</p>\n<p>接下來就來建立一個公開的 S3 容器，這邊就不會提到權限如何控管哦！</p>\n<h2 id=\"建立一個公開的-S3-容器\"><a href=\"#建立一個公開的-S3-容器\" class=\"headerlink\" title=\"建立一個公開的 S3 容器\"></a>建立一個公開的 S3 容器</h2><p>建立一個名為<code>2019-it-30-bucket</code>的容器，地區就選與 Lambda 同樣的地區，直接按下左下角的<code>create</code>來建立。<br><img src=\"https://i.imgur.com/lfRsTDn.png\" alt></p>\n<p>建立完會像這樣<br><img src=\"https://i.imgur.com/SgPTxsQ.png\" alt><br>接著點進去後在點到第三個選項會看到 Block of public access 是啟動的狀態，因為我們接下來需要讓我們的頁面可以外部使用<br><img src=\"https://i.imgur.com/M065zbI.png\" alt><br>就把 check box 的按掉，在按下 <code>Save</code><br><img src=\"https://i.imgur.com/SjT0qY7.png\" alt><br>要輸入<code>confirm</code>就修改完成嚕<br><img src=\"https://i.imgur.com/qxquZI1.png\" alt><br>接著一樣點到第三個個選項，選到<code>Access Control List</code>，看到<code>Access for bucket owner</code>這個選項的<code>Canonical ID</code>，選項都全部打勾之後再來調整，這樣之後的 HTML 檔案外面就看得到了。<br><img src=\"https://i.imgur.com/uZfyrAQ.png\" alt></p>\n<h2 id=\"測試\"><a href=\"#測試\" class=\"headerlink\" title=\"測試\"></a>測試</h2><p>接著上傳一個<code>index.html</code>的檔案來測試</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;h1&gt;Hello world&lt;/h1&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>上傳後下拉式選單選擇<code>public read</code>的選項，因為一個檔案在 S3 就算是一個 Object，所以一定要讓它能對外，然後按下左下的 Upload<br><img src=\"https://i.imgur.com/iO2R9aW.png\" alt></p>\n<p>成功後點進這個檔案，並按下方的<code>Object URL</code>，看到 Hello World 的話就代表成功囉，這時可以開個無痕測一次，確認一下沒有錯誤 😃<br><img src=\"https://i.imgur.com/m1jC1E2.png\" alt></p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://zh.wikipedia.org/wiki/Amazon_S3\" target=\"_blank\" rel=\"noopener\">AWS S3 wiki</a></p>\n"},{"title":"Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify","abbrlink":2244661996,"date":"2019-09-21T12:30:27.000Z","_content":"\n繼上一篇我們已經可以讓使用者註冊 Notify 並將 token 放入資料庫，接著就帶各位使用 query string 的方式讓你的 Notify 可以送訊息給所有註冊過的 Notify。\n\n首先我們進入我們已經建立過的 controller/notify_controller.py，會看到 class 下有我們之前建立的 post method，這時我們就在前面加入 get method，並加入以下的 code，讓這個 class 看起來比較有順序(~~潔癖~~)\n\n```python=\nfrom flask import request\n\nclass NotifyController(Resource):\n\n    def get(self):\n            msg = request.args.get('msg')\n            with Database() as db, db.connect() as conn:\n                with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                    cur.execute(\n                        f\"SELECT token FROM notify\")\n                    fetch = cur.fetchall()\n            for f in fetch:\n                headers = {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': f\"Bearer {f['token']}\"\n                }\n                payload = {'message': msg}\n\n                r = requests.post(\n                    'https://notify-api.line.me/api/notify', data=payload, headers=headers)\n            return {'result': 'ok'}, 200\n\n    def post(self):\n        ...\n```\n\n這次使用的套件比上次多 import 一個 flask 底下的 request (注意沒有 s 哦)，這個主要是讓我們可以抓到網址問號後面接的參數，這邊我設定打 API 的人會打一個 msg 的參數。\n\n接著就是使用進 DB 撈我們的 token 們，並用一個迴圈來跑\n\n再來是設定 headers 以及 payload\n\nheaders 的部分參考 Notify 的文件，如下圖\n![](https://i.imgur.com/B4bjvja.png)\n我們需要設定 Content-Type 以及 Authorization，需要注意的是 Authorization 是使用 Bearer 格式([參考](https://blog.yorkxin.org/2013/09/30/oauth2-6-bearer-token.html))，他中間是有加`空白鍵`的，這邊很多朋友都會錯在這裡，千萬要記得檢查這邊！\n\n接著是要送出去的東西是要用什麼送出，本篇只用 message 做範例，若需要使用到其他的功能，像是圖片、貼圖等等的可參考以下的圖片\n![](https://i.imgur.com/I6617R6.png)\n\n接著我們就可以使用`sls deploy`來部署我們的程式啦\n\n等等！\n這邊有個需要注意的地方是，照著這次的範例使用的話會需要用 docker 來幫忙跑編譯，因為 psycopg2-binary 這個套件如果不是在 Linux 的環境下會需要透過 docker 幫忙編譯完再丟過去\n這部分需要在`serverless.yml`下填入參數\n\n```\ncustom:\n  pythonRequirements:\n    dockerizePip: true\n```\n\n如此一來當前環境若不是 Linux 的話他就會使用 docker 來幫忙，記得 docker 要開哦 🙏\n\n> 當然最簡單的方法就是把它直接抓下來放在專案中，只是這樣就會比較髒一點，可以從這邊抓 -> [參考](https://github.com/jkehler/awslambda-psycopg2)\n\n> 這邊可以先在環境變數上加上`SLS_DEBUG=*` 接著在加上 sls deploy 後面加上`--verbose`可以看到 serverless 到底都在背地裡做了什麼事情 🤣\n\n接著我們就使用 Postman 來幫我們送字串出去，參考下圖，當回傳 ok 就成功了 🎉\n![](https://i.imgur.com/oXlBNeC.png)\n你的 Notify 應該要回你了～\n![](https://i.imgur.com/nihyJxX.png)\n\n## 結論\n\n這邊帶大家做一個簡單的應用，一般來說我覺得放在 query string 讓其他 API 來呼叫的時候帶參數來就可以直接用是很方便的，不用再特地自己寫方法去呼叫 LINE Notify 來幫我們送，反正 AWS Lambda 有一百萬次的請求不怕 🤣\n","source":"_posts/Day6-建立一個使用-Query-string-來幫忙發送的-LINE-Notify.md","raw":"---\ntitle: Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify\ntags:\n  - LINE\n  - Notify\n  - python\ncategories: 2019鐵人賽\nabbrlink: 2244661996\ndate: 2019-09-21 20:30:27\n---\n\n繼上一篇我們已經可以讓使用者註冊 Notify 並將 token 放入資料庫，接著就帶各位使用 query string 的方式讓你的 Notify 可以送訊息給所有註冊過的 Notify。\n\n首先我們進入我們已經建立過的 controller/notify_controller.py，會看到 class 下有我們之前建立的 post method，這時我們就在前面加入 get method，並加入以下的 code，讓這個 class 看起來比較有順序(~~潔癖~~)\n\n```python=\nfrom flask import request\n\nclass NotifyController(Resource):\n\n    def get(self):\n            msg = request.args.get('msg')\n            with Database() as db, db.connect() as conn:\n                with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                    cur.execute(\n                        f\"SELECT token FROM notify\")\n                    fetch = cur.fetchall()\n            for f in fetch:\n                headers = {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': f\"Bearer {f['token']}\"\n                }\n                payload = {'message': msg}\n\n                r = requests.post(\n                    'https://notify-api.line.me/api/notify', data=payload, headers=headers)\n            return {'result': 'ok'}, 200\n\n    def post(self):\n        ...\n```\n\n這次使用的套件比上次多 import 一個 flask 底下的 request (注意沒有 s 哦)，這個主要是讓我們可以抓到網址問號後面接的參數，這邊我設定打 API 的人會打一個 msg 的參數。\n\n接著就是使用進 DB 撈我們的 token 們，並用一個迴圈來跑\n\n再來是設定 headers 以及 payload\n\nheaders 的部分參考 Notify 的文件，如下圖\n![](https://i.imgur.com/B4bjvja.png)\n我們需要設定 Content-Type 以及 Authorization，需要注意的是 Authorization 是使用 Bearer 格式([參考](https://blog.yorkxin.org/2013/09/30/oauth2-6-bearer-token.html))，他中間是有加`空白鍵`的，這邊很多朋友都會錯在這裡，千萬要記得檢查這邊！\n\n接著是要送出去的東西是要用什麼送出，本篇只用 message 做範例，若需要使用到其他的功能，像是圖片、貼圖等等的可參考以下的圖片\n![](https://i.imgur.com/I6617R6.png)\n\n接著我們就可以使用`sls deploy`來部署我們的程式啦\n\n等等！\n這邊有個需要注意的地方是，照著這次的範例使用的話會需要用 docker 來幫忙跑編譯，因為 psycopg2-binary 這個套件如果不是在 Linux 的環境下會需要透過 docker 幫忙編譯完再丟過去\n這部分需要在`serverless.yml`下填入參數\n\n```\ncustom:\n  pythonRequirements:\n    dockerizePip: true\n```\n\n如此一來當前環境若不是 Linux 的話他就會使用 docker 來幫忙，記得 docker 要開哦 🙏\n\n> 當然最簡單的方法就是把它直接抓下來放在專案中，只是這樣就會比較髒一點，可以從這邊抓 -> [參考](https://github.com/jkehler/awslambda-psycopg2)\n\n> 這邊可以先在環境變數上加上`SLS_DEBUG=*` 接著在加上 sls deploy 後面加上`--verbose`可以看到 serverless 到底都在背地裡做了什麼事情 🤣\n\n接著我們就使用 Postman 來幫我們送字串出去，參考下圖，當回傳 ok 就成功了 🎉\n![](https://i.imgur.com/oXlBNeC.png)\n你的 Notify 應該要回你了～\n![](https://i.imgur.com/nihyJxX.png)\n\n## 結論\n\n這邊帶大家做一個簡單的應用，一般來說我覺得放在 query string 讓其他 API 來呼叫的時候帶參數來就可以直接用是很方便的，不用再特地自己寫方法去呼叫 LINE Notify 來幫我們送，反正 AWS Lambda 有一百萬次的請求不怕 🤣\n","slug":"Day6-建立一個使用-Query-string-來幫忙發送的-LINE-Notify","published":1,"updated":"2020-06-19T14:03:58.850Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k7002t7crikpge8j1h","content":"<p>繼上一篇我們已經可以讓使用者註冊 Notify 並將 token 放入資料庫，接著就帶各位使用 query string 的方式讓你的 Notify 可以送訊息給所有註冊過的 Notify。</p>\n<p>首先我們進入我們已經建立過的 controller/notify_controller.py，會看到 class 下有我們之前建立的 post method，這時我們就在前面加入 get method，並加入以下的 code，讓這個 class 看起來比較有順序(<del>潔癖</del>)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> request</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NotifyController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">            msg = request.args.get(<span class=\"string\">'msg'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                    cur.execute(</span><br><span class=\"line\">                        <span class=\"string\">f\"SELECT token FROM notify\"</span>)</span><br><span class=\"line\">                    fetch = cur.fetchall()</span><br><span class=\"line\">            <span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">                headers = &#123;</span><br><span class=\"line\">                    <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'Authorization'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;f[<span class=\"string\">'token'</span>]&#125;</span>\"</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                payload = &#123;<span class=\"string\">'message'</span>: msg&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                r = requests.post(</span><br><span class=\"line\">                    <span class=\"string\">'https://notify-api.line.me/api/notify'</span>, data=payload, headers=headers)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: <span class=\"string\">'ok'</span>&#125;, <span class=\"number\">200</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        ...</span><br></pre></td></tr></table></figure>\n\n<p>這次使用的套件比上次多 import 一個 flask 底下的 request (注意沒有 s 哦)，這個主要是讓我們可以抓到網址問號後面接的參數，這邊我設定打 API 的人會打一個 msg 的參數。</p>\n<p>接著就是使用進 DB 撈我們的 token 們，並用一個迴圈來跑</p>\n<p>再來是設定 headers 以及 payload</p>\n<p>headers 的部分參考 Notify 的文件，如下圖<br><img src=\"https://i.imgur.com/B4bjvja.png\" alt><br>我們需要設定 Content-Type 以及 Authorization，需要注意的是 Authorization 是使用 Bearer 格式(<a href=\"https://blog.yorkxin.org/2013/09/30/oauth2-6-bearer-token.html\" target=\"_blank\" rel=\"noopener\">參考</a>)，他中間是有加<code>空白鍵</code>的，這邊很多朋友都會錯在這裡，千萬要記得檢查這邊！</p>\n<p>接著是要送出去的東西是要用什麼送出，本篇只用 message 做範例，若需要使用到其他的功能，像是圖片、貼圖等等的可參考以下的圖片<br><img src=\"https://i.imgur.com/I6617R6.png\" alt></p>\n<p>接著我們就可以使用<code>sls deploy</code>來部署我們的程式啦</p>\n<p>等等！<br>這邊有個需要注意的地方是，照著這次的範例使用的話會需要用 docker 來幫忙跑編譯，因為 psycopg2-binary 這個套件如果不是在 Linux 的環境下會需要透過 docker 幫忙編譯完再丟過去<br>這部分需要在<code>serverless.yml</code>下填入參數</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">custom:</span><br><span class=\"line\">  pythonRequirements:</span><br><span class=\"line\">    dockerizePip: true</span><br></pre></td></tr></table></figure>\n\n<p>如此一來當前環境若不是 Linux 的話他就會使用 docker 來幫忙，記得 docker 要開哦 🙏</p>\n<blockquote>\n<p>當然最簡單的方法就是把它直接抓下來放在專案中，只是這樣就會比較髒一點，可以從這邊抓 -&gt; <a href=\"https://github.com/jkehler/awslambda-psycopg2\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<blockquote>\n<p>這邊可以先在環境變數上加上<code>SLS_DEBUG=*</code> 接著在加上 sls deploy 後面加上<code>--verbose</code>可以看到 serverless 到底都在背地裡做了什麼事情 🤣</p>\n</blockquote>\n<p>接著我們就使用 Postman 來幫我們送字串出去，參考下圖，當回傳 ok 就成功了 🎉<br><img src=\"https://i.imgur.com/oXlBNeC.png\" alt><br>你的 Notify 應該要回你了～<br><img src=\"https://i.imgur.com/nihyJxX.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>這邊帶大家做一個簡單的應用，一般來說我覺得放在 query string 讓其他 API 來呼叫的時候帶參數來就可以直接用是很方便的，不用再特地自己寫方法去呼叫 LINE Notify 來幫我們送，反正 AWS Lambda 有一百萬次的請求不怕 🤣</p>\n","site":{"data":{}},"excerpt":"","more":"<p>繼上一篇我們已經可以讓使用者註冊 Notify 並將 token 放入資料庫，接著就帶各位使用 query string 的方式讓你的 Notify 可以送訊息給所有註冊過的 Notify。</p>\n<p>首先我們進入我們已經建立過的 controller/notify_controller.py，會看到 class 下有我們之前建立的 post method，這時我們就在前面加入 get method，並加入以下的 code，讓這個 class 看起來比較有順序(<del>潔癖</del>)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> request</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NotifyController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">            msg = request.args.get(<span class=\"string\">'msg'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                    cur.execute(</span><br><span class=\"line\">                        <span class=\"string\">f\"SELECT token FROM notify\"</span>)</span><br><span class=\"line\">                    fetch = cur.fetchall()</span><br><span class=\"line\">            <span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">                headers = &#123;</span><br><span class=\"line\">                    <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'Authorization'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;f[<span class=\"string\">'token'</span>]&#125;</span>\"</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                payload = &#123;<span class=\"string\">'message'</span>: msg&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                r = requests.post(</span><br><span class=\"line\">                    <span class=\"string\">'https://notify-api.line.me/api/notify'</span>, data=payload, headers=headers)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: <span class=\"string\">'ok'</span>&#125;, <span class=\"number\">200</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        ...</span><br></pre></td></tr></table></figure>\n\n<p>這次使用的套件比上次多 import 一個 flask 底下的 request (注意沒有 s 哦)，這個主要是讓我們可以抓到網址問號後面接的參數，這邊我設定打 API 的人會打一個 msg 的參數。</p>\n<p>接著就是使用進 DB 撈我們的 token 們，並用一個迴圈來跑</p>\n<p>再來是設定 headers 以及 payload</p>\n<p>headers 的部分參考 Notify 的文件，如下圖<br><img src=\"https://i.imgur.com/B4bjvja.png\" alt><br>我們需要設定 Content-Type 以及 Authorization，需要注意的是 Authorization 是使用 Bearer 格式(<a href=\"https://blog.yorkxin.org/2013/09/30/oauth2-6-bearer-token.html\" target=\"_blank\" rel=\"noopener\">參考</a>)，他中間是有加<code>空白鍵</code>的，這邊很多朋友都會錯在這裡，千萬要記得檢查這邊！</p>\n<p>接著是要送出去的東西是要用什麼送出，本篇只用 message 做範例，若需要使用到其他的功能，像是圖片、貼圖等等的可參考以下的圖片<br><img src=\"https://i.imgur.com/I6617R6.png\" alt></p>\n<p>接著我們就可以使用<code>sls deploy</code>來部署我們的程式啦</p>\n<p>等等！<br>這邊有個需要注意的地方是，照著這次的範例使用的話會需要用 docker 來幫忙跑編譯，因為 psycopg2-binary 這個套件如果不是在 Linux 的環境下會需要透過 docker 幫忙編譯完再丟過去<br>這部分需要在<code>serverless.yml</code>下填入參數</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">custom:</span><br><span class=\"line\">  pythonRequirements:</span><br><span class=\"line\">    dockerizePip: true</span><br></pre></td></tr></table></figure>\n\n<p>如此一來當前環境若不是 Linux 的話他就會使用 docker 來幫忙，記得 docker 要開哦 🙏</p>\n<blockquote>\n<p>當然最簡單的方法就是把它直接抓下來放在專案中，只是這樣就會比較髒一點，可以從這邊抓 -&gt; <a href=\"https://github.com/jkehler/awslambda-psycopg2\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<blockquote>\n<p>這邊可以先在環境變數上加上<code>SLS_DEBUG=*</code> 接著在加上 sls deploy 後面加上<code>--verbose</code>可以看到 serverless 到底都在背地裡做了什麼事情 🤣</p>\n</blockquote>\n<p>接著我們就使用 Postman 來幫我們送字串出去，參考下圖，當回傳 ok 就成功了 🎉<br><img src=\"https://i.imgur.com/oXlBNeC.png\" alt><br>你的 Notify 應該要回你了～<br><img src=\"https://i.imgur.com/nihyJxX.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>這邊帶大家做一個簡單的應用，一般來說我覺得放在 query string 讓其他 API 來呼叫的時候帶參數來就可以直接用是很方便的，不用再特地自己寫方法去呼叫 LINE Notify 來幫我們送，反正 AWS Lambda 有一百萬次的請求不怕 🤣</p>\n"},{"title":"Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理","abbrlink":2061415749,"date":"2019-09-21T12:33:28.000Z","_content":"\n## 前言\n\n看著前幾天的文章，像我們 notify 驗證的 API 有使用到 `REDIRECT_URI`、`CLIENT_ID` 以及 `CLIENT_SECRET`，或是像 PostgreSQL 的帳號密碼，\n只是說若今天當程式碼變多的時候，抑或是這個參數有給其他 API 使用，那在尋找的時候不僅費工又浪費時間\n那接下來就帶著大家在 serverless.yml 一步步加入變數值，並更改 code。\n\n## 動手吧！\n\n用 npm 安裝 serverless 的 `dotenv` 套件\n\n```\nnpm i -D serverless-dotenv-plugin\n```\n\n接著加入新的套件到`serverless.yml`\n\n```\nplugins:\n  - serverless-dotenv-plugin\n```\n\n新增`dotenv`到 requirements.txt\n\n```\npython-dotenv==0.10.3\n```\n\n到 api.py 加入下面內容\n\n```\nfrom dotenv import load_dotenv\nenv_path = Path('.') / '.env'\nload_dotenv(dotenv_path=env_path)\n```\n\n接著新增`.env`並輸入對應的內容\n\n```\nNOTIFY_REDIRECT_URI=\nNOTIFY_CLIENT_ID=\nNOTIFY_CLIENT_SECRET=\nREGION=us-east-2\nSQS_URL=\nSQS_ARN=\nPG_DB=\nPG_HOST=\nPG_NAME=\nPG_PWD=\nPG_PORT=\n```\n\n接著修改有使用到他們的地方，範例如下\n\n```\nimport os\nos.getenv(\"SQS_ARN\")\n```\n\n既然有安裝 serverless 的套件了，那 yml 檔也可以使用哦！\n\n```\nprovider:\n  name: aws\n  runtime: python3.7\n  region: ${env:REGION}\n```\n\n## 後記\n\n有時候把專案抓下來的時候要找到這些輸入的地方很容易找不到(我有點癡呆)，一般 open source 也都會有一個`.env`的，用`serverless-dotenv-plugin`來幫忙弄就方便許多了，後續有需要再繼續往裡面新增就好了～\n\n最後在搭配 python 的 [dot env 套件](https://serverless.com/plugins/serverless-dotenv-plugin/)使用就讓整個好用多了 🤣，只是說 html 因為目前還不是透過 serverless 來幫忙部署，所以這邊的參數就沒辦法吃設定檔了 😓\n\n## 參考\n\n[os.environ](https://stackoverflow.com/questions/4906977/how-to-access-environment-variable-values)\n[env setting](https://serverless.com/framework/docs/providers/aws/guide/variables/)\n","source":"_posts/Day7-在-serverless-裡使用環境變數讓這些-key-好管理.md","raw":"---\ntitle: Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理\ntags:\n  - Serverless\n  - dotenv\ncategories: 2019鐵人賽\nabbrlink: 2061415749\ndate: 2019-09-21 20:33:28\n---\n\n## 前言\n\n看著前幾天的文章，像我們 notify 驗證的 API 有使用到 `REDIRECT_URI`、`CLIENT_ID` 以及 `CLIENT_SECRET`，或是像 PostgreSQL 的帳號密碼，\n只是說若今天當程式碼變多的時候，抑或是這個參數有給其他 API 使用，那在尋找的時候不僅費工又浪費時間\n那接下來就帶著大家在 serverless.yml 一步步加入變數值，並更改 code。\n\n## 動手吧！\n\n用 npm 安裝 serverless 的 `dotenv` 套件\n\n```\nnpm i -D serverless-dotenv-plugin\n```\n\n接著加入新的套件到`serverless.yml`\n\n```\nplugins:\n  - serverless-dotenv-plugin\n```\n\n新增`dotenv`到 requirements.txt\n\n```\npython-dotenv==0.10.3\n```\n\n到 api.py 加入下面內容\n\n```\nfrom dotenv import load_dotenv\nenv_path = Path('.') / '.env'\nload_dotenv(dotenv_path=env_path)\n```\n\n接著新增`.env`並輸入對應的內容\n\n```\nNOTIFY_REDIRECT_URI=\nNOTIFY_CLIENT_ID=\nNOTIFY_CLIENT_SECRET=\nREGION=us-east-2\nSQS_URL=\nSQS_ARN=\nPG_DB=\nPG_HOST=\nPG_NAME=\nPG_PWD=\nPG_PORT=\n```\n\n接著修改有使用到他們的地方，範例如下\n\n```\nimport os\nos.getenv(\"SQS_ARN\")\n```\n\n既然有安裝 serverless 的套件了，那 yml 檔也可以使用哦！\n\n```\nprovider:\n  name: aws\n  runtime: python3.7\n  region: ${env:REGION}\n```\n\n## 後記\n\n有時候把專案抓下來的時候要找到這些輸入的地方很容易找不到(我有點癡呆)，一般 open source 也都會有一個`.env`的，用`serverless-dotenv-plugin`來幫忙弄就方便許多了，後續有需要再繼續往裡面新增就好了～\n\n最後在搭配 python 的 [dot env 套件](https://serverless.com/plugins/serverless-dotenv-plugin/)使用就讓整個好用多了 🤣，只是說 html 因為目前還不是透過 serverless 來幫忙部署，所以這邊的參數就沒辦法吃設定檔了 😓\n\n## 參考\n\n[os.environ](https://stackoverflow.com/questions/4906977/how-to-access-environment-variable-values)\n[env setting](https://serverless.com/framework/docs/providers/aws/guide/variables/)\n","slug":"Day7-在-serverless-裡使用環境變數讓這些-key-好管理","published":1,"updated":"2020-06-19T14:03:58.852Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k8002v7crikyplbu4r","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>看著前幾天的文章，像我們 notify 驗證的 API 有使用到 <code>REDIRECT_URI</code>、<code>CLIENT_ID</code> 以及 <code>CLIENT_SECRET</code>，或是像 PostgreSQL 的帳號密碼，<br>只是說若今天當程式碼變多的時候，抑或是這個參數有給其他 API 使用，那在尋找的時候不僅費工又浪費時間<br>那接下來就帶著大家在 serverless.yml 一步步加入變數值，並更改 code。</p>\n<h2 id=\"動手吧！\"><a href=\"#動手吧！\" class=\"headerlink\" title=\"動手吧！\"></a>動手吧！</h2><p>用 npm 安裝 serverless 的 <code>dotenv</code> 套件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -D serverless-dotenv-plugin</span><br></pre></td></tr></table></figure>\n\n<p>接著加入新的套件到<code>serverless.yml</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins:</span><br><span class=\"line\">  - serverless-dotenv-plugin</span><br></pre></td></tr></table></figure>\n\n<p>新增<code>dotenv</code>到 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python-dotenv==0.10.3</span><br></pre></td></tr></table></figure>\n\n<p>到 api.py 加入下面內容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from dotenv import load_dotenv</span><br><span class=\"line\">env_path = Path(&apos;.&apos;) / &apos;.env&apos;</span><br><span class=\"line\">load_dotenv(dotenv_path=env_path)</span><br></pre></td></tr></table></figure>\n\n<p>接著新增<code>.env</code>並輸入對應的內容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NOTIFY_REDIRECT_URI=</span><br><span class=\"line\">NOTIFY_CLIENT_ID=</span><br><span class=\"line\">NOTIFY_CLIENT_SECRET=</span><br><span class=\"line\">REGION=us-east-2</span><br><span class=\"line\">SQS_URL=</span><br><span class=\"line\">SQS_ARN=</span><br><span class=\"line\">PG_DB=</span><br><span class=\"line\">PG_HOST=</span><br><span class=\"line\">PG_NAME=</span><br><span class=\"line\">PG_PWD=</span><br><span class=\"line\">PG_PORT=</span><br></pre></td></tr></table></figure>\n\n<p>接著修改有使用到他們的地方，範例如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">os.getenv(&quot;SQS_ARN&quot;)</span><br></pre></td></tr></table></figure>\n\n<p>既然有安裝 serverless 的套件了，那 yml 檔也可以使用哦！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">provider:</span><br><span class=\"line\">  name: aws</span><br><span class=\"line\">  runtime: python3.7</span><br><span class=\"line\">  region: $&#123;env:REGION&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"後記\"><a href=\"#後記\" class=\"headerlink\" title=\"後記\"></a>後記</h2><p>有時候把專案抓下來的時候要找到這些輸入的地方很容易找不到(我有點癡呆)，一般 open source 也都會有一個<code>.env</code>的，用<code>serverless-dotenv-plugin</code>來幫忙弄就方便許多了，後續有需要再繼續往裡面新增就好了～</p>\n<p>最後在搭配 python 的 <a href=\"https://serverless.com/plugins/serverless-dotenv-plugin/\" target=\"_blank\" rel=\"noopener\">dot env 套件</a>使用就讓整個好用多了 🤣，只是說 html 因為目前還不是透過 serverless 來幫忙部署，所以這邊的參數就沒辦法吃設定檔了 😓</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://stackoverflow.com/questions/4906977/how-to-access-environment-variable-values\" target=\"_blank\" rel=\"noopener\">os.environ</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/guide/variables/\" target=\"_blank\" rel=\"noopener\">env setting</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>看著前幾天的文章，像我們 notify 驗證的 API 有使用到 <code>REDIRECT_URI</code>、<code>CLIENT_ID</code> 以及 <code>CLIENT_SECRET</code>，或是像 PostgreSQL 的帳號密碼，<br>只是說若今天當程式碼變多的時候，抑或是這個參數有給其他 API 使用，那在尋找的時候不僅費工又浪費時間<br>那接下來就帶著大家在 serverless.yml 一步步加入變數值，並更改 code。</p>\n<h2 id=\"動手吧！\"><a href=\"#動手吧！\" class=\"headerlink\" title=\"動手吧！\"></a>動手吧！</h2><p>用 npm 安裝 serverless 的 <code>dotenv</code> 套件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -D serverless-dotenv-plugin</span><br></pre></td></tr></table></figure>\n\n<p>接著加入新的套件到<code>serverless.yml</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins:</span><br><span class=\"line\">  - serverless-dotenv-plugin</span><br></pre></td></tr></table></figure>\n\n<p>新增<code>dotenv</code>到 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python-dotenv==0.10.3</span><br></pre></td></tr></table></figure>\n\n<p>到 api.py 加入下面內容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from dotenv import load_dotenv</span><br><span class=\"line\">env_path = Path(&apos;.&apos;) / &apos;.env&apos;</span><br><span class=\"line\">load_dotenv(dotenv_path=env_path)</span><br></pre></td></tr></table></figure>\n\n<p>接著新增<code>.env</code>並輸入對應的內容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NOTIFY_REDIRECT_URI=</span><br><span class=\"line\">NOTIFY_CLIENT_ID=</span><br><span class=\"line\">NOTIFY_CLIENT_SECRET=</span><br><span class=\"line\">REGION=us-east-2</span><br><span class=\"line\">SQS_URL=</span><br><span class=\"line\">SQS_ARN=</span><br><span class=\"line\">PG_DB=</span><br><span class=\"line\">PG_HOST=</span><br><span class=\"line\">PG_NAME=</span><br><span class=\"line\">PG_PWD=</span><br><span class=\"line\">PG_PORT=</span><br></pre></td></tr></table></figure>\n\n<p>接著修改有使用到他們的地方，範例如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">os.getenv(&quot;SQS_ARN&quot;)</span><br></pre></td></tr></table></figure>\n\n<p>既然有安裝 serverless 的套件了，那 yml 檔也可以使用哦！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">provider:</span><br><span class=\"line\">  name: aws</span><br><span class=\"line\">  runtime: python3.7</span><br><span class=\"line\">  region: $&#123;env:REGION&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"後記\"><a href=\"#後記\" class=\"headerlink\" title=\"後記\"></a>後記</h2><p>有時候把專案抓下來的時候要找到這些輸入的地方很容易找不到(我有點癡呆)，一般 open source 也都會有一個<code>.env</code>的，用<code>serverless-dotenv-plugin</code>來幫忙弄就方便許多了，後續有需要再繼續往裡面新增就好了～</p>\n<p>最後在搭配 python 的 <a href=\"https://serverless.com/plugins/serverless-dotenv-plugin/\" target=\"_blank\" rel=\"noopener\">dot env 套件</a>使用就讓整個好用多了 🤣，只是說 html 因為目前還不是透過 serverless 來幫忙部署，所以這邊的參數就沒辦法吃設定檔了 😓</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://stackoverflow.com/questions/4906977/how-to-access-environment-variable-values\" target=\"_blank\" rel=\"noopener\">os.environ</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/guide/variables/\" target=\"_blank\" rel=\"noopener\">env setting</a></p>\n"},{"title":"Day5 - 做一個與 LINE Notify 連動的服務","abbrlink":1338246174,"date":"2019-09-20T07:46:15.000Z","_content":"\n## 建立 LINE Notify 服務\n\n第一步先到 [LINE Notify](https://notify-bot.line.me/zh_TW/) 管力登入服務去建立一個服務\n![](https://i.imgur.com/he0csJI.png)\n接著按下`登入服務`\n![](https://i.imgur.com/iZmktaA.png)\n把該填的填一填，要注意的是 Callback Url 這邊先暫時先打 localhost:5500，等頁面上傳後再回來改 domain\n![](https://i.imgur.com/5zzxTcj.png)\n\n---\n\n![](https://i.imgur.com/VfaWKEs.png)\n\n建立完成之後就到剛剛填的信箱去收信點下網址並啟動服務\n![](https://i.imgur.com/jmZSycQ.png)\n這樣第一步就建立完成嚕！\n\n## 動工\n\n接著上次的透過上次的專案並使用 flask_restful 來改造成 Restful 格式的專案(後面開發會比較輕鬆)\n因為我們會讓前端呼叫，CORS 設定成＊比較輕鬆，若是有要設定跨域問題的在這邊設定哦 👏\n加入套件到 requirements.txt\n\n```\nflask==1.0.2\nFlask-RESTful==0.3.6\nFlask-Cors==3.0.6\nrequests==2.22.0\n```\n\n透過使用 flask_restful 幫忙轉發並管理路由\n將 api.py 改為以下的 code\n\n```python=\nfrom flask import Flask\nfrom flask_restful import Api\nfrom flask_cors import CORS\nfrom controller.notify_controller import NotifyController\n\napp = Flask(__name__)\nCORS(app, resources={r\"*\": {\"origins\": \"*\", \"supports_credentials\": True}})\napi = Api(app)\n\napi.add_resource(NotifyController, '/notify')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n這邊我使用 Postgresql，並在專案底下建立一個 lib/ 的資料夾，裡頭放著名為 db.py (這裡還是要記得建立 **init**.py 哦！)\n這邊只簡單建立[ Context Manager ](https://blog.gtwang.org/programming/python-with-context-manager-tutorial/)讓連線可以被我呼叫。\ndb.py:\n\n```python=\nimport psycopg2\nimport psycopg2.extras\n\nclass Database():\n    conns = []\n    def __enter__(self):\n        return self\n\n    def connect(self):\n        conn = psycopg2.connect(\n            database=PG_DB,\n            user=PG_USER,\n            password=PG_PWD,\n            host=PG_HOST,\n            port=PG_PORT\n        )\n        self.conns.append(conn)\n        return conn\n\n    def __exit__(self, type, value, traceback):\n        for conn in self.conns:\n            conn.close()\n        self.conns.clear()\n```\n\n新增一下資料夾名為 controller，建立 **init**.py & notify_controller.py，這邊搭配 with 做資源管理器，\nDB 部分則見黎一個 notify 表，然後一個 token 的欄位。\n\n> 在這個 class 類別下方法只要輸入 `def get/post/put/patch/delete` 的函式就可以對應 CRUD 的功能了！\n\nnotify_controller.py code is:\n\n```python=\nfrom flask_restful import Resource, reqparse\nimport requests\nimport json\nfrom lib.db import Database\nimport psycopg2.extras\n\nclass NotifyController(Resource):\n    def post(self):\n        parser = reqparse.RequestParser()\n        parser.add_argument('code', required=True, help='code can not be blank!')\n        args = parser.parse_args()\n        code = args['code']\n        client = {'grant_type': 'authorization_code', 'code': code, 'redirect_uri': 'YOUR_REDIRECT_URI',\n                  'client_id': 'YOUR_CLIENT_ID', 'client_secret': 'YOUR_CLIENT_SECRET'}\n        r = requests.post(\n            'https://notify-bot.line.me/oauth/token', data=client)\n        req = json.loads(r.text)\n        if req['status'] == 200:\n            token = req['access_token']\n            # Here is use PostgreSQL, you can change your love db\n            with Database() as db:\n                with db.connect() as conn:\n                    with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                        cur.execute(\n                            f\"INSERT INTO notify(token) VALUES ('{token}')\")\n            return {'access_token': req['access_token']}, 200\n        else:\n            return {'message': r.text}, 200\n```\n\n以下這三個要設定成你的當時輸入的字串\n\n- YOUR_REDIRECT_URI\n- YOUR_CLIENT_ID\n- YOUR_CLIENT_SECRET\n\n> 若不清楚 Client_id & Client_secret 的話就回到 Notify 頁面並點選剛剛建立的服務就能看到 token 了\n\n![](https://i.imgur.com/T0nJaGE.png)\n\n建立一個 views/ 的資料夾，並建立兩個檔案\n\n- notify_index.html\n  > 這邊需要修改 `client_id` 以及 `redirect_uri`\n  > 這個檔案主要功能是讓使用者有個可以按按鈕觸發的地方，當然這只是個範例，實際上線可能就會直接 call API 導向 LINE Notify 頁面等等\n\n```htmlmixed=\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>Link Notify</title>\n  </head>\n  <body>\n    <button onclick=\"Auth();\">點選這裡連結到LineNotify</button>\n\n    <script>\n      function Auth() {\n        var URL = \"https://notify-bot.line.me/oauth/authorize?\";\n        URL += \"response_type=code\";\n        URL += \"&client_id=YOUR_CLIENT_ID\";\n        URL += \"&redirect_uri=YOUR_REDIRECT_URI\";\n        URL += \"&scope=notify\";\n        URL += \"&state=nostate\";\n        window.location.href = URL;\n      }\n    </script>\n  </body>\n</html>\n```\n\n- notify_confirm.html\n  > 修改 ajax 裡的 url，將網址換成之前部署的網址，若忘了可以在部署一次 `sls deploy`\n  > 當導回來的時候透過 ajax 來呼叫 serverless api 讓後端發 requests 給`https://notify-bot.line.me/oauth/token`來獲取`access_token`。\n\n_因為這個路由有 CORS 的問題，若透過瀏覽器來的話會出錯，這邊則是讓後端去處理_\n\n```htmlmixed=\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>message check</title>\n  </head>\n  <body>\n    verify messate:\n    <div class=\"message\"></div>\n  </body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n\n  <script>\n    var urlParams = new URLSearchParams(window.location.search);\n    var notify_code = urlParams.get(\"code\");\n    var state = urlParams.get(\"state\");\n    $(function() {\n      $.ajax({\n        url: \"https://SLS_URI.execute-api.us-east-2.amazonaws.com/dev/notify\",\n        type: \"POST\",\n        dataType: \"json\",\n        data: { code: notify_code },\n        success: function(response) {\n          console.log(response);\n          $(\".message\").text(response[\"access_token\"]);\n        },\n        error: function(xhr) {\n          console.log(xhr);\n          alert(\"Ajax request 發生錯誤\");\n        }\n      });\n    });\n  </script>\n</html>\n```\n\n接著就是測試程式碼是不是正常的，把這兩個檔案丟到 S3 上面\n![](https://i.imgur.com/SYRxzA1.png)\n\n---\n\n![](https://i.imgur.com/N3olwJd.png)\n\n把 object url 複製到 LINE Notify 上的 callback url 欄位，這樣就可以實機測試了 🤣\n![](https://i.imgur.com/i6Y7dK2.png)\n\n接著按下 index page 的按鈕應該就會看到連動成功(進資料庫應該也會被 insert 一筆)\n![](https://i.imgur.com/lEP0AmZ.png)\n\n到了這邊如果沒問題真的是恭喜你，我踩了好多坑 Orz\n\n## 參考\n\n[資源管理器](https://blog.gtwang.org/programming/python-with-context-manager-tutorial/)\n[flask CORS](https://github.com/corydolphin/flask-cors)\n[CORS](https://serverless.com/framework/docs/providers/aws/events/apigateway/#enabling-cors)\n","source":"_posts/Day5-做一個與-LINE-Notify-連動的服務.md","raw":"---\ntitle: Day5 - 做一個與 LINE Notify 連動的服務\ntags:\n  - LINE Notify\n  - python\ncategories: 2019鐵人賽\nabbrlink: 1338246174\ndate: 2019-09-20 15:46:15\n---\n\n## 建立 LINE Notify 服務\n\n第一步先到 [LINE Notify](https://notify-bot.line.me/zh_TW/) 管力登入服務去建立一個服務\n![](https://i.imgur.com/he0csJI.png)\n接著按下`登入服務`\n![](https://i.imgur.com/iZmktaA.png)\n把該填的填一填，要注意的是 Callback Url 這邊先暫時先打 localhost:5500，等頁面上傳後再回來改 domain\n![](https://i.imgur.com/5zzxTcj.png)\n\n---\n\n![](https://i.imgur.com/VfaWKEs.png)\n\n建立完成之後就到剛剛填的信箱去收信點下網址並啟動服務\n![](https://i.imgur.com/jmZSycQ.png)\n這樣第一步就建立完成嚕！\n\n## 動工\n\n接著上次的透過上次的專案並使用 flask_restful 來改造成 Restful 格式的專案(後面開發會比較輕鬆)\n因為我們會讓前端呼叫，CORS 設定成＊比較輕鬆，若是有要設定跨域問題的在這邊設定哦 👏\n加入套件到 requirements.txt\n\n```\nflask==1.0.2\nFlask-RESTful==0.3.6\nFlask-Cors==3.0.6\nrequests==2.22.0\n```\n\n透過使用 flask_restful 幫忙轉發並管理路由\n將 api.py 改為以下的 code\n\n```python=\nfrom flask import Flask\nfrom flask_restful import Api\nfrom flask_cors import CORS\nfrom controller.notify_controller import NotifyController\n\napp = Flask(__name__)\nCORS(app, resources={r\"*\": {\"origins\": \"*\", \"supports_credentials\": True}})\napi = Api(app)\n\napi.add_resource(NotifyController, '/notify')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n這邊我使用 Postgresql，並在專案底下建立一個 lib/ 的資料夾，裡頭放著名為 db.py (這裡還是要記得建立 **init**.py 哦！)\n這邊只簡單建立[ Context Manager ](https://blog.gtwang.org/programming/python-with-context-manager-tutorial/)讓連線可以被我呼叫。\ndb.py:\n\n```python=\nimport psycopg2\nimport psycopg2.extras\n\nclass Database():\n    conns = []\n    def __enter__(self):\n        return self\n\n    def connect(self):\n        conn = psycopg2.connect(\n            database=PG_DB,\n            user=PG_USER,\n            password=PG_PWD,\n            host=PG_HOST,\n            port=PG_PORT\n        )\n        self.conns.append(conn)\n        return conn\n\n    def __exit__(self, type, value, traceback):\n        for conn in self.conns:\n            conn.close()\n        self.conns.clear()\n```\n\n新增一下資料夾名為 controller，建立 **init**.py & notify_controller.py，這邊搭配 with 做資源管理器，\nDB 部分則見黎一個 notify 表，然後一個 token 的欄位。\n\n> 在這個 class 類別下方法只要輸入 `def get/post/put/patch/delete` 的函式就可以對應 CRUD 的功能了！\n\nnotify_controller.py code is:\n\n```python=\nfrom flask_restful import Resource, reqparse\nimport requests\nimport json\nfrom lib.db import Database\nimport psycopg2.extras\n\nclass NotifyController(Resource):\n    def post(self):\n        parser = reqparse.RequestParser()\n        parser.add_argument('code', required=True, help='code can not be blank!')\n        args = parser.parse_args()\n        code = args['code']\n        client = {'grant_type': 'authorization_code', 'code': code, 'redirect_uri': 'YOUR_REDIRECT_URI',\n                  'client_id': 'YOUR_CLIENT_ID', 'client_secret': 'YOUR_CLIENT_SECRET'}\n        r = requests.post(\n            'https://notify-bot.line.me/oauth/token', data=client)\n        req = json.loads(r.text)\n        if req['status'] == 200:\n            token = req['access_token']\n            # Here is use PostgreSQL, you can change your love db\n            with Database() as db:\n                with db.connect() as conn:\n                    with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                        cur.execute(\n                            f\"INSERT INTO notify(token) VALUES ('{token}')\")\n            return {'access_token': req['access_token']}, 200\n        else:\n            return {'message': r.text}, 200\n```\n\n以下這三個要設定成你的當時輸入的字串\n\n- YOUR_REDIRECT_URI\n- YOUR_CLIENT_ID\n- YOUR_CLIENT_SECRET\n\n> 若不清楚 Client_id & Client_secret 的話就回到 Notify 頁面並點選剛剛建立的服務就能看到 token 了\n\n![](https://i.imgur.com/T0nJaGE.png)\n\n建立一個 views/ 的資料夾，並建立兩個檔案\n\n- notify_index.html\n  > 這邊需要修改 `client_id` 以及 `redirect_uri`\n  > 這個檔案主要功能是讓使用者有個可以按按鈕觸發的地方，當然這只是個範例，實際上線可能就會直接 call API 導向 LINE Notify 頁面等等\n\n```htmlmixed=\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>Link Notify</title>\n  </head>\n  <body>\n    <button onclick=\"Auth();\">點選這裡連結到LineNotify</button>\n\n    <script>\n      function Auth() {\n        var URL = \"https://notify-bot.line.me/oauth/authorize?\";\n        URL += \"response_type=code\";\n        URL += \"&client_id=YOUR_CLIENT_ID\";\n        URL += \"&redirect_uri=YOUR_REDIRECT_URI\";\n        URL += \"&scope=notify\";\n        URL += \"&state=nostate\";\n        window.location.href = URL;\n      }\n    </script>\n  </body>\n</html>\n```\n\n- notify_confirm.html\n  > 修改 ajax 裡的 url，將網址換成之前部署的網址，若忘了可以在部署一次 `sls deploy`\n  > 當導回來的時候透過 ajax 來呼叫 serverless api 讓後端發 requests 給`https://notify-bot.line.me/oauth/token`來獲取`access_token`。\n\n_因為這個路由有 CORS 的問題，若透過瀏覽器來的話會出錯，這邊則是讓後端去處理_\n\n```htmlmixed=\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n    <title>message check</title>\n  </head>\n  <body>\n    verify messate:\n    <div class=\"message\"></div>\n  </body>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js\"></script>\n\n  <script>\n    var urlParams = new URLSearchParams(window.location.search);\n    var notify_code = urlParams.get(\"code\");\n    var state = urlParams.get(\"state\");\n    $(function() {\n      $.ajax({\n        url: \"https://SLS_URI.execute-api.us-east-2.amazonaws.com/dev/notify\",\n        type: \"POST\",\n        dataType: \"json\",\n        data: { code: notify_code },\n        success: function(response) {\n          console.log(response);\n          $(\".message\").text(response[\"access_token\"]);\n        },\n        error: function(xhr) {\n          console.log(xhr);\n          alert(\"Ajax request 發生錯誤\");\n        }\n      });\n    });\n  </script>\n</html>\n```\n\n接著就是測試程式碼是不是正常的，把這兩個檔案丟到 S3 上面\n![](https://i.imgur.com/SYRxzA1.png)\n\n---\n\n![](https://i.imgur.com/N3olwJd.png)\n\n把 object url 複製到 LINE Notify 上的 callback url 欄位，這樣就可以實機測試了 🤣\n![](https://i.imgur.com/i6Y7dK2.png)\n\n接著按下 index page 的按鈕應該就會看到連動成功(進資料庫應該也會被 insert 一筆)\n![](https://i.imgur.com/lEP0AmZ.png)\n\n到了這邊如果沒問題真的是恭喜你，我踩了好多坑 Orz\n\n## 參考\n\n[資源管理器](https://blog.gtwang.org/programming/python-with-context-manager-tutorial/)\n[flask CORS](https://github.com/corydolphin/flask-cors)\n[CORS](https://serverless.com/framework/docs/providers/aws/events/apigateway/#enabling-cors)\n","slug":"Day5-做一個與-LINE-Notify-連動的服務","published":1,"updated":"2020-06-19T14:03:58.849Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31k9002y7crid8hwi6cj","content":"<h2 id=\"建立-LINE-Notify-服務\"><a href=\"#建立-LINE-Notify-服務\" class=\"headerlink\" title=\"建立 LINE Notify 服務\"></a>建立 LINE Notify 服務</h2><p>第一步先到 <a href=\"https://notify-bot.line.me/zh_TW/\" target=\"_blank\" rel=\"noopener\">LINE Notify</a> 管力登入服務去建立一個服務<br><img src=\"https://i.imgur.com/he0csJI.png\" alt><br>接著按下<code>登入服務</code><br><img src=\"https://i.imgur.com/iZmktaA.png\" alt><br>把該填的填一填，要注意的是 Callback Url 這邊先暫時先打 localhost:5500，等頁面上傳後再回來改 domain<br><img src=\"https://i.imgur.com/5zzxTcj.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/VfaWKEs.png\" alt></p>\n<p>建立完成之後就到剛剛填的信箱去收信點下網址並啟動服務<br><img src=\"https://i.imgur.com/jmZSycQ.png\" alt><br>這樣第一步就建立完成嚕！</p>\n<h2 id=\"動工\"><a href=\"#動工\" class=\"headerlink\" title=\"動工\"></a>動工</h2><p>接著上次的透過上次的專案並使用 flask_restful 來改造成 Restful 格式的專案(後面開發會比較輕鬆)<br>因為我們會讓前端呼叫，CORS 設定成＊比較輕鬆，若是有要設定跨域問題的在這邊設定哦 👏<br>加入套件到 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flask==1.0.2</span><br><span class=\"line\">Flask-RESTful==0.3.6</span><br><span class=\"line\">Flask-Cors==3.0.6</span><br><span class=\"line\">requests==2.22.0</span><br></pre></td></tr></table></figure>\n\n<p>透過使用 flask_restful 幫忙轉發並管理路由<br>將 api.py 改為以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Api</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_cors <span class=\"keyword\">import</span> CORS</span><br><span class=\"line\"><span class=\"keyword\">from</span> controller.notify_controller <span class=\"keyword\">import</span> NotifyController</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">CORS(app, resources=&#123;<span class=\"string\">r\"*\"</span>: &#123;<span class=\"string\">\"origins\"</span>: <span class=\"string\">\"*\"</span>, <span class=\"string\">\"supports_credentials\"</span>: <span class=\"literal\">True</span>&#125;&#125;)</span><br><span class=\"line\">api = Api(app)</span><br><span class=\"line\"></span><br><span class=\"line\">api.add_resource(NotifyController, <span class=\"string\">'/notify'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>這邊我使用 Postgresql，並在專案底下建立一個 lib/ 的資料夾，裡頭放著名為 db.py (這裡還是要記得建立 <strong>init</strong>.py 哦！)<br>這邊只簡單建立<a href=\"https://blog.gtwang.org/programming/python-with-context-manager-tutorial/\" target=\"_blank\" rel=\"noopener\"> Context Manager </a>讓連線可以被我呼叫。<br>db.py:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> psycopg2</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Database</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    conns = []</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__enter__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">connect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        conn = psycopg2.connect(</span><br><span class=\"line\">            database=PG_DB,</span><br><span class=\"line\">            user=PG_USER,</span><br><span class=\"line\">            password=PG_PWD,</span><br><span class=\"line\">            host=PG_HOST,</span><br><span class=\"line\">            port=PG_PORT</span><br><span class=\"line\">        )</span><br><span class=\"line\">        self.conns.append(conn)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> conn</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__exit__</span><span class=\"params\">(self, type, value, traceback)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> conn <span class=\"keyword\">in</span> self.conns:</span><br><span class=\"line\">            conn.close()</span><br><span class=\"line\">        self.conns.clear()</span><br></pre></td></tr></table></figure>\n\n<p>新增一下資料夾名為 controller，建立 <strong>init</strong>.py &amp; notify_controller.py，這邊搭配 with 做資源管理器，<br>DB 部分則見黎一個 notify 表，然後一個 token 的欄位。</p>\n<blockquote>\n<p>在這個 class 類別下方法只要輸入 <code>def get/post/put/patch/delete</code> 的函式就可以對應 CRUD 的功能了！</p>\n</blockquote>\n<p>notify_controller.py code is:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource, reqparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.db <span class=\"keyword\">import</span> Database</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NotifyController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        parser = reqparse.RequestParser()</span><br><span class=\"line\">        parser.add_argument(<span class=\"string\">'code'</span>, required=<span class=\"literal\">True</span>, help=<span class=\"string\">'code can not be blank!'</span>)</span><br><span class=\"line\">        args = parser.parse_args()</span><br><span class=\"line\">        code = args[<span class=\"string\">'code'</span>]</span><br><span class=\"line\">        client = &#123;<span class=\"string\">'grant_type'</span>: <span class=\"string\">'authorization_code'</span>, <span class=\"string\">'code'</span>: code, <span class=\"string\">'redirect_uri'</span>: <span class=\"string\">'YOUR_REDIRECT_URI'</span>,</span><br><span class=\"line\">                  <span class=\"string\">'client_id'</span>: <span class=\"string\">'YOUR_CLIENT_ID'</span>, <span class=\"string\">'client_secret'</span>: <span class=\"string\">'YOUR_CLIENT_SECRET'</span>&#125;</span><br><span class=\"line\">        r = requests.post(</span><br><span class=\"line\">            <span class=\"string\">'https://notify-bot.line.me/oauth/token'</span>, data=client)</span><br><span class=\"line\">        req = json.loads(r.text)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> req[<span class=\"string\">'status'</span>] == <span class=\"number\">200</span>:</span><br><span class=\"line\">            token = req[<span class=\"string\">'access_token'</span>]</span><br><span class=\"line\">            <span class=\"comment\"># Here is use PostgreSQL, you can change your love db</span></span><br><span class=\"line\">            <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">                    <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                        cur.execute(</span><br><span class=\"line\">                            <span class=\"string\">f\"INSERT INTO notify(token) VALUES ('<span class=\"subst\">&#123;token&#125;</span>')\"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'access_token'</span>: req[<span class=\"string\">'access_token'</span>]&#125;, <span class=\"number\">200</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'message'</span>: r.text&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>以下這三個要設定成你的當時輸入的字串</p>\n<ul>\n<li>YOUR_REDIRECT_URI</li>\n<li>YOUR_CLIENT_ID</li>\n<li>YOUR_CLIENT_SECRET</li>\n</ul>\n<blockquote>\n<p>若不清楚 Client_id &amp; Client_secret 的話就回到 Notify 頁面並點選剛剛建立的服務就能看到 token 了</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/T0nJaGE.png\" alt></p>\n<p>建立一個 views/ 的資料夾，並建立兩個檔案</p>\n<ul>\n<li>notify_index.html<blockquote>\n<p>這邊需要修改 <code>client_id</code> 以及 <code>redirect_uri</code><br>這個檔案主要功能是讓使用者有個可以按按鈕觸發的地方，當然這只是個範例，實際上線可能就會直接 call API 導向 LINE Notify 頁面等等</p>\n</blockquote>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\">  &lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class=\"line\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span><br><span class=\"line\">    &lt;title&gt;Link Notify&lt;/title&gt;</span><br><span class=\"line\">  &lt;/head&gt;</span><br><span class=\"line\">  &lt;body&gt;</span><br><span class=\"line\">    &lt;button onclick=&quot;Auth();&quot;&gt;點選這裡連結到LineNotify&lt;/button&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;script&gt;</span><br><span class=\"line\">      function Auth() &#123;</span><br><span class=\"line\">        var URL = &quot;https://notify-bot.line.me/oauth/authorize?&quot;;</span><br><span class=\"line\">        URL += &quot;response_type=code&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;client_id=YOUR_CLIENT_ID&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;redirect_uri=YOUR_REDIRECT_URI&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;scope=notify&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;state=nostate&quot;;</span><br><span class=\"line\">        window.location.href = URL;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>notify_confirm.html<blockquote>\n<p>修改 ajax 裡的 url，將網址換成之前部署的網址，若忘了可以在部署一次 <code>sls deploy</code><br>當導回來的時候透過 ajax 來呼叫 serverless api 讓後端發 requests 給<code>https://notify-bot.line.me/oauth/token</code>來獲取<code>access_token</code>。</p>\n</blockquote>\n</li>\n</ul>\n<p><em>因為這個路由有 CORS 的問題，若透過瀏覽器來的話會出錯，這邊則是讓後端去處理</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\">  &lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class=\"line\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span><br><span class=\"line\">    &lt;title&gt;message check&lt;/title&gt;</span><br><span class=\"line\">  &lt;/head&gt;</span><br><span class=\"line\">  &lt;body&gt;</span><br><span class=\"line\">    verify messate:</span><br><span class=\"line\">    &lt;div class=&quot;message&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\">  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;script&gt;</span><br><span class=\"line\">    var urlParams = new URLSearchParams(window.location.search);</span><br><span class=\"line\">    var notify_code = urlParams.get(&quot;code&quot;);</span><br><span class=\"line\">    var state = urlParams.get(&quot;state&quot;);</span><br><span class=\"line\">    $(function() &#123;</span><br><span class=\"line\">      $.ajax(&#123;</span><br><span class=\"line\">        url: &quot;https://SLS_URI.execute-api.us-east-2.amazonaws.com/dev/notify&quot;,</span><br><span class=\"line\">        type: &quot;POST&quot;,</span><br><span class=\"line\">        dataType: &quot;json&quot;,</span><br><span class=\"line\">        data: &#123; code: notify_code &#125;,</span><br><span class=\"line\">        success: function(response) &#123;</span><br><span class=\"line\">          console.log(response);</span><br><span class=\"line\">          $(&quot;.message&quot;).text(response[&quot;access_token&quot;]);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        error: function(xhr) &#123;</span><br><span class=\"line\">          console.log(xhr);</span><br><span class=\"line\">          alert(&quot;Ajax request 發生錯誤&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &lt;/script&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>接著就是測試程式碼是不是正常的，把這兩個檔案丟到 S3 上面<br><img src=\"https://i.imgur.com/SYRxzA1.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/N3olwJd.png\" alt></p>\n<p>把 object url 複製到 LINE Notify 上的 callback url 欄位，這樣就可以實機測試了 🤣<br><img src=\"https://i.imgur.com/i6Y7dK2.png\" alt></p>\n<p>接著按下 index page 的按鈕應該就會看到連動成功(進資料庫應該也會被 insert 一筆)<br><img src=\"https://i.imgur.com/lEP0AmZ.png\" alt></p>\n<p>到了這邊如果沒問題真的是恭喜你，我踩了好多坑 Orz</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://blog.gtwang.org/programming/python-with-context-manager-tutorial/\" target=\"_blank\" rel=\"noopener\">資源管理器</a><br><a href=\"https://github.com/corydolphin/flask-cors\" target=\"_blank\" rel=\"noopener\">flask CORS</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway/#enabling-cors\" target=\"_blank\" rel=\"noopener\">CORS</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"建立-LINE-Notify-服務\"><a href=\"#建立-LINE-Notify-服務\" class=\"headerlink\" title=\"建立 LINE Notify 服務\"></a>建立 LINE Notify 服務</h2><p>第一步先到 <a href=\"https://notify-bot.line.me/zh_TW/\" target=\"_blank\" rel=\"noopener\">LINE Notify</a> 管力登入服務去建立一個服務<br><img src=\"https://i.imgur.com/he0csJI.png\" alt><br>接著按下<code>登入服務</code><br><img src=\"https://i.imgur.com/iZmktaA.png\" alt><br>把該填的填一填，要注意的是 Callback Url 這邊先暫時先打 localhost:5500，等頁面上傳後再回來改 domain<br><img src=\"https://i.imgur.com/5zzxTcj.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/VfaWKEs.png\" alt></p>\n<p>建立完成之後就到剛剛填的信箱去收信點下網址並啟動服務<br><img src=\"https://i.imgur.com/jmZSycQ.png\" alt><br>這樣第一步就建立完成嚕！</p>\n<h2 id=\"動工\"><a href=\"#動工\" class=\"headerlink\" title=\"動工\"></a>動工</h2><p>接著上次的透過上次的專案並使用 flask_restful 來改造成 Restful 格式的專案(後面開發會比較輕鬆)<br>因為我們會讓前端呼叫，CORS 設定成＊比較輕鬆，若是有要設定跨域問題的在這邊設定哦 👏<br>加入套件到 requirements.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flask==1.0.2</span><br><span class=\"line\">Flask-RESTful==0.3.6</span><br><span class=\"line\">Flask-Cors==3.0.6</span><br><span class=\"line\">requests==2.22.0</span><br></pre></td></tr></table></figure>\n\n<p>透過使用 flask_restful 幫忙轉發並管理路由<br>將 api.py 改為以下的 code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Api</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_cors <span class=\"keyword\">import</span> CORS</span><br><span class=\"line\"><span class=\"keyword\">from</span> controller.notify_controller <span class=\"keyword\">import</span> NotifyController</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">CORS(app, resources=&#123;<span class=\"string\">r\"*\"</span>: &#123;<span class=\"string\">\"origins\"</span>: <span class=\"string\">\"*\"</span>, <span class=\"string\">\"supports_credentials\"</span>: <span class=\"literal\">True</span>&#125;&#125;)</span><br><span class=\"line\">api = Api(app)</span><br><span class=\"line\"></span><br><span class=\"line\">api.add_resource(NotifyController, <span class=\"string\">'/notify'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>這邊我使用 Postgresql，並在專案底下建立一個 lib/ 的資料夾，裡頭放著名為 db.py (這裡還是要記得建立 <strong>init</strong>.py 哦！)<br>這邊只簡單建立<a href=\"https://blog.gtwang.org/programming/python-with-context-manager-tutorial/\" target=\"_blank\" rel=\"noopener\"> Context Manager </a>讓連線可以被我呼叫。<br>db.py:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> psycopg2</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Database</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    conns = []</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__enter__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">connect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        conn = psycopg2.connect(</span><br><span class=\"line\">            database=PG_DB,</span><br><span class=\"line\">            user=PG_USER,</span><br><span class=\"line\">            password=PG_PWD,</span><br><span class=\"line\">            host=PG_HOST,</span><br><span class=\"line\">            port=PG_PORT</span><br><span class=\"line\">        )</span><br><span class=\"line\">        self.conns.append(conn)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> conn</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__exit__</span><span class=\"params\">(self, type, value, traceback)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> conn <span class=\"keyword\">in</span> self.conns:</span><br><span class=\"line\">            conn.close()</span><br><span class=\"line\">        self.conns.clear()</span><br></pre></td></tr></table></figure>\n\n<p>新增一下資料夾名為 controller，建立 <strong>init</strong>.py &amp; notify_controller.py，這邊搭配 with 做資源管理器，<br>DB 部分則見黎一個 notify 表，然後一個 token 的欄位。</p>\n<blockquote>\n<p>在這個 class 類別下方法只要輸入 <code>def get/post/put/patch/delete</code> 的函式就可以對應 CRUD 的功能了！</p>\n</blockquote>\n<p>notify_controller.py code is:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource, reqparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.db <span class=\"keyword\">import</span> Database</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NotifyController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        parser = reqparse.RequestParser()</span><br><span class=\"line\">        parser.add_argument(<span class=\"string\">'code'</span>, required=<span class=\"literal\">True</span>, help=<span class=\"string\">'code can not be blank!'</span>)</span><br><span class=\"line\">        args = parser.parse_args()</span><br><span class=\"line\">        code = args[<span class=\"string\">'code'</span>]</span><br><span class=\"line\">        client = &#123;<span class=\"string\">'grant_type'</span>: <span class=\"string\">'authorization_code'</span>, <span class=\"string\">'code'</span>: code, <span class=\"string\">'redirect_uri'</span>: <span class=\"string\">'YOUR_REDIRECT_URI'</span>,</span><br><span class=\"line\">                  <span class=\"string\">'client_id'</span>: <span class=\"string\">'YOUR_CLIENT_ID'</span>, <span class=\"string\">'client_secret'</span>: <span class=\"string\">'YOUR_CLIENT_SECRET'</span>&#125;</span><br><span class=\"line\">        r = requests.post(</span><br><span class=\"line\">            <span class=\"string\">'https://notify-bot.line.me/oauth/token'</span>, data=client)</span><br><span class=\"line\">        req = json.loads(r.text)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> req[<span class=\"string\">'status'</span>] == <span class=\"number\">200</span>:</span><br><span class=\"line\">            token = req[<span class=\"string\">'access_token'</span>]</span><br><span class=\"line\">            <span class=\"comment\"># Here is use PostgreSQL, you can change your love db</span></span><br><span class=\"line\">            <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">                    <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                        cur.execute(</span><br><span class=\"line\">                            <span class=\"string\">f\"INSERT INTO notify(token) VALUES ('<span class=\"subst\">&#123;token&#125;</span>')\"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'access_token'</span>: req[<span class=\"string\">'access_token'</span>]&#125;, <span class=\"number\">200</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"string\">'message'</span>: r.text&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>以下這三個要設定成你的當時輸入的字串</p>\n<ul>\n<li>YOUR_REDIRECT_URI</li>\n<li>YOUR_CLIENT_ID</li>\n<li>YOUR_CLIENT_SECRET</li>\n</ul>\n<blockquote>\n<p>若不清楚 Client_id &amp; Client_secret 的話就回到 Notify 頁面並點選剛剛建立的服務就能看到 token 了</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/T0nJaGE.png\" alt></p>\n<p>建立一個 views/ 的資料夾，並建立兩個檔案</p>\n<ul>\n<li>notify_index.html<blockquote>\n<p>這邊需要修改 <code>client_id</code> 以及 <code>redirect_uri</code><br>這個檔案主要功能是讓使用者有個可以按按鈕觸發的地方，當然這只是個範例，實際上線可能就會直接 call API 導向 LINE Notify 頁面等等</p>\n</blockquote>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\">  &lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class=\"line\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span><br><span class=\"line\">    &lt;title&gt;Link Notify&lt;/title&gt;</span><br><span class=\"line\">  &lt;/head&gt;</span><br><span class=\"line\">  &lt;body&gt;</span><br><span class=\"line\">    &lt;button onclick=&quot;Auth();&quot;&gt;點選這裡連結到LineNotify&lt;/button&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;script&gt;</span><br><span class=\"line\">      function Auth() &#123;</span><br><span class=\"line\">        var URL = &quot;https://notify-bot.line.me/oauth/authorize?&quot;;</span><br><span class=\"line\">        URL += &quot;response_type=code&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;client_id=YOUR_CLIENT_ID&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;redirect_uri=YOUR_REDIRECT_URI&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;scope=notify&quot;;</span><br><span class=\"line\">        URL += &quot;&amp;state=nostate&quot;;</span><br><span class=\"line\">        window.location.href = URL;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>notify_confirm.html<blockquote>\n<p>修改 ajax 裡的 url，將網址換成之前部署的網址，若忘了可以在部署一次 <code>sls deploy</code><br>當導回來的時候透過 ajax 來呼叫 serverless api 讓後端發 requests 給<code>https://notify-bot.line.me/oauth/token</code>來獲取<code>access_token</code>。</p>\n</blockquote>\n</li>\n</ul>\n<p><em>因為這個路由有 CORS 的問題，若透過瀏覽器來的話會出錯，這邊則是讓後端去處理</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\">  &lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class=\"line\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span><br><span class=\"line\">    &lt;title&gt;message check&lt;/title&gt;</span><br><span class=\"line\">  &lt;/head&gt;</span><br><span class=\"line\">  &lt;body&gt;</span><br><span class=\"line\">    verify messate:</span><br><span class=\"line\">    &lt;div class=&quot;message&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\">  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;script&gt;</span><br><span class=\"line\">    var urlParams = new URLSearchParams(window.location.search);</span><br><span class=\"line\">    var notify_code = urlParams.get(&quot;code&quot;);</span><br><span class=\"line\">    var state = urlParams.get(&quot;state&quot;);</span><br><span class=\"line\">    $(function() &#123;</span><br><span class=\"line\">      $.ajax(&#123;</span><br><span class=\"line\">        url: &quot;https://SLS_URI.execute-api.us-east-2.amazonaws.com/dev/notify&quot;,</span><br><span class=\"line\">        type: &quot;POST&quot;,</span><br><span class=\"line\">        dataType: &quot;json&quot;,</span><br><span class=\"line\">        data: &#123; code: notify_code &#125;,</span><br><span class=\"line\">        success: function(response) &#123;</span><br><span class=\"line\">          console.log(response);</span><br><span class=\"line\">          $(&quot;.message&quot;).text(response[&quot;access_token&quot;]);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        error: function(xhr) &#123;</span><br><span class=\"line\">          console.log(xhr);</span><br><span class=\"line\">          alert(&quot;Ajax request 發生錯誤&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &lt;/script&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>接著就是測試程式碼是不是正常的，把這兩個檔案丟到 S3 上面<br><img src=\"https://i.imgur.com/SYRxzA1.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/N3olwJd.png\" alt></p>\n<p>把 object url 複製到 LINE Notify 上的 callback url 欄位，這樣就可以實機測試了 🤣<br><img src=\"https://i.imgur.com/i6Y7dK2.png\" alt></p>\n<p>接著按下 index page 的按鈕應該就會看到連動成功(進資料庫應該也會被 insert 一筆)<br><img src=\"https://i.imgur.com/lEP0AmZ.png\" alt></p>\n<p>到了這邊如果沒問題真的是恭喜你，我踩了好多坑 Orz</p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://blog.gtwang.org/programming/python-with-context-manager-tutorial/\" target=\"_blank\" rel=\"noopener\">資源管理器</a><br><a href=\"https://github.com/corydolphin/flask-cors\" target=\"_blank\" rel=\"noopener\">flask CORS</a><br><a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway/#enabling-cors\" target=\"_blank\" rel=\"noopener\">CORS</a></p>\n"},{"title":"Day8 - SQS 簡單介紹 & 建立","abbrlink":3884948296,"date":"2019-09-22T12:34:30.000Z","_content":"\n[詳細介紹](https://ithelp.ithome.com.tw/articles/10194654)\n\n以前自己在架伺服器的時候，提到訊息佇列不外乎都是 RabbitMQ 或是 Kafka，只是現在 AWS、GCP 這類的雲端平台都越來越火紅了，手動按一下服務就建好了(信用卡也在哭泣)，省去很多建立服務的時間，只是說一般時候根本找不到項目練習 😓，剛好最近在複習 LINE Notfiy，就趁這個機會順便練習並記錄一下 ✌️\n\n## 你需要先了解…\n\n> 當 Http requests 非常大量到一定程度，database 已經跟不上處理的速度，尤其是 relational database，這時就需要 queue 來緩衝；所以社群網站像 Facebook or LinkedIn 都使用大量的 message queue and cache.\n> By -> Leonard Lee\n\n> SQS 就是 managed queue service，主要就是 async, central messaging (對相對應的程式來說，通常處理 api 的會有多個 instances 同時存在，像是 auto-scaling)，像是 fb 通知、寄送 email 認證信這種不用即時處理的情況，只要給訊息給 queue 讓其他服務或程式去處理，可以把原本的邏輯簡化(以及責任區分)，甚至些事件是預期同時會有多個 listener 會需要處理的情況，在一個 api 裡面去處理這些會讓邏輯變很複雜/不好維護。\n> By -> Bill Chung\n\n> 還有就是如果負責處理 request 的 host 有問題，message queue 可以用來短暫儲存還未被處理的 requests 使他們不至於丟失，直到 host 回復正常或是換了一個好的 host 後，message queue 裡面的的 requests 就可以繼續被處理\n> By -> 盧元駿\n\n以上來自我之前寫過的文章 [使用 Serverless 讓 AWS SQS 幫你發送 LINE Notify](https://medium.com/@nijia.lin/使用-serverless-讓-aws-sqs-幫你發送-line-notify-fc3b918473cc)\n\n今天在需要發個請求去呼叫 LINE API(或是其他服務的 API)，都可能會碰到圖片，圖片不管他怎麼壓縮，終究還是比文字肥，在數量多的情況下可能就會發現 API 罷工(就會像被斷詠唱一樣)。雖然平常使用可能不會這麼平凡呼叫，但若在商業用途上使用者多的時候一次呼叫就會有一大筆，這時候用 Queue 讓他們排隊一個一個來就在適合不過了 🎉。\n\n## 為什麼選擇 AWS SQS\n\nAmazon Simple Queue Service (SQS) 是全受管訊息佇列服務，可讓您分離和擴展微型服務、分散式系統及無伺服器應用程式。SQS 可免除與管理和操作訊息導向中介軟體相關的複雜性及開銷，也可讓開發人員專注在與眾不同的工作上。您可以使用 SQS 在軟體元件之間傳送、存放和接收不限數量的訊息，不會遺失訊息或需要其他服務可用。使用 AWS 主控台、命令列界面或自選的 SDK 以及三個簡單的命令，即可在幾分鐘內開始使用 SQS。(參考 [AWS](https://aws.amazon.com/tw/sqs/))\n\nSQS 有在免費方案裡面，只要一個月別高於 100 萬個請求就不會被收錢啦 💪\n![](https://i.imgur.com/az2V5a4.png)\n\n> AWS 的免費方案可以參考 -> [LINK](https://aws.amazon.com/tw/free/?all-free-tier.sort-by=item.additionalFields.SortRank&all-free-tier.sort-order=asc&awsm.page-all-free-tier=5&source=post_page-----fc3b918473cc----------------------)\n\n## 建立 SQS\n\n接著就要開始引入 SQS 嚕，首先到 AWS 上的 SQS 頁面，如下\n\n![](https://i.imgur.com/HXXX2SI.png)\n\n---\n\n接著選左邊的`Standard Queue`並填入 name 就好\n![](https://i.imgur.com/Q88vd9t.png)\n\n---\n\n建立完之後就可以看到下面有建立完的資訊\n\n> ARN 以及 URL 接下來都會用到哦\n\n![](https://i.imgur.com/7pUSK9Q.png)\n\n## 結論\n\n接下來會帶各位使用 Notify 接在 SQS 上，這篇就先帶各位介紹並先手動建立一個 Queue，之後會在大家使用 python 的 boto3 的套件來搭配使用 AWS 服務使用 👏\n","source":"_posts/Day8-SQS-簡單介紹-建立.md","raw":"---\ntitle: Day8 - SQS 簡單介紹 & 建立\ntags:\n  - AWS\n  - SQS\ncategories: 2019鐵人賽\nabbrlink: 3884948296\ndate: 2019-09-22 20:34:30\n---\n\n[詳細介紹](https://ithelp.ithome.com.tw/articles/10194654)\n\n以前自己在架伺服器的時候，提到訊息佇列不外乎都是 RabbitMQ 或是 Kafka，只是現在 AWS、GCP 這類的雲端平台都越來越火紅了，手動按一下服務就建好了(信用卡也在哭泣)，省去很多建立服務的時間，只是說一般時候根本找不到項目練習 😓，剛好最近在複習 LINE Notfiy，就趁這個機會順便練習並記錄一下 ✌️\n\n## 你需要先了解…\n\n> 當 Http requests 非常大量到一定程度，database 已經跟不上處理的速度，尤其是 relational database，這時就需要 queue 來緩衝；所以社群網站像 Facebook or LinkedIn 都使用大量的 message queue and cache.\n> By -> Leonard Lee\n\n> SQS 就是 managed queue service，主要就是 async, central messaging (對相對應的程式來說，通常處理 api 的會有多個 instances 同時存在，像是 auto-scaling)，像是 fb 通知、寄送 email 認證信這種不用即時處理的情況，只要給訊息給 queue 讓其他服務或程式去處理，可以把原本的邏輯簡化(以及責任區分)，甚至些事件是預期同時會有多個 listener 會需要處理的情況，在一個 api 裡面去處理這些會讓邏輯變很複雜/不好維護。\n> By -> Bill Chung\n\n> 還有就是如果負責處理 request 的 host 有問題，message queue 可以用來短暫儲存還未被處理的 requests 使他們不至於丟失，直到 host 回復正常或是換了一個好的 host 後，message queue 裡面的的 requests 就可以繼續被處理\n> By -> 盧元駿\n\n以上來自我之前寫過的文章 [使用 Serverless 讓 AWS SQS 幫你發送 LINE Notify](https://medium.com/@nijia.lin/使用-serverless-讓-aws-sqs-幫你發送-line-notify-fc3b918473cc)\n\n今天在需要發個請求去呼叫 LINE API(或是其他服務的 API)，都可能會碰到圖片，圖片不管他怎麼壓縮，終究還是比文字肥，在數量多的情況下可能就會發現 API 罷工(就會像被斷詠唱一樣)。雖然平常使用可能不會這麼平凡呼叫，但若在商業用途上使用者多的時候一次呼叫就會有一大筆，這時候用 Queue 讓他們排隊一個一個來就在適合不過了 🎉。\n\n## 為什麼選擇 AWS SQS\n\nAmazon Simple Queue Service (SQS) 是全受管訊息佇列服務，可讓您分離和擴展微型服務、分散式系統及無伺服器應用程式。SQS 可免除與管理和操作訊息導向中介軟體相關的複雜性及開銷，也可讓開發人員專注在與眾不同的工作上。您可以使用 SQS 在軟體元件之間傳送、存放和接收不限數量的訊息，不會遺失訊息或需要其他服務可用。使用 AWS 主控台、命令列界面或自選的 SDK 以及三個簡單的命令，即可在幾分鐘內開始使用 SQS。(參考 [AWS](https://aws.amazon.com/tw/sqs/))\n\nSQS 有在免費方案裡面，只要一個月別高於 100 萬個請求就不會被收錢啦 💪\n![](https://i.imgur.com/az2V5a4.png)\n\n> AWS 的免費方案可以參考 -> [LINK](https://aws.amazon.com/tw/free/?all-free-tier.sort-by=item.additionalFields.SortRank&all-free-tier.sort-order=asc&awsm.page-all-free-tier=5&source=post_page-----fc3b918473cc----------------------)\n\n## 建立 SQS\n\n接著就要開始引入 SQS 嚕，首先到 AWS 上的 SQS 頁面，如下\n\n![](https://i.imgur.com/HXXX2SI.png)\n\n---\n\n接著選左邊的`Standard Queue`並填入 name 就好\n![](https://i.imgur.com/Q88vd9t.png)\n\n---\n\n建立完之後就可以看到下面有建立完的資訊\n\n> ARN 以及 URL 接下來都會用到哦\n\n![](https://i.imgur.com/7pUSK9Q.png)\n\n## 結論\n\n接下來會帶各位使用 Notify 接在 SQS 上，這篇就先帶各位介紹並先手動建立一個 Queue，之後會在大家使用 python 的 boto3 的套件來搭配使用 AWS 服務使用 👏\n","slug":"Day8-SQS-簡單介紹-建立","published":1,"updated":"2020-06-19T14:03:58.851Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kb00317cri6t330c6n","content":"<p><a href=\"https://ithelp.ithome.com.tw/articles/10194654\" target=\"_blank\" rel=\"noopener\">詳細介紹</a></p>\n<p>以前自己在架伺服器的時候，提到訊息佇列不外乎都是 RabbitMQ 或是 Kafka，只是現在 AWS、GCP 這類的雲端平台都越來越火紅了，手動按一下服務就建好了(信用卡也在哭泣)，省去很多建立服務的時間，只是說一般時候根本找不到項目練習 😓，剛好最近在複習 LINE Notfiy，就趁這個機會順便練習並記錄一下 ✌️</p>\n<h2 id=\"你需要先了解…\"><a href=\"#你需要先了解…\" class=\"headerlink\" title=\"你需要先了解…\"></a>你需要先了解…</h2><blockquote>\n<p>當 Http requests 非常大量到一定程度，database 已經跟不上處理的速度，尤其是 relational database，這時就需要 queue 來緩衝；所以社群網站像 Facebook or LinkedIn 都使用大量的 message queue and cache.<br>By -&gt; Leonard Lee</p>\n</blockquote>\n<blockquote>\n<p>SQS 就是 managed queue service，主要就是 async, central messaging (對相對應的程式來說，通常處理 api 的會有多個 instances 同時存在，像是 auto-scaling)，像是 fb 通知、寄送 email 認證信這種不用即時處理的情況，只要給訊息給 queue 讓其他服務或程式去處理，可以把原本的邏輯簡化(以及責任區分)，甚至些事件是預期同時會有多個 listener 會需要處理的情況，在一個 api 裡面去處理這些會讓邏輯變很複雜/不好維護。<br>By -&gt; Bill Chung</p>\n</blockquote>\n<blockquote>\n<p>還有就是如果負責處理 request 的 host 有問題，message queue 可以用來短暫儲存還未被處理的 requests 使他們不至於丟失，直到 host 回復正常或是換了一個好的 host 後，message queue 裡面的的 requests 就可以繼續被處理<br>By -&gt; 盧元駿</p>\n</blockquote>\n<p>以上來自我之前寫過的文章 <a href=\"https://medium.com/@nijia.lin/使用-serverless-讓-aws-sqs-幫你發送-line-notify-fc3b918473cc\" target=\"_blank\" rel=\"noopener\">使用 Serverless 讓 AWS SQS 幫你發送 LINE Notify</a></p>\n<p>今天在需要發個請求去呼叫 LINE API(或是其他服務的 API)，都可能會碰到圖片，圖片不管他怎麼壓縮，終究還是比文字肥，在數量多的情況下可能就會發現 API 罷工(就會像被斷詠唱一樣)。雖然平常使用可能不會這麼平凡呼叫，但若在商業用途上使用者多的時候一次呼叫就會有一大筆，這時候用 Queue 讓他們排隊一個一個來就在適合不過了 🎉。</p>\n<h2 id=\"為什麼選擇-AWS-SQS\"><a href=\"#為什麼選擇-AWS-SQS\" class=\"headerlink\" title=\"為什麼選擇 AWS SQS\"></a>為什麼選擇 AWS SQS</h2><p>Amazon Simple Queue Service (SQS) 是全受管訊息佇列服務，可讓您分離和擴展微型服務、分散式系統及無伺服器應用程式。SQS 可免除與管理和操作訊息導向中介軟體相關的複雜性及開銷，也可讓開發人員專注在與眾不同的工作上。您可以使用 SQS 在軟體元件之間傳送、存放和接收不限數量的訊息，不會遺失訊息或需要其他服務可用。使用 AWS 主控台、命令列界面或自選的 SDK 以及三個簡單的命令，即可在幾分鐘內開始使用 SQS。(參考 <a href=\"https://aws.amazon.com/tw/sqs/\" target=\"_blank\" rel=\"noopener\">AWS</a>)</p>\n<p>SQS 有在免費方案裡面，只要一個月別高於 100 萬個請求就不會被收錢啦 💪<br><img src=\"https://i.imgur.com/az2V5a4.png\" alt></p>\n<blockquote>\n<p>AWS 的免費方案可以參考 -&gt; <a href=\"https://aws.amazon.com/tw/free/?all-free-tier.sort-by=item.additionalFields.SortRank&all-free-tier.sort-order=asc&awsm.page-all-free-tier=5&source=post_page-----fc3b918473cc----------------------\" target=\"_blank\" rel=\"noopener\">LINK</a></p>\n</blockquote>\n<h2 id=\"建立-SQS\"><a href=\"#建立-SQS\" class=\"headerlink\" title=\"建立 SQS\"></a>建立 SQS</h2><p>接著就要開始引入 SQS 嚕，首先到 AWS 上的 SQS 頁面，如下</p>\n<p><img src=\"https://i.imgur.com/HXXX2SI.png\" alt></p>\n<hr>\n<p>接著選左邊的<code>Standard Queue</code>並填入 name 就好<br><img src=\"https://i.imgur.com/Q88vd9t.png\" alt></p>\n<hr>\n<p>建立完之後就可以看到下面有建立完的資訊</p>\n<blockquote>\n<p>ARN 以及 URL 接下來都會用到哦</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/7pUSK9Q.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>接下來會帶各位使用 Notify 接在 SQS 上，這篇就先帶各位介紹並先手動建立一個 Queue，之後會在大家使用 python 的 boto3 的套件來搭配使用 AWS 服務使用 👏</p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://ithelp.ithome.com.tw/articles/10194654\" target=\"_blank\" rel=\"noopener\">詳細介紹</a></p>\n<p>以前自己在架伺服器的時候，提到訊息佇列不外乎都是 RabbitMQ 或是 Kafka，只是現在 AWS、GCP 這類的雲端平台都越來越火紅了，手動按一下服務就建好了(信用卡也在哭泣)，省去很多建立服務的時間，只是說一般時候根本找不到項目練習 😓，剛好最近在複習 LINE Notfiy，就趁這個機會順便練習並記錄一下 ✌️</p>\n<h2 id=\"你需要先了解…\"><a href=\"#你需要先了解…\" class=\"headerlink\" title=\"你需要先了解…\"></a>你需要先了解…</h2><blockquote>\n<p>當 Http requests 非常大量到一定程度，database 已經跟不上處理的速度，尤其是 relational database，這時就需要 queue 來緩衝；所以社群網站像 Facebook or LinkedIn 都使用大量的 message queue and cache.<br>By -&gt; Leonard Lee</p>\n</blockquote>\n<blockquote>\n<p>SQS 就是 managed queue service，主要就是 async, central messaging (對相對應的程式來說，通常處理 api 的會有多個 instances 同時存在，像是 auto-scaling)，像是 fb 通知、寄送 email 認證信這種不用即時處理的情況，只要給訊息給 queue 讓其他服務或程式去處理，可以把原本的邏輯簡化(以及責任區分)，甚至些事件是預期同時會有多個 listener 會需要處理的情況，在一個 api 裡面去處理這些會讓邏輯變很複雜/不好維護。<br>By -&gt; Bill Chung</p>\n</blockquote>\n<blockquote>\n<p>還有就是如果負責處理 request 的 host 有問題，message queue 可以用來短暫儲存還未被處理的 requests 使他們不至於丟失，直到 host 回復正常或是換了一個好的 host 後，message queue 裡面的的 requests 就可以繼續被處理<br>By -&gt; 盧元駿</p>\n</blockquote>\n<p>以上來自我之前寫過的文章 <a href=\"https://medium.com/@nijia.lin/使用-serverless-讓-aws-sqs-幫你發送-line-notify-fc3b918473cc\" target=\"_blank\" rel=\"noopener\">使用 Serverless 讓 AWS SQS 幫你發送 LINE Notify</a></p>\n<p>今天在需要發個請求去呼叫 LINE API(或是其他服務的 API)，都可能會碰到圖片，圖片不管他怎麼壓縮，終究還是比文字肥，在數量多的情況下可能就會發現 API 罷工(就會像被斷詠唱一樣)。雖然平常使用可能不會這麼平凡呼叫，但若在商業用途上使用者多的時候一次呼叫就會有一大筆，這時候用 Queue 讓他們排隊一個一個來就在適合不過了 🎉。</p>\n<h2 id=\"為什麼選擇-AWS-SQS\"><a href=\"#為什麼選擇-AWS-SQS\" class=\"headerlink\" title=\"為什麼選擇 AWS SQS\"></a>為什麼選擇 AWS SQS</h2><p>Amazon Simple Queue Service (SQS) 是全受管訊息佇列服務，可讓您分離和擴展微型服務、分散式系統及無伺服器應用程式。SQS 可免除與管理和操作訊息導向中介軟體相關的複雜性及開銷，也可讓開發人員專注在與眾不同的工作上。您可以使用 SQS 在軟體元件之間傳送、存放和接收不限數量的訊息，不會遺失訊息或需要其他服務可用。使用 AWS 主控台、命令列界面或自選的 SDK 以及三個簡單的命令，即可在幾分鐘內開始使用 SQS。(參考 <a href=\"https://aws.amazon.com/tw/sqs/\" target=\"_blank\" rel=\"noopener\">AWS</a>)</p>\n<p>SQS 有在免費方案裡面，只要一個月別高於 100 萬個請求就不會被收錢啦 💪<br><img src=\"https://i.imgur.com/az2V5a4.png\" alt></p>\n<blockquote>\n<p>AWS 的免費方案可以參考 -&gt; <a href=\"https://aws.amazon.com/tw/free/?all-free-tier.sort-by=item.additionalFields.SortRank&all-free-tier.sort-order=asc&awsm.page-all-free-tier=5&source=post_page-----fc3b918473cc----------------------\" target=\"_blank\" rel=\"noopener\">LINK</a></p>\n</blockquote>\n<h2 id=\"建立-SQS\"><a href=\"#建立-SQS\" class=\"headerlink\" title=\"建立 SQS\"></a>建立 SQS</h2><p>接著就要開始引入 SQS 嚕，首先到 AWS 上的 SQS 頁面，如下</p>\n<p><img src=\"https://i.imgur.com/HXXX2SI.png\" alt></p>\n<hr>\n<p>接著選左邊的<code>Standard Queue</code>並填入 name 就好<br><img src=\"https://i.imgur.com/Q88vd9t.png\" alt></p>\n<hr>\n<p>建立完之後就可以看到下面有建立完的資訊</p>\n<blockquote>\n<p>ARN 以及 URL 接下來都會用到哦</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/7pUSK9Q.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>接下來會帶各位使用 Notify 接在 SQS 上，這篇就先帶各位介紹並先手動建立一個 Queue，之後會在大家使用 python 的 boto3 的套件來搭配使用 AWS 服務使用 👏</p>\n"},{"title":"Day9 - SQS 串接 Notify 實作！","abbrlink":3810543739,"date":"2019-09-23T12:35:36.000Z","_content":"\n首先先建立一個`consumer/`資料夾，新增`__init__.py`以及`notify_handler.py`\n\n在`notify_handler.py`輸入以下程式碼\n\n```python=\nimport json\nimport requests\n\n\ndef line_notify_handler(event, context):\n    print(event)\n    body = json.loads(event['Records'][0]['body'])\n    print(body)\n    headers = {\n        'Authorization': f\"Bearer {body['token']}\",\n        'Content-Type': 'application/x-www-form-urlencoded'\n    }\n    r = requests.post('https://notify-api.line.me/api/notify',\n                      headers=headers,\n                      data={'message': body['message']})\n    print(r)\n\n# AWS record sample\n# {'Records': [{'messageId': 'fddc42ba-a122-4581-965e-d0144ac8a5ad', 'receiptHandle': 'AQEBjO32gY5pXOfOrmDR0hD4k1av9KyjbHFpc+rIBPV2Brif7Lo+jqnGevSjfFwlICyGf+BhWwKaxFw8XdB3QTzRbw0vnLURjnQeDSBrJHa/S57SRs9TOLRBq38maycAVg69iZbetg9VhLMBCcLtOtPHTzKkmo+/Sosm51WA5CzXK7A0rteikx6nxS1CUIpq6MAujodupP0Hgr5RjK5nH/nmxA4Db0leWEmLokalZbtlx4W14tp7PZxPOrQOLDaGrH//p4h32tY8IN3MkCqi+gyNT7kCU4KwCGOIrybb07ZWyKBTKw+KOMNr/Ykj4z2N1qxIvTM55UY9d8V29YsH32OjrZTei5P7Nke/51E2tWkmkqoFAlqzxDjQPvpP+Pvvr8aazeeZ6opkr59UefAiiyM71Q==', 'body': 'hi', 'attributes': {'ApproximateReceiveCount': '9', 'SentTimestamp': '1566621263072', 'SenderId': '901588721449', 'ApproximateFirstReceiveTimestamp': '1566621263072'}, 'messageAttributes': {}, 'md5OfBody': '49f68a5c8493ec2c0bf489821c21fc3b', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-east-1:901588721449:LINE_notify_consumer', 'awsRegion': 'us-east-1'}]}\n```\n\n接著在`requirements.txt`加入`boto3`，他是一個使用 python 介接 AWS 的套件\n\n```\nboto3==1.9.189\n```\n\n加入`SQS_URL`以及`SQS_ARN`到`.env`裡面\n\n```\nSQS_URL=sqs url\nSQS_ARN=your sqs arn\n```\n\nadd controller/notify_sqs_controller.py\n\n```python=\nfrom flask_restful import Resource, reqparse\nimport json\nfrom lib.db import Database\nimport psycopg2.extras\nimport os\nimport boto3\n\n\ndef send_message(url, attr, body, delay=0):\n    cli.send_message(\n        QueueUrl=url,\n        DelaySeconds=0,\n        MessageAttributes=attr,\n        MessageBody=body,\n    )\n\n\nclass SendNotifyBySQSController(Resource):\n    cli = boto3.client(\"sqs\", region_name=os.environ(\"region\"))\n\n    def post(self):\n        parser = reqparse.RequestParser()\n        parser.add_argument(\n            'message', required=True, help='message can not be blank!')\n        args = parser.parse_args()\n        msg = args['message']\n        with Database() as db, db.connect() as conn:\n            with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                cur.execute(\n                    f\"SELECT token FROM notify\")\n                fetch = cur.fetchall()\n        for f in fetch:\n            body = {\n                'token': f\"Bearer {f['token']}\",\n                'message': f\"Hello everyone, {msg}\"\n            }\n            cli.send_message(\n                QueueUrl=os.environ(\"SQS_URL\"),\n                DelaySeconds=0,\n                MessageAttributes={},\n                MessageBody=json.dumps(body),\n            )\n        return {'result': 'ok'}, 200\n```\n\n程式寫完了就是要加一條路由`/notify/sqs`\n\n```\nfrom controller.notify_sqs_controller import SendNotifyBySQSController\napi.add_resource(SendNotifyBySQSController, '/notify/sqs')\n```\n\n接著透過`wsgi`在本地起一個 server\n\n```\nsls wsgi serve\n```\n\n再搭配 postman 來做測試，測試內容如下\n\n```\n{\n  \"message\": \"test Content\"\n}\n```\n\n接著透過`sls deploy`部署上會遇到一個問題，會有 Access Denied，所以要在`serverless.yml`加入 IAM role 的設定\n\nadd iam in provider\n\n```yaml=\niamRoleStatements:\n  - Effect: Allow\n    Action:\n      - sqs:SendMessage\n    Resource:\n      - ${env:SQS_ARN}\n```\n\n## 測試\n\n![](https://i.imgur.com/5FViVEk.png)\n![](https://i.imgur.com/Xg70nDp.png)\n\n## 結論\n\n使用 SQS 這類服務都會需要透過`boto3`來幫忙串接，最需要注意的就是 IAM role，因為在本地端的 key 通常權限都是最大的，但上到 AWS 上就會有權限的問題，所以要記得加入 IAM 哦！\n\nCode is [here](https://github.com/louis70109/aws-python-line-api/blob/master/controller/notify_sqs_controller.py)\n\n專案也會持續更新，更多詳情可以 follow 我的專案 [aws-python-line-api](https://github.com/louis70109/aws-python-line-api)。\n","source":"_posts/Day9-SQS-串接-Notify-實作！.md","raw":"---\ntitle: Day9 - SQS 串接 Notify 實作！\ntags:\n  - AWS\n  - SQS\n  - LINE\n  - Notify\n  - IAM\ncategories: 2019鐵人賽\nabbrlink: 3810543739\ndate: 2019-09-23 20:35:36\n---\n\n首先先建立一個`consumer/`資料夾，新增`__init__.py`以及`notify_handler.py`\n\n在`notify_handler.py`輸入以下程式碼\n\n```python=\nimport json\nimport requests\n\n\ndef line_notify_handler(event, context):\n    print(event)\n    body = json.loads(event['Records'][0]['body'])\n    print(body)\n    headers = {\n        'Authorization': f\"Bearer {body['token']}\",\n        'Content-Type': 'application/x-www-form-urlencoded'\n    }\n    r = requests.post('https://notify-api.line.me/api/notify',\n                      headers=headers,\n                      data={'message': body['message']})\n    print(r)\n\n# AWS record sample\n# {'Records': [{'messageId': 'fddc42ba-a122-4581-965e-d0144ac8a5ad', 'receiptHandle': 'AQEBjO32gY5pXOfOrmDR0hD4k1av9KyjbHFpc+rIBPV2Brif7Lo+jqnGevSjfFwlICyGf+BhWwKaxFw8XdB3QTzRbw0vnLURjnQeDSBrJHa/S57SRs9TOLRBq38maycAVg69iZbetg9VhLMBCcLtOtPHTzKkmo+/Sosm51WA5CzXK7A0rteikx6nxS1CUIpq6MAujodupP0Hgr5RjK5nH/nmxA4Db0leWEmLokalZbtlx4W14tp7PZxPOrQOLDaGrH//p4h32tY8IN3MkCqi+gyNT7kCU4KwCGOIrybb07ZWyKBTKw+KOMNr/Ykj4z2N1qxIvTM55UY9d8V29YsH32OjrZTei5P7Nke/51E2tWkmkqoFAlqzxDjQPvpP+Pvvr8aazeeZ6opkr59UefAiiyM71Q==', 'body': 'hi', 'attributes': {'ApproximateReceiveCount': '9', 'SentTimestamp': '1566621263072', 'SenderId': '901588721449', 'ApproximateFirstReceiveTimestamp': '1566621263072'}, 'messageAttributes': {}, 'md5OfBody': '49f68a5c8493ec2c0bf489821c21fc3b', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-east-1:901588721449:LINE_notify_consumer', 'awsRegion': 'us-east-1'}]}\n```\n\n接著在`requirements.txt`加入`boto3`，他是一個使用 python 介接 AWS 的套件\n\n```\nboto3==1.9.189\n```\n\n加入`SQS_URL`以及`SQS_ARN`到`.env`裡面\n\n```\nSQS_URL=sqs url\nSQS_ARN=your sqs arn\n```\n\nadd controller/notify_sqs_controller.py\n\n```python=\nfrom flask_restful import Resource, reqparse\nimport json\nfrom lib.db import Database\nimport psycopg2.extras\nimport os\nimport boto3\n\n\ndef send_message(url, attr, body, delay=0):\n    cli.send_message(\n        QueueUrl=url,\n        DelaySeconds=0,\n        MessageAttributes=attr,\n        MessageBody=body,\n    )\n\n\nclass SendNotifyBySQSController(Resource):\n    cli = boto3.client(\"sqs\", region_name=os.environ(\"region\"))\n\n    def post(self):\n        parser = reqparse.RequestParser()\n        parser.add_argument(\n            'message', required=True, help='message can not be blank!')\n        args = parser.parse_args()\n        msg = args['message']\n        with Database() as db, db.connect() as conn:\n            with conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) as cur:\n                cur.execute(\n                    f\"SELECT token FROM notify\")\n                fetch = cur.fetchall()\n        for f in fetch:\n            body = {\n                'token': f\"Bearer {f['token']}\",\n                'message': f\"Hello everyone, {msg}\"\n            }\n            cli.send_message(\n                QueueUrl=os.environ(\"SQS_URL\"),\n                DelaySeconds=0,\n                MessageAttributes={},\n                MessageBody=json.dumps(body),\n            )\n        return {'result': 'ok'}, 200\n```\n\n程式寫完了就是要加一條路由`/notify/sqs`\n\n```\nfrom controller.notify_sqs_controller import SendNotifyBySQSController\napi.add_resource(SendNotifyBySQSController, '/notify/sqs')\n```\n\n接著透過`wsgi`在本地起一個 server\n\n```\nsls wsgi serve\n```\n\n再搭配 postman 來做測試，測試內容如下\n\n```\n{\n  \"message\": \"test Content\"\n}\n```\n\n接著透過`sls deploy`部署上會遇到一個問題，會有 Access Denied，所以要在`serverless.yml`加入 IAM role 的設定\n\nadd iam in provider\n\n```yaml=\niamRoleStatements:\n  - Effect: Allow\n    Action:\n      - sqs:SendMessage\n    Resource:\n      - ${env:SQS_ARN}\n```\n\n## 測試\n\n![](https://i.imgur.com/5FViVEk.png)\n![](https://i.imgur.com/Xg70nDp.png)\n\n## 結論\n\n使用 SQS 這類服務都會需要透過`boto3`來幫忙串接，最需要注意的就是 IAM role，因為在本地端的 key 通常權限都是最大的，但上到 AWS 上就會有權限的問題，所以要記得加入 IAM 哦！\n\nCode is [here](https://github.com/louis70109/aws-python-line-api/blob/master/controller/notify_sqs_controller.py)\n\n專案也會持續更新，更多詳情可以 follow 我的專案 [aws-python-line-api](https://github.com/louis70109/aws-python-line-api)。\n","slug":"Day9-SQS-串接-Notify-實作！","published":1,"updated":"2020-06-19T14:03:58.853Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kc00357criyncvkhpp","content":"<p>首先先建立一個<code>consumer/</code>資料夾，新增<code>__init__.py</code>以及<code>notify_handler.py</code></p>\n<p>在<code>notify_handler.py</code>輸入以下程式碼</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">line_notify_handler</span><span class=\"params\">(event, context)</span>:</span></span><br><span class=\"line\">    print(event)</span><br><span class=\"line\">    body = json.loads(event[<span class=\"string\">'Records'</span>][<span class=\"number\">0</span>][<span class=\"string\">'body'</span>])</span><br><span class=\"line\">    print(body)</span><br><span class=\"line\">    headers = &#123;</span><br><span class=\"line\">        <span class=\"string\">'Authorization'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;body[<span class=\"string\">'token'</span>]&#125;</span>\"</span>,</span><br><span class=\"line\">        <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    r = requests.post(<span class=\"string\">'https://notify-api.line.me/api/notify'</span>,</span><br><span class=\"line\">                      headers=headers,</span><br><span class=\"line\">                      data=&#123;<span class=\"string\">'message'</span>: body[<span class=\"string\">'message'</span>]&#125;)</span><br><span class=\"line\">    print(r)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># AWS record sample</span></span><br><span class=\"line\"><span class=\"comment\"># &#123;'Records': [&#123;'messageId': 'fddc42ba-a122-4581-965e-d0144ac8a5ad', 'receiptHandle': 'AQEBjO32gY5pXOfOrmDR0hD4k1av9KyjbHFpc+rIBPV2Brif7Lo+jqnGevSjfFwlICyGf+BhWwKaxFw8XdB3QTzRbw0vnLURjnQeDSBrJHa/S57SRs9TOLRBq38maycAVg69iZbetg9VhLMBCcLtOtPHTzKkmo+/Sosm51WA5CzXK7A0rteikx6nxS1CUIpq6MAujodupP0Hgr5RjK5nH/nmxA4Db0leWEmLokalZbtlx4W14tp7PZxPOrQOLDaGrH//p4h32tY8IN3MkCqi+gyNT7kCU4KwCGOIrybb07ZWyKBTKw+KOMNr/Ykj4z2N1qxIvTM55UY9d8V29YsH32OjrZTei5P7Nke/51E2tWkmkqoFAlqzxDjQPvpP+Pvvr8aazeeZ6opkr59UefAiiyM71Q==', 'body': 'hi', 'attributes': &#123;'ApproximateReceiveCount': '9', 'SentTimestamp': '1566621263072', 'SenderId': '901588721449', 'ApproximateFirstReceiveTimestamp': '1566621263072'&#125;, 'messageAttributes': &#123;&#125;, 'md5OfBody': '49f68a5c8493ec2c0bf489821c21fc3b', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-east-1:901588721449:LINE_notify_consumer', 'awsRegion': 'us-east-1'&#125;]&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著在<code>requirements.txt</code>加入<code>boto3</code>，他是一個使用 python 介接 AWS 的套件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boto3==1.9.189</span><br></pre></td></tr></table></figure>\n\n<p>加入<code>SQS_URL</code>以及<code>SQS_ARN</code>到<code>.env</code>裡面</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SQS_URL=sqs url</span><br><span class=\"line\">SQS_ARN=your sqs arn</span><br></pre></td></tr></table></figure>\n\n<p>add controller/notify_sqs_controller.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource, reqparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.db <span class=\"keyword\">import</span> Database</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> boto3</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">send_message</span><span class=\"params\">(url, attr, body, delay=<span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    cli.send_message(</span><br><span class=\"line\">        QueueUrl=url,</span><br><span class=\"line\">        DelaySeconds=<span class=\"number\">0</span>,</span><br><span class=\"line\">        MessageAttributes=attr,</span><br><span class=\"line\">        MessageBody=body,</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SendNotifyBySQSController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    cli = boto3.client(<span class=\"string\">\"sqs\"</span>, region_name=os.environ(<span class=\"string\">\"region\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        parser = reqparse.RequestParser()</span><br><span class=\"line\">        parser.add_argument(</span><br><span class=\"line\">            <span class=\"string\">'message'</span>, required=<span class=\"literal\">True</span>, help=<span class=\"string\">'message can not be blank!'</span>)</span><br><span class=\"line\">        args = parser.parse_args()</span><br><span class=\"line\">        msg = args[<span class=\"string\">'message'</span>]</span><br><span class=\"line\">        <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">            <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                cur.execute(</span><br><span class=\"line\">                    <span class=\"string\">f\"SELECT token FROM notify\"</span>)</span><br><span class=\"line\">                fetch = cur.fetchall()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">            body = &#123;</span><br><span class=\"line\">                <span class=\"string\">'token'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;f[<span class=\"string\">'token'</span>]&#125;</span>\"</span>,</span><br><span class=\"line\">                <span class=\"string\">'message'</span>: <span class=\"string\">f\"Hello everyone, <span class=\"subst\">&#123;msg&#125;</span>\"</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            cli.send_message(</span><br><span class=\"line\">                QueueUrl=os.environ(<span class=\"string\">\"SQS_URL\"</span>),</span><br><span class=\"line\">                DelaySeconds=<span class=\"number\">0</span>,</span><br><span class=\"line\">                MessageAttributes=&#123;&#125;,</span><br><span class=\"line\">                MessageBody=json.dumps(body),</span><br><span class=\"line\">            )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: <span class=\"string\">'ok'</span>&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>程式寫完了就是要加一條路由<code>/notify/sqs</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from controller.notify_sqs_controller import SendNotifyBySQSController</span><br><span class=\"line\">api.add_resource(SendNotifyBySQSController, &apos;/notify/sqs&apos;)</span><br></pre></td></tr></table></figure>\n\n<p>接著透過<code>wsgi</code>在本地起一個 server</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>再搭配 postman 來做測試，測試內容如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;message&quot;: &quot;test Content&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>接著透過<code>sls deploy</code>部署上會遇到一個問題，會有 Access Denied，所以要在<code>serverless.yml</code>加入 IAM role 的設定</p>\n<p>add iam in provider</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">iamRoleStatements:</span></span><br><span class=\"line\"><span class=\"attr\">  - Effect:</span> <span class=\"string\">Allow</span></span><br><span class=\"line\"><span class=\"attr\">    Action:</span></span><br><span class=\"line\"><span class=\"attr\">      - sqs:</span><span class=\"string\">SendMessage</span></span><br><span class=\"line\"><span class=\"attr\">    Resource:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">$&#123;env:SQS_ARN&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"測試\"><a href=\"#測試\" class=\"headerlink\" title=\"測試\"></a>測試</h2><p><img src=\"https://i.imgur.com/5FViVEk.png\" alt><br><img src=\"https://i.imgur.com/Xg70nDp.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>使用 SQS 這類服務都會需要透過<code>boto3</code>來幫忙串接，最需要注意的就是 IAM role，因為在本地端的 key 通常權限都是最大的，但上到 AWS 上就會有權限的問題，所以要記得加入 IAM 哦！</p>\n<p>Code is <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/notify_sqs_controller.py\" target=\"_blank\" rel=\"noopener\">here</a></p>\n<p>專案也會持續更新，更多詳情可以 follow 我的專案 <a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">aws-python-line-api</a>。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>首先先建立一個<code>consumer/</code>資料夾，新增<code>__init__.py</code>以及<code>notify_handler.py</code></p>\n<p>在<code>notify_handler.py</code>輸入以下程式碼</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">line_notify_handler</span><span class=\"params\">(event, context)</span>:</span></span><br><span class=\"line\">    print(event)</span><br><span class=\"line\">    body = json.loads(event[<span class=\"string\">'Records'</span>][<span class=\"number\">0</span>][<span class=\"string\">'body'</span>])</span><br><span class=\"line\">    print(body)</span><br><span class=\"line\">    headers = &#123;</span><br><span class=\"line\">        <span class=\"string\">'Authorization'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;body[<span class=\"string\">'token'</span>]&#125;</span>\"</span>,</span><br><span class=\"line\">        <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    r = requests.post(<span class=\"string\">'https://notify-api.line.me/api/notify'</span>,</span><br><span class=\"line\">                      headers=headers,</span><br><span class=\"line\">                      data=&#123;<span class=\"string\">'message'</span>: body[<span class=\"string\">'message'</span>]&#125;)</span><br><span class=\"line\">    print(r)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># AWS record sample</span></span><br><span class=\"line\"><span class=\"comment\"># &#123;'Records': [&#123;'messageId': 'fddc42ba-a122-4581-965e-d0144ac8a5ad', 'receiptHandle': 'AQEBjO32gY5pXOfOrmDR0hD4k1av9KyjbHFpc+rIBPV2Brif7Lo+jqnGevSjfFwlICyGf+BhWwKaxFw8XdB3QTzRbw0vnLURjnQeDSBrJHa/S57SRs9TOLRBq38maycAVg69iZbetg9VhLMBCcLtOtPHTzKkmo+/Sosm51WA5CzXK7A0rteikx6nxS1CUIpq6MAujodupP0Hgr5RjK5nH/nmxA4Db0leWEmLokalZbtlx4W14tp7PZxPOrQOLDaGrH//p4h32tY8IN3MkCqi+gyNT7kCU4KwCGOIrybb07ZWyKBTKw+KOMNr/Ykj4z2N1qxIvTM55UY9d8V29YsH32OjrZTei5P7Nke/51E2tWkmkqoFAlqzxDjQPvpP+Pvvr8aazeeZ6opkr59UefAiiyM71Q==', 'body': 'hi', 'attributes': &#123;'ApproximateReceiveCount': '9', 'SentTimestamp': '1566621263072', 'SenderId': '901588721449', 'ApproximateFirstReceiveTimestamp': '1566621263072'&#125;, 'messageAttributes': &#123;&#125;, 'md5OfBody': '49f68a5c8493ec2c0bf489821c21fc3b', 'eventSource': 'aws:sqs', 'eventSourceARN': 'arn:aws:sqs:us-east-1:901588721449:LINE_notify_consumer', 'awsRegion': 'us-east-1'&#125;]&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接著在<code>requirements.txt</code>加入<code>boto3</code>，他是一個使用 python 介接 AWS 的套件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boto3==1.9.189</span><br></pre></td></tr></table></figure>\n\n<p>加入<code>SQS_URL</code>以及<code>SQS_ARN</code>到<code>.env</code>裡面</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SQS_URL=sqs url</span><br><span class=\"line\">SQS_ARN=your sqs arn</span><br></pre></td></tr></table></figure>\n\n<p>add controller/notify_sqs_controller.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_restful <span class=\"keyword\">import</span> Resource, reqparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.db <span class=\"keyword\">import</span> Database</span><br><span class=\"line\"><span class=\"keyword\">import</span> psycopg2.extras</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> boto3</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">send_message</span><span class=\"params\">(url, attr, body, delay=<span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    cli.send_message(</span><br><span class=\"line\">        QueueUrl=url,</span><br><span class=\"line\">        DelaySeconds=<span class=\"number\">0</span>,</span><br><span class=\"line\">        MessageAttributes=attr,</span><br><span class=\"line\">        MessageBody=body,</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SendNotifyBySQSController</span><span class=\"params\">(Resource)</span>:</span></span><br><span class=\"line\">    cli = boto3.client(<span class=\"string\">\"sqs\"</span>, region_name=os.environ(<span class=\"string\">\"region\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        parser = reqparse.RequestParser()</span><br><span class=\"line\">        parser.add_argument(</span><br><span class=\"line\">            <span class=\"string\">'message'</span>, required=<span class=\"literal\">True</span>, help=<span class=\"string\">'message can not be blank!'</span>)</span><br><span class=\"line\">        args = parser.parse_args()</span><br><span class=\"line\">        msg = args[<span class=\"string\">'message'</span>]</span><br><span class=\"line\">        <span class=\"keyword\">with</span> Database() <span class=\"keyword\">as</span> db, db.connect() <span class=\"keyword\">as</span> conn:</span><br><span class=\"line\">            <span class=\"keyword\">with</span> conn.cursor(cursor_factory=psycopg2.extras.RealDictCursor) <span class=\"keyword\">as</span> cur:</span><br><span class=\"line\">                cur.execute(</span><br><span class=\"line\">                    <span class=\"string\">f\"SELECT token FROM notify\"</span>)</span><br><span class=\"line\">                fetch = cur.fetchall()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> fetch:</span><br><span class=\"line\">            body = &#123;</span><br><span class=\"line\">                <span class=\"string\">'token'</span>: <span class=\"string\">f\"Bearer <span class=\"subst\">&#123;f[<span class=\"string\">'token'</span>]&#125;</span>\"</span>,</span><br><span class=\"line\">                <span class=\"string\">'message'</span>: <span class=\"string\">f\"Hello everyone, <span class=\"subst\">&#123;msg&#125;</span>\"</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            cli.send_message(</span><br><span class=\"line\">                QueueUrl=os.environ(<span class=\"string\">\"SQS_URL\"</span>),</span><br><span class=\"line\">                DelaySeconds=<span class=\"number\">0</span>,</span><br><span class=\"line\">                MessageAttributes=&#123;&#125;,</span><br><span class=\"line\">                MessageBody=json.dumps(body),</span><br><span class=\"line\">            )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;<span class=\"string\">'result'</span>: <span class=\"string\">'ok'</span>&#125;, <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>程式寫完了就是要加一條路由<code>/notify/sqs</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from controller.notify_sqs_controller import SendNotifyBySQSController</span><br><span class=\"line\">api.add_resource(SendNotifyBySQSController, &apos;/notify/sqs&apos;)</span><br></pre></td></tr></table></figure>\n\n<p>接著透過<code>wsgi</code>在本地起一個 server</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>再搭配 postman 來做測試，測試內容如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;message&quot;: &quot;test Content&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>接著透過<code>sls deploy</code>部署上會遇到一個問題，會有 Access Denied，所以要在<code>serverless.yml</code>加入 IAM role 的設定</p>\n<p>add iam in provider</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">iamRoleStatements:</span></span><br><span class=\"line\"><span class=\"attr\">  - Effect:</span> <span class=\"string\">Allow</span></span><br><span class=\"line\"><span class=\"attr\">    Action:</span></span><br><span class=\"line\"><span class=\"attr\">      - sqs:</span><span class=\"string\">SendMessage</span></span><br><span class=\"line\"><span class=\"attr\">    Resource:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">$&#123;env:SQS_ARN&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"測試\"><a href=\"#測試\" class=\"headerlink\" title=\"測試\"></a>測試</h2><p><img src=\"https://i.imgur.com/5FViVEk.png\" alt><br><img src=\"https://i.imgur.com/Xg70nDp.png\" alt></p>\n<h2 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h2><p>使用 SQS 這類服務都會需要透過<code>boto3</code>來幫忙串接，最需要注意的就是 IAM role，因為在本地端的 key 通常權限都是最大的，但上到 AWS 上就會有權限的問題，所以要記得加入 IAM 哦！</p>\n<p>Code is <a href=\"https://github.com/louis70109/aws-python-line-api/blob/master/controller/notify_sqs_controller.py\" target=\"_blank\" rel=\"noopener\">here</a></p>\n<p>專案也會持續更新，更多詳情可以 follow 我的專案 <a href=\"https://github.com/louis70109/aws-python-line-api\" target=\"_blank\" rel=\"noopener\">aws-python-line-api</a>。</p>\n"},{"title":"[Docker] Mysql & PHPMyadmin 映射 & 連接方法","abbrlink":268492519,"date":"2019-10-16T14:06:49.000Z","_content":"\n詳細文件[參考](https://hub.docker.com/_/mysql)\n\ndocker 抓 mysql 最新的版本\n\n```sh\ndocker pull mysql:tag\n```\n\n若只是要建立普通容器用以下指令:\n\n```sh\ndocker run -d -p 3306:3306 -e MYSQL_USER=\"myname\" -e MYSQL_PASSWORD=\"mypasswd\" -e MYSQL_ROOT_PASSWORD=\"root_pwd\" --name mysqltest1 mysql:5.7 --character-set-server=utf8 --collation-server=utf8_general_ci\n```\n\n由於會有備份的問題，所以要先建立資料夾們\n\n```sh\nmkdir ~/docker\nmkdir ~/docker/mysql\nmkdir ~/docker/mysql/conf\nmkdir ~/docker/mysql/data\n```\n\n新增 my.cnf 配置文件\n\nvim ~/docker/mysql/conf/my.cnf\n\n`my.cnf` 加入如下内容：\n\n```sh\n[mysqld]\n  user=mysql\n  character-set-server=utf8\n  default_authentication_plugin=mysql_native_password\n[client]\n  default-character-set=utf8\n[mysql]\n  default-character-set=utf8\n```\n\n將 /docker 這個資料夾映射到容器內的 /etcmysql/my.cnf\n\n```sh\ndocker run -d -p 3306:3306 --privileged=true -v ~/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf -v ~/docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqltest2 mysql:5.7\n```\n\n- --privileged=true：容器内的 root 永有真正 root 权限，否則容器内 root 只是外部普通用戶權限\n- -v ~/docker/mysql/conf/my.cnf:/etc/my.cnf：映射 config 資料夾\n- -v ~/docker/mysql/data:/var/lib/mysql：映射 data 資料夾 (table 都在這)\n\n如此一來就可以儲存 /docker 這個資料夾達到備份的功能\n\n## PHPMyadmin\n\n將 myadmin 連接 mysql 的容器指令:\n\n```sh\ndocker run --name myadmin -d --link mysql_db_server:db -p 9100:80 phpmyadmin/phpmyadmin\n```\n\nmysql_db_server = mysql container id\n\n在瀏覽器上輸入 localhost:9100 就可以看到 phpmyadmin 囉！\n\n## Docker 查詢容器 IP\n\n```sh\ndocker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' container_name_or_id\n```\n","source":"_posts/Docker-Mysql-PHPMyadmin-映射-連接方法.md","raw":"---\ntitle: '[Docker] Mysql & PHPMyadmin 映射 & 連接方法'\ntags:\n  - Mysql\n  - Docker\n  - PHPMyadmin\ncategories: Docker\nabbrlink: 268492519\ndate: 2019-10-16 22:06:49\n---\n\n詳細文件[參考](https://hub.docker.com/_/mysql)\n\ndocker 抓 mysql 最新的版本\n\n```sh\ndocker pull mysql:tag\n```\n\n若只是要建立普通容器用以下指令:\n\n```sh\ndocker run -d -p 3306:3306 -e MYSQL_USER=\"myname\" -e MYSQL_PASSWORD=\"mypasswd\" -e MYSQL_ROOT_PASSWORD=\"root_pwd\" --name mysqltest1 mysql:5.7 --character-set-server=utf8 --collation-server=utf8_general_ci\n```\n\n由於會有備份的問題，所以要先建立資料夾們\n\n```sh\nmkdir ~/docker\nmkdir ~/docker/mysql\nmkdir ~/docker/mysql/conf\nmkdir ~/docker/mysql/data\n```\n\n新增 my.cnf 配置文件\n\nvim ~/docker/mysql/conf/my.cnf\n\n`my.cnf` 加入如下内容：\n\n```sh\n[mysqld]\n  user=mysql\n  character-set-server=utf8\n  default_authentication_plugin=mysql_native_password\n[client]\n  default-character-set=utf8\n[mysql]\n  default-character-set=utf8\n```\n\n將 /docker 這個資料夾映射到容器內的 /etcmysql/my.cnf\n\n```sh\ndocker run -d -p 3306:3306 --privileged=true -v ~/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf -v ~/docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqltest2 mysql:5.7\n```\n\n- --privileged=true：容器内的 root 永有真正 root 权限，否則容器内 root 只是外部普通用戶權限\n- -v ~/docker/mysql/conf/my.cnf:/etc/my.cnf：映射 config 資料夾\n- -v ~/docker/mysql/data:/var/lib/mysql：映射 data 資料夾 (table 都在這)\n\n如此一來就可以儲存 /docker 這個資料夾達到備份的功能\n\n## PHPMyadmin\n\n將 myadmin 連接 mysql 的容器指令:\n\n```sh\ndocker run --name myadmin -d --link mysql_db_server:db -p 9100:80 phpmyadmin/phpmyadmin\n```\n\nmysql_db_server = mysql container id\n\n在瀏覽器上輸入 localhost:9100 就可以看到 phpmyadmin 囉！\n\n## Docker 查詢容器 IP\n\n```sh\ndocker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' container_name_or_id\n```\n","slug":"Docker-Mysql-PHPMyadmin-映射-連接方法","published":1,"updated":"2020-06-19T14:03:58.854Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kd00387crivmf3f2k3","content":"<p>詳細文件<a href=\"https://hub.docker.com/_/mysql\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n<p>docker 抓 mysql 最新的版本</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:tag</span><br></pre></td></tr></table></figure>\n\n<p>若只是要建立普通容器用以下指令:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 -e MYSQL_USER=<span class=\"string\">\"myname\"</span> -e MYSQL_PASSWORD=<span class=\"string\">\"mypasswd\"</span> -e MYSQL_ROOT_PASSWORD=<span class=\"string\">\"root_pwd\"</span> --name mysqltest1 mysql:5.7 --character-set-server=utf8 --collation-server=utf8_general_ci</span><br></pre></td></tr></table></figure>\n\n<p>由於會有備份的問題，所以要先建立資料夾們</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/docker</span><br><span class=\"line\">mkdir ~/docker/mysql</span><br><span class=\"line\">mkdir ~/docker/mysql/conf</span><br><span class=\"line\">mkdir ~/docker/mysql/data</span><br></pre></td></tr></table></figure>\n\n<p>新增 my.cnf 配置文件</p>\n<p>vim ~/docker/mysql/conf/my.cnf</p>\n<p><code>my.cnf</code> 加入如下内容：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">  user=mysql</span><br><span class=\"line\">  character-set-server=utf8</span><br><span class=\"line\">  default_authentication_plugin=mysql_native_password</span><br><span class=\"line\">[client]</span><br><span class=\"line\">  default-character-set=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\">  default-character-set=utf8</span><br></pre></td></tr></table></figure>\n\n<p>將 /docker 這個資料夾映射到容器內的 /etcmysql/my.cnf</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 --privileged=<span class=\"literal\">true</span> -v ~/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf -v ~/docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqltest2 mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>–privileged=true：容器内的 root 永有真正 root 权限，否則容器内 root 只是外部普通用戶權限</li>\n<li>-v ~/docker/mysql/conf/my.cnf:/etc/my.cnf：映射 config 資料夾</li>\n<li>-v ~/docker/mysql/data:/var/lib/mysql：映射 data 資料夾 (table 都在這)</li>\n</ul>\n<p>如此一來就可以儲存 /docker 這個資料夾達到備份的功能</p>\n<h2 id=\"PHPMyadmin\"><a href=\"#PHPMyadmin\" class=\"headerlink\" title=\"PHPMyadmin\"></a>PHPMyadmin</h2><p>將 myadmin 連接 mysql 的容器指令:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name myadmin -d --link mysql_db_server:db -p 9100:80 phpmyadmin/phpmyadmin</span><br></pre></td></tr></table></figure>\n\n<p>mysql_db_server = mysql container id</p>\n<p>在瀏覽器上輸入 localhost:9100 就可以看到 phpmyadmin 囉！</p>\n<h2 id=\"Docker-查詢容器-IP\"><a href=\"#Docker-查詢容器-IP\" class=\"headerlink\" title=\"Docker 查詢容器 IP\"></a>Docker 查詢容器 IP</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect -f <span class=\"string\">'&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;'</span> container_name_or_id</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>詳細文件<a href=\"https://hub.docker.com/_/mysql\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n<p>docker 抓 mysql 最新的版本</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:tag</span><br></pre></td></tr></table></figure>\n\n<p>若只是要建立普通容器用以下指令:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 -e MYSQL_USER=<span class=\"string\">\"myname\"</span> -e MYSQL_PASSWORD=<span class=\"string\">\"mypasswd\"</span> -e MYSQL_ROOT_PASSWORD=<span class=\"string\">\"root_pwd\"</span> --name mysqltest1 mysql:5.7 --character-set-server=utf8 --collation-server=utf8_general_ci</span><br></pre></td></tr></table></figure>\n\n<p>由於會有備份的問題，所以要先建立資料夾們</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/docker</span><br><span class=\"line\">mkdir ~/docker/mysql</span><br><span class=\"line\">mkdir ~/docker/mysql/conf</span><br><span class=\"line\">mkdir ~/docker/mysql/data</span><br></pre></td></tr></table></figure>\n\n<p>新增 my.cnf 配置文件</p>\n<p>vim ~/docker/mysql/conf/my.cnf</p>\n<p><code>my.cnf</code> 加入如下内容：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">  user=mysql</span><br><span class=\"line\">  character-set-server=utf8</span><br><span class=\"line\">  default_authentication_plugin=mysql_native_password</span><br><span class=\"line\">[client]</span><br><span class=\"line\">  default-character-set=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\">  default-character-set=utf8</span><br></pre></td></tr></table></figure>\n\n<p>將 /docker 這個資料夾映射到容器內的 /etcmysql/my.cnf</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 --privileged=<span class=\"literal\">true</span> -v ~/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf -v ~/docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqltest2 mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>–privileged=true：容器内的 root 永有真正 root 权限，否則容器内 root 只是外部普通用戶權限</li>\n<li>-v ~/docker/mysql/conf/my.cnf:/etc/my.cnf：映射 config 資料夾</li>\n<li>-v ~/docker/mysql/data:/var/lib/mysql：映射 data 資料夾 (table 都在這)</li>\n</ul>\n<p>如此一來就可以儲存 /docker 這個資料夾達到備份的功能</p>\n<h2 id=\"PHPMyadmin\"><a href=\"#PHPMyadmin\" class=\"headerlink\" title=\"PHPMyadmin\"></a>PHPMyadmin</h2><p>將 myadmin 連接 mysql 的容器指令:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name myadmin -d --link mysql_db_server:db -p 9100:80 phpmyadmin/phpmyadmin</span><br></pre></td></tr></table></figure>\n\n<p>mysql_db_server = mysql container id</p>\n<p>在瀏覽器上輸入 localhost:9100 就可以看到 phpmyadmin 囉！</p>\n<h2 id=\"Docker-查詢容器-IP\"><a href=\"#Docker-查詢容器-IP\" class=\"headerlink\" title=\"Docker 查詢容器 IP\"></a>Docker 查詢容器 IP</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect -f <span class=\"string\">'&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;'</span> container_name_or_id</span><br></pre></td></tr></table></figure>\n\n"},{"title":"2019 LINE Dev Day - 議程心得(2) - How we continuously delivery LINE TODAY App with high agility and high quality","abbrlink":2683526012,"date":"2019-11-21T16:55:53.000Z","_content":"\n# How we continuously delivery LINE TODAY App with high agility and high quality\n![](https://i.imgur.com/ZGXdq4F.png)\n\n簡報連結: [URL](https://speakerdeck.com/line_devday2019/how-we-continuously-delivery-line-today-app-with-high-agility-and-high-quality)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。\n\n這個議程是難得出現的台灣人，一開始只是想說聽看看 LINE TODAY 是如何透過維持高度敏捷以及保持高品質，其實也就是瞎子摸象，結果聽到自我介紹後發現是台灣人來講，感覺就是在異地聽到一個台灣味的口音覺得很親切🤣\n\n接下來就看一下我聽完這場的心得吧!\n\n# 負責專案\n\n- LINE\n- LINE TODAY\n- LINE SDK\n- LINE MUSIC(Taiwan)\n![](https://i.imgur.com/nVgupO1m.jpg)\n最近常常出現在左上角的那個 LINE MUSIC\n\n## 流程\n![](https://i.imgur.com/WTUuqWX.png)\n\n從 Pull Request - Code review - Build pipeline - unit test - UI test - deploy\n\n當中提到兩個主要部分：\n- Unit test: 覆蓋率最好要多少？\n- UI test: 自動化測試的可信度？\n\n![](https://i.imgur.com/kNu9cv9.jpg)\n且在測試當中會有一種測試叫做 flaky test，有時候測試有過、有時候有沒過，完全讓人摸不著頭緒的測試，這會傷害到軟體品質以及覆蓋率，因此若這種狀況出現時趕快號招團隊的人來討論這個狀態是否處理。\n\n> [flaky test](http://blog.castman.net/%E7%A0%94%E7%A9%B6/2016/06/06/flaky-tests.html)\n\n## UI 自動化測試\n在這部分提到說 UI test code 好寫但是難去維護，主要在於 UI 的東西可能會因為裝置、作業系統...等等的問題去影響到，且會很容易出現 flaky test，這邊我詢問講者得到的答案是測試只要確認在當前 UI 上最重要的元件若有出來的話這部分的測試就給過，若太精細的測試時常會影響到整體的開發敏捷度與流暢度。\n\n> 想想也是有道理，平常聽到人家說測試測試的，只是當今天測試時的究竟是要到多詳細還是要取決於團隊的決定。\n\n這段講者有提到要注意 UI Automation test 是 [Smoke test](https://en.wikipedia.org/wiki/Smoke_testing_(software))，因此要注意**維護成本**以及**flaky test**的問題！\n\n## 驗收標準 - [Acceptance Criteria](https://www.altexsoft.com/blog/business/acceptance-criteria-purposes-formats-and-best-practices/)\n![](https://i.imgur.com/N5ovDf7.jpg)\n\n接著就提到團隊需要準備各種情境所需要的東西：\n- 不一樣的測試資料來讓產品有**彈性**且是**可信賴**\n- 若有針對類似 Database 這類的測試團隊則更需要去注意測試細節避免導致特異情況\n總之就是 Product Owner(PO) 是需要訂定團隊規則並讓大家去遵守，確保品質！\n\n![](https://i.imgur.com/Vq13ngl.png)\n這裡有提到他們經由上述制定好的驗收標準之後，隨著 Release 版本之後的手動測試比率逐漸減少，到後來都是偏向自動化測試去處理，且是有團隊可信度。\n\n## Code Coverage\n這邊以 iOS 開發為例，首先就是 MVC 框架上所遇到的問題，官網都是以 MVC 下去做範例，但實際上開發起來則是還得以 MVVM 的框架去執行在測試的部分才不會採太多不必要的坑。\n![](https://i.imgur.com/WOIgOQe.png)\n接下來提到的部分我覺得是這個議程最重要的一部分，就是如何去取捨覆蓋範圍，像是上圖顯示，可能會有一些 Callback 或是其他的是不可預期的範圍，團隊需要將這些問題一一列出來討論，並且去制定一個最低標準以及 Must have 的標準，促使團隊可以更有規則的去進行開發，如下圖所示。\n![](https://i.imgur.com/jidpVl3.png)\n\n# 結論\n其實一家公司很願意花成本去讓開發者可以去寫各種測試確認服務品質，若是以普遍環境來說這真的是很難人可貴的地方，此外從中也了解到一個好的流程應該是如何，從談需求到開發中間所要經歷過多少事才能讓一個服務起來，測試這部分真的是很大的一門學問，千萬別寫一堆測試但這個測試只是自己測開心的，而是要讓測試的內容可以讓團隊很放心的將 code 交給測試去驗證，達到這樣子目的的程式我相信在市場上一定是很能接受考驗的！\n![](https://i.imgur.com/HnFB307.png)\n","source":"_posts/How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality.md","raw":"---\ntitle: >-\n  2019 LINE Dev Day - 議程心得(2) - How we continuously delivery LINE TODAY App with\n  high agility and high quality\ntags:\n  - LINE\n  - Dev Day 2019\ncategories: 研討會\nabbrlink: 2683526012\ndate: 2019-11-22 00:55:53\n---\n\n# How we continuously delivery LINE TODAY App with high agility and high quality\n![](https://i.imgur.com/ZGXdq4F.png)\n\n簡報連結: [URL](https://speakerdeck.com/line_devday2019/how-we-continuously-delivery-line-today-app-with-high-agility-and-high-quality)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。\n\n這個議程是難得出現的台灣人，一開始只是想說聽看看 LINE TODAY 是如何透過維持高度敏捷以及保持高品質，其實也就是瞎子摸象，結果聽到自我介紹後發現是台灣人來講，感覺就是在異地聽到一個台灣味的口音覺得很親切🤣\n\n接下來就看一下我聽完這場的心得吧!\n\n# 負責專案\n\n- LINE\n- LINE TODAY\n- LINE SDK\n- LINE MUSIC(Taiwan)\n![](https://i.imgur.com/nVgupO1m.jpg)\n最近常常出現在左上角的那個 LINE MUSIC\n\n## 流程\n![](https://i.imgur.com/WTUuqWX.png)\n\n從 Pull Request - Code review - Build pipeline - unit test - UI test - deploy\n\n當中提到兩個主要部分：\n- Unit test: 覆蓋率最好要多少？\n- UI test: 自動化測試的可信度？\n\n![](https://i.imgur.com/kNu9cv9.jpg)\n且在測試當中會有一種測試叫做 flaky test，有時候測試有過、有時候有沒過，完全讓人摸不著頭緒的測試，這會傷害到軟體品質以及覆蓋率，因此若這種狀況出現時趕快號招團隊的人來討論這個狀態是否處理。\n\n> [flaky test](http://blog.castman.net/%E7%A0%94%E7%A9%B6/2016/06/06/flaky-tests.html)\n\n## UI 自動化測試\n在這部分提到說 UI test code 好寫但是難去維護，主要在於 UI 的東西可能會因為裝置、作業系統...等等的問題去影響到，且會很容易出現 flaky test，這邊我詢問講者得到的答案是測試只要確認在當前 UI 上最重要的元件若有出來的話這部分的測試就給過，若太精細的測試時常會影響到整體的開發敏捷度與流暢度。\n\n> 想想也是有道理，平常聽到人家說測試測試的，只是當今天測試時的究竟是要到多詳細還是要取決於團隊的決定。\n\n這段講者有提到要注意 UI Automation test 是 [Smoke test](https://en.wikipedia.org/wiki/Smoke_testing_(software))，因此要注意**維護成本**以及**flaky test**的問題！\n\n## 驗收標準 - [Acceptance Criteria](https://www.altexsoft.com/blog/business/acceptance-criteria-purposes-formats-and-best-practices/)\n![](https://i.imgur.com/N5ovDf7.jpg)\n\n接著就提到團隊需要準備各種情境所需要的東西：\n- 不一樣的測試資料來讓產品有**彈性**且是**可信賴**\n- 若有針對類似 Database 這類的測試團隊則更需要去注意測試細節避免導致特異情況\n總之就是 Product Owner(PO) 是需要訂定團隊規則並讓大家去遵守，確保品質！\n\n![](https://i.imgur.com/Vq13ngl.png)\n這裡有提到他們經由上述制定好的驗收標準之後，隨著 Release 版本之後的手動測試比率逐漸減少，到後來都是偏向自動化測試去處理，且是有團隊可信度。\n\n## Code Coverage\n這邊以 iOS 開發為例，首先就是 MVC 框架上所遇到的問題，官網都是以 MVC 下去做範例，但實際上開發起來則是還得以 MVVM 的框架去執行在測試的部分才不會採太多不必要的坑。\n![](https://i.imgur.com/WOIgOQe.png)\n接下來提到的部分我覺得是這個議程最重要的一部分，就是如何去取捨覆蓋範圍，像是上圖顯示，可能會有一些 Callback 或是其他的是不可預期的範圍，團隊需要將這些問題一一列出來討論，並且去制定一個最低標準以及 Must have 的標準，促使團隊可以更有規則的去進行開發，如下圖所示。\n![](https://i.imgur.com/jidpVl3.png)\n\n# 結論\n其實一家公司很願意花成本去讓開發者可以去寫各種測試確認服務品質，若是以普遍環境來說這真的是很難人可貴的地方，此外從中也了解到一個好的流程應該是如何，從談需求到開發中間所要經歷過多少事才能讓一個服務起來，測試這部分真的是很大的一門學問，千萬別寫一堆測試但這個測試只是自己測開心的，而是要讓測試的內容可以讓團隊很放心的將 code 交給測試去驗證，達到這樣子目的的程式我相信在市場上一定是很能接受考驗的！\n![](https://i.imgur.com/HnFB307.png)\n","slug":"How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality","published":1,"updated":"2020-06-19T14:03:58.856Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kf003a7criu357fb1d","content":"<h1 id=\"How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality\"><a href=\"#How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality\" class=\"headerlink\" title=\"How we continuously delivery LINE TODAY App with high agility and high quality\"></a>How we continuously delivery LINE TODAY App with high agility and high quality</h1><p><img src=\"https://i.imgur.com/ZGXdq4F.png\" alt></p>\n<p>簡報連結: <a href=\"https://speakerdeck.com/line_devday2019/how-we-continuously-delivery-line-today-app-with-high-agility-and-high-quality\" target=\"_blank\" rel=\"noopener\">URL</a></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。</p>\n<p>這個議程是難得出現的台灣人，一開始只是想說聽看看 LINE TODAY 是如何透過維持高度敏捷以及保持高品質，其實也就是瞎子摸象，結果聽到自我介紹後發現是台灣人來講，感覺就是在異地聽到一個台灣味的口音覺得很親切🤣</p>\n<p>接下來就看一下我聽完這場的心得吧!</p>\n<h1 id=\"負責專案\"><a href=\"#負責專案\" class=\"headerlink\" title=\"負責專案\"></a>負責專案</h1><ul>\n<li>LINE</li>\n<li>LINE TODAY</li>\n<li>LINE SDK</li>\n<li>LINE MUSIC(Taiwan)<br><img src=\"https://i.imgur.com/nVgupO1m.jpg\" alt><br>最近常常出現在左上角的那個 LINE MUSIC</li>\n</ul>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p><img src=\"https://i.imgur.com/WTUuqWX.png\" alt></p>\n<p>從 Pull Request - Code review - Build pipeline - unit test - UI test - deploy</p>\n<p>當中提到兩個主要部分：</p>\n<ul>\n<li>Unit test: 覆蓋率最好要多少？</li>\n<li>UI test: 自動化測試的可信度？</li>\n</ul>\n<p><img src=\"https://i.imgur.com/kNu9cv9.jpg\" alt><br>且在測試當中會有一種測試叫做 flaky test，有時候測試有過、有時候有沒過，完全讓人摸不著頭緒的測試，這會傷害到軟體品質以及覆蓋率，因此若這種狀況出現時趕快號招團隊的人來討論這個狀態是否處理。</p>\n<blockquote>\n<p><a href=\"http://blog.castman.net/%E7%A0%94%E7%A9%B6/2016/06/06/flaky-tests.html\" target=\"_blank\" rel=\"noopener\">flaky test</a></p>\n</blockquote>\n<h2 id=\"UI-自動化測試\"><a href=\"#UI-自動化測試\" class=\"headerlink\" title=\"UI 自動化測試\"></a>UI 自動化測試</h2><p>在這部分提到說 UI test code 好寫但是難去維護，主要在於 UI 的東西可能會因為裝置、作業系統…等等的問題去影響到，且會很容易出現 flaky test，這邊我詢問講者得到的答案是測試只要確認在當前 UI 上最重要的元件若有出來的話這部分的測試就給過，若太精細的測試時常會影響到整體的開發敏捷度與流暢度。</p>\n<blockquote>\n<p>想想也是有道理，平常聽到人家說測試測試的，只是當今天測試時的究竟是要到多詳細還是要取決於團隊的決定。</p>\n</blockquote>\n<p>這段講者有提到要注意 UI Automation test 是 <a href=\"https://en.wikipedia.org/wiki/Smoke_testing_(software)\" target=\"_blank\" rel=\"noopener\">Smoke test</a>，因此要注意<strong>維護成本</strong>以及<strong>flaky test</strong>的問題！</p>\n<h2 id=\"驗收標準-Acceptance-Criteria\"><a href=\"#驗收標準-Acceptance-Criteria\" class=\"headerlink\" title=\"驗收標準 - Acceptance Criteria\"></a>驗收標準 - <a href=\"https://www.altexsoft.com/blog/business/acceptance-criteria-purposes-formats-and-best-practices/\" target=\"_blank\" rel=\"noopener\">Acceptance Criteria</a></h2><p><img src=\"https://i.imgur.com/N5ovDf7.jpg\" alt></p>\n<p>接著就提到團隊需要準備各種情境所需要的東西：</p>\n<ul>\n<li>不一樣的測試資料來讓產品有<strong>彈性</strong>且是<strong>可信賴</strong></li>\n<li>若有針對類似 Database 這類的測試團隊則更需要去注意測試細節避免導致特異情況<br>總之就是 Product Owner(PO) 是需要訂定團隊規則並讓大家去遵守，確保品質！</li>\n</ul>\n<p><img src=\"https://i.imgur.com/Vq13ngl.png\" alt><br>這裡有提到他們經由上述制定好的驗收標準之後，隨著 Release 版本之後的手動測試比率逐漸減少，到後來都是偏向自動化測試去處理，且是有團隊可信度。</p>\n<h2 id=\"Code-Coverage\"><a href=\"#Code-Coverage\" class=\"headerlink\" title=\"Code Coverage\"></a>Code Coverage</h2><p>這邊以 iOS 開發為例，首先就是 MVC 框架上所遇到的問題，官網都是以 MVC 下去做範例，但實際上開發起來則是還得以 MVVM 的框架去執行在測試的部分才不會採太多不必要的坑。<br><img src=\"https://i.imgur.com/WOIgOQe.png\" alt><br>接下來提到的部分我覺得是這個議程最重要的一部分，就是如何去取捨覆蓋範圍，像是上圖顯示，可能會有一些 Callback 或是其他的是不可預期的範圍，團隊需要將這些問題一一列出來討論，並且去制定一個最低標準以及 Must have 的標準，促使團隊可以更有規則的去進行開發，如下圖所示。<br><img src=\"https://i.imgur.com/jidpVl3.png\" alt></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>其實一家公司很願意花成本去讓開發者可以去寫各種測試確認服務品質，若是以普遍環境來說這真的是很難人可貴的地方，此外從中也了解到一個好的流程應該是如何，從談需求到開發中間所要經歷過多少事才能讓一個服務起來，測試這部分真的是很大的一門學問，千萬別寫一堆測試但這個測試只是自己測開心的，而是要讓測試的內容可以讓團隊很放心的將 code 交給測試去驗證，達到這樣子目的的程式我相信在市場上一定是很能接受考驗的！<br><img src=\"https://i.imgur.com/HnFB307.png\" alt></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality\"><a href=\"#How-we-continuously-delivery-LINE-TODAY-App-with-high-agility-and-high-quality\" class=\"headerlink\" title=\"How we continuously delivery LINE TODAY App with high agility and high quality\"></a>How we continuously delivery LINE TODAY App with high agility and high quality</h1><p><img src=\"https://i.imgur.com/ZGXdq4F.png\" alt></p>\n<p>簡報連結: <a href=\"https://speakerdeck.com/line_devday2019/how-we-continuously-delivery-line-today-app-with-high-agility-and-high-quality\" target=\"_blank\" rel=\"noopener\">URL</a></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，很開心這次能夠以 LINE API Expert 的身份被邀請來參加 LINE Developer Day 2019。</p>\n<p>這個議程是難得出現的台灣人，一開始只是想說聽看看 LINE TODAY 是如何透過維持高度敏捷以及保持高品質，其實也就是瞎子摸象，結果聽到自我介紹後發現是台灣人來講，感覺就是在異地聽到一個台灣味的口音覺得很親切🤣</p>\n<p>接下來就看一下我聽完這場的心得吧!</p>\n<h1 id=\"負責專案\"><a href=\"#負責專案\" class=\"headerlink\" title=\"負責專案\"></a>負責專案</h1><ul>\n<li>LINE</li>\n<li>LINE TODAY</li>\n<li>LINE SDK</li>\n<li>LINE MUSIC(Taiwan)<br><img src=\"https://i.imgur.com/nVgupO1m.jpg\" alt><br>最近常常出現在左上角的那個 LINE MUSIC</li>\n</ul>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p><img src=\"https://i.imgur.com/WTUuqWX.png\" alt></p>\n<p>從 Pull Request - Code review - Build pipeline - unit test - UI test - deploy</p>\n<p>當中提到兩個主要部分：</p>\n<ul>\n<li>Unit test: 覆蓋率最好要多少？</li>\n<li>UI test: 自動化測試的可信度？</li>\n</ul>\n<p><img src=\"https://i.imgur.com/kNu9cv9.jpg\" alt><br>且在測試當中會有一種測試叫做 flaky test，有時候測試有過、有時候有沒過，完全讓人摸不著頭緒的測試，這會傷害到軟體品質以及覆蓋率，因此若這種狀況出現時趕快號招團隊的人來討論這個狀態是否處理。</p>\n<blockquote>\n<p><a href=\"http://blog.castman.net/%E7%A0%94%E7%A9%B6/2016/06/06/flaky-tests.html\" target=\"_blank\" rel=\"noopener\">flaky test</a></p>\n</blockquote>\n<h2 id=\"UI-自動化測試\"><a href=\"#UI-自動化測試\" class=\"headerlink\" title=\"UI 自動化測試\"></a>UI 自動化測試</h2><p>在這部分提到說 UI test code 好寫但是難去維護，主要在於 UI 的東西可能會因為裝置、作業系統…等等的問題去影響到，且會很容易出現 flaky test，這邊我詢問講者得到的答案是測試只要確認在當前 UI 上最重要的元件若有出來的話這部分的測試就給過，若太精細的測試時常會影響到整體的開發敏捷度與流暢度。</p>\n<blockquote>\n<p>想想也是有道理，平常聽到人家說測試測試的，只是當今天測試時的究竟是要到多詳細還是要取決於團隊的決定。</p>\n</blockquote>\n<p>這段講者有提到要注意 UI Automation test 是 <a href=\"https://en.wikipedia.org/wiki/Smoke_testing_(software)\" target=\"_blank\" rel=\"noopener\">Smoke test</a>，因此要注意<strong>維護成本</strong>以及<strong>flaky test</strong>的問題！</p>\n<h2 id=\"驗收標準-Acceptance-Criteria\"><a href=\"#驗收標準-Acceptance-Criteria\" class=\"headerlink\" title=\"驗收標準 - Acceptance Criteria\"></a>驗收標準 - <a href=\"https://www.altexsoft.com/blog/business/acceptance-criteria-purposes-formats-and-best-practices/\" target=\"_blank\" rel=\"noopener\">Acceptance Criteria</a></h2><p><img src=\"https://i.imgur.com/N5ovDf7.jpg\" alt></p>\n<p>接著就提到團隊需要準備各種情境所需要的東西：</p>\n<ul>\n<li>不一樣的測試資料來讓產品有<strong>彈性</strong>且是<strong>可信賴</strong></li>\n<li>若有針對類似 Database 這類的測試團隊則更需要去注意測試細節避免導致特異情況<br>總之就是 Product Owner(PO) 是需要訂定團隊規則並讓大家去遵守，確保品質！</li>\n</ul>\n<p><img src=\"https://i.imgur.com/Vq13ngl.png\" alt><br>這裡有提到他們經由上述制定好的驗收標準之後，隨著 Release 版本之後的手動測試比率逐漸減少，到後來都是偏向自動化測試去處理，且是有團隊可信度。</p>\n<h2 id=\"Code-Coverage\"><a href=\"#Code-Coverage\" class=\"headerlink\" title=\"Code Coverage\"></a>Code Coverage</h2><p>這邊以 iOS 開發為例，首先就是 MVC 框架上所遇到的問題，官網都是以 MVC 下去做範例，但實際上開發起來則是還得以 MVVM 的框架去執行在測試的部分才不會採太多不必要的坑。<br><img src=\"https://i.imgur.com/WOIgOQe.png\" alt><br>接下來提到的部分我覺得是這個議程最重要的一部分，就是如何去取捨覆蓋範圍，像是上圖顯示，可能會有一些 Callback 或是其他的是不可預期的範圍，團隊需要將這些問題一一列出來討論，並且去制定一個最低標準以及 Must have 的標準，促使團隊可以更有規則的去進行開發，如下圖所示。<br><img src=\"https://i.imgur.com/jidpVl3.png\" alt></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>其實一家公司很願意花成本去讓開發者可以去寫各種測試確認服務品質，若是以普遍環境來說這真的是很難人可貴的地方，此外從中也了解到一個好的流程應該是如何，從談需求到開發中間所要經歷過多少事才能讓一個服務起來，測試這部分真的是很大的一門學問，千萬別寫一堆測試但這個測試只是自己測開心的，而是要讓測試的內容可以讓團隊很放心的將 code 交給測試去驗證，達到這樣子目的的程式我相信在市場上一定是很能接受考驗的！<br><img src=\"https://i.imgur.com/HnFB307.png\" alt></p>\n"},{"title":"【LINE API 的小眉角】feat. Flex message, LIFF, Richmenu, Provider","abbrlink":3574514001,"date":"2020-04-11T13:10:23.000Z","_content":"\n![birds](https://i.imgur.com/HHj7c5Kl.jpg)\n\n# 前言\n\n因為遇到了很多不算坑的坑(~~說啥呢？~~)，有些是文件沒有寫而有些可能是我沒有注意到的，但既然都知道了就乾脆記下來吧！\n\n# LIFF reply 到底算不算收費？\n\n> [LIFF SendMessage api](https://developers.line.biz/en/docs/liff/developing-liff-apps/#developing-a-liff-app)\n\n字面上看起來很像 `Push Message` 的事件，但實際上是走 Flex Message，使用 Message api 的 Reply 功能來幫忙使用者發送條件引發 Bot 行為，並非是透過 Push api 發送讓 Bot 反應，這邊需要多注意喔！\n\n```javascript\nliff.sendMessages([\n  {\n    type: \"text\",\n    text: \"You've successfully sent a message! Hooray!\",\n  },\n]);\n```\n\n<!-- more -->\n\n> 但是現在 LIFF 還沒有 `postback` 的功能喔！😭\n\n# Flex button 文字(text)欄位空值問題\n\nflex 的 button text 的文字不能用 0 長度的字串，但可以用 `' '` 中間為空白鍵的字串去解決長度 0 的問題，否則會出現以上的錯誤:\n\n```bash\nResponse Data -\n  {\n    \"message\": \"A message (messages[0]) in the request body is invalid\",\n    \"details\": [\n      {\n        \"message\": \"must be non-empty text\",\n        \"property\": \"/contents/0/footer/contents/1/action/text\"\n      },\n      ...\n    ]\n  }\n```\n\n# User id 的問題 - Provider\n\n如下圖所示，左邊為我擁有的 provider，而右邊框框則為兩個不同 provider 下屬於我的 user id，只要在同一個 provider 下 user id 都會是固定的，無論用 Login 或 Message API。\n![](https://i.imgur.com/gqRltSU.png)\n\n---\n\n![](https://i.imgur.com/8rXmRy7.png)\n\n# Richmenu\n\n## 座標計算\n\nrichmenu 的 x,y 是從左上(0, 0)算到右下(n, n)\n限制:\n\n- Image format: JPEG or PNG\n- Image size (pixels): 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270\n- Max file size: 1 MB\n\n> [參考](https://developers.line.biz/en/docs/messaging-api/using-rich-menus/#creating-a-rich-menu-using-the-messaging-api)\n\n## 使用 link 的方式指定給特定使用者\n\n➡️ python API - [連結特定使用者](https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L640)\n\n若只需要連結特定使用者的話使用這個 api，我目前使用情境有兩個\n\n- Bot 裡有多重身份需要依照角色不同而給不同的 richmenu\n- 實作上下頁的功能，透過讓使用者按下特定位置時觸發更新成另一張圖片\n\n```python\ndef link_rich_menu_to_user(self, user_id, rich_menu_id, timeout=None):\n```\n\n➡️ python API - [一次連結多個使用者](https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L661)\n\n```python\ndef link_rich_menu_to_users(self, user_ids, rich_menu_id, timeout=None):\n```\n\n### 範例影片\n\n![](https://i.imgur.com/nFA7A7p.gif)\n\n## 設定 richmenu 為預設\n\n若是使用 setDefault 的話需要上一頁再回來才會更動，因為 setDefault 的行為則是對當前 Bot 的所有使用者設定，如果想要馬上變化的話則是使用上述 link 的方式哦！\n\n# [模擬 postback 在 LIFF 傳送隱藏資料給機器人](https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html)\n\n> 感謝`均民`提供與授權給我記錄在我部落格上 😀\n\n為什麼要模擬呢？因為如同我一開始 `LIFF reply 到底算不算收費？`，LIFF 現在還沒有 `postback` 的 reply 功能，但有些事件我們不希望幫使用者打字去觸發 reply，但現在根本沒這功能那到底要怎辦呢？\n\n這篇作者想到了一個`奇技淫巧`的方法，就是使用最小 size 的透明圖片(`png`)並藉由 liff.sendMessage 來發送圖片事件達到模擬 postback 狀態。\n\n- [透明圖片](https://i.imgur.com/WN88L3I.png)\n\n> 詳細內容參閱 [部落格](https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html#yun-zuo-yuan-li)\n\n# [輔助開發 LINE Flex 訊息的工具](https://taichunmin.idv.tw/blog/2020-04-06-line-devbot.html)\n\n> 這部分一樣感謝`均民`提供\n\n通常我們在開發 LINE bot 時如果需要一些比較華麗的顯示方式時，所用的設計工具不外乎是官方出的 [ Flex Message Simulator](https://developers.line.biz/flex-simulator/) 以及 [LINE Bot Designer](https://developers.line.biz/en/services/bot-designer/)，前者是在網頁上直接編輯使用，後者則是可以安裝桌面版編輯測試，相較於網頁版本後者使用上比較完整，而通常設計完之後就直接塞進去 code 來做測試。\n\n但總要在測試時才知道 iOS 跟 Android 的樣子有差，這篇作者幫忙做了一隻機器人可以幫忙處理這件事，當開發完一部份之後，在電腦版的 LINE 貼上 json 後，才看兩種手機所呈現的樣子是什麼，而不用做完一個功能而各別打字或是按 richmenu，但這樣實在太不符合開發流程啦，當然是在電腦版貼上去直接看手機最快啦！\n\n# 結論\n\n開發那麼多的 LINE API 難免會遇到 spec 沒寫或是沒注意到的地方，趁最近有空把它記錄下來分享給大家知道，或許我現在遇到的問題也會是各位遇到的問題 😆\n\n如果有任何遇到的一些小眉角也歡迎到[我的粉絲團](https://www.facebook.com/nijiatw)分享給我知道喔！\n","source":"_posts/LINE-Flex-message-LIFF-Richmenu-Provider.md","raw":"---\ntitle: '【LINE API 的小眉角】feat. Flex message, LIFF, Richmenu, Provider'\ntags:\n  - LINE\n  - LIFF\n  - Flex message\n  - Richmenu\n  - Provider\ncategories: Chatbot\nabbrlink: 3574514001\ndate: 2020-04-11 21:10:23\n---\n\n![birds](https://i.imgur.com/HHj7c5Kl.jpg)\n\n# 前言\n\n因為遇到了很多不算坑的坑(~~說啥呢？~~)，有些是文件沒有寫而有些可能是我沒有注意到的，但既然都知道了就乾脆記下來吧！\n\n# LIFF reply 到底算不算收費？\n\n> [LIFF SendMessage api](https://developers.line.biz/en/docs/liff/developing-liff-apps/#developing-a-liff-app)\n\n字面上看起來很像 `Push Message` 的事件，但實際上是走 Flex Message，使用 Message api 的 Reply 功能來幫忙使用者發送條件引發 Bot 行為，並非是透過 Push api 發送讓 Bot 反應，這邊需要多注意喔！\n\n```javascript\nliff.sendMessages([\n  {\n    type: \"text\",\n    text: \"You've successfully sent a message! Hooray!\",\n  },\n]);\n```\n\n<!-- more -->\n\n> 但是現在 LIFF 還沒有 `postback` 的功能喔！😭\n\n# Flex button 文字(text)欄位空值問題\n\nflex 的 button text 的文字不能用 0 長度的字串，但可以用 `' '` 中間為空白鍵的字串去解決長度 0 的問題，否則會出現以上的錯誤:\n\n```bash\nResponse Data -\n  {\n    \"message\": \"A message (messages[0]) in the request body is invalid\",\n    \"details\": [\n      {\n        \"message\": \"must be non-empty text\",\n        \"property\": \"/contents/0/footer/contents/1/action/text\"\n      },\n      ...\n    ]\n  }\n```\n\n# User id 的問題 - Provider\n\n如下圖所示，左邊為我擁有的 provider，而右邊框框則為兩個不同 provider 下屬於我的 user id，只要在同一個 provider 下 user id 都會是固定的，無論用 Login 或 Message API。\n![](https://i.imgur.com/gqRltSU.png)\n\n---\n\n![](https://i.imgur.com/8rXmRy7.png)\n\n# Richmenu\n\n## 座標計算\n\nrichmenu 的 x,y 是從左上(0, 0)算到右下(n, n)\n限制:\n\n- Image format: JPEG or PNG\n- Image size (pixels): 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270\n- Max file size: 1 MB\n\n> [參考](https://developers.line.biz/en/docs/messaging-api/using-rich-menus/#creating-a-rich-menu-using-the-messaging-api)\n\n## 使用 link 的方式指定給特定使用者\n\n➡️ python API - [連結特定使用者](https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L640)\n\n若只需要連結特定使用者的話使用這個 api，我目前使用情境有兩個\n\n- Bot 裡有多重身份需要依照角色不同而給不同的 richmenu\n- 實作上下頁的功能，透過讓使用者按下特定位置時觸發更新成另一張圖片\n\n```python\ndef link_rich_menu_to_user(self, user_id, rich_menu_id, timeout=None):\n```\n\n➡️ python API - [一次連結多個使用者](https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L661)\n\n```python\ndef link_rich_menu_to_users(self, user_ids, rich_menu_id, timeout=None):\n```\n\n### 範例影片\n\n![](https://i.imgur.com/nFA7A7p.gif)\n\n## 設定 richmenu 為預設\n\n若是使用 setDefault 的話需要上一頁再回來才會更動，因為 setDefault 的行為則是對當前 Bot 的所有使用者設定，如果想要馬上變化的話則是使用上述 link 的方式哦！\n\n# [模擬 postback 在 LIFF 傳送隱藏資料給機器人](https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html)\n\n> 感謝`均民`提供與授權給我記錄在我部落格上 😀\n\n為什麼要模擬呢？因為如同我一開始 `LIFF reply 到底算不算收費？`，LIFF 現在還沒有 `postback` 的 reply 功能，但有些事件我們不希望幫使用者打字去觸發 reply，但現在根本沒這功能那到底要怎辦呢？\n\n這篇作者想到了一個`奇技淫巧`的方法，就是使用最小 size 的透明圖片(`png`)並藉由 liff.sendMessage 來發送圖片事件達到模擬 postback 狀態。\n\n- [透明圖片](https://i.imgur.com/WN88L3I.png)\n\n> 詳細內容參閱 [部落格](https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html#yun-zuo-yuan-li)\n\n# [輔助開發 LINE Flex 訊息的工具](https://taichunmin.idv.tw/blog/2020-04-06-line-devbot.html)\n\n> 這部分一樣感謝`均民`提供\n\n通常我們在開發 LINE bot 時如果需要一些比較華麗的顯示方式時，所用的設計工具不外乎是官方出的 [ Flex Message Simulator](https://developers.line.biz/flex-simulator/) 以及 [LINE Bot Designer](https://developers.line.biz/en/services/bot-designer/)，前者是在網頁上直接編輯使用，後者則是可以安裝桌面版編輯測試，相較於網頁版本後者使用上比較完整，而通常設計完之後就直接塞進去 code 來做測試。\n\n但總要在測試時才知道 iOS 跟 Android 的樣子有差，這篇作者幫忙做了一隻機器人可以幫忙處理這件事，當開發完一部份之後，在電腦版的 LINE 貼上 json 後，才看兩種手機所呈現的樣子是什麼，而不用做完一個功能而各別打字或是按 richmenu，但這樣實在太不符合開發流程啦，當然是在電腦版貼上去直接看手機最快啦！\n\n# 結論\n\n開發那麼多的 LINE API 難免會遇到 spec 沒寫或是沒注意到的地方，趁最近有空把它記錄下來分享給大家知道，或許我現在遇到的問題也會是各位遇到的問題 😆\n\n如果有任何遇到的一些小眉角也歡迎到[我的粉絲團](https://www.facebook.com/nijiatw)分享給我知道喔！\n","slug":"LINE-Flex-message-LIFF-Richmenu-Provider","published":1,"updated":"2020-06-19T15:13:46.238Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kh003f7cripdbu9fki","content":"<p><img src=\"https://i.imgur.com/HHj7c5Kl.jpg\" alt=\"birds\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>因為遇到了很多不算坑的坑(<del>說啥呢？</del>)，有些是文件沒有寫而有些可能是我沒有注意到的，但既然都知道了就乾脆記下來吧！</p>\n<h1 id=\"LIFF-reply-到底算不算收費？\"><a href=\"#LIFF-reply-到底算不算收費？\" class=\"headerlink\" title=\"LIFF reply 到底算不算收費？\"></a>LIFF reply 到底算不算收費？</h1><blockquote>\n<p><a href=\"https://developers.line.biz/en/docs/liff/developing-liff-apps/#developing-a-liff-app\" target=\"_blank\" rel=\"noopener\">LIFF SendMessage api</a></p>\n</blockquote>\n<p>字面上看起來很像 <code>Push Message</code> 的事件，但實際上是走 Flex Message，使用 Message api 的 Reply 功能來幫忙使用者發送條件引發 Bot 行為，並非是透過 Push api 發送讓 Bot 反應，這邊需要多注意喔！</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liff.sendMessages([</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    type: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">    text: <span class=\"string\">\"You've successfully sent a message! Hooray!\"</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<blockquote>\n<p>但是現在 LIFF 還沒有 <code>postback</code> 的功能喔！😭</p>\n</blockquote>\n<h1 id=\"Flex-button-文字-text-欄位空值問題\"><a href=\"#Flex-button-文字-text-欄位空值問題\" class=\"headerlink\" title=\"Flex button 文字(text)欄位空值問題\"></a>Flex button 文字(text)欄位空值問題</h1><p>flex 的 button text 的文字不能用 0 長度的字串，但可以用 <code>&#39; &#39;</code> 中間為空白鍵的字串去解決長度 0 的問題，否則會出現以上的錯誤:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Response Data -</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"message\"</span>: <span class=\"string\">\"A message (messages[0]) in the request body is invalid\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"details\"</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"string\">\"message\"</span>: <span class=\"string\">\"must be non-empty text\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"property\"</span>: <span class=\"string\">\"/contents/0/footer/contents/1/action/text\"</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      ...</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"User-id-的問題-Provider\"><a href=\"#User-id-的問題-Provider\" class=\"headerlink\" title=\"User id 的問題 - Provider\"></a>User id 的問題 - Provider</h1><p>如下圖所示，左邊為我擁有的 provider，而右邊框框則為兩個不同 provider 下屬於我的 user id，只要在同一個 provider 下 user id 都會是固定的，無論用 Login 或 Message API。<br><img src=\"https://i.imgur.com/gqRltSU.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/8rXmRy7.png\" alt></p>\n<h1 id=\"Richmenu\"><a href=\"#Richmenu\" class=\"headerlink\" title=\"Richmenu\"></a>Richmenu</h1><h2 id=\"座標計算\"><a href=\"#座標計算\" class=\"headerlink\" title=\"座標計算\"></a>座標計算</h2><p>richmenu 的 x,y 是從左上(0, 0)算到右下(n, n)<br>限制:</p>\n<ul>\n<li>Image format: JPEG or PNG</li>\n<li>Image size (pixels): 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270</li>\n<li>Max file size: 1 MB</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developers.line.biz/en/docs/messaging-api/using-rich-menus/#creating-a-rich-menu-using-the-messaging-api\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<h2 id=\"使用-link-的方式指定給特定使用者\"><a href=\"#使用-link-的方式指定給特定使用者\" class=\"headerlink\" title=\"使用 link 的方式指定給特定使用者\"></a>使用 link 的方式指定給特定使用者</h2><p>➡️ python API - <a href=\"https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L640\" target=\"_blank\" rel=\"noopener\">連結特定使用者</a></p>\n<p>若只需要連結特定使用者的話使用這個 api，我目前使用情境有兩個</p>\n<ul>\n<li>Bot 裡有多重身份需要依照角色不同而給不同的 richmenu</li>\n<li>實作上下頁的功能，透過讓使用者按下特定位置時觸發更新成另一張圖片</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">link_rich_menu_to_user</span><span class=\"params\">(self, user_id, rich_menu_id, timeout=None)</span>:</span></span><br></pre></td></tr></table></figure>\n\n<p>➡️ python API - <a href=\"https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L661\" target=\"_blank\" rel=\"noopener\">一次連結多個使用者</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">link_rich_menu_to_users</span><span class=\"params\">(self, user_ids, rich_menu_id, timeout=None)</span>:</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"範例影片\"><a href=\"#範例影片\" class=\"headerlink\" title=\"範例影片\"></a>範例影片</h3><p><img src=\"https://i.imgur.com/nFA7A7p.gif\" alt></p>\n<h2 id=\"設定-richmenu-為預設\"><a href=\"#設定-richmenu-為預設\" class=\"headerlink\" title=\"設定 richmenu 為預設\"></a>設定 richmenu 為預設</h2><p>若是使用 setDefault 的話需要上一頁再回來才會更動，因為 setDefault 的行為則是對當前 Bot 的所有使用者設定，如果想要馬上變化的話則是使用上述 link 的方式哦！</p>\n<h1 id=\"模擬-postback-在-LIFF-傳送隱藏資料給機器人\"><a href=\"#模擬-postback-在-LIFF-傳送隱藏資料給機器人\" class=\"headerlink\" title=\"模擬 postback 在 LIFF 傳送隱藏資料給機器人\"></a><a href=\"https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html\" target=\"_blank\" rel=\"noopener\">模擬 postback 在 LIFF 傳送隱藏資料給機器人</a></h1><blockquote>\n<p>感謝<code>均民</code>提供與授權給我記錄在我部落格上 😀</p>\n</blockquote>\n<p>為什麼要模擬呢？因為如同我一開始 <code>LIFF reply 到底算不算收費？</code>，LIFF 現在還沒有 <code>postback</code> 的 reply 功能，但有些事件我們不希望幫使用者打字去觸發 reply，但現在根本沒這功能那到底要怎辦呢？</p>\n<p>這篇作者想到了一個<code>奇技淫巧</code>的方法，就是使用最小 size 的透明圖片(<code>png</code>)並藉由 liff.sendMessage 來發送圖片事件達到模擬 postback 狀態。</p>\n<ul>\n<li><a href=\"https://i.imgur.com/WN88L3I.png\" target=\"_blank\" rel=\"noopener\">透明圖片</a></li>\n</ul>\n<blockquote>\n<p>詳細內容參閱 <a href=\"https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html#yun-zuo-yuan-li\" target=\"_blank\" rel=\"noopener\">部落格</a></p>\n</blockquote>\n<h1 id=\"輔助開發-LINE-Flex-訊息的工具\"><a href=\"#輔助開發-LINE-Flex-訊息的工具\" class=\"headerlink\" title=\"輔助開發 LINE Flex 訊息的工具\"></a><a href=\"https://taichunmin.idv.tw/blog/2020-04-06-line-devbot.html\" target=\"_blank\" rel=\"noopener\">輔助開發 LINE Flex 訊息的工具</a></h1><blockquote>\n<p>這部分一樣感謝<code>均民</code>提供</p>\n</blockquote>\n<p>通常我們在開發 LINE bot 時如果需要一些比較華麗的顯示方式時，所用的設計工具不外乎是官方出的 <a href=\"https://developers.line.biz/flex-simulator/\" target=\"_blank\" rel=\"noopener\"> Flex Message Simulator</a> 以及 <a href=\"https://developers.line.biz/en/services/bot-designer/\" target=\"_blank\" rel=\"noopener\">LINE Bot Designer</a>，前者是在網頁上直接編輯使用，後者則是可以安裝桌面版編輯測試，相較於網頁版本後者使用上比較完整，而通常設計完之後就直接塞進去 code 來做測試。</p>\n<p>但總要在測試時才知道 iOS 跟 Android 的樣子有差，這篇作者幫忙做了一隻機器人可以幫忙處理這件事，當開發完一部份之後，在電腦版的 LINE 貼上 json 後，才看兩種手機所呈現的樣子是什麼，而不用做完一個功能而各別打字或是按 richmenu，但這樣實在太不符合開發流程啦，當然是在電腦版貼上去直接看手機最快啦！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>開發那麼多的 LINE API 難免會遇到 spec 沒寫或是沒注意到的地方，趁最近有空把它記錄下來分享給大家知道，或許我現在遇到的問題也會是各位遇到的問題 😆</p>\n<p>如果有任何遇到的一些小眉角也歡迎到<a href=\"https://www.facebook.com/nijiatw\" target=\"_blank\" rel=\"noopener\">我的粉絲團</a>分享給我知道喔！</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/HHj7c5Kl.jpg\" alt=\"birds\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>因為遇到了很多不算坑的坑(<del>說啥呢？</del>)，有些是文件沒有寫而有些可能是我沒有注意到的，但既然都知道了就乾脆記下來吧！</p>\n<h1 id=\"LIFF-reply-到底算不算收費？\"><a href=\"#LIFF-reply-到底算不算收費？\" class=\"headerlink\" title=\"LIFF reply 到底算不算收費？\"></a>LIFF reply 到底算不算收費？</h1><blockquote>\n<p><a href=\"https://developers.line.biz/en/docs/liff/developing-liff-apps/#developing-a-liff-app\" target=\"_blank\" rel=\"noopener\">LIFF SendMessage api</a></p>\n</blockquote>\n<p>字面上看起來很像 <code>Push Message</code> 的事件，但實際上是走 Flex Message，使用 Message api 的 Reply 功能來幫忙使用者發送條件引發 Bot 行為，並非是透過 Push api 發送讓 Bot 反應，這邊需要多注意喔！</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liff.sendMessages([</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    type: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">    text: <span class=\"string\">\"You've successfully sent a message! Hooray!\"</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>","more":"<blockquote>\n<p>但是現在 LIFF 還沒有 <code>postback</code> 的功能喔！😭</p>\n</blockquote>\n<h1 id=\"Flex-button-文字-text-欄位空值問題\"><a href=\"#Flex-button-文字-text-欄位空值問題\" class=\"headerlink\" title=\"Flex button 文字(text)欄位空值問題\"></a>Flex button 文字(text)欄位空值問題</h1><p>flex 的 button text 的文字不能用 0 長度的字串，但可以用 <code>&#39; &#39;</code> 中間為空白鍵的字串去解決長度 0 的問題，否則會出現以上的錯誤:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Response Data -</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"message\"</span>: <span class=\"string\">\"A message (messages[0]) in the request body is invalid\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"details\"</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"string\">\"message\"</span>: <span class=\"string\">\"must be non-empty text\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"property\"</span>: <span class=\"string\">\"/contents/0/footer/contents/1/action/text\"</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      ...</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"User-id-的問題-Provider\"><a href=\"#User-id-的問題-Provider\" class=\"headerlink\" title=\"User id 的問題 - Provider\"></a>User id 的問題 - Provider</h1><p>如下圖所示，左邊為我擁有的 provider，而右邊框框則為兩個不同 provider 下屬於我的 user id，只要在同一個 provider 下 user id 都會是固定的，無論用 Login 或 Message API。<br><img src=\"https://i.imgur.com/gqRltSU.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/8rXmRy7.png\" alt></p>\n<h1 id=\"Richmenu\"><a href=\"#Richmenu\" class=\"headerlink\" title=\"Richmenu\"></a>Richmenu</h1><h2 id=\"座標計算\"><a href=\"#座標計算\" class=\"headerlink\" title=\"座標計算\"></a>座標計算</h2><p>richmenu 的 x,y 是從左上(0, 0)算到右下(n, n)<br>限制:</p>\n<ul>\n<li>Image format: JPEG or PNG</li>\n<li>Image size (pixels): 2500x1686, 2500x843, 1200x810, 1200x405, 800x540, 800x270</li>\n<li>Max file size: 1 MB</li>\n</ul>\n<blockquote>\n<p><a href=\"https://developers.line.biz/en/docs/messaging-api/using-rich-menus/#creating-a-rich-menu-using-the-messaging-api\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n</blockquote>\n<h2 id=\"使用-link-的方式指定給特定使用者\"><a href=\"#使用-link-的方式指定給特定使用者\" class=\"headerlink\" title=\"使用 link 的方式指定給特定使用者\"></a>使用 link 的方式指定給特定使用者</h2><p>➡️ python API - <a href=\"https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L640\" target=\"_blank\" rel=\"noopener\">連結特定使用者</a></p>\n<p>若只需要連結特定使用者的話使用這個 api，我目前使用情境有兩個</p>\n<ul>\n<li>Bot 裡有多重身份需要依照角色不同而給不同的 richmenu</li>\n<li>實作上下頁的功能，透過讓使用者按下特定位置時觸發更新成另一張圖片</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">link_rich_menu_to_user</span><span class=\"params\">(self, user_id, rich_menu_id, timeout=None)</span>:</span></span><br></pre></td></tr></table></figure>\n\n<p>➡️ python API - <a href=\"https://github.com/line/line-bot-sdk-python/blob/master/linebot/api.py#L661\" target=\"_blank\" rel=\"noopener\">一次連結多個使用者</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">link_rich_menu_to_users</span><span class=\"params\">(self, user_ids, rich_menu_id, timeout=None)</span>:</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"範例影片\"><a href=\"#範例影片\" class=\"headerlink\" title=\"範例影片\"></a>範例影片</h3><p><img src=\"https://i.imgur.com/nFA7A7p.gif\" alt></p>\n<h2 id=\"設定-richmenu-為預設\"><a href=\"#設定-richmenu-為預設\" class=\"headerlink\" title=\"設定 richmenu 為預設\"></a>設定 richmenu 為預設</h2><p>若是使用 setDefault 的話需要上一頁再回來才會更動，因為 setDefault 的行為則是對當前 Bot 的所有使用者設定，如果想要馬上變化的話則是使用上述 link 的方式哦！</p>\n<h1 id=\"模擬-postback-在-LIFF-傳送隱藏資料給機器人\"><a href=\"#模擬-postback-在-LIFF-傳送隱藏資料給機器人\" class=\"headerlink\" title=\"模擬 postback 在 LIFF 傳送隱藏資料給機器人\"></a><a href=\"https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html\" target=\"_blank\" rel=\"noopener\">模擬 postback 在 LIFF 傳送隱藏資料給機器人</a></h1><blockquote>\n<p>感謝<code>均民</code>提供與授權給我記錄在我部落格上 😀</p>\n</blockquote>\n<p>為什麼要模擬呢？因為如同我一開始 <code>LIFF reply 到底算不算收費？</code>，LIFF 現在還沒有 <code>postback</code> 的 reply 功能，但有些事件我們不希望幫使用者打字去觸發 reply，但現在根本沒這功能那到底要怎辦呢？</p>\n<p>這篇作者想到了一個<code>奇技淫巧</code>的方法，就是使用最小 size 的透明圖片(<code>png</code>)並藉由 liff.sendMessage 來發送圖片事件達到模擬 postback 狀態。</p>\n<ul>\n<li><a href=\"https://i.imgur.com/WN88L3I.png\" target=\"_blank\" rel=\"noopener\">透明圖片</a></li>\n</ul>\n<blockquote>\n<p>詳細內容參閱 <a href=\"https://taichunmin.idv.tw/blog/2020-04-07-line-liff-send-hidden-data.html#yun-zuo-yuan-li\" target=\"_blank\" rel=\"noopener\">部落格</a></p>\n</blockquote>\n<h1 id=\"輔助開發-LINE-Flex-訊息的工具\"><a href=\"#輔助開發-LINE-Flex-訊息的工具\" class=\"headerlink\" title=\"輔助開發 LINE Flex 訊息的工具\"></a><a href=\"https://taichunmin.idv.tw/blog/2020-04-06-line-devbot.html\" target=\"_blank\" rel=\"noopener\">輔助開發 LINE Flex 訊息的工具</a></h1><blockquote>\n<p>這部分一樣感謝<code>均民</code>提供</p>\n</blockquote>\n<p>通常我們在開發 LINE bot 時如果需要一些比較華麗的顯示方式時，所用的設計工具不外乎是官方出的 <a href=\"https://developers.line.biz/flex-simulator/\" target=\"_blank\" rel=\"noopener\"> Flex Message Simulator</a> 以及 <a href=\"https://developers.line.biz/en/services/bot-designer/\" target=\"_blank\" rel=\"noopener\">LINE Bot Designer</a>，前者是在網頁上直接編輯使用，後者則是可以安裝桌面版編輯測試，相較於網頁版本後者使用上比較完整，而通常設計完之後就直接塞進去 code 來做測試。</p>\n<p>但總要在測試時才知道 iOS 跟 Android 的樣子有差，這篇作者幫忙做了一隻機器人可以幫忙處理這件事，當開發完一部份之後，在電腦版的 LINE 貼上 json 後，才看兩種手機所呈現的樣子是什麼，而不用做完一個功能而各別打字或是按 richmenu，但這樣實在太不符合開發流程啦，當然是在電腦版貼上去直接看手機最快啦！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>開發那麼多的 LINE API 難免會遇到 spec 沒寫或是沒注意到的地方，趁最近有空把它記錄下來分享給大家知道，或許我現在遇到的問題也會是各位遇到的問題 😆</p>\n<p>如果有任何遇到的一些小眉角也歡迎到<a href=\"https://www.facebook.com/nijiatw\" target=\"_blank\" rel=\"noopener\">我的粉絲團</a>分享給我知道喔！</p>"},{"title":"【LINE API】- 使用 Icon Switch 讓你的機器人同時有多個角色！ feat. Python","abbrlink":1756248633,"date":"2020-03-28T03:16:47.000Z","_content":"\n最近 LINE 釋出了一個我很喜歡的功能 - [Icon Switch](https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch)🎚，從字面上的意思就是可以切換機器人的 Icon (名稱以及大頭貼)，過往開發者在使用時都只能較死板的使用同一個頭像或暱稱來回應使用者，而現在只要使用這個這個功能就可以很輕易地切換你想要的大頭貼以及暱稱了 😇\n\n> 據可靠消息指出這以前是需要收費的功能，而現在則是免費推出來給大家使用，讓大家可以有更多的彈性去開發新功能～\n\n![](https://i.imgur.com/TbtdNFjl.png)\n\n<!-- more -->\n\n# 差在哪邊\n\n⭐️ 用 python 做了一個簡單範例程式歡迎大家試玩: https://github.com/louis70109/line-icon-switch-python\n\n原本我們要讓機器人輸出文字時會送這樣的 json:\n\n```json\n{\n  \"type\": \"text\",\n  \"text\": \"Hello, world\"\n}\n```\n\n而 Icon Switch 這個功能看起來似乎要設定很多東西，但他其實只要...\n\n```json\n{\n  \"type\": \"text\",\n  \"text\": \"Hello, I am Cony!!\",\n  \"sender\": {\n    \"name\": \"Cony\",\n    \"iconUrl\": \"https://line.me/conyprof\"\n  }\n}\n```\n\n有發現哪邊不一樣嗎？就是指在這個 json 裡面加入 `sender.name` 以及 `sender.iconUrl` 就可以把 大頭貼以及名字換掉啦 🎉\n\n官方文件也說明的很清楚，有興趣的朋友可以[參考官方網站](https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch)\n![](https://i.imgur.com/0o5tiWJ.png)\n\n> 名稱最多只能 20 個字\n> 網址必須要是 Https\n\n# Python 如何實現？\n\n一般機器人的回應我們都會使用`TextSendMessage`來幫我們產生出對應的輸出內容(JSON)\n\n```python\nfrom linebot.models import TextSendMessage\n\ntext = TextSendMessage(text=\"小編去哪兒了呢？\")\n```\n\n而照著先前的 JSON 範例我們就需要先 `import Sender`，並且在`TextSendMessage`第二個參數地方加上`sender`的參數，範例如下：\n\n```python\nfrom linebot.models import (TextSendMessage, Sender)\n\ntext = TextSendMessage(\n  text=\"叫你老闆出來啦\",\n  sender=Sender(\n    name=\"Boss\",\n    icon_url=\"https://{YOUR_BOSS_AVATAR}.jpg\")\n)\n```\n\n如此一來就可以達到切換的功能囉！\n\n# 結論\n\n在 Icon Switch 這個新功能上很適合做一些對話流程上`分類`以及`角色切換`的用途，若是再進階一點甚至貼 Google analytics 標籤來做分析，了解在這個角色下使用者的回應狀態為何，同一時間在分眾的同時還能讓使用者覺得很特別，達到一個雙贏的 communication！😁，諸多應用就留給大家開發發想囉！\n","source":"_posts/LINE-new-API-Icon-Switch.md","raw":"---\ntitle: 【LINE API】- 使用 Icon Switch 讓你的機器人同時有多個角色！ feat. Python\ntags:\n  - LINE\n  - Icon Switch\n  - Python\n  - AWS\n  - Serverless\ncategories: Chatbot\nabbrlink: 1756248633\ndate: 2020-03-28 11:16:47\n---\n\n最近 LINE 釋出了一個我很喜歡的功能 - [Icon Switch](https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch)🎚，從字面上的意思就是可以切換機器人的 Icon (名稱以及大頭貼)，過往開發者在使用時都只能較死板的使用同一個頭像或暱稱來回應使用者，而現在只要使用這個這個功能就可以很輕易地切換你想要的大頭貼以及暱稱了 😇\n\n> 據可靠消息指出這以前是需要收費的功能，而現在則是免費推出來給大家使用，讓大家可以有更多的彈性去開發新功能～\n\n![](https://i.imgur.com/TbtdNFjl.png)\n\n<!-- more -->\n\n# 差在哪邊\n\n⭐️ 用 python 做了一個簡單範例程式歡迎大家試玩: https://github.com/louis70109/line-icon-switch-python\n\n原本我們要讓機器人輸出文字時會送這樣的 json:\n\n```json\n{\n  \"type\": \"text\",\n  \"text\": \"Hello, world\"\n}\n```\n\n而 Icon Switch 這個功能看起來似乎要設定很多東西，但他其實只要...\n\n```json\n{\n  \"type\": \"text\",\n  \"text\": \"Hello, I am Cony!!\",\n  \"sender\": {\n    \"name\": \"Cony\",\n    \"iconUrl\": \"https://line.me/conyprof\"\n  }\n}\n```\n\n有發現哪邊不一樣嗎？就是指在這個 json 裡面加入 `sender.name` 以及 `sender.iconUrl` 就可以把 大頭貼以及名字換掉啦 🎉\n\n官方文件也說明的很清楚，有興趣的朋友可以[參考官方網站](https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch)\n![](https://i.imgur.com/0o5tiWJ.png)\n\n> 名稱最多只能 20 個字\n> 網址必須要是 Https\n\n# Python 如何實現？\n\n一般機器人的回應我們都會使用`TextSendMessage`來幫我們產生出對應的輸出內容(JSON)\n\n```python\nfrom linebot.models import TextSendMessage\n\ntext = TextSendMessage(text=\"小編去哪兒了呢？\")\n```\n\n而照著先前的 JSON 範例我們就需要先 `import Sender`，並且在`TextSendMessage`第二個參數地方加上`sender`的參數，範例如下：\n\n```python\nfrom linebot.models import (TextSendMessage, Sender)\n\ntext = TextSendMessage(\n  text=\"叫你老闆出來啦\",\n  sender=Sender(\n    name=\"Boss\",\n    icon_url=\"https://{YOUR_BOSS_AVATAR}.jpg\")\n)\n```\n\n如此一來就可以達到切換的功能囉！\n\n# 結論\n\n在 Icon Switch 這個新功能上很適合做一些對話流程上`分類`以及`角色切換`的用途，若是再進階一點甚至貼 Google analytics 標籤來做分析，了解在這個角色下使用者的回應狀態為何，同一時間在分眾的同時還能讓使用者覺得很特別，達到一個雙贏的 communication！😁，諸多應用就留給大家開發發想囉！\n","slug":"LINE-new-API-Icon-Switch","published":1,"updated":"2020-06-19T14:03:58.855Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ki003i7cric6z4dv4j","content":"<p>最近 LINE 釋出了一個我很喜歡的功能 - <a href=\"https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch\" target=\"_blank\" rel=\"noopener\">Icon Switch</a>🎚，從字面上的意思就是可以切換機器人的 Icon (名稱以及大頭貼)，過往開發者在使用時都只能較死板的使用同一個頭像或暱稱來回應使用者，而現在只要使用這個這個功能就可以很輕易地切換你想要的大頭貼以及暱稱了 😇</p>\n<blockquote>\n<p>據可靠消息指出這以前是需要收費的功能，而現在則是免費推出來給大家使用，讓大家可以有更多的彈性去開發新功能～</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/TbtdNFjl.png\" alt></p>\n<a id=\"more\"></a>\n\n<h1 id=\"差在哪邊\"><a href=\"#差在哪邊\" class=\"headerlink\" title=\"差在哪邊\"></a>差在哪邊</h1><p>⭐️ 用 python 做了一個簡單範例程式歡迎大家試玩: <a href=\"https://github.com/louis70109/line-icon-switch-python\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/line-icon-switch-python</a></p>\n<p>原本我們要讓機器人輸出文字時會送這樣的 json:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"Hello, world\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>而 Icon Switch 這個功能看起來似乎要設定很多東西，但他其實只要…</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"Hello, I am Cony!!\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"sender\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Cony\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"iconUrl\"</span>: <span class=\"string\">\"https://line.me/conyprof\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>有發現哪邊不一樣嗎？就是指在這個 json 裡面加入 <code>sender.name</code> 以及 <code>sender.iconUrl</code> 就可以把 大頭貼以及名字換掉啦 🎉</p>\n<p>官方文件也說明的很清楚，有興趣的朋友可以<a href=\"https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch\" target=\"_blank\" rel=\"noopener\">參考官方網站</a><br><img src=\"https://i.imgur.com/0o5tiWJ.png\" alt></p>\n<blockquote>\n<p>名稱最多只能 20 個字<br>網址必須要是 Https</p>\n</blockquote>\n<h1 id=\"Python-如何實現？\"><a href=\"#Python-如何實現？\" class=\"headerlink\" title=\"Python 如何實現？\"></a>Python 如何實現？</h1><p>一般機器人的回應我們都會使用<code>TextSendMessage</code>來幫我們產生出對應的輸出內容(JSON)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> TextSendMessage</span><br><span class=\"line\"></span><br><span class=\"line\">text = TextSendMessage(text=<span class=\"string\">\"小編去哪兒了呢？\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>而照著先前的 JSON 範例我們就需要先 <code>import Sender</code>，並且在<code>TextSendMessage</code>第二個參數地方加上<code>sender</code>的參數，範例如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (TextSendMessage, Sender)</span><br><span class=\"line\"></span><br><span class=\"line\">text = TextSendMessage(</span><br><span class=\"line\">  text=<span class=\"string\">\"叫你老闆出來啦\"</span>,</span><br><span class=\"line\">  sender=Sender(</span><br><span class=\"line\">    name=<span class=\"string\">\"Boss\"</span>,</span><br><span class=\"line\">    icon_url=<span class=\"string\">\"https://&#123;YOUR_BOSS_AVATAR&#125;.jpg\"</span>)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>如此一來就可以達到切換的功能囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在 Icon Switch 這個新功能上很適合做一些對話流程上<code>分類</code>以及<code>角色切換</code>的用途，若是再進階一點甚至貼 Google analytics 標籤來做分析，了解在這個角色下使用者的回應狀態為何，同一時間在分眾的同時還能讓使用者覺得很特別，達到一個雙贏的 communication！😁，諸多應用就留給大家開發發想囉！</p>\n","site":{"data":{}},"excerpt":"<p>最近 LINE 釋出了一個我很喜歡的功能 - <a href=\"https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch\" target=\"_blank\" rel=\"noopener\">Icon Switch</a>🎚，從字面上的意思就是可以切換機器人的 Icon (名稱以及大頭貼)，過往開發者在使用時都只能較死板的使用同一個頭像或暱稱來回應使用者，而現在只要使用這個這個功能就可以很輕易地切換你想要的大頭貼以及暱稱了 😇</p>\n<blockquote>\n<p>據可靠消息指出這以前是需要收費的功能，而現在則是免費推出來給大家使用，讓大家可以有更多的彈性去開發新功能～</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/TbtdNFjl.png\" alt></p>","more":"<h1 id=\"差在哪邊\"><a href=\"#差在哪邊\" class=\"headerlink\" title=\"差在哪邊\"></a>差在哪邊</h1><p>⭐️ 用 python 做了一個簡單範例程式歡迎大家試玩: <a href=\"https://github.com/louis70109/line-icon-switch-python\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/line-icon-switch-python</a></p>\n<p>原本我們要讓機器人輸出文字時會送這樣的 json:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"Hello, world\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>而 Icon Switch 這個功能看起來似乎要設定很多東西，但他其實只要…</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"text\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"Hello, I am Cony!!\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"sender\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Cony\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"iconUrl\"</span>: <span class=\"string\">\"https://line.me/conyprof\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>有發現哪邊不一樣嗎？就是指在這個 json 裡面加入 <code>sender.name</code> 以及 <code>sender.iconUrl</code> 就可以把 大頭貼以及名字換掉啦 🎉</p>\n<p>官方文件也說明的很清楚，有興趣的朋友可以<a href=\"https://developers.line.biz/zh-hant/reference/messaging-api/#icon-nickname-switch\" target=\"_blank\" rel=\"noopener\">參考官方網站</a><br><img src=\"https://i.imgur.com/0o5tiWJ.png\" alt></p>\n<blockquote>\n<p>名稱最多只能 20 個字<br>網址必須要是 Https</p>\n</blockquote>\n<h1 id=\"Python-如何實現？\"><a href=\"#Python-如何實現？\" class=\"headerlink\" title=\"Python 如何實現？\"></a>Python 如何實現？</h1><p>一般機器人的回應我們都會使用<code>TextSendMessage</code>來幫我們產生出對應的輸出內容(JSON)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> TextSendMessage</span><br><span class=\"line\"></span><br><span class=\"line\">text = TextSendMessage(text=<span class=\"string\">\"小編去哪兒了呢？\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>而照著先前的 JSON 範例我們就需要先 <code>import Sender</code>，並且在<code>TextSendMessage</code>第二個參數地方加上<code>sender</code>的參數，範例如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (TextSendMessage, Sender)</span><br><span class=\"line\"></span><br><span class=\"line\">text = TextSendMessage(</span><br><span class=\"line\">  text=<span class=\"string\">\"叫你老闆出來啦\"</span>,</span><br><span class=\"line\">  sender=Sender(</span><br><span class=\"line\">    name=<span class=\"string\">\"Boss\"</span>,</span><br><span class=\"line\">    icon_url=<span class=\"string\">\"https://&#123;YOUR_BOSS_AVATAR&#125;.jpg\"</span>)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>如此一來就可以達到切換的功能囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在 Icon Switch 這個新功能上很適合做一些對話流程上<code>分類</code>以及<code>角色切換</code>的用途，若是再進階一點甚至貼 Google analytics 標籤來做分析，了解在這個角色下使用者的回應狀態為何，同一時間在分眾的同時還能讓使用者覺得很特別，達到一個雙贏的 communication！😁，諸多應用就留給大家開發發想囉！</p>"},{"title":"Python - operator","abbrlink":1458295714,"date":"2020-01-07T15:12:22.000Z","_content":"\n# 前言\n\n最近在實作需要處理字串並且把它改成真實的`判斷式`，找 google 的過程中找到了[一篇解答](https://stackoverflow.com/questions/1740726/turn-string-into-operator)，當中剛好看到 [Operator](https://docs.python.org/3/library/operator.html) 這個套件，以下就用一些範例來示範～\n\n# 實作\n\n處理的範例: `1=1AND2<5OR8>9`\n\n可以使用`re`把字串處理成陣列\n\n```python\nre.split(\"AND|OR\", payload)\n# -> [1=1, 2<5, 8>9]\n```\n\n> 接著再使用`迴圈`+同樣的方法去處理掉`=`、`>`、`<`\n\n在處理完之後就可以找到所有的 `key` 以及 `value` 的陣列\n\n接著就是要把 `AND`、`OR` 找出來存下來，這邊我會會使用`split('AND', 1)`只切第一個找到的`AND`字串，因為像是 SQL Where 子句的功能要一個一個處理才行，否則最後判斷會出問題。\n\n```python\nwhile re.search('(AND)|(OR)', payload) is not None:\n    result = payload.split('AND', 1)\n    if result[0] and ... # 判斷 AND 字串\n    result = payload.split('OR', 1)\n    if result[0] and ... # 判斷 OR 字串\n```\n\n接著再切完之後會拿到`operator_list`知道裡面有哪些運算子的陣列，以原本的資料來說可以用迴圈去處理，這邊我就用簡單的範例來表示`operator`可以處理的東西。\n\n像是`operator`除了可以判斷純數字以及純字串以外，也可判斷`英文`+`數字`的組合。\n\n```python\noperator_list = ['>', '<', '=']\nif operator_list[0] == '>':\n    result = operator.gt(2, 0)\nif operator_list[1] == '<':\n    result = operator.lt('z01', 'z99')\nif operator_list[2] == '=':\n    result = operator.eq('A', 'A')\n```\n\n使用以上方法可以比對運算子，而使用以下方法則可以比對`AND`以及`OR`\n\n```python\nex = ['AND', 'OR']\nif ex[0] == 'AND':\n    result = operator.and_(1, 1)\nif ex[1] == 'OR':\n    result = operator.or_(1, 0)\n```\n\n# 結論\n\n透過 `operator` 這個函示庫讓我處理`運算子們`可以少很多事，藉此紀錄一下工作上使遇到的一些方法以及問題，最驚訝的就是可以比對`英文`+`中文`的判斷式，以一些韌體的本版資訊來說他們會擁有這樣的組合，在上傳之後要比對時用這樣的方法就很方便，若有什麼問題歡迎留言給我 😊\n\n# 參考\n\n- [stackoverflow](https://stackoverflow.com/questions/1740726/turn-string-into-operator)\n- [operator](https://docs.python.org/3/library/operator.html)\n","source":"_posts/Python-operator.md","raw":"---\ntitle: Python - operator\ntags:\n  - Python\n  - operator\ncategories: 學習紀錄\nabbrlink: 1458295714\ndate: 2020-01-07 23:12:22\n---\n\n# 前言\n\n最近在實作需要處理字串並且把它改成真實的`判斷式`，找 google 的過程中找到了[一篇解答](https://stackoverflow.com/questions/1740726/turn-string-into-operator)，當中剛好看到 [Operator](https://docs.python.org/3/library/operator.html) 這個套件，以下就用一些範例來示範～\n\n# 實作\n\n處理的範例: `1=1AND2<5OR8>9`\n\n可以使用`re`把字串處理成陣列\n\n```python\nre.split(\"AND|OR\", payload)\n# -> [1=1, 2<5, 8>9]\n```\n\n> 接著再使用`迴圈`+同樣的方法去處理掉`=`、`>`、`<`\n\n在處理完之後就可以找到所有的 `key` 以及 `value` 的陣列\n\n接著就是要把 `AND`、`OR` 找出來存下來，這邊我會會使用`split('AND', 1)`只切第一個找到的`AND`字串，因為像是 SQL Where 子句的功能要一個一個處理才行，否則最後判斷會出問題。\n\n```python\nwhile re.search('(AND)|(OR)', payload) is not None:\n    result = payload.split('AND', 1)\n    if result[0] and ... # 判斷 AND 字串\n    result = payload.split('OR', 1)\n    if result[0] and ... # 判斷 OR 字串\n```\n\n接著再切完之後會拿到`operator_list`知道裡面有哪些運算子的陣列，以原本的資料來說可以用迴圈去處理，這邊我就用簡單的範例來表示`operator`可以處理的東西。\n\n像是`operator`除了可以判斷純數字以及純字串以外，也可判斷`英文`+`數字`的組合。\n\n```python\noperator_list = ['>', '<', '=']\nif operator_list[0] == '>':\n    result = operator.gt(2, 0)\nif operator_list[1] == '<':\n    result = operator.lt('z01', 'z99')\nif operator_list[2] == '=':\n    result = operator.eq('A', 'A')\n```\n\n使用以上方法可以比對運算子，而使用以下方法則可以比對`AND`以及`OR`\n\n```python\nex = ['AND', 'OR']\nif ex[0] == 'AND':\n    result = operator.and_(1, 1)\nif ex[1] == 'OR':\n    result = operator.or_(1, 0)\n```\n\n# 結論\n\n透過 `operator` 這個函示庫讓我處理`運算子們`可以少很多事，藉此紀錄一下工作上使遇到的一些方法以及問題，最驚訝的就是可以比對`英文`+`中文`的判斷式，以一些韌體的本版資訊來說他們會擁有這樣的組合，在上傳之後要比對時用這樣的方法就很方便，若有什麼問題歡迎留言給我 😊\n\n# 參考\n\n- [stackoverflow](https://stackoverflow.com/questions/1740726/turn-string-into-operator)\n- [operator](https://docs.python.org/3/library/operator.html)\n","slug":"Python-operator","published":1,"updated":"2020-06-19T14:03:58.857Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kk003m7crioozovmlw","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近在實作需要處理字串並且把它改成真實的<code>判斷式</code>，找 google 的過程中找到了<a href=\"https://stackoverflow.com/questions/1740726/turn-string-into-operator\" target=\"_blank\" rel=\"noopener\">一篇解答</a>，當中剛好看到 <a href=\"https://docs.python.org/3/library/operator.html\" target=\"_blank\" rel=\"noopener\">Operator</a> 這個套件，以下就用一些範例來示範～</p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>處理的範例: <code>1=1AND2&lt;5OR8&gt;9</code></p>\n<p>可以使用<code>re</code>把字串處理成陣列</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re.split(<span class=\"string\">\"AND|OR\"</span>, payload)</span><br><span class=\"line\"><span class=\"comment\"># -&gt; [1=1, 2&lt;5, 8&gt;9]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>接著再使用<code>迴圈</code>+同樣的方法去處理掉<code>=</code>、<code>&gt;</code>、<code>&lt;</code></p>\n</blockquote>\n<p>在處理完之後就可以找到所有的 <code>key</code> 以及 <code>value</code> 的陣列</p>\n<p>接著就是要把 <code>AND</code>、<code>OR</code> 找出來存下來，這邊我會會使用<code>split(&#39;AND&#39;, 1)</code>只切第一個找到的<code>AND</code>字串，因為像是 SQL Where 子句的功能要一個一個處理才行，否則最後判斷會出問題。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> re.search(<span class=\"string\">'(AND)|(OR)'</span>, payload) <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">    result = payload.split(<span class=\"string\">'AND'</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> result[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> ... <span class=\"comment\"># 判斷 AND 字串</span></span><br><span class=\"line\">    result = payload.split(<span class=\"string\">'OR'</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> result[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> ... <span class=\"comment\"># 判斷 OR 字串</span></span><br></pre></td></tr></table></figure>\n\n<p>接著再切完之後會拿到<code>operator_list</code>知道裡面有哪些運算子的陣列，以原本的資料來說可以用迴圈去處理，這邊我就用簡單的範例來表示<code>operator</code>可以處理的東西。</p>\n<p>像是<code>operator</code>除了可以判斷純數字以及純字串以外，也可判斷<code>英文</code>+<code>數字</code>的組合。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">operator_list = [<span class=\"string\">'&gt;'</span>, <span class=\"string\">'&lt;'</span>, <span class=\"string\">'='</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">0</span>] == <span class=\"string\">'&gt;'</span>:</span><br><span class=\"line\">    result = operator.gt(<span class=\"number\">2</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">1</span>] == <span class=\"string\">'&lt;'</span>:</span><br><span class=\"line\">    result = operator.lt(<span class=\"string\">'z01'</span>, <span class=\"string\">'z99'</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">2</span>] == <span class=\"string\">'='</span>:</span><br><span class=\"line\">    result = operator.eq(<span class=\"string\">'A'</span>, <span class=\"string\">'A'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>使用以上方法可以比對運算子，而使用以下方法則可以比對<code>AND</code>以及<code>OR</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ex = [<span class=\"string\">'AND'</span>, <span class=\"string\">'OR'</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> ex[<span class=\"number\">0</span>] == <span class=\"string\">'AND'</span>:</span><br><span class=\"line\">    result = operator.and_(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> ex[<span class=\"number\">1</span>] == <span class=\"string\">'OR'</span>:</span><br><span class=\"line\">    result = operator.or_(<span class=\"number\">1</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>透過 <code>operator</code> 這個函示庫讓我處理<code>運算子們</code>可以少很多事，藉此紀錄一下工作上使遇到的一些方法以及問題，最驚訝的就是可以比對<code>英文</code>+<code>中文</code>的判斷式，以一些韌體的本版資訊來說他們會擁有這樣的組合，在上傳之後要比對時用這樣的方法就很方便，若有什麼問題歡迎留言給我 😊</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://stackoverflow.com/questions/1740726/turn-string-into-operator\" target=\"_blank\" rel=\"noopener\">stackoverflow</a></li>\n<li><a href=\"https://docs.python.org/3/library/operator.html\" target=\"_blank\" rel=\"noopener\">operator</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近在實作需要處理字串並且把它改成真實的<code>判斷式</code>，找 google 的過程中找到了<a href=\"https://stackoverflow.com/questions/1740726/turn-string-into-operator\" target=\"_blank\" rel=\"noopener\">一篇解答</a>，當中剛好看到 <a href=\"https://docs.python.org/3/library/operator.html\" target=\"_blank\" rel=\"noopener\">Operator</a> 這個套件，以下就用一些範例來示範～</p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>處理的範例: <code>1=1AND2&lt;5OR8&gt;9</code></p>\n<p>可以使用<code>re</code>把字串處理成陣列</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re.split(<span class=\"string\">\"AND|OR\"</span>, payload)</span><br><span class=\"line\"><span class=\"comment\"># -&gt; [1=1, 2&lt;5, 8&gt;9]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>接著再使用<code>迴圈</code>+同樣的方法去處理掉<code>=</code>、<code>&gt;</code>、<code>&lt;</code></p>\n</blockquote>\n<p>在處理完之後就可以找到所有的 <code>key</code> 以及 <code>value</code> 的陣列</p>\n<p>接著就是要把 <code>AND</code>、<code>OR</code> 找出來存下來，這邊我會會使用<code>split(&#39;AND&#39;, 1)</code>只切第一個找到的<code>AND</code>字串，因為像是 SQL Where 子句的功能要一個一個處理才行，否則最後判斷會出問題。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> re.search(<span class=\"string\">'(AND)|(OR)'</span>, payload) <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">    result = payload.split(<span class=\"string\">'AND'</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> result[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> ... <span class=\"comment\"># 判斷 AND 字串</span></span><br><span class=\"line\">    result = payload.split(<span class=\"string\">'OR'</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> result[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> ... <span class=\"comment\"># 判斷 OR 字串</span></span><br></pre></td></tr></table></figure>\n\n<p>接著再切完之後會拿到<code>operator_list</code>知道裡面有哪些運算子的陣列，以原本的資料來說可以用迴圈去處理，這邊我就用簡單的範例來表示<code>operator</code>可以處理的東西。</p>\n<p>像是<code>operator</code>除了可以判斷純數字以及純字串以外，也可判斷<code>英文</code>+<code>數字</code>的組合。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">operator_list = [<span class=\"string\">'&gt;'</span>, <span class=\"string\">'&lt;'</span>, <span class=\"string\">'='</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">0</span>] == <span class=\"string\">'&gt;'</span>:</span><br><span class=\"line\">    result = operator.gt(<span class=\"number\">2</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">1</span>] == <span class=\"string\">'&lt;'</span>:</span><br><span class=\"line\">    result = operator.lt(<span class=\"string\">'z01'</span>, <span class=\"string\">'z99'</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> operator_list[<span class=\"number\">2</span>] == <span class=\"string\">'='</span>:</span><br><span class=\"line\">    result = operator.eq(<span class=\"string\">'A'</span>, <span class=\"string\">'A'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>使用以上方法可以比對運算子，而使用以下方法則可以比對<code>AND</code>以及<code>OR</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ex = [<span class=\"string\">'AND'</span>, <span class=\"string\">'OR'</span>]</span><br><span class=\"line\"><span class=\"keyword\">if</span> ex[<span class=\"number\">0</span>] == <span class=\"string\">'AND'</span>:</span><br><span class=\"line\">    result = operator.and_(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> ex[<span class=\"number\">1</span>] == <span class=\"string\">'OR'</span>:</span><br><span class=\"line\">    result = operator.or_(<span class=\"number\">1</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>透過 <code>operator</code> 這個函示庫讓我處理<code>運算子們</code>可以少很多事，藉此紀錄一下工作上使遇到的一些方法以及問題，最驚訝的就是可以比對<code>英文</code>+<code>中文</code>的判斷式，以一些韌體的本版資訊來說他們會擁有這樣的組合，在上傳之後要比對時用這樣的方法就很方便，若有什麼問題歡迎留言給我 😊</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://stackoverflow.com/questions/1740726/turn-string-into-operator\" target=\"_blank\" rel=\"noopener\">stackoverflow</a></li>\n<li><a href=\"https://docs.python.org/3/library/operator.html\" target=\"_blank\" rel=\"noopener\">operator</a></li>\n</ul>\n"},{"title":"【第一次直播就上手 (1)】使用 Streamlabs 在 Youtube 上直播","abbrlink":446933730,"date":"2020-03-20T16:51:38.000Z","_content":"\n# 前言\n\n最近一次的 Chatbot 小聚因為在疫情期間可預期現場來的會眾一定不多，所以在這場小聚中也加上線上直播的部分，但因為我首次導入還不是很熟悉，在谷歌大神的幫忙下找到本篇介紹的軟體 - Streamlabs，使用 XR 錄影起來的品質覺得還不錯，且連講者 Demo 時的 LINE token 都看得一清二楚 🤣，接下來就來介紹一下我使用的過程。\n\n> 這邊我使用 iOS 做範例，小聚資訊可以參考 [Chatbot GitHub](https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2020.md#chatbot-meetup-17-at-dcard)\n\n<!-- more -->\n\n# 步驟\n\n1. 首先先到 APP store 下載 `Streamlabs`，找到這個綠綠的就按下去，其他看起來也是相關的軟體，有興趣的朋友可以試試看。\n\n![](https://i.imgur.com/phRSYFwl.jpg)\n\n---\n\n2. 下載完後點入會看到這個畫面，可以比較熱門的三大金剛 `Twitch`、`Youtube`、`Facebook`以及其他的平台，這邊我選擇使用現在大家愛看的 `Youtube`。\n\n![](https://i.imgur.com/mM2CgHh.png)\n\n---\n\n3. 接下來就是選擇你的 Google 帳號\n\n![](https://i.imgur.com/ywGIpKD.png)\n\n---\n\n4. 按下中間**紅色**的大按鈕後，選擇最下面的 `Create Event` 來建立串流直播\n   ![](https://i.imgur.com/tydZrfH.jpg)\n\n---\n\n5. 輸入這次直播的基本資訊(`標題`與`描述`)，有在看 Youtube 的朋友可能會想在描述多 ➕ 東西，這邊可以先預先做起來用複製貼上的方式放入，多一些表情符號也比較能吸引目光哦！\n\n![](https://i.imgur.com/BDwThYD.jpg)\n\n---\n\n6. 若開成功後會看到左下角的`Chat Enabled`，代表直播已經準備上去了。\n\n> 剛開時會需要給串流 APP 一些時間(大概 20~30 秒)，讓它把東西傳上去，千萬別太心急就把他關了喔！！！\n\n![](https://i.imgur.com/7lRBEFN.jpg)\n\n---\n\n7. 串流直播開始不間斷上傳之後就會看到他已經連線至`聊天室`了，這時就可以開始表演了 🎉\n\n![](https://i.imgur.com/xnynRjE.jpg)\n\n---\n\n8. FPS、觀眾留言以及畫質等等資訊也可以在這邊看到\n   ![](https://i.imgur.com/l9YGIhR.jpg)\n\n---\n\n9. 最後要關掉他會問你要繼續還是要完成結束～\n\n![](https://i.imgur.com/Y2QxpCa.jpg)\n\n# 短評\n\n在於第一次用可能有很多部分沒有顧慮太多，對於現場直播我應該帶著多去問講者問題來帶動一些氣氛讓線上的朋友也能參與我們的討論縮進彼此的距離 🤝，在疫情比較緩和後再來實行這件事～ 🙂\n\n下一篇我再帶各位使用我預計在下次線上小聚想用的直播方法給大家參考，會跟最近股價狂漲的 Zoom 有關喔！\n","source":"_posts/Streamlabs-Youtube-streaming.md","raw":"---\ntitle: 【第一次直播就上手 (1)】使用 Streamlabs 在 Youtube 上直播\ntags:\n  - Streamlabs\n  - Youtube\n  - Stream\n  - meetups\ncategories: 學習紀錄\nabbrlink: 446933730\ndate: 2020-03-21 00:51:38\n---\n\n# 前言\n\n最近一次的 Chatbot 小聚因為在疫情期間可預期現場來的會眾一定不多，所以在這場小聚中也加上線上直播的部分，但因為我首次導入還不是很熟悉，在谷歌大神的幫忙下找到本篇介紹的軟體 - Streamlabs，使用 XR 錄影起來的品質覺得還不錯，且連講者 Demo 時的 LINE token 都看得一清二楚 🤣，接下來就來介紹一下我使用的過程。\n\n> 這邊我使用 iOS 做範例，小聚資訊可以參考 [Chatbot GitHub](https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2020.md#chatbot-meetup-17-at-dcard)\n\n<!-- more -->\n\n# 步驟\n\n1. 首先先到 APP store 下載 `Streamlabs`，找到這個綠綠的就按下去，其他看起來也是相關的軟體，有興趣的朋友可以試試看。\n\n![](https://i.imgur.com/phRSYFwl.jpg)\n\n---\n\n2. 下載完後點入會看到這個畫面，可以比較熱門的三大金剛 `Twitch`、`Youtube`、`Facebook`以及其他的平台，這邊我選擇使用現在大家愛看的 `Youtube`。\n\n![](https://i.imgur.com/mM2CgHh.png)\n\n---\n\n3. 接下來就是選擇你的 Google 帳號\n\n![](https://i.imgur.com/ywGIpKD.png)\n\n---\n\n4. 按下中間**紅色**的大按鈕後，選擇最下面的 `Create Event` 來建立串流直播\n   ![](https://i.imgur.com/tydZrfH.jpg)\n\n---\n\n5. 輸入這次直播的基本資訊(`標題`與`描述`)，有在看 Youtube 的朋友可能會想在描述多 ➕ 東西，這邊可以先預先做起來用複製貼上的方式放入，多一些表情符號也比較能吸引目光哦！\n\n![](https://i.imgur.com/BDwThYD.jpg)\n\n---\n\n6. 若開成功後會看到左下角的`Chat Enabled`，代表直播已經準備上去了。\n\n> 剛開時會需要給串流 APP 一些時間(大概 20~30 秒)，讓它把東西傳上去，千萬別太心急就把他關了喔！！！\n\n![](https://i.imgur.com/7lRBEFN.jpg)\n\n---\n\n7. 串流直播開始不間斷上傳之後就會看到他已經連線至`聊天室`了，這時就可以開始表演了 🎉\n\n![](https://i.imgur.com/xnynRjE.jpg)\n\n---\n\n8. FPS、觀眾留言以及畫質等等資訊也可以在這邊看到\n   ![](https://i.imgur.com/l9YGIhR.jpg)\n\n---\n\n9. 最後要關掉他會問你要繼續還是要完成結束～\n\n![](https://i.imgur.com/Y2QxpCa.jpg)\n\n# 短評\n\n在於第一次用可能有很多部分沒有顧慮太多，對於現場直播我應該帶著多去問講者問題來帶動一些氣氛讓線上的朋友也能參與我們的討論縮進彼此的距離 🤝，在疫情比較緩和後再來實行這件事～ 🙂\n\n下一篇我再帶各位使用我預計在下次線上小聚想用的直播方法給大家參考，會跟最近股價狂漲的 Zoom 有關喔！\n","slug":"Streamlabs-Youtube-streaming","published":1,"updated":"2020-06-19T15:12:33.742Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kl003p7criaus9a59p","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近一次的 Chatbot 小聚因為在疫情期間可預期現場來的會眾一定不多，所以在這場小聚中也加上線上直播的部分，但因為我首次導入還不是很熟悉，在谷歌大神的幫忙下找到本篇介紹的軟體 - Streamlabs，使用 XR 錄影起來的品質覺得還不錯，且連講者 Demo 時的 LINE token 都看得一清二楚 🤣，接下來就來介紹一下我使用的過程。</p>\n<blockquote>\n<p>這邊我使用 iOS 做範例，小聚資訊可以參考 <a href=\"https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2020.md#chatbot-meetup-17-at-dcard\" target=\"_blank\" rel=\"noopener\">Chatbot GitHub</a></p>\n</blockquote>\n<a id=\"more\"></a>\n\n<h1 id=\"步驟\"><a href=\"#步驟\" class=\"headerlink\" title=\"步驟\"></a>步驟</h1><ol>\n<li>首先先到 APP store 下載 <code>Streamlabs</code>，找到這個綠綠的就按下去，其他看起來也是相關的軟體，有興趣的朋友可以試試看。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/phRSYFwl.jpg\" alt></p>\n<hr>\n<ol start=\"2\">\n<li>下載完後點入會看到這個畫面，可以比較熱門的三大金剛 <code>Twitch</code>、<code>Youtube</code>、<code>Facebook</code>以及其他的平台，這邊我選擇使用現在大家愛看的 <code>Youtube</code>。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/mM2CgHh.png\" alt></p>\n<hr>\n<ol start=\"3\">\n<li>接下來就是選擇你的 Google 帳號</li>\n</ol>\n<p><img src=\"https://i.imgur.com/ywGIpKD.png\" alt></p>\n<hr>\n<ol start=\"4\">\n<li>按下中間<strong>紅色</strong>的大按鈕後，選擇最下面的 <code>Create Event</code> 來建立串流直播<br><img src=\"https://i.imgur.com/tydZrfH.jpg\" alt></li>\n</ol>\n<hr>\n<ol start=\"5\">\n<li>輸入這次直播的基本資訊(<code>標題</code>與<code>描述</code>)，有在看 Youtube 的朋友可能會想在描述多 ➕ 東西，這邊可以先預先做起來用複製貼上的方式放入，多一些表情符號也比較能吸引目光哦！</li>\n</ol>\n<p><img src=\"https://i.imgur.com/BDwThYD.jpg\" alt></p>\n<hr>\n<ol start=\"6\">\n<li>若開成功後會看到左下角的<code>Chat Enabled</code>，代表直播已經準備上去了。</li>\n</ol>\n<blockquote>\n<p>剛開時會需要給串流 APP 一些時間(大概 20~30 秒)，讓它把東西傳上去，千萬別太心急就把他關了喔！！！</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/7lRBEFN.jpg\" alt></p>\n<hr>\n<ol start=\"7\">\n<li>串流直播開始不間斷上傳之後就會看到他已經連線至<code>聊天室</code>了，這時就可以開始表演了 🎉</li>\n</ol>\n<p><img src=\"https://i.imgur.com/xnynRjE.jpg\" alt></p>\n<hr>\n<ol start=\"8\">\n<li>FPS、觀眾留言以及畫質等等資訊也可以在這邊看到<br><img src=\"https://i.imgur.com/l9YGIhR.jpg\" alt></li>\n</ol>\n<hr>\n<ol start=\"9\">\n<li>最後要關掉他會問你要繼續還是要完成結束～</li>\n</ol>\n<p><img src=\"https://i.imgur.com/Y2QxpCa.jpg\" alt></p>\n<h1 id=\"短評\"><a href=\"#短評\" class=\"headerlink\" title=\"短評\"></a>短評</h1><p>在於第一次用可能有很多部分沒有顧慮太多，對於現場直播我應該帶著多去問講者問題來帶動一些氣氛讓線上的朋友也能參與我們的討論縮進彼此的距離 🤝，在疫情比較緩和後再來實行這件事～ 🙂</p>\n<p>下一篇我再帶各位使用我預計在下次線上小聚想用的直播方法給大家參考，會跟最近股價狂漲的 Zoom 有關喔！</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近一次的 Chatbot 小聚因為在疫情期間可預期現場來的會眾一定不多，所以在這場小聚中也加上線上直播的部分，但因為我首次導入還不是很熟悉，在谷歌大神的幫忙下找到本篇介紹的軟體 - Streamlabs，使用 XR 錄影起來的品質覺得還不錯，且連講者 Demo 時的 LINE token 都看得一清二楚 🤣，接下來就來介紹一下我使用的過程。</p>\n<blockquote>\n<p>這邊我使用 iOS 做範例，小聚資訊可以參考 <a href=\"https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2020.md#chatbot-meetup-17-at-dcard\" target=\"_blank\" rel=\"noopener\">Chatbot GitHub</a></p>\n</blockquote>","more":"<h1 id=\"步驟\"><a href=\"#步驟\" class=\"headerlink\" title=\"步驟\"></a>步驟</h1><ol>\n<li>首先先到 APP store 下載 <code>Streamlabs</code>，找到這個綠綠的就按下去，其他看起來也是相關的軟體，有興趣的朋友可以試試看。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/phRSYFwl.jpg\" alt></p>\n<hr>\n<ol start=\"2\">\n<li>下載完後點入會看到這個畫面，可以比較熱門的三大金剛 <code>Twitch</code>、<code>Youtube</code>、<code>Facebook</code>以及其他的平台，這邊我選擇使用現在大家愛看的 <code>Youtube</code>。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/mM2CgHh.png\" alt></p>\n<hr>\n<ol start=\"3\">\n<li>接下來就是選擇你的 Google 帳號</li>\n</ol>\n<p><img src=\"https://i.imgur.com/ywGIpKD.png\" alt></p>\n<hr>\n<ol start=\"4\">\n<li>按下中間<strong>紅色</strong>的大按鈕後，選擇最下面的 <code>Create Event</code> 來建立串流直播<br><img src=\"https://i.imgur.com/tydZrfH.jpg\" alt></li>\n</ol>\n<hr>\n<ol start=\"5\">\n<li>輸入這次直播的基本資訊(<code>標題</code>與<code>描述</code>)，有在看 Youtube 的朋友可能會想在描述多 ➕ 東西，這邊可以先預先做起來用複製貼上的方式放入，多一些表情符號也比較能吸引目光哦！</li>\n</ol>\n<p><img src=\"https://i.imgur.com/BDwThYD.jpg\" alt></p>\n<hr>\n<ol start=\"6\">\n<li>若開成功後會看到左下角的<code>Chat Enabled</code>，代表直播已經準備上去了。</li>\n</ol>\n<blockquote>\n<p>剛開時會需要給串流 APP 一些時間(大概 20~30 秒)，讓它把東西傳上去，千萬別太心急就把他關了喔！！！</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/7lRBEFN.jpg\" alt></p>\n<hr>\n<ol start=\"7\">\n<li>串流直播開始不間斷上傳之後就會看到他已經連線至<code>聊天室</code>了，這時就可以開始表演了 🎉</li>\n</ol>\n<p><img src=\"https://i.imgur.com/xnynRjE.jpg\" alt></p>\n<hr>\n<ol start=\"8\">\n<li>FPS、觀眾留言以及畫質等等資訊也可以在這邊看到<br><img src=\"https://i.imgur.com/l9YGIhR.jpg\" alt></li>\n</ol>\n<hr>\n<ol start=\"9\">\n<li>最後要關掉他會問你要繼續還是要完成結束～</li>\n</ol>\n<p><img src=\"https://i.imgur.com/Y2QxpCa.jpg\" alt></p>\n<h1 id=\"短評\"><a href=\"#短評\" class=\"headerlink\" title=\"短評\"></a>短評</h1><p>在於第一次用可能有很多部分沒有顧慮太多，對於現場直播我應該帶著多去問講者問題來帶動一些氣氛讓線上的朋友也能參與我們的討論縮進彼此的距離 🤝，在疫情比較緩和後再來實行這件事～ 🙂</p>\n<p>下一篇我再帶各位使用我預計在下次線上小聚想用的直播方法給大家參考，會跟最近股價狂漲的 Zoom 有關喔！</p>"},{"title":"透過 IRC 與 Twich 聊天室連結互動","abbrlink":307657668,"date":"2019-12-24T14:09:27.000Z","_content":"\n\n# 前言\n\n為什麼會想玩這個呢，因為之前串了一隻介接 Twitch API 的聊天機器人，不過最近因為 API 似乎已經翻新了，所以那隻機器人暫時死亡了 😆，但是聊天機器人不限定只有在 facebook、LINE 通訊軟體上，因此就寫了這篇文章來紀錄一下使用過程。\n\n# 文件 & 申請密鑰\n\nTwitch Chatbot IRC [官方文件](https://dev.twitch.tv/docs/irc/)\n\n- GitHub\n  - [連結](https://github.com/tmijs/tmi.js)\n  - [文件](https://github.com/tmijs/docs)\n\n> 要使用的朋友在 google 時可能會找到另一套，不過他也說請大家來用 `tmi.js` 了ＸＤ\n\n首先要先申請一個 `OAUTH` 的密鑰，網址[在這邊](https://twitchapps.com/tmi/)\n\n# 套件安裝\n\n透過`npm`安裝`tmi.js`\n\n```bash\nnpm i tmi.js\n```\n\n# IRC 通訊\n\n接著需要寫一個腳本透過`IRC`的方法來與 Twitch 的聊天室連結：\n\n> [IRC](https://zh.wikipedia.org/wiki/IRC)（Internet Relay Chat）是一個位於應用層的協定。其主要用於群體聊天，但同樣也可以用於個人對個人的聊天。\n\n## 新增 `bot.js`\n\n```javascript\nconst tmi = require('tmi.js');\nconst client = new tmi.Client({\n  options: { debug: true },\n  connection: {\n    reconnect: true,\n    secure: true,\n  },\n  identity: {\n    username: 'YOUR_NAME',\n    password: 'oauth:YOUR_KEY',\n  },\n  channels: ['yuniko0720'], // 想加入的聊天室\n});\nclient.connect();\nclient.on('message', (channel, tags, message, self) => {\n  if (self) return;\n  if (message.toLowerCase() === '87') {\n    client.say(channel, `@${tags.username}, 你是第 N 個說 87!`);\n  }\n});\n```\n\n## 設定檔\n\n- `username`: 設定你的使用者名稱\n- `password`: 申請的 oauth 放在這邊，格式皆是`oauth:XXXXX`\n- `channels`: 一般會進入自己的頻道，當然也可以去其他頻道\n\n```javascript\nidentity: {\n    username: 'YOUR_NAME',\n    password: 'oauth:YOUR_KEY',\n  },\n  channels: ['yuniko0720'],\n```\n\n## 連結聊天室\n\n這部分則是開始監聽聊天室的內容，所有的範例連結[皆在此](https://github.com/tmijs/docs/tree/gh-pages/_posts/v1.4.2)。\n\n```javascript\nclient.on('message', (channel, tags, message, self) => {\n  if (self) return;\n  if (message.toLowerCase() === '87') {\n    client.say(channel, `@${tags.username}, 你是第 N 個說 87!`);\n  }\n});\n```\n\n# 成果\n\n執行`node bot.js`會看到以下的畫面\n\n![](https://i.imgur.com/01aiJVw.png)\n\n其實這樣監聽看起來真的是讓我這個宅心噴發 🚀🚀，可以透過`IRC`收到聊天室訊息後看後續要怎麼處理，像有些實況主與觀眾的互動可能是輸入`+1`這樣的文字來獲得獎賞(抑或是互罵 🤣)，在很多情境下這樣用會讓觀眾除了跟實況主互動以外還有個對象能玩 👾。\n\n# 結論\n\n而在這樣監聽下若人數很高之後其實可以收集到更多的資訊去做利用，也許想是開啟`訂閱者模式`後讓訂閱者輸入特定文字後將資訊傳入`Google sheet`之類的資料表，在做抽獎等活動性質的內容，對整個遊戲實況內容行銷都會是滿好與觀眾互動的方式～\n\n大概就玩到這邊了，下次想到什麼應用再來說 😆\n","source":"_posts/Twich-chatroom-IRC.md","raw":"---\ntitle: 透過 IRC 與 Twich 聊天室連結互動\ntags:\n  - Twitch\n  - irc\n  - chatbot\nabbrlink: 307657668\ndate: 2019-12-24 22:09:27\n---\n\n\n# 前言\n\n為什麼會想玩這個呢，因為之前串了一隻介接 Twitch API 的聊天機器人，不過最近因為 API 似乎已經翻新了，所以那隻機器人暫時死亡了 😆，但是聊天機器人不限定只有在 facebook、LINE 通訊軟體上，因此就寫了這篇文章來紀錄一下使用過程。\n\n# 文件 & 申請密鑰\n\nTwitch Chatbot IRC [官方文件](https://dev.twitch.tv/docs/irc/)\n\n- GitHub\n  - [連結](https://github.com/tmijs/tmi.js)\n  - [文件](https://github.com/tmijs/docs)\n\n> 要使用的朋友在 google 時可能會找到另一套，不過他也說請大家來用 `tmi.js` 了ＸＤ\n\n首先要先申請一個 `OAUTH` 的密鑰，網址[在這邊](https://twitchapps.com/tmi/)\n\n# 套件安裝\n\n透過`npm`安裝`tmi.js`\n\n```bash\nnpm i tmi.js\n```\n\n# IRC 通訊\n\n接著需要寫一個腳本透過`IRC`的方法來與 Twitch 的聊天室連結：\n\n> [IRC](https://zh.wikipedia.org/wiki/IRC)（Internet Relay Chat）是一個位於應用層的協定。其主要用於群體聊天，但同樣也可以用於個人對個人的聊天。\n\n## 新增 `bot.js`\n\n```javascript\nconst tmi = require('tmi.js');\nconst client = new tmi.Client({\n  options: { debug: true },\n  connection: {\n    reconnect: true,\n    secure: true,\n  },\n  identity: {\n    username: 'YOUR_NAME',\n    password: 'oauth:YOUR_KEY',\n  },\n  channels: ['yuniko0720'], // 想加入的聊天室\n});\nclient.connect();\nclient.on('message', (channel, tags, message, self) => {\n  if (self) return;\n  if (message.toLowerCase() === '87') {\n    client.say(channel, `@${tags.username}, 你是第 N 個說 87!`);\n  }\n});\n```\n\n## 設定檔\n\n- `username`: 設定你的使用者名稱\n- `password`: 申請的 oauth 放在這邊，格式皆是`oauth:XXXXX`\n- `channels`: 一般會進入自己的頻道，當然也可以去其他頻道\n\n```javascript\nidentity: {\n    username: 'YOUR_NAME',\n    password: 'oauth:YOUR_KEY',\n  },\n  channels: ['yuniko0720'],\n```\n\n## 連結聊天室\n\n這部分則是開始監聽聊天室的內容，所有的範例連結[皆在此](https://github.com/tmijs/docs/tree/gh-pages/_posts/v1.4.2)。\n\n```javascript\nclient.on('message', (channel, tags, message, self) => {\n  if (self) return;\n  if (message.toLowerCase() === '87') {\n    client.say(channel, `@${tags.username}, 你是第 N 個說 87!`);\n  }\n});\n```\n\n# 成果\n\n執行`node bot.js`會看到以下的畫面\n\n![](https://i.imgur.com/01aiJVw.png)\n\n其實這樣監聽看起來真的是讓我這個宅心噴發 🚀🚀，可以透過`IRC`收到聊天室訊息後看後續要怎麼處理，像有些實況主與觀眾的互動可能是輸入`+1`這樣的文字來獲得獎賞(抑或是互罵 🤣)，在很多情境下這樣用會讓觀眾除了跟實況主互動以外還有個對象能玩 👾。\n\n# 結論\n\n而在這樣監聽下若人數很高之後其實可以收集到更多的資訊去做利用，也許想是開啟`訂閱者模式`後讓訂閱者輸入特定文字後將資訊傳入`Google sheet`之類的資料表，在做抽獎等活動性質的內容，對整個遊戲實況內容行銷都會是滿好與觀眾互動的方式～\n\n大概就玩到這邊了，下次想到什麼應用再來說 😆\n","slug":"Twich-chatroom-IRC","published":1,"updated":"2020-06-19T14:03:58.862Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kn003t7crit1ysqrwz","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>為什麼會想玩這個呢，因為之前串了一隻介接 Twitch API 的聊天機器人，不過最近因為 API 似乎已經翻新了，所以那隻機器人暫時死亡了 😆，但是聊天機器人不限定只有在 facebook、LINE 通訊軟體上，因此就寫了這篇文章來紀錄一下使用過程。</p>\n<h1 id=\"文件-amp-申請密鑰\"><a href=\"#文件-amp-申請密鑰\" class=\"headerlink\" title=\"文件 &amp; 申請密鑰\"></a>文件 &amp; 申請密鑰</h1><p>Twitch Chatbot IRC <a href=\"https://dev.twitch.tv/docs/irc/\" target=\"_blank\" rel=\"noopener\">官方文件</a></p>\n<ul>\n<li>GitHub<ul>\n<li><a href=\"https://github.com/tmijs/tmi.js\" target=\"_blank\" rel=\"noopener\">連結</a></li>\n<li><a href=\"https://github.com/tmijs/docs\" target=\"_blank\" rel=\"noopener\">文件</a></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>要使用的朋友在 google 時可能會找到另一套，不過他也說請大家來用 <code>tmi.js</code> 了ＸＤ</p>\n</blockquote>\n<p>首先要先申請一個 <code>OAUTH</code> 的密鑰，網址<a href=\"https://twitchapps.com/tmi/\" target=\"_blank\" rel=\"noopener\">在這邊</a></p>\n<h1 id=\"套件安裝\"><a href=\"#套件安裝\" class=\"headerlink\" title=\"套件安裝\"></a>套件安裝</h1><p>透過<code>npm</code>安裝<code>tmi.js</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i tmi.js</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"IRC-通訊\"><a href=\"#IRC-通訊\" class=\"headerlink\" title=\"IRC 通訊\"></a>IRC 通訊</h1><p>接著需要寫一個腳本透過<code>IRC</code>的方法來與 Twitch 的聊天室連結：</p>\n<blockquote>\n<p><a href=\"https://zh.wikipedia.org/wiki/IRC\" target=\"_blank\" rel=\"noopener\">IRC</a>（Internet Relay Chat）是一個位於應用層的協定。其主要用於群體聊天，但同樣也可以用於個人對個人的聊天。</p>\n</blockquote>\n<h2 id=\"新增-bot-js\"><a href=\"#新增-bot-js\" class=\"headerlink\" title=\"新增 bot.js\"></a>新增 <code>bot.js</code></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tmi = <span class=\"built_in\">require</span>(<span class=\"string\">'tmi.js'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> client = <span class=\"keyword\">new</span> tmi.Client(&#123;</span><br><span class=\"line\">  options: &#123; <span class=\"attr\">debug</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">  connection: &#123;</span><br><span class=\"line\">    reconnect: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    secure: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  identity: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">'YOUR_NAME'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">'oauth:YOUR_KEY'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  channels: [<span class=\"string\">'yuniko0720'</span>], <span class=\"comment\">// 想加入的聊天室</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">client.connect();</span><br><span class=\"line\">client.on(<span class=\"string\">'message'</span>, (channel, tags, message, self) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (self) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (message.toLowerCase() === <span class=\"string\">'87'</span>) &#123;</span><br><span class=\"line\">    client.say(channel, <span class=\"string\">`@<span class=\"subst\">$&#123;tags.username&#125;</span>, 你是第 N 個說 87!`</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"設定檔\"><a href=\"#設定檔\" class=\"headerlink\" title=\"設定檔\"></a>設定檔</h2><ul>\n<li><code>username</code>: 設定你的使用者名稱</li>\n<li><code>password</code>: 申請的 oauth 放在這邊，格式皆是<code>oauth:XXXXX</code></li>\n<li><code>channels</code>: 一般會進入自己的頻道，當然也可以去其他頻道</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">identity: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">'YOUR_NAME'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">'oauth:YOUR_KEY'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  channels: [<span class=\"string\">'yuniko0720'</span>],</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"連結聊天室\"><a href=\"#連結聊天室\" class=\"headerlink\" title=\"連結聊天室\"></a>連結聊天室</h2><p>這部分則是開始監聽聊天室的內容，所有的範例連結<a href=\"https://github.com/tmijs/docs/tree/gh-pages/_posts/v1.4.2\" target=\"_blank\" rel=\"noopener\">皆在此</a>。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">client.on(<span class=\"string\">'message'</span>, (channel, tags, message, self) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (self) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (message.toLowerCase() === <span class=\"string\">'87'</span>) &#123;</span><br><span class=\"line\">    client.say(channel, <span class=\"string\">`@<span class=\"subst\">$&#123;tags.username&#125;</span>, 你是第 N 個說 87!`</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"成果\"><a href=\"#成果\" class=\"headerlink\" title=\"成果\"></a>成果</h1><p>執行<code>node bot.js</code>會看到以下的畫面</p>\n<p><img src=\"https://i.imgur.com/01aiJVw.png\" alt></p>\n<p>其實這樣監聽看起來真的是讓我這個宅心噴發 🚀🚀，可以透過<code>IRC</code>收到聊天室訊息後看後續要怎麼處理，像有些實況主與觀眾的互動可能是輸入<code>+1</code>這樣的文字來獲得獎賞(抑或是互罵 🤣)，在很多情境下這樣用會讓觀眾除了跟實況主互動以外還有個對象能玩 👾。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>而在這樣監聽下若人數很高之後其實可以收集到更多的資訊去做利用，也許想是開啟<code>訂閱者模式</code>後讓訂閱者輸入特定文字後將資訊傳入<code>Google sheet</code>之類的資料表，在做抽獎等活動性質的內容，對整個遊戲實況內容行銷都會是滿好與觀眾互動的方式～</p>\n<p>大概就玩到這邊了，下次想到什麼應用再來說 😆</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>為什麼會想玩這個呢，因為之前串了一隻介接 Twitch API 的聊天機器人，不過最近因為 API 似乎已經翻新了，所以那隻機器人暫時死亡了 😆，但是聊天機器人不限定只有在 facebook、LINE 通訊軟體上，因此就寫了這篇文章來紀錄一下使用過程。</p>\n<h1 id=\"文件-amp-申請密鑰\"><a href=\"#文件-amp-申請密鑰\" class=\"headerlink\" title=\"文件 &amp; 申請密鑰\"></a>文件 &amp; 申請密鑰</h1><p>Twitch Chatbot IRC <a href=\"https://dev.twitch.tv/docs/irc/\" target=\"_blank\" rel=\"noopener\">官方文件</a></p>\n<ul>\n<li>GitHub<ul>\n<li><a href=\"https://github.com/tmijs/tmi.js\" target=\"_blank\" rel=\"noopener\">連結</a></li>\n<li><a href=\"https://github.com/tmijs/docs\" target=\"_blank\" rel=\"noopener\">文件</a></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>要使用的朋友在 google 時可能會找到另一套，不過他也說請大家來用 <code>tmi.js</code> 了ＸＤ</p>\n</blockquote>\n<p>首先要先申請一個 <code>OAUTH</code> 的密鑰，網址<a href=\"https://twitchapps.com/tmi/\" target=\"_blank\" rel=\"noopener\">在這邊</a></p>\n<h1 id=\"套件安裝\"><a href=\"#套件安裝\" class=\"headerlink\" title=\"套件安裝\"></a>套件安裝</h1><p>透過<code>npm</code>安裝<code>tmi.js</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i tmi.js</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"IRC-通訊\"><a href=\"#IRC-通訊\" class=\"headerlink\" title=\"IRC 通訊\"></a>IRC 通訊</h1><p>接著需要寫一個腳本透過<code>IRC</code>的方法來與 Twitch 的聊天室連結：</p>\n<blockquote>\n<p><a href=\"https://zh.wikipedia.org/wiki/IRC\" target=\"_blank\" rel=\"noopener\">IRC</a>（Internet Relay Chat）是一個位於應用層的協定。其主要用於群體聊天，但同樣也可以用於個人對個人的聊天。</p>\n</blockquote>\n<h2 id=\"新增-bot-js\"><a href=\"#新增-bot-js\" class=\"headerlink\" title=\"新增 bot.js\"></a>新增 <code>bot.js</code></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tmi = <span class=\"built_in\">require</span>(<span class=\"string\">'tmi.js'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> client = <span class=\"keyword\">new</span> tmi.Client(&#123;</span><br><span class=\"line\">  options: &#123; <span class=\"attr\">debug</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">  connection: &#123;</span><br><span class=\"line\">    reconnect: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    secure: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  identity: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">'YOUR_NAME'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">'oauth:YOUR_KEY'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  channels: [<span class=\"string\">'yuniko0720'</span>], <span class=\"comment\">// 想加入的聊天室</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">client.connect();</span><br><span class=\"line\">client.on(<span class=\"string\">'message'</span>, (channel, tags, message, self) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (self) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (message.toLowerCase() === <span class=\"string\">'87'</span>) &#123;</span><br><span class=\"line\">    client.say(channel, <span class=\"string\">`@<span class=\"subst\">$&#123;tags.username&#125;</span>, 你是第 N 個說 87!`</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"設定檔\"><a href=\"#設定檔\" class=\"headerlink\" title=\"設定檔\"></a>設定檔</h2><ul>\n<li><code>username</code>: 設定你的使用者名稱</li>\n<li><code>password</code>: 申請的 oauth 放在這邊，格式皆是<code>oauth:XXXXX</code></li>\n<li><code>channels</code>: 一般會進入自己的頻道，當然也可以去其他頻道</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">identity: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">'YOUR_NAME'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">'oauth:YOUR_KEY'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  channels: [<span class=\"string\">'yuniko0720'</span>],</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"連結聊天室\"><a href=\"#連結聊天室\" class=\"headerlink\" title=\"連結聊天室\"></a>連結聊天室</h2><p>這部分則是開始監聽聊天室的內容，所有的範例連結<a href=\"https://github.com/tmijs/docs/tree/gh-pages/_posts/v1.4.2\" target=\"_blank\" rel=\"noopener\">皆在此</a>。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">client.on(<span class=\"string\">'message'</span>, (channel, tags, message, self) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (self) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (message.toLowerCase() === <span class=\"string\">'87'</span>) &#123;</span><br><span class=\"line\">    client.say(channel, <span class=\"string\">`@<span class=\"subst\">$&#123;tags.username&#125;</span>, 你是第 N 個說 87!`</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"成果\"><a href=\"#成果\" class=\"headerlink\" title=\"成果\"></a>成果</h1><p>執行<code>node bot.js</code>會看到以下的畫面</p>\n<p><img src=\"https://i.imgur.com/01aiJVw.png\" alt></p>\n<p>其實這樣監聽看起來真的是讓我這個宅心噴發 🚀🚀，可以透過<code>IRC</code>收到聊天室訊息後看後續要怎麼處理，像有些實況主與觀眾的互動可能是輸入<code>+1</code>這樣的文字來獲得獎賞(抑或是互罵 🤣)，在很多情境下這樣用會讓觀眾除了跟實況主互動以外還有個對象能玩 👾。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>而在這樣監聽下若人數很高之後其實可以收集到更多的資訊去做利用，也許想是開啟<code>訂閱者模式</code>後讓訂閱者輸入特定文字後將資訊傳入<code>Google sheet</code>之類的資料表，在做抽獎等活動性質的內容，對整個遊戲實況內容行銷都會是滿好與觀眾互動的方式～</p>\n<p>大概就玩到這邊了，下次想到什麼應用再來說 😆</p>\n"},{"title":"2019 LINE Dev Day - 議程心得(1) - Seamless device migration using LINE secure backup","abbrlink":3420766478,"date":"2019-11-21T06:58:09.000Z","_content":"\n# Seamless device migration using LINE secure backup\n![](https://i.imgur.com/IWGmnvQ.jpg)\n\n簡報連結: [LINE Dev Day 2019](https://speakerdeck.com/line_devday2019/seamless-device-migration-using-line-secure-backups)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，這次被 LINE 邀請來參加 LINE Developer Day 2019。\n經由 每位負責人的 Keynote 開場完後就是會眾們開始聽議程的時候了，我選擇跟資安相關的主題來開始我今日的第一場議程，想想在接觸資安時還是大學時期呢(遠望)。\n\n# 心得\n開場不免俗的一定是要自我介紹並說主要大綱，講者本身為一個駭客並是 [Side-Channel Marvels](https://github.com/SideChannelMarvels) 成員之一，在 GitHub 上坐了一個逆向工程的工具 - [QBDI](https://github.com/QBDI/QBDI)。而作為一個 Hacker 破壞當然對他們來說是相對簡單，但換個方向來看，就是透過滲透測試來建立更完整的服務內容，的確在真實世界上要摧毀一個服務是相對容易的！\n\n但講者是在 LINE 這種規模較大的公司裡做滲透測試，在滲透後做完測試報告時需要顧慮到其他開發團隊的工作時程問題，也許這個漏洞在實際服務運轉上的容錯率是相對高的話，就可以讓開發團隊安排時程去修補漏洞而避免延遲產品上線時間。\n \n ![](https://i.imgur.com/r60FVBM.jpg)\n\n這邊主要提到一些 **加密協定原則** 以及傳統訊息傳送都是怎麼做。\n![](https://i.imgur.com/wJHnXMz.jpg)\n接著說到帳號轉移裝置時的問題，今天要從舊的裝置備份到新裝置時，若透過 Server 的話他只有加密過後的資料，如此一來根本無法備份過去，而 end-to-end 的備份的話會遇到以下問題：\n- 會受到各種通訊協定的問題(wifi, Bluetooth, NFC...)\n- ios - andriod 不同裝置相容性問題\n- 需要重新建構訊息模型\n- 要怎麼處理來自 parameter 的攻擊\n  - Hacker 透過中間人攻擊\n  - 會透過各種狀態來找尋漏洞 (BGP, DNS, Certificate PKI...)\n\n## UX x Security\n前面簡單介紹一些備份上的問題以裝置間的問題，接下來就進入如何在最好的使用者體驗上並擁有資訊安全：\n\n### 若要最好的使用者體驗 - Best UX\n![流程](https://i.imgur.com/E3N0d5l.jpg)\n- ✅不需要在意裝置間的問題\n- ❌會被駭客透過中間人攻擊去塞有問題的資料\n- ❌安全層級等於零\n\n> 這樣公司就不用運作啦 (笑)\n\n### 最安全的等級但最差的 UX\n![\bBest security](https://i.imgur.com/RFkmVAE.jpg)\n- ✅Private key 加密過並且擁有最難破解的密碼\n- ❌使用者根本記不得這密碼\n- ❌密碼過於複雜\n\n> 這邊講者有補充若是只有六位數的密碼他大概有 **一百萬** 種可能性，可以透過暴力破解的方式就解決，且有大約 **10%** 的密碼是重覆性很高的，因此還是建議擁有大小寫以及特殊符號是相對好！\n\n每天都會有弱密碼出現於生活中\n- combination padlock\n    - 硬體設備都用很弱的加密協定\n- Banking card PIN\n    - 很容易出現像是 **生日** 這類的密碼\n- smart phone lock screen\n    - 使用者求快 \n    - ARM trustZone / apple secure\n\n## Server Side 相關相關加密元件\n- [Trusted execution environment(TEE)](https://en.wikipedia.org/wiki/Trusted_execution_environment): 保護 process 相關\n- [Trusted Platform Module(TPM)](https://en.wikipedia.org/wiki/Trusted_Platform_Module): 微控制器相關加密元件\n- [Hardware security module(HSM)](https://zh.wikipedia.org/wiki/%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97): 一種用於保障和管理強認證系統所使用的數字金鑰，並同時提供相關密碼學操作的電腦硬體裝置。\n\n## HSM in backups\n接著就介紹是如何透過 HSM 的硬體元件來處理備份資料資安的問題\n![](https://i.imgur.com/CSkYEHD.jpg)\n透過硬體(HSM)來幫忙加密確保每一段上傳下載都是安全且可加解密，使用者在這過程中也不需要輸入一大串的密碼就只顧及資訊安全而放棄 UX，而在 HSM 當中會將私鑰安全的存下來，不用擔心會有被攔取之類的問題。\n\n由於 HSM 經過雙重加密認證達到資訊安全且是安全的儲存下來，因此不會因為被抓到之後就馬上被解開，確保整個資料傳遞上的安全性。\n\n![](https://i.imgur.com/A6Mo2mw.jpg)\n上圖則為 HSM 簽證公鑰的註冊流程，經由一連串的加密把它存成二進制 source code，且裝置還是能使用 public key 來解開這個二進制檔案，如此一來在備份到新裝置上就不用擔心整包資料的安全性了！\n\n# 結論\n我們在實作的網站在沒什麼流量時都不太需要注意資安相關，但當系統請求越來越大或是有金流時在每段的加解密終究都相對重要很多，且在建立 UX 以及 Security 之間要如何平衡也是個重要的議題，如同講者說的，在做這些技術的同時且站在巨人的肩膀上(LINE)對於白帽駭客的成就感是源源不絕的，能夠透過滲透來讓我們每天在用的東西更加完整也是很棒的一個作法😊。\n\n而過往在聽駭客朋友們在聊都是在講 [WAF](https://www.techbang.com/posts/1826-waf-web-host-bridge-is-falling-down) 較多是在講 Web application 相關的，這次聽到的 HSM 功能看起來雖然很相似，但看來是叫專注在資料的加解密當中，或許當中應該還有更深入的功能還未提到，透過這個議程認識到新的東西也是一大收穫😁。\n","source":"_posts/Seamless-device-migration-using-LINE-secure-backup.md","raw":"---\ntitle: >-\n  2019 LINE Dev Day - 議程心得(1) - Seamless device migration using LINE secure\n  backup\ntags:\n  - LINE\n  - Dev Day 2019\ncategories: 研討會\nabbrlink: 3420766478\ndate: 2019-11-21 14:58:09\n---\n\n# Seamless device migration using LINE secure backup\n![](https://i.imgur.com/IWGmnvQ.jpg)\n\n簡報連結: [LINE Dev Day 2019](https://speakerdeck.com/line_devday2019/seamless-device-migration-using-line-secure-backups)\n\n# 前言\n大家好我是 [Chatbot Developer Taiwan](https://www.facebook.com/groups/chatbot.tw/) - NiJia，這次被 LINE 邀請來參加 LINE Developer Day 2019。\n經由 每位負責人的 Keynote 開場完後就是會眾們開始聽議程的時候了，我選擇跟資安相關的主題來開始我今日的第一場議程，想想在接觸資安時還是大學時期呢(遠望)。\n\n# 心得\n開場不免俗的一定是要自我介紹並說主要大綱，講者本身為一個駭客並是 [Side-Channel Marvels](https://github.com/SideChannelMarvels) 成員之一，在 GitHub 上坐了一個逆向工程的工具 - [QBDI](https://github.com/QBDI/QBDI)。而作為一個 Hacker 破壞當然對他們來說是相對簡單，但換個方向來看，就是透過滲透測試來建立更完整的服務內容，的確在真實世界上要摧毀一個服務是相對容易的！\n\n但講者是在 LINE 這種規模較大的公司裡做滲透測試，在滲透後做完測試報告時需要顧慮到其他開發團隊的工作時程問題，也許這個漏洞在實際服務運轉上的容錯率是相對高的話，就可以讓開發團隊安排時程去修補漏洞而避免延遲產品上線時間。\n \n ![](https://i.imgur.com/r60FVBM.jpg)\n\n這邊主要提到一些 **加密協定原則** 以及傳統訊息傳送都是怎麼做。\n![](https://i.imgur.com/wJHnXMz.jpg)\n接著說到帳號轉移裝置時的問題，今天要從舊的裝置備份到新裝置時，若透過 Server 的話他只有加密過後的資料，如此一來根本無法備份過去，而 end-to-end 的備份的話會遇到以下問題：\n- 會受到各種通訊協定的問題(wifi, Bluetooth, NFC...)\n- ios - andriod 不同裝置相容性問題\n- 需要重新建構訊息模型\n- 要怎麼處理來自 parameter 的攻擊\n  - Hacker 透過中間人攻擊\n  - 會透過各種狀態來找尋漏洞 (BGP, DNS, Certificate PKI...)\n\n## UX x Security\n前面簡單介紹一些備份上的問題以裝置間的問題，接下來就進入如何在最好的使用者體驗上並擁有資訊安全：\n\n### 若要最好的使用者體驗 - Best UX\n![流程](https://i.imgur.com/E3N0d5l.jpg)\n- ✅不需要在意裝置間的問題\n- ❌會被駭客透過中間人攻擊去塞有問題的資料\n- ❌安全層級等於零\n\n> 這樣公司就不用運作啦 (笑)\n\n### 最安全的等級但最差的 UX\n![\bBest security](https://i.imgur.com/RFkmVAE.jpg)\n- ✅Private key 加密過並且擁有最難破解的密碼\n- ❌使用者根本記不得這密碼\n- ❌密碼過於複雜\n\n> 這邊講者有補充若是只有六位數的密碼他大概有 **一百萬** 種可能性，可以透過暴力破解的方式就解決，且有大約 **10%** 的密碼是重覆性很高的，因此還是建議擁有大小寫以及特殊符號是相對好！\n\n每天都會有弱密碼出現於生活中\n- combination padlock\n    - 硬體設備都用很弱的加密協定\n- Banking card PIN\n    - 很容易出現像是 **生日** 這類的密碼\n- smart phone lock screen\n    - 使用者求快 \n    - ARM trustZone / apple secure\n\n## Server Side 相關相關加密元件\n- [Trusted execution environment(TEE)](https://en.wikipedia.org/wiki/Trusted_execution_environment): 保護 process 相關\n- [Trusted Platform Module(TPM)](https://en.wikipedia.org/wiki/Trusted_Platform_Module): 微控制器相關加密元件\n- [Hardware security module(HSM)](https://zh.wikipedia.org/wiki/%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97): 一種用於保障和管理強認證系統所使用的數字金鑰，並同時提供相關密碼學操作的電腦硬體裝置。\n\n## HSM in backups\n接著就介紹是如何透過 HSM 的硬體元件來處理備份資料資安的問題\n![](https://i.imgur.com/CSkYEHD.jpg)\n透過硬體(HSM)來幫忙加密確保每一段上傳下載都是安全且可加解密，使用者在這過程中也不需要輸入一大串的密碼就只顧及資訊安全而放棄 UX，而在 HSM 當中會將私鑰安全的存下來，不用擔心會有被攔取之類的問題。\n\n由於 HSM 經過雙重加密認證達到資訊安全且是安全的儲存下來，因此不會因為被抓到之後就馬上被解開，確保整個資料傳遞上的安全性。\n\n![](https://i.imgur.com/A6Mo2mw.jpg)\n上圖則為 HSM 簽證公鑰的註冊流程，經由一連串的加密把它存成二進制 source code，且裝置還是能使用 public key 來解開這個二進制檔案，如此一來在備份到新裝置上就不用擔心整包資料的安全性了！\n\n# 結論\n我們在實作的網站在沒什麼流量時都不太需要注意資安相關，但當系統請求越來越大或是有金流時在每段的加解密終究都相對重要很多，且在建立 UX 以及 Security 之間要如何平衡也是個重要的議題，如同講者說的，在做這些技術的同時且站在巨人的肩膀上(LINE)對於白帽駭客的成就感是源源不絕的，能夠透過滲透來讓我們每天在用的東西更加完整也是很棒的一個作法😊。\n\n而過往在聽駭客朋友們在聊都是在講 [WAF](https://www.techbang.com/posts/1826-waf-web-host-bridge-is-falling-down) 較多是在講 Web application 相關的，這次聽到的 HSM 功能看起來雖然很相似，但看來是叫專注在資料的加解密當中，或許當中應該還有更深入的功能還未提到，透過這個議程認識到新的東西也是一大收穫😁。\n","slug":"Seamless-device-migration-using-LINE-secure-backup","published":1,"updated":"2020-06-19T14:03:58.858Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ko003v7criifha3704","content":"<h1 id=\"Seamless-device-migration-using-LINE-secure-backup\"><a href=\"#Seamless-device-migration-using-LINE-secure-backup\" class=\"headerlink\" title=\"Seamless device migration using LINE secure backup\"></a>Seamless device migration using LINE secure backup</h1><p><img src=\"https://i.imgur.com/IWGmnvQ.jpg\" alt></p>\n<p>簡報連結: <a href=\"https://speakerdeck.com/line_devday2019/seamless-device-migration-using-line-secure-backups\" target=\"_blank\" rel=\"noopener\">LINE Dev Day 2019</a></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，這次被 LINE 邀請來參加 LINE Developer Day 2019。<br>經由 每位負責人的 Keynote 開場完後就是會眾們開始聽議程的時候了，我選擇跟資安相關的主題來開始我今日的第一場議程，想想在接觸資安時還是大學時期呢(遠望)。</p>\n<h1 id=\"心得\"><a href=\"#心得\" class=\"headerlink\" title=\"心得\"></a>心得</h1><p>開場不免俗的一定是要自我介紹並說主要大綱，講者本身為一個駭客並是 <a href=\"https://github.com/SideChannelMarvels\" target=\"_blank\" rel=\"noopener\">Side-Channel Marvels</a> 成員之一，在 GitHub 上坐了一個逆向工程的工具 - <a href=\"https://github.com/QBDI/QBDI\" target=\"_blank\" rel=\"noopener\">QBDI</a>。而作為一個 Hacker 破壞當然對他們來說是相對簡單，但換個方向來看，就是透過滲透測試來建立更完整的服務內容，的確在真實世界上要摧毀一個服務是相對容易的！</p>\n<p>但講者是在 LINE 這種規模較大的公司裡做滲透測試，在滲透後做完測試報告時需要顧慮到其他開發團隊的工作時程問題，也許這個漏洞在實際服務運轉上的容錯率是相對高的話，就可以讓開發團隊安排時程去修補漏洞而避免延遲產品上線時間。</p>\n<p> <img src=\"https://i.imgur.com/r60FVBM.jpg\" alt></p>\n<p>這邊主要提到一些 <strong>加密協定原則</strong> 以及傳統訊息傳送都是怎麼做。<br><img src=\"https://i.imgur.com/wJHnXMz.jpg\" alt><br>接著說到帳號轉移裝置時的問題，今天要從舊的裝置備份到新裝置時，若透過 Server 的話他只有加密過後的資料，如此一來根本無法備份過去，而 end-to-end 的備份的話會遇到以下問題：</p>\n<ul>\n<li>會受到各種通訊協定的問題(wifi, Bluetooth, NFC…)</li>\n<li>ios - andriod 不同裝置相容性問題</li>\n<li>需要重新建構訊息模型</li>\n<li>要怎麼處理來自 parameter 的攻擊<ul>\n<li>Hacker 透過中間人攻擊</li>\n<li>會透過各種狀態來找尋漏洞 (BGP, DNS, Certificate PKI…)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"UX-x-Security\"><a href=\"#UX-x-Security\" class=\"headerlink\" title=\"UX x Security\"></a>UX x Security</h2><p>前面簡單介紹一些備份上的問題以裝置間的問題，接下來就進入如何在最好的使用者體驗上並擁有資訊安全：</p>\n<h3 id=\"若要最好的使用者體驗-Best-UX\"><a href=\"#若要最好的使用者體驗-Best-UX\" class=\"headerlink\" title=\"若要最好的使用者體驗 - Best UX\"></a>若要最好的使用者體驗 - Best UX</h3><p><img src=\"https://i.imgur.com/E3N0d5l.jpg\" alt=\"流程\"></p>\n<ul>\n<li>✅不需要在意裝置間的問題</li>\n<li>❌會被駭客透過中間人攻擊去塞有問題的資料</li>\n<li>❌安全層級等於零</li>\n</ul>\n<blockquote>\n<p>這樣公司就不用運作啦 (笑)</p>\n</blockquote>\n<h3 id=\"最安全的等級但最差的-UX\"><a href=\"#最安全的等級但最差的-UX\" class=\"headerlink\" title=\"最安全的等級但最差的 UX\"></a>最安全的等級但最差的 UX</h3><p><img src=\"https://i.imgur.com/RFkmVAE.jpg\" alt=\"\bBest security\"></p>\n<ul>\n<li>✅Private key 加密過並且擁有最難破解的密碼</li>\n<li>❌使用者根本記不得這密碼</li>\n<li>❌密碼過於複雜</li>\n</ul>\n<blockquote>\n<p>這邊講者有補充若是只有六位數的密碼他大概有 <strong>一百萬</strong> 種可能性，可以透過暴力破解的方式就解決，且有大約 <strong>10%</strong> 的密碼是重覆性很高的，因此還是建議擁有大小寫以及特殊符號是相對好！</p>\n</blockquote>\n<p>每天都會有弱密碼出現於生活中</p>\n<ul>\n<li>combination padlock<ul>\n<li>硬體設備都用很弱的加密協定</li>\n</ul>\n</li>\n<li>Banking card PIN<ul>\n<li>很容易出現像是 <strong>生日</strong> 這類的密碼</li>\n</ul>\n</li>\n<li>smart phone lock screen<ul>\n<li>使用者求快 </li>\n<li>ARM trustZone / apple secure</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Server-Side-相關相關加密元件\"><a href=\"#Server-Side-相關相關加密元件\" class=\"headerlink\" title=\"Server Side 相關相關加密元件\"></a>Server Side 相關相關加密元件</h2><ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Trusted_execution_environment\" target=\"_blank\" rel=\"noopener\">Trusted execution environment(TEE)</a>: 保護 process 相關</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Trusted_Platform_Module\" target=\"_blank\" rel=\"noopener\">Trusted Platform Module(TPM)</a>: 微控制器相關加密元件</li>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97\" target=\"_blank\" rel=\"noopener\">Hardware security module(HSM)</a>: 一種用於保障和管理強認證系統所使用的數字金鑰，並同時提供相關密碼學操作的電腦硬體裝置。</li>\n</ul>\n<h2 id=\"HSM-in-backups\"><a href=\"#HSM-in-backups\" class=\"headerlink\" title=\"HSM in backups\"></a>HSM in backups</h2><p>接著就介紹是如何透過 HSM 的硬體元件來處理備份資料資安的問題<br><img src=\"https://i.imgur.com/CSkYEHD.jpg\" alt><br>透過硬體(HSM)來幫忙加密確保每一段上傳下載都是安全且可加解密，使用者在這過程中也不需要輸入一大串的密碼就只顧及資訊安全而放棄 UX，而在 HSM 當中會將私鑰安全的存下來，不用擔心會有被攔取之類的問題。</p>\n<p>由於 HSM 經過雙重加密認證達到資訊安全且是安全的儲存下來，因此不會因為被抓到之後就馬上被解開，確保整個資料傳遞上的安全性。</p>\n<p><img src=\"https://i.imgur.com/A6Mo2mw.jpg\" alt><br>上圖則為 HSM 簽證公鑰的註冊流程，經由一連串的加密把它存成二進制 source code，且裝置還是能使用 public key 來解開這個二進制檔案，如此一來在備份到新裝置上就不用擔心整包資料的安全性了！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>我們在實作的網站在沒什麼流量時都不太需要注意資安相關，但當系統請求越來越大或是有金流時在每段的加解密終究都相對重要很多，且在建立 UX 以及 Security 之間要如何平衡也是個重要的議題，如同講者說的，在做這些技術的同時且站在巨人的肩膀上(LINE)對於白帽駭客的成就感是源源不絕的，能夠透過滲透來讓我們每天在用的東西更加完整也是很棒的一個作法😊。</p>\n<p>而過往在聽駭客朋友們在聊都是在講 <a href=\"https://www.techbang.com/posts/1826-waf-web-host-bridge-is-falling-down\" target=\"_blank\" rel=\"noopener\">WAF</a> 較多是在講 Web application 相關的，這次聽到的 HSM 功能看起來雖然很相似，但看來是叫專注在資料的加解密當中，或許當中應該還有更深入的功能還未提到，透過這個議程認識到新的東西也是一大收穫😁。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Seamless-device-migration-using-LINE-secure-backup\"><a href=\"#Seamless-device-migration-using-LINE-secure-backup\" class=\"headerlink\" title=\"Seamless device migration using LINE secure backup\"></a>Seamless device migration using LINE secure backup</h1><p><img src=\"https://i.imgur.com/IWGmnvQ.jpg\" alt></p>\n<p>簡報連結: <a href=\"https://speakerdeck.com/line_devday2019/seamless-device-migration-using-line-secure-backups\" target=\"_blank\" rel=\"noopener\">LINE Dev Day 2019</a></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot Developer Taiwan</a> - NiJia，這次被 LINE 邀請來參加 LINE Developer Day 2019。<br>經由 每位負責人的 Keynote 開場完後就是會眾們開始聽議程的時候了，我選擇跟資安相關的主題來開始我今日的第一場議程，想想在接觸資安時還是大學時期呢(遠望)。</p>\n<h1 id=\"心得\"><a href=\"#心得\" class=\"headerlink\" title=\"心得\"></a>心得</h1><p>開場不免俗的一定是要自我介紹並說主要大綱，講者本身為一個駭客並是 <a href=\"https://github.com/SideChannelMarvels\" target=\"_blank\" rel=\"noopener\">Side-Channel Marvels</a> 成員之一，在 GitHub 上坐了一個逆向工程的工具 - <a href=\"https://github.com/QBDI/QBDI\" target=\"_blank\" rel=\"noopener\">QBDI</a>。而作為一個 Hacker 破壞當然對他們來說是相對簡單，但換個方向來看，就是透過滲透測試來建立更完整的服務內容，的確在真實世界上要摧毀一個服務是相對容易的！</p>\n<p>但講者是在 LINE 這種規模較大的公司裡做滲透測試，在滲透後做完測試報告時需要顧慮到其他開發團隊的工作時程問題，也許這個漏洞在實際服務運轉上的容錯率是相對高的話，就可以讓開發團隊安排時程去修補漏洞而避免延遲產品上線時間。</p>\n<p> <img src=\"https://i.imgur.com/r60FVBM.jpg\" alt></p>\n<p>這邊主要提到一些 <strong>加密協定原則</strong> 以及傳統訊息傳送都是怎麼做。<br><img src=\"https://i.imgur.com/wJHnXMz.jpg\" alt><br>接著說到帳號轉移裝置時的問題，今天要從舊的裝置備份到新裝置時，若透過 Server 的話他只有加密過後的資料，如此一來根本無法備份過去，而 end-to-end 的備份的話會遇到以下問題：</p>\n<ul>\n<li>會受到各種通訊協定的問題(wifi, Bluetooth, NFC…)</li>\n<li>ios - andriod 不同裝置相容性問題</li>\n<li>需要重新建構訊息模型</li>\n<li>要怎麼處理來自 parameter 的攻擊<ul>\n<li>Hacker 透過中間人攻擊</li>\n<li>會透過各種狀態來找尋漏洞 (BGP, DNS, Certificate PKI…)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"UX-x-Security\"><a href=\"#UX-x-Security\" class=\"headerlink\" title=\"UX x Security\"></a>UX x Security</h2><p>前面簡單介紹一些備份上的問題以裝置間的問題，接下來就進入如何在最好的使用者體驗上並擁有資訊安全：</p>\n<h3 id=\"若要最好的使用者體驗-Best-UX\"><a href=\"#若要最好的使用者體驗-Best-UX\" class=\"headerlink\" title=\"若要最好的使用者體驗 - Best UX\"></a>若要最好的使用者體驗 - Best UX</h3><p><img src=\"https://i.imgur.com/E3N0d5l.jpg\" alt=\"流程\"></p>\n<ul>\n<li>✅不需要在意裝置間的問題</li>\n<li>❌會被駭客透過中間人攻擊去塞有問題的資料</li>\n<li>❌安全層級等於零</li>\n</ul>\n<blockquote>\n<p>這樣公司就不用運作啦 (笑)</p>\n</blockquote>\n<h3 id=\"最安全的等級但最差的-UX\"><a href=\"#最安全的等級但最差的-UX\" class=\"headerlink\" title=\"最安全的等級但最差的 UX\"></a>最安全的等級但最差的 UX</h3><p><img src=\"https://i.imgur.com/RFkmVAE.jpg\" alt=\"\bBest security\"></p>\n<ul>\n<li>✅Private key 加密過並且擁有最難破解的密碼</li>\n<li>❌使用者根本記不得這密碼</li>\n<li>❌密碼過於複雜</li>\n</ul>\n<blockquote>\n<p>這邊講者有補充若是只有六位數的密碼他大概有 <strong>一百萬</strong> 種可能性，可以透過暴力破解的方式就解決，且有大約 <strong>10%</strong> 的密碼是重覆性很高的，因此還是建議擁有大小寫以及特殊符號是相對好！</p>\n</blockquote>\n<p>每天都會有弱密碼出現於生活中</p>\n<ul>\n<li>combination padlock<ul>\n<li>硬體設備都用很弱的加密協定</li>\n</ul>\n</li>\n<li>Banking card PIN<ul>\n<li>很容易出現像是 <strong>生日</strong> 這類的密碼</li>\n</ul>\n</li>\n<li>smart phone lock screen<ul>\n<li>使用者求快 </li>\n<li>ARM trustZone / apple secure</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Server-Side-相關相關加密元件\"><a href=\"#Server-Side-相關相關加密元件\" class=\"headerlink\" title=\"Server Side 相關相關加密元件\"></a>Server Side 相關相關加密元件</h2><ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Trusted_execution_environment\" target=\"_blank\" rel=\"noopener\">Trusted execution environment(TEE)</a>: 保護 process 相關</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Trusted_Platform_Module\" target=\"_blank\" rel=\"noopener\">Trusted Platform Module(TPM)</a>: 微控制器相關加密元件</li>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97\" target=\"_blank\" rel=\"noopener\">Hardware security module(HSM)</a>: 一種用於保障和管理強認證系統所使用的數字金鑰，並同時提供相關密碼學操作的電腦硬體裝置。</li>\n</ul>\n<h2 id=\"HSM-in-backups\"><a href=\"#HSM-in-backups\" class=\"headerlink\" title=\"HSM in backups\"></a>HSM in backups</h2><p>接著就介紹是如何透過 HSM 的硬體元件來處理備份資料資安的問題<br><img src=\"https://i.imgur.com/CSkYEHD.jpg\" alt><br>透過硬體(HSM)來幫忙加密確保每一段上傳下載都是安全且可加解密，使用者在這過程中也不需要輸入一大串的密碼就只顧及資訊安全而放棄 UX，而在 HSM 當中會將私鑰安全的存下來，不用擔心會有被攔取之類的問題。</p>\n<p>由於 HSM 經過雙重加密認證達到資訊安全且是安全的儲存下來，因此不會因為被抓到之後就馬上被解開，確保整個資料傳遞上的安全性。</p>\n<p><img src=\"https://i.imgur.com/A6Mo2mw.jpg\" alt><br>上圖則為 HSM 簽證公鑰的註冊流程，經由一連串的加密把它存成二進制 source code，且裝置還是能使用 public key 來解開這個二進制檔案，如此一來在備份到新裝置上就不用擔心整包資料的安全性了！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>我們在實作的網站在沒什麼流量時都不太需要注意資安相關，但當系統請求越來越大或是有金流時在每段的加解密終究都相對重要很多，且在建立 UX 以及 Security 之間要如何平衡也是個重要的議題，如同講者說的，在做這些技術的同時且站在巨人的肩膀上(LINE)對於白帽駭客的成就感是源源不絕的，能夠透過滲透來讓我們每天在用的東西更加完整也是很棒的一個作法😊。</p>\n<p>而過往在聽駭客朋友們在聊都是在講 <a href=\"https://www.techbang.com/posts/1826-waf-web-host-bridge-is-falling-down\" target=\"_blank\" rel=\"noopener\">WAF</a> 較多是在講 Web application 相關的，這次聽到的 HSM 功能看起來雖然很相似，但看來是叫專注在資料的加解密當中，或許當中應該還有更深入的功能還未提到，透過這個議程認識到新的東西也是一大收穫😁。</p>\n"},{"title":"Typescript 不一樣的地方 - Interface, Class Type, 多型別","abbrlink":2145224856,"date":"2020-03-21T08:11:54.000Z","_content":"\n# 前言\n\n有一次在網路上閒逛的時候看到了[這篇部落格](https://blog.asana.com/2020/01/typescript-quirks/)，裡頭透過一些簡單的敘述來展示 Typescript 跟別人不太一樣的地方，也說到一些需要注意的眉角，這次文章則含有些許的文章翻譯以及個人評述在裡面，以下就開始吧！\n\n# 三個項目\n\n<!-- more -->\n\n## 1. 解釋 Interface 在加入額外參數時所會遇到的問題\n\ninterface 必須 assign 給一個參數，若直接傳入則會出錯，雖然 TypeScript 可以多傳其他不相關的 key，但它嚴格限制沒有 assign 的使用方式\n\n> 範例參考: [TypeScript playground](https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5AIygggBMAuZAZTClEzwF888YBXEBMYdEMgAOjcBkwAKClhriAlLgJEEAgM7oANhAB0GrBIBE4mgeQBqZNMzbS5CnNbsVIVWGSYm0ZAF5FREmSUJgCCwGQUcFoGADRKhHCYEDQAzI4ioGDiEh4giVAOeOli+vj+tkHIBqHhkRAxccgJScipLHJAA)\n\n以下兩個就是使用上的區別\n\n```Javascript\nconst ginger = {\n    breed: \"Airedale\",\n    age: 3\n}\nprintDog(ginger)\n\n> Dog:Airedale\n```\n\n```Javascript\nprintDog({\n    breed: \"Airedale\",\n    age: 3\n})\n\nArgument of type '{ breed: string; age: number; }' is not assignable to parameter of type 'Dog'.\n  Object literal may only specify known properties, and 'age' does not exist in type 'Dog'.\n```\n\n所以若會傳 Object 進去函式的話要注意一下 parameter 接收值的類型喔！\n\n## 2. Class 也可以當作型別\n\n一般來說使用 TypeScript 要做型別檢查時第一個想法一定是用 Interface 來處理，這點就跟 Golang 使用的方法相似，但除了用 Interface 來定義型別以為，也可以像 python 用 class 來定義，Python 3 之後可以定義型別(~~雖然有跟沒有一樣~~)，透過一些 [marshmallow](https://marshmallow.readthedocs.io/en/stable/) 或是 [pydantic](https://pydantic-docs.helpmanual.io/) 可以做到這件事，因此這個段落就在講這件事情。\n\n> 範例參考: [TypeScript playground](https://www.typescriptlang.org/play/index.html#code/MYGwhgzhAEAiD2BzaBvAUNT0BGAnApvgCYBc0EALrgJYB2iGWw8tluArsBfLgBR6FS5KnUQBKVIyxYKAC2oQAdAOLQAvDgLEp0AL5p9aAGbtaXai2gAHGrQoJEvIkjIOJ6ac1bwQ+RSCReACIHMiDoAGpoZ0RlLSIxAzQ0UEgYAGEwCklpFSE2UR0vNk5uPjyyAvp3HWk5BTjBdU1BHX1DYuyIWUgKMGbafAB3aEyKYIBZMDp8UfgWIMSbOntA7t6wMSA)\n\n使用範例:\n\n```Javascript\nclass Dog {\n    breed: string\n    constructor(breed: string) {\n        this.breed = breed\n    }\n}\n```\n\nAfter defining that, TypeScript allows you to use the class name as a type so you could write a function like:\n\n```Javascript\nfunction printDog(dog: Dog) {\n    console.log(\"Dog: \" + dog.breed)\n}\n```\n\n## 3. 多型別問題\n\nTypeScript 中其中一個功能是可以定義一個變數擁有多型別，基本上在使用時都在最上層 object 的話沒問題，但若判斷第二層之後的 Object 並回傳第一層的 object 則會噴錯。\n\n試玩一下可以更清楚這個行為發生的原因喔!\n\n> 範例參考: [TypeScript](https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5MOAD3RHQFsBPALlwKOYGcAHCBYCFhgIgDCcEMBbJ4VYABtgcKKL5NCAXyXIARnIDWDFmHkhMeVXlCRYiFELCNmJcpVoN8zVhy49+AMQgyxCODAAVxZFZlVmKgh0AHddfVAjEzAaDmQAQREqOClkAF5ka2QAHzQsPDwYIJAEMGAKZGFgbKkAOXRRCAAKJpaGTOacgEp4g2wXImAYZB6snIA6ewpqGnn2Tm4xPILBJrEJaVl5UKHbV0IoCGCoEEa5qXnNKC01ZWRfFhQJ88vr296FlFYq9jEA)\n\n# 結論\n\n雖然現在 TypeScript 越來越多人用，如果想要很完善的型別定義以及一致性可能不適合，但若想要在 Javascript 基礎中使用或練習一些型別定義的話他就很適合了。\n\n# 參考\n\n1. [TypeScript’s quirks: How inconsistencies make the language more complex](https://blog.asana.com/2020/01/typescript-quirks)\n","source":"_posts/Typescript-的怪異之處-文章簡評.md","raw":"---\ntitle: 'Typescript 不一樣的地方 - Interface, Class Type, 多型別'\ntags:\n  - TypeScript\ncategories: 學習紀錄\nabbrlink: 2145224856\ndate: 2020-03-21 16:11:54\n---\n\n# 前言\n\n有一次在網路上閒逛的時候看到了[這篇部落格](https://blog.asana.com/2020/01/typescript-quirks/)，裡頭透過一些簡單的敘述來展示 Typescript 跟別人不太一樣的地方，也說到一些需要注意的眉角，這次文章則含有些許的文章翻譯以及個人評述在裡面，以下就開始吧！\n\n# 三個項目\n\n<!-- more -->\n\n## 1. 解釋 Interface 在加入額外參數時所會遇到的問題\n\ninterface 必須 assign 給一個參數，若直接傳入則會出錯，雖然 TypeScript 可以多傳其他不相關的 key，但它嚴格限制沒有 assign 的使用方式\n\n> 範例參考: [TypeScript playground](https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5AIygggBMAuZAZTClEzwF888YBXEBMYdEMgAOjcBkwAKClhriAlLgJEEAgM7oANhAB0GrBIBE4mgeQBqZNMzbS5CnNbsVIVWGSYm0ZAF5FREmSUJgCCwGQUcFoGADRKhHCYEDQAzI4ioGDiEh4giVAOeOli+vj+tkHIBqHhkRAxccgJScipLHJAA)\n\n以下兩個就是使用上的區別\n\n```Javascript\nconst ginger = {\n    breed: \"Airedale\",\n    age: 3\n}\nprintDog(ginger)\n\n> Dog:Airedale\n```\n\n```Javascript\nprintDog({\n    breed: \"Airedale\",\n    age: 3\n})\n\nArgument of type '{ breed: string; age: number; }' is not assignable to parameter of type 'Dog'.\n  Object literal may only specify known properties, and 'age' does not exist in type 'Dog'.\n```\n\n所以若會傳 Object 進去函式的話要注意一下 parameter 接收值的類型喔！\n\n## 2. Class 也可以當作型別\n\n一般來說使用 TypeScript 要做型別檢查時第一個想法一定是用 Interface 來處理，這點就跟 Golang 使用的方法相似，但除了用 Interface 來定義型別以為，也可以像 python 用 class 來定義，Python 3 之後可以定義型別(~~雖然有跟沒有一樣~~)，透過一些 [marshmallow](https://marshmallow.readthedocs.io/en/stable/) 或是 [pydantic](https://pydantic-docs.helpmanual.io/) 可以做到這件事，因此這個段落就在講這件事情。\n\n> 範例參考: [TypeScript playground](https://www.typescriptlang.org/play/index.html#code/MYGwhgzhAEAiD2BzaBvAUNT0BGAnApvgCYBc0EALrgJYB2iGWw8tluArsBfLgBR6FS5KnUQBKVIyxYKAC2oQAdAOLQAvDgLEp0AL5p9aAGbtaXai2gAHGrQoJEvIkjIOJ6ac1bwQ+RSCReACIHMiDoAGpoZ0RlLSIxAzQ0UEgYAGEwCklpFSE2UR0vNk5uPjyyAvp3HWk5BTjBdU1BHX1DYuyIWUgKMGbafAB3aEyKYIBZMDp8UfgWIMSbOntA7t6wMSA)\n\n使用範例:\n\n```Javascript\nclass Dog {\n    breed: string\n    constructor(breed: string) {\n        this.breed = breed\n    }\n}\n```\n\nAfter defining that, TypeScript allows you to use the class name as a type so you could write a function like:\n\n```Javascript\nfunction printDog(dog: Dog) {\n    console.log(\"Dog: \" + dog.breed)\n}\n```\n\n## 3. 多型別問題\n\nTypeScript 中其中一個功能是可以定義一個變數擁有多型別，基本上在使用時都在最上層 object 的話沒問題，但若判斷第二層之後的 Object 並回傳第一層的 object 則會噴錯。\n\n試玩一下可以更清楚這個行為發生的原因喔!\n\n> 範例參考: [TypeScript](https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5MOAD3RHQFsBPALlwKOYGcAHCBYCFhgIgDCcEMBbJ4VYABtgcKKL5NCAXyXIARnIDWDFmHkhMeVXlCRYiFELCNmJcpVoN8zVhy49+AMQgyxCODAAVxZFZlVmKgh0AHddfVAjEzAaDmQAQREqOClkAF5ka2QAHzQsPDwYIJAEMGAKZGFgbKkAOXRRCAAKJpaGTOacgEp4g2wXImAYZB6snIA6ewpqGnn2Tm4xPILBJrEJaVl5UKHbV0IoCGCoEEa5qXnNKC01ZWRfFhQJ88vr296FlFYq9jEA)\n\n# 結論\n\n雖然現在 TypeScript 越來越多人用，如果想要很完善的型別定義以及一致性可能不適合，但若想要在 Javascript 基礎中使用或練習一些型別定義的話他就很適合了。\n\n# 參考\n\n1. [TypeScript’s quirks: How inconsistencies make the language more complex](https://blog.asana.com/2020/01/typescript-quirks)\n","slug":"Typescript-的怪異之處-文章簡評","published":1,"updated":"2020-06-19T14:03:58.861Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kq003y7cric6segskw","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>有一次在網路上閒逛的時候看到了<a href=\"https://blog.asana.com/2020/01/typescript-quirks/\" target=\"_blank\" rel=\"noopener\">這篇部落格</a>，裡頭透過一些簡單的敘述來展示 Typescript 跟別人不太一樣的地方，也說到一些需要注意的眉角，這次文章則含有些許的文章翻譯以及個人評述在裡面，以下就開始吧！</p>\n<h1 id=\"三個項目\"><a href=\"#三個項目\" class=\"headerlink\" title=\"三個項目\"></a>三個項目</h1><a id=\"more\"></a>\n\n<h2 id=\"1-解釋-Interface-在加入額外參數時所會遇到的問題\"><a href=\"#1-解釋-Interface-在加入額外參數時所會遇到的問題\" class=\"headerlink\" title=\"1. 解釋 Interface 在加入額外參數時所會遇到的問題\"></a>1. 解釋 Interface 在加入額外參數時所會遇到的問題</h2><p>interface 必須 assign 給一個參數，若直接傳入則會出錯，雖然 TypeScript 可以多傳其他不相關的 key，但它嚴格限制沒有 assign 的使用方式</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5AIygggBMAuZAZTClEzwF888YBXEBMYdEMgAOjcBkwAKClhriAlLgJEEAgM7oANhAB0GrBIBE4mgeQBqZNMzbS5CnNbsVIVWGSYm0ZAF5FREmSUJgCCwGQUcFoGADRKhHCYEDQAzI4ioGDiEh4giVAOeOli+vj+tkHIBqHhkRAxccgJScipLHJAA\" target=\"_blank\" rel=\"noopener\">TypeScript playground</a></p>\n</blockquote>\n<p>以下兩個就是使用上的區別</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ginger = &#123;</span><br><span class=\"line\">    breed: <span class=\"string\">\"Airedale\"</span>,</span><br><span class=\"line\">    age: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">printDog(ginger)</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Dog:Airedale</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printDog(&#123;</span><br><span class=\"line\">    breed: <span class=\"string\">\"Airedale\"</span>,</span><br><span class=\"line\">    age: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">Argument <span class=\"keyword\">of</span> type <span class=\"string\">'&#123; breed: string; age: number; &#125;'</span> is not assignable to parameter <span class=\"keyword\">of</span> type <span class=\"string\">'Dog'</span>.</span><br><span class=\"line\">  <span class=\"built_in\">Object</span> literal may only specify known properties, and <span class=\"string\">'age'</span> does not exist <span class=\"keyword\">in</span> type <span class=\"string\">'Dog'</span>.</span><br></pre></td></tr></table></figure>\n\n<p>所以若會傳 Object 進去函式的話要注意一下 parameter 接收值的類型喔！</p>\n<h2 id=\"2-Class-也可以當作型別\"><a href=\"#2-Class-也可以當作型別\" class=\"headerlink\" title=\"2. Class 也可以當作型別\"></a>2. Class 也可以當作型別</h2><p>一般來說使用 TypeScript 要做型別檢查時第一個想法一定是用 Interface 來處理，這點就跟 Golang 使用的方法相似，但除了用 Interface 來定義型別以為，也可以像 python 用 class 來定義，Python 3 之後可以定義型別(<del>雖然有跟沒有一樣</del>)，透過一些 <a href=\"https://marshmallow.readthedocs.io/en/stable/\" target=\"_blank\" rel=\"noopener\">marshmallow</a> 或是 <a href=\"https://pydantic-docs.helpmanual.io/\" target=\"_blank\" rel=\"noopener\">pydantic</a> 可以做到這件事，因此這個段落就在講這件事情。</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/MYGwhgzhAEAiD2BzaBvAUNT0BGAnApvgCYBc0EALrgJYB2iGWw8tluArsBfLgBR6FS5KnUQBKVIyxYKAC2oQAdAOLQAvDgLEp0AL5p9aAGbtaXai2gAHGrQoJEvIkjIOJ6ac1bwQ+RSCReACIHMiDoAGpoZ0RlLSIxAzQ0UEgYAGEwCklpFSE2UR0vNk5uPjyyAvp3HWk5BTjBdU1BHX1DYuyIWUgKMGbafAB3aEyKYIBZMDp8UfgWIMSbOntA7t6wMSA\" target=\"_blank\" rel=\"noopener\">TypeScript playground</a></p>\n</blockquote>\n<p>使用範例:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Dog</span> </span>&#123;</span><br><span class=\"line\">    breed: string</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(breed: string) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.breed = breed</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>After defining that, TypeScript allows you to use the class name as a type so you could write a function like:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">printDog</span>(<span class=\"params\">dog: Dog</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Dog: \"</span> + dog.breed)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-多型別問題\"><a href=\"#3-多型別問題\" class=\"headerlink\" title=\"3. 多型別問題\"></a>3. 多型別問題</h2><p>TypeScript 中其中一個功能是可以定義一個變數擁有多型別，基本上在使用時都在最上層 object 的話沒問題，但若判斷第二層之後的 Object 並回傳第一層的 object 則會噴錯。</p>\n<p>試玩一下可以更清楚這個行為發生的原因喔!</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5MOAD3RHQFsBPALlwKOYGcAHCBYCFhgIgDCcEMBbJ4VYABtgcKKL5NCAXyXIARnIDWDFmHkhMeVXlCRYiFELCNmJcpVoN8zVhy49+AMQgyxCODAAVxZFZlVmKgh0AHddfVAjEzAaDmQAQREqOClkAF5ka2QAHzQsPDwYIJAEMGAKZGFgbKkAOXRRCAAKJpaGTOacgEp4g2wXImAYZB6snIA6ewpqGnn2Tm4xPILBJrEJaVl5UKHbV0IoCGCoEEa5qXnNKC01ZWRfFhQJ88vr296FlFYq9jEA\" target=\"_blank\" rel=\"noopener\">TypeScript</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然現在 TypeScript 越來越多人用，如果想要很完善的型別定義以及一致性可能不適合，但若想要在 Javascript 基礎中使用或練習一些型別定義的話他就很適合了。</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ol>\n<li><a href=\"https://blog.asana.com/2020/01/typescript-quirks\" target=\"_blank\" rel=\"noopener\">TypeScript’s quirks: How inconsistencies make the language more complex</a></li>\n</ol>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>有一次在網路上閒逛的時候看到了<a href=\"https://blog.asana.com/2020/01/typescript-quirks/\" target=\"_blank\" rel=\"noopener\">這篇部落格</a>，裡頭透過一些簡單的敘述來展示 Typescript 跟別人不太一樣的地方，也說到一些需要注意的眉角，這次文章則含有些許的文章翻譯以及個人評述在裡面，以下就開始吧！</p>\n<h1 id=\"三個項目\"><a href=\"#三個項目\" class=\"headerlink\" title=\"三個項目\"></a>三個項目</h1>","more":"<h2 id=\"1-解釋-Interface-在加入額外參數時所會遇到的問題\"><a href=\"#1-解釋-Interface-在加入額外參數時所會遇到的問題\" class=\"headerlink\" title=\"1. 解釋 Interface 在加入額外參數時所會遇到的問題\"></a>1. 解釋 Interface 在加入額外參數時所會遇到的問題</h2><p>interface 必須 assign 給一個參數，若直接傳入則會出錯，雖然 TypeScript 可以多傳其他不相關的 key，但它嚴格限制沒有 assign 的使用方式</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5AIygggBMAuZAZTClEzwF888YBXEBMYdEMgAOjcBkwAKClhriAlLgJEEAgM7oANhAB0GrBIBE4mgeQBqZNMzbS5CnNbsVIVWGSYm0ZAF5FREmSUJgCCwGQUcFoGADRKhHCYEDQAzI4ioGDiEh4giVAOeOli+vj+tkHIBqHhkRAxccgJScipLHJAA\" target=\"_blank\" rel=\"noopener\">TypeScript playground</a></p>\n</blockquote>\n<p>以下兩個就是使用上的區別</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ginger = &#123;</span><br><span class=\"line\">    breed: <span class=\"string\">\"Airedale\"</span>,</span><br><span class=\"line\">    age: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">printDog(ginger)</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; Dog:Airedale</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printDog(&#123;</span><br><span class=\"line\">    breed: <span class=\"string\">\"Airedale\"</span>,</span><br><span class=\"line\">    age: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">Argument <span class=\"keyword\">of</span> type <span class=\"string\">'&#123; breed: string; age: number; &#125;'</span> is not assignable to parameter <span class=\"keyword\">of</span> type <span class=\"string\">'Dog'</span>.</span><br><span class=\"line\">  <span class=\"built_in\">Object</span> literal may only specify known properties, and <span class=\"string\">'age'</span> does not exist <span class=\"keyword\">in</span> type <span class=\"string\">'Dog'</span>.</span><br></pre></td></tr></table></figure>\n\n<p>所以若會傳 Object 進去函式的話要注意一下 parameter 接收值的類型喔！</p>\n<h2 id=\"2-Class-也可以當作型別\"><a href=\"#2-Class-也可以當作型別\" class=\"headerlink\" title=\"2. Class 也可以當作型別\"></a>2. Class 也可以當作型別</h2><p>一般來說使用 TypeScript 要做型別檢查時第一個想法一定是用 Interface 來處理，這點就跟 Golang 使用的方法相似，但除了用 Interface 來定義型別以為，也可以像 python 用 class 來定義，Python 3 之後可以定義型別(<del>雖然有跟沒有一樣</del>)，透過一些 <a href=\"https://marshmallow.readthedocs.io/en/stable/\" target=\"_blank\" rel=\"noopener\">marshmallow</a> 或是 <a href=\"https://pydantic-docs.helpmanual.io/\" target=\"_blank\" rel=\"noopener\">pydantic</a> 可以做到這件事，因此這個段落就在講這件事情。</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/MYGwhgzhAEAiD2BzaBvAUNT0BGAnApvgCYBc0EALrgJYB2iGWw8tluArsBfLgBR6FS5KnUQBKVIyxYKAC2oQAdAOLQAvDgLEp0AL5p9aAGbtaXai2gAHGrQoJEvIkjIOJ6ac1bwQ+RSCReACIHMiDoAGpoZ0RlLSIxAzQ0UEgYAGEwCklpFSE2UR0vNk5uPjyyAvp3HWk5BTjBdU1BHX1DYuyIWUgKMGbafAB3aEyKYIBZMDp8UfgWIMSbOntA7t6wMSA\" target=\"_blank\" rel=\"noopener\">TypeScript playground</a></p>\n</blockquote>\n<p>使用範例:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Dog</span> </span>&#123;</span><br><span class=\"line\">    breed: string</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(breed: string) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.breed = breed</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>After defining that, TypeScript allows you to use the class name as a type so you could write a function like:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">printDog</span>(<span class=\"params\">dog: Dog</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Dog: \"</span> + dog.breed)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-多型別問題\"><a href=\"#3-多型別問題\" class=\"headerlink\" title=\"3. 多型別問題\"></a>3. 多型別問題</h2><p>TypeScript 中其中一個功能是可以定義一個變數擁有多型別，基本上在使用時都在最上層 object 的話沒問題，但若判斷第二層之後的 Object 並回傳第一層的 object 則會噴錯。</p>\n<p>試玩一下可以更清楚這個行為發生的原因喔!</p>\n<blockquote>\n<p>範例參考: <a href=\"https://www.typescriptlang.org/play/index.html#code/JYOwLgpgTgZghgYwgAgCIHsDmyDeAoZQ5MOAD3RHQFsBPALlwKOYGcAHCBYCFhgIgDCcEMBbJ4VYABtgcKKL5NCAXyXIARnIDWDFmHkhMeVXlCRYiFELCNmJcpVoN8zVhy49+AMQgyxCODAAVxZFZlVmKgh0AHddfVAjEzAaDmQAQREqOClkAF5ka2QAHzQsPDwYIJAEMGAKZGFgbKkAOXRRCAAKJpaGTOacgEp4g2wXImAYZB6snIA6ewpqGnn2Tm4xPILBJrEJaVl5UKHbV0IoCGCoEEa5qXnNKC01ZWRfFhQJ88vr296FlFYq9jEA\" target=\"_blank\" rel=\"noopener\">TypeScript</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然現在 TypeScript 越來越多人用，如果想要很完善的型別定義以及一致性可能不適合，但若想要在 Javascript 基礎中使用或練習一些型別定義的話他就很適合了。</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ol>\n<li><a href=\"https://blog.asana.com/2020/01/typescript-quirks\" target=\"_blank\" rel=\"noopener\">TypeScript’s quirks: How inconsistencies make the language more complex</a></li>\n</ol>"},{"title":"Chatbot meetup 北部 #13 at 台北商業大學 & 中部 #3 at 夢森林","abbrlink":2496230010,"date":"2019-10-25T08:59:43.000Z","_content":"\n![](https://i.imgur.com/P3F7Xjp.png)\n\n# 前言\n\n大家好，我是 NiJia，很榮幸被邀...是本來就負責 Chatbot meetup 的 Co-organizer，連續兩天參加了 meetup 真的是揮灑自己熱情兩邊跑(好 High)，希望藉由社群的分享讓大家可以吸收到不同的新知！\n\n- 北部小聚 #13 連結: https://chatbots.kktix.cc/events/chatb13ts\n- 中部小聚 #3 連結: https://chatbots.kktix.cc/events/chatbots-taichung-003\n- 共筆: https://beta.hackfoldr.org/chatbot/\n\n這次活動場地感謝 溫明輝 教授幫 chatbot 借了台北商業大學的場地，而台北商業大學最近有跟 LINE PROTOSTAR 聯合舉辦了 ”LINE Chatbot 對話機器人設計大賽”，覺得自己的機器人不錯嘛？歡迎大家踴躍報名參賽哦！\n\n# 北部小聚 in 台北商業大學\n\n## LINE Platform Update 201910 - Evan Lin\n\n<script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"36b3e28d2a3f4e489250cbe7d84234a4\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n長期支持 Chatbot 社群的 [Evan 大大](https://www.evanlin.com/chatbot13/)為大家帶來陣子 LINE 的更新內容，像我這種開發者最期待的就是 LIFF v2 終於上線了 🎉，當中增加了很多種應用讓嗷嗷待哺的工程師們終於可以生出更多種不一樣的應用啦，\n\n- 外部瀏覽器上使用 LIFF 🎉\n- 兼容 Login v2.1，取得使用者基本資訊\n- 可掃描 QR code\n- 在 LIFF 的 webview 下可獲取使用者的 OS/Language/AccessToken 等等的內容\n\n詳細參考: https://engineering.linecorp.com/ja/blog/liff-v2/\n\n試玩新功能：\n![](https://i.imgur.com/zHx9RcBm.png)\n\n## LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯\n\n### [簡報連結](https://docs.google.com/presentation/d/1MNCbVIsMoLAWtPjg22e1-_3PLA2OpyHKSAIvw53Vdsk/edit#slide=id.g654c56bcd3_0_5)\n\n身為卡米粉的我終於再度聽到卡米哥的議程啦，這次介紹的是從 COSCUP 之後一直更新的 [kamigo](https://github.com/etrex/kamigo)，並完全使用這個套件做的寵物協尋機器人，此議程就已這隻機器人為主體介紹。\n\n在實作網頁的過程中最長需要弄的東西不外乎就是表單驗證、搜尋以及分頁，因為 kamigo 是讓使用者經由 LIFF 幫忙將表單回傳成一份 JSON 至使用者的的對話欄上，\n再轉介給 controller 去解析並儲存進資料庫，但若使用者在操作的過程中少輸入會不會一樣送出？\n此時 kamigo 透過 rails 原生既有的 `validates` 來驗證表單欄位內容，並藉由 Turbolinks ajax + js.erb 讓表單在送出時先透過 ajax 打到後端驗證，若驗證失敗後則回傳告知 LIFF 哪個欄位有問題，這個方法也讓我使用到這個套件的[肌肉仔](https://github.com/louis70109/muscle_man)可以透過 rails 的鬼神方法幫我驗證表單，如此一來在表單的確認上就沒問題啦！🎉\n\n順手捐星星，救救卡米狗: https://github.com/etrex/kamigo\n\n## 不懂開發也能建立屬於自己的 Chatbot - 白凱仁\n\n<script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"4386dd5577e74e528b353d1f56c8a201\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n接著由 Cloud Native Taiwan User Group Co-organizer - Kyle Bai 為大家帶來講題，藉由故事的敘述讓大家知道他是為甚麼啟動這個 idea 出來，並靈活運用圖片演示對話流程(筆記)，並因為打遊戲的困擾決定做一個機器人來解決朋友問題，運用 container 的技術來封裝 chatbot App，再用 k8s 透過 N 台機器來管理 container 讓它獲得不死之握能力，確保服務的可用性與延展性。\n\n最後再透過 live demo 的方式讓會眾們一飽眼福，若是對於 Cloud Native 相關技術有興趣的朋友別忘了[加入社群](https://www.facebook.com/groups/cloudnative.tw/)，或是你已經有相關主題遲遲沒地方講？趕快搭上線讓你有舞台可以發揮 😎\n\n## 閃電秀\n\n這部分就參考 Evan 大大的[文章](https://www.evanlin.com/chatbot13/#閃電秀)\n\n- Afore: 如何用 Chatbot 說 921 故事\n- 謝化挺: 921 Chatbot 開發心得\n- C.T Lin: 介紹即將發佈的 Bottender v1\n- kevin: 宣傳 DevFest 活動\n- Demo: FunWater - It’s time to rethink about the “single-use plastic” product.\n\n# 中部小聚 in 夢森林\n\n## LINE Pay 串接全紀錄 - KoKo\n\n身為通勤學的作者也是自由工作者的 KoKo 每次都熱情參加 Chatbot 的活動 👏，本次邀請來帶大家認識 LINE Pay，透過詳細的介紹 LINE Pay 帶著大家一步一步做並提醒大家當中需要注意的部分，有部分的會眾是金融相關背景也特地來了解 LINE Pay 的各種機制，透過 KoKo 解釋後讓會眾更清楚裡頭眉眉角角，此時真的是感受到滿滿的熱情，講者跟會眾踴躍的討論也讓整個活動更活絡，想了解更多議題的歡迎來許願或是來當講者體驗一下中部人真正的活力啊！\n\n## serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy\n\nCOSCUP 就來擔任 Chatbot Taiwan 講者的 Jimmy，本次來分享他包起來的 servo 的容器服務，主要原因是因為在開發機器人時大家都習慣用 ngrok，只是每次都要重新執行重新貼到 LINE Bot 或 LIFF 上，如此繁雜的步驟現在只要透過 container 以及自定義的 DNS 每次只要 docker 啟動後 Domain 啟動後即可開始寫機器人，根本不需要再進後台重新填寫，只能說工程師沒有極限啊！\n\n透過 Jimmy 將 serveo 打包的 container 就不會有連線不穩定的問題(我有經歷過 🤣)，這邊需要注意的問題 serveo 有 ssh 連線數的問題，但一般來說在開發人數不會太多，這樣理論上已經很夠用了～\n\n若對這服務有興趣的話：https://github.com/taichunmin/docker-serveo\n\n## 閃電秀\n\n### 感謝 Flex Simulator 拯救了我 - 陳佳新\n\n身為中部負責人的佳新，介紹 LINE 的工具 - [Flex Message Simulator](https://developers.line.biz/console/fx/)，因為應用大量的 flex message 在自家產品「彰化旅行+」上，透過 LINE 的工具讓我們使用 flex message 上能夠叫得心應手。\n\n### ChatBot 製造 ChatBot - EJ Lin\n\n近期加入 chatbot 志工的 EJ 製作了一個可以透過 chatbot 管理 chatbot 的服務，將使用者所註冊機器人的 secret 以及 token 放入後，就能訂閱 ptt 特定作者的文章，當作者只要發文就會透過 push message 通知訂閱的人，若這邊 500 則免費訊息用完的話就建議使用者在開新的 🤣\n\n### 肌肉仔更新啦 - NiJia Lin\n\n最後則是我前一陣子分享過的健身記錄機器人-[肌肉仔](https://github.com/louis70109/muscle_man)，引入了最新更新的 flex message 站牌樣板，讓健身者在訓練的每筆紀錄變得更漂亮，讓健身者可以像是公車一樣一步一步的往下一站走！\n\n肌肉仔還是會持續更新，有興趣的朋友別忘了幫小弟按個星星 ⭐️ 鼓勵我繼續前進 😃\n\n- 連結：https://github.com/louis70109/muscle_man\n\n# 結論\n\n臺北臺中連著兩天舉辦真的是很累，但是看到大家踴躍的互動讓我覺得不虛此行，接下來還需要大家的熱情支持，讓我們繼續辦下去 🚀\n\n---\n\nChatbot Taiwan 在台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot 與 AI，及大家共同關心的話題。歡迎大家踴躍分享、自由與會眾交流，同時也期望大家可以在分享中得到收獲。\n\n歡迎各位報名、推薦講者以及閃電秀，介紹自己開發的 chatbot 並分享 chatbot 相關的議題，若有相關需要合作歡迎與我聯繫 https://m.me/linnijia。\n","source":"_posts/chatbot-13.md","raw":"---\ntitle: 'Chatbot meetup 北部 #13 at 台北商業大學 & 中部 #3 at 夢森林'\ntags:\n  - chatbot\n  - meetup\ncategories: 研討會\nabbrlink: 2496230010\ndate: 2019-10-25 16:59:43\n---\n\n![](https://i.imgur.com/P3F7Xjp.png)\n\n# 前言\n\n大家好，我是 NiJia，很榮幸被邀...是本來就負責 Chatbot meetup 的 Co-organizer，連續兩天參加了 meetup 真的是揮灑自己熱情兩邊跑(好 High)，希望藉由社群的分享讓大家可以吸收到不同的新知！\n\n- 北部小聚 #13 連結: https://chatbots.kktix.cc/events/chatb13ts\n- 中部小聚 #3 連結: https://chatbots.kktix.cc/events/chatbots-taichung-003\n- 共筆: https://beta.hackfoldr.org/chatbot/\n\n這次活動場地感謝 溫明輝 教授幫 chatbot 借了台北商業大學的場地，而台北商業大學最近有跟 LINE PROTOSTAR 聯合舉辦了 ”LINE Chatbot 對話機器人設計大賽”，覺得自己的機器人不錯嘛？歡迎大家踴躍報名參賽哦！\n\n# 北部小聚 in 台北商業大學\n\n## LINE Platform Update 201910 - Evan Lin\n\n<script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"36b3e28d2a3f4e489250cbe7d84234a4\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n長期支持 Chatbot 社群的 [Evan 大大](https://www.evanlin.com/chatbot13/)為大家帶來陣子 LINE 的更新內容，像我這種開發者最期待的就是 LIFF v2 終於上線了 🎉，當中增加了很多種應用讓嗷嗷待哺的工程師們終於可以生出更多種不一樣的應用啦，\n\n- 外部瀏覽器上使用 LIFF 🎉\n- 兼容 Login v2.1，取得使用者基本資訊\n- 可掃描 QR code\n- 在 LIFF 的 webview 下可獲取使用者的 OS/Language/AccessToken 等等的內容\n\n詳細參考: https://engineering.linecorp.com/ja/blog/liff-v2/\n\n試玩新功能：\n![](https://i.imgur.com/zHx9RcBm.png)\n\n## LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯\n\n### [簡報連結](https://docs.google.com/presentation/d/1MNCbVIsMoLAWtPjg22e1-_3PLA2OpyHKSAIvw53Vdsk/edit#slide=id.g654c56bcd3_0_5)\n\n身為卡米粉的我終於再度聽到卡米哥的議程啦，這次介紹的是從 COSCUP 之後一直更新的 [kamigo](https://github.com/etrex/kamigo)，並完全使用這個套件做的寵物協尋機器人，此議程就已這隻機器人為主體介紹。\n\n在實作網頁的過程中最長需要弄的東西不外乎就是表單驗證、搜尋以及分頁，因為 kamigo 是讓使用者經由 LIFF 幫忙將表單回傳成一份 JSON 至使用者的的對話欄上，\n再轉介給 controller 去解析並儲存進資料庫，但若使用者在操作的過程中少輸入會不會一樣送出？\n此時 kamigo 透過 rails 原生既有的 `validates` 來驗證表單欄位內容，並藉由 Turbolinks ajax + js.erb 讓表單在送出時先透過 ajax 打到後端驗證，若驗證失敗後則回傳告知 LIFF 哪個欄位有問題，這個方法也讓我使用到這個套件的[肌肉仔](https://github.com/louis70109/muscle_man)可以透過 rails 的鬼神方法幫我驗證表單，如此一來在表單的確認上就沒問題啦！🎉\n\n順手捐星星，救救卡米狗: https://github.com/etrex/kamigo\n\n## 不懂開發也能建立屬於自己的 Chatbot - 白凱仁\n\n<script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"4386dd5577e74e528b353d1f56c8a201\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n接著由 Cloud Native Taiwan User Group Co-organizer - Kyle Bai 為大家帶來講題，藉由故事的敘述讓大家知道他是為甚麼啟動這個 idea 出來，並靈活運用圖片演示對話流程(筆記)，並因為打遊戲的困擾決定做一個機器人來解決朋友問題，運用 container 的技術來封裝 chatbot App，再用 k8s 透過 N 台機器來管理 container 讓它獲得不死之握能力，確保服務的可用性與延展性。\n\n最後再透過 live demo 的方式讓會眾們一飽眼福，若是對於 Cloud Native 相關技術有興趣的朋友別忘了[加入社群](https://www.facebook.com/groups/cloudnative.tw/)，或是你已經有相關主題遲遲沒地方講？趕快搭上線讓你有舞台可以發揮 😎\n\n## 閃電秀\n\n這部分就參考 Evan 大大的[文章](https://www.evanlin.com/chatbot13/#閃電秀)\n\n- Afore: 如何用 Chatbot 說 921 故事\n- 謝化挺: 921 Chatbot 開發心得\n- C.T Lin: 介紹即將發佈的 Bottender v1\n- kevin: 宣傳 DevFest 活動\n- Demo: FunWater - It’s time to rethink about the “single-use plastic” product.\n\n# 中部小聚 in 夢森林\n\n## LINE Pay 串接全紀錄 - KoKo\n\n身為通勤學的作者也是自由工作者的 KoKo 每次都熱情參加 Chatbot 的活動 👏，本次邀請來帶大家認識 LINE Pay，透過詳細的介紹 LINE Pay 帶著大家一步一步做並提醒大家當中需要注意的部分，有部分的會眾是金融相關背景也特地來了解 LINE Pay 的各種機制，透過 KoKo 解釋後讓會眾更清楚裡頭眉眉角角，此時真的是感受到滿滿的熱情，講者跟會眾踴躍的討論也讓整個活動更活絡，想了解更多議題的歡迎來許願或是來當講者體驗一下中部人真正的活力啊！\n\n## serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy\n\nCOSCUP 就來擔任 Chatbot Taiwan 講者的 Jimmy，本次來分享他包起來的 servo 的容器服務，主要原因是因為在開發機器人時大家都習慣用 ngrok，只是每次都要重新執行重新貼到 LINE Bot 或 LIFF 上，如此繁雜的步驟現在只要透過 container 以及自定義的 DNS 每次只要 docker 啟動後 Domain 啟動後即可開始寫機器人，根本不需要再進後台重新填寫，只能說工程師沒有極限啊！\n\n透過 Jimmy 將 serveo 打包的 container 就不會有連線不穩定的問題(我有經歷過 🤣)，這邊需要注意的問題 serveo 有 ssh 連線數的問題，但一般來說在開發人數不會太多，這樣理論上已經很夠用了～\n\n若對這服務有興趣的話：https://github.com/taichunmin/docker-serveo\n\n## 閃電秀\n\n### 感謝 Flex Simulator 拯救了我 - 陳佳新\n\n身為中部負責人的佳新，介紹 LINE 的工具 - [Flex Message Simulator](https://developers.line.biz/console/fx/)，因為應用大量的 flex message 在自家產品「彰化旅行+」上，透過 LINE 的工具讓我們使用 flex message 上能夠叫得心應手。\n\n### ChatBot 製造 ChatBot - EJ Lin\n\n近期加入 chatbot 志工的 EJ 製作了一個可以透過 chatbot 管理 chatbot 的服務，將使用者所註冊機器人的 secret 以及 token 放入後，就能訂閱 ptt 特定作者的文章，當作者只要發文就會透過 push message 通知訂閱的人，若這邊 500 則免費訊息用完的話就建議使用者在開新的 🤣\n\n### 肌肉仔更新啦 - NiJia Lin\n\n最後則是我前一陣子分享過的健身記錄機器人-[肌肉仔](https://github.com/louis70109/muscle_man)，引入了最新更新的 flex message 站牌樣板，讓健身者在訓練的每筆紀錄變得更漂亮，讓健身者可以像是公車一樣一步一步的往下一站走！\n\n肌肉仔還是會持續更新，有興趣的朋友別忘了幫小弟按個星星 ⭐️ 鼓勵我繼續前進 😃\n\n- 連結：https://github.com/louis70109/muscle_man\n\n# 結論\n\n臺北臺中連著兩天舉辦真的是很累，但是看到大家踴躍的互動讓我覺得不虛此行，接下來還需要大家的熱情支持，讓我們繼續辦下去 🚀\n\n---\n\nChatbot Taiwan 在台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot 與 AI，及大家共同關心的話題。歡迎大家踴躍分享、自由與會眾交流，同時也期望大家可以在分享中得到收獲。\n\n歡迎各位報名、推薦講者以及閃電秀，介紹自己開發的 chatbot 並分享 chatbot 相關的議題，若有相關需要合作歡迎與我聯繫 https://m.me/linnijia。\n","slug":"chatbot-13","published":1,"updated":"2020-06-19T14:03:58.860Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kr00417cripwyhmo3f","content":"<p><img src=\"https://i.imgur.com/P3F7Xjp.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 NiJia，很榮幸被邀…是本來就負責 Chatbot meetup 的 Co-organizer，連續兩天參加了 meetup 真的是揮灑自己熱情兩邊跑(好 High)，希望藉由社群的分享讓大家可以吸收到不同的新知！</p>\n<ul>\n<li>北部小聚 #13 連結: <a href=\"https://chatbots.kktix.cc/events/chatb13ts\" target=\"_blank\" rel=\"noopener\">https://chatbots.kktix.cc/events/chatb13ts</a></li>\n<li>中部小聚 #3 連結: <a href=\"https://chatbots.kktix.cc/events/chatbots-taichung-003\" target=\"_blank\" rel=\"noopener\">https://chatbots.kktix.cc/events/chatbots-taichung-003</a></li>\n<li>共筆: <a href=\"https://beta.hackfoldr.org/chatbot/\" target=\"_blank\" rel=\"noopener\">https://beta.hackfoldr.org/chatbot/</a></li>\n</ul>\n<p>這次活動場地感謝 溫明輝 教授幫 chatbot 借了台北商業大學的場地，而台北商業大學最近有跟 LINE PROTOSTAR 聯合舉辦了 ”LINE Chatbot 對話機器人設計大賽”，覺得自己的機器人不錯嘛？歡迎大家踴躍報名參賽哦！</p>\n<h1 id=\"北部小聚-in-台北商業大學\"><a href=\"#北部小聚-in-台北商業大學\" class=\"headerlink\" title=\"北部小聚 in 台北商業大學\"></a>北部小聚 in 台北商業大學</h1><h2 id=\"LINE-Platform-Update-201910-Evan-Lin\"><a href=\"#LINE-Platform-Update-201910-Evan-Lin\" class=\"headerlink\" title=\"LINE Platform Update 201910 - Evan Lin\"></a>LINE Platform Update 201910 - Evan Lin</h2><script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"36b3e28d2a3f4e489250cbe7d84234a4\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>長期支持 Chatbot 社群的 <a href=\"https://www.evanlin.com/chatbot13/\" target=\"_blank\" rel=\"noopener\">Evan 大大</a>為大家帶來陣子 LINE 的更新內容，像我這種開發者最期待的就是 LIFF v2 終於上線了 🎉，當中增加了很多種應用讓嗷嗷待哺的工程師們終於可以生出更多種不一樣的應用啦，</p>\n<ul>\n<li>外部瀏覽器上使用 LIFF 🎉</li>\n<li>兼容 Login v2.1，取得使用者基本資訊</li>\n<li>可掃描 QR code</li>\n<li>在 LIFF 的 webview 下可獲取使用者的 OS/Language/AccessToken 等等的內容</li>\n</ul>\n<p>詳細參考: <a href=\"https://engineering.linecorp.com/ja/blog/liff-v2/\" target=\"_blank\" rel=\"noopener\">https://engineering.linecorp.com/ja/blog/liff-v2/</a></p>\n<p>試玩新功能：<br><img src=\"https://i.imgur.com/zHx9RcBm.png\" alt></p>\n<h2 id=\"LINE-Bot-上的表單驗證、搜尋以及分頁-郭佳甯\"><a href=\"#LINE-Bot-上的表單驗證、搜尋以及分頁-郭佳甯\" class=\"headerlink\" title=\"LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯\"></a>LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯</h2><h3 id=\"簡報連結\"><a href=\"#簡報連結\" class=\"headerlink\" title=\"簡報連結\"></a><a href=\"https://docs.google.com/presentation/d/1MNCbVIsMoLAWtPjg22e1-_3PLA2OpyHKSAIvw53Vdsk/edit#slide=id.g654c56bcd3_0_5\" target=\"_blank\" rel=\"noopener\">簡報連結</a></h3><p>身為卡米粉的我終於再度聽到卡米哥的議程啦，這次介紹的是從 COSCUP 之後一直更新的 <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">kamigo</a>，並完全使用這個套件做的寵物協尋機器人，此議程就已這隻機器人為主體介紹。</p>\n<p>在實作網頁的過程中最長需要弄的東西不外乎就是表單驗證、搜尋以及分頁，因為 kamigo 是讓使用者經由 LIFF 幫忙將表單回傳成一份 JSON 至使用者的的對話欄上，<br>再轉介給 controller 去解析並儲存進資料庫，但若使用者在操作的過程中少輸入會不會一樣送出？<br>此時 kamigo 透過 rails 原生既有的 <code>validates</code> 來驗證表單欄位內容，並藉由 Turbolinks ajax + js.erb 讓表單在送出時先透過 ajax 打到後端驗證，若驗證失敗後則回傳告知 LIFF 哪個欄位有問題，這個方法也讓我使用到這個套件的<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a>可以透過 rails 的鬼神方法幫我驗證表單，如此一來在表單的確認上就沒問題啦！🎉</p>\n<p>順手捐星星，救救卡米狗: <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">https://github.com/etrex/kamigo</a></p>\n<h2 id=\"不懂開發也能建立屬於自己的-Chatbot-白凱仁\"><a href=\"#不懂開發也能建立屬於自己的-Chatbot-白凱仁\" class=\"headerlink\" title=\"不懂開發也能建立屬於自己的 Chatbot - 白凱仁\"></a>不懂開發也能建立屬於自己的 Chatbot - 白凱仁</h2><script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"4386dd5577e74e528b353d1f56c8a201\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>接著由 Cloud Native Taiwan User Group Co-organizer - Kyle Bai 為大家帶來講題，藉由故事的敘述讓大家知道他是為甚麼啟動這個 idea 出來，並靈活運用圖片演示對話流程(筆記)，並因為打遊戲的困擾決定做一個機器人來解決朋友問題，運用 container 的技術來封裝 chatbot App，再用 k8s 透過 N 台機器來管理 container 讓它獲得不死之握能力，確保服務的可用性與延展性。</p>\n<p>最後再透過 live demo 的方式讓會眾們一飽眼福，若是對於 Cloud Native 相關技術有興趣的朋友別忘了<a href=\"https://www.facebook.com/groups/cloudnative.tw/\" target=\"_blank\" rel=\"noopener\">加入社群</a>，或是你已經有相關主題遲遲沒地方講？趕快搭上線讓你有舞台可以發揮 😎</p>\n<h2 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h2><p>這部分就參考 Evan 大大的<a href=\"https://www.evanlin.com/chatbot13/#閃電秀\" target=\"_blank\" rel=\"noopener\">文章</a></p>\n<ul>\n<li>Afore: 如何用 Chatbot 說 921 故事</li>\n<li>謝化挺: 921 Chatbot 開發心得</li>\n<li>C.T Lin: 介紹即將發佈的 Bottender v1</li>\n<li>kevin: 宣傳 DevFest 活動</li>\n<li>Demo: FunWater - It’s time to rethink about the “single-use plastic” product.</li>\n</ul>\n<h1 id=\"中部小聚-in-夢森林\"><a href=\"#中部小聚-in-夢森林\" class=\"headerlink\" title=\"中部小聚 in 夢森林\"></a>中部小聚 in 夢森林</h1><h2 id=\"LINE-Pay-串接全紀錄-KoKo\"><a href=\"#LINE-Pay-串接全紀錄-KoKo\" class=\"headerlink\" title=\"LINE Pay 串接全紀錄 - KoKo\"></a>LINE Pay 串接全紀錄 - KoKo</h2><p>身為通勤學的作者也是自由工作者的 KoKo 每次都熱情參加 Chatbot 的活動 👏，本次邀請來帶大家認識 LINE Pay，透過詳細的介紹 LINE Pay 帶著大家一步一步做並提醒大家當中需要注意的部分，有部分的會眾是金融相關背景也特地來了解 LINE Pay 的各種機制，透過 KoKo 解釋後讓會眾更清楚裡頭眉眉角角，此時真的是感受到滿滿的熱情，講者跟會眾踴躍的討論也讓整個活動更活絡，想了解更多議題的歡迎來許願或是來當講者體驗一下中部人真正的活力啊！</p>\n<h2 id=\"serveo-讓你用-Docker-開發-chatbot-也能過的去-Jimmy\"><a href=\"#serveo-讓你用-Docker-開發-chatbot-也能過的去-Jimmy\" class=\"headerlink\" title=\"serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy\"></a>serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy</h2><p>COSCUP 就來擔任 Chatbot Taiwan 講者的 Jimmy，本次來分享他包起來的 servo 的容器服務，主要原因是因為在開發機器人時大家都習慣用 ngrok，只是每次都要重新執行重新貼到 LINE Bot 或 LIFF 上，如此繁雜的步驟現在只要透過 container 以及自定義的 DNS 每次只要 docker 啟動後 Domain 啟動後即可開始寫機器人，根本不需要再進後台重新填寫，只能說工程師沒有極限啊！</p>\n<p>透過 Jimmy 將 serveo 打包的 container 就不會有連線不穩定的問題(我有經歷過 🤣)，這邊需要注意的問題 serveo 有 ssh 連線數的問題，但一般來說在開發人數不會太多，這樣理論上已經很夠用了～</p>\n<p>若對這服務有興趣的話：<a href=\"https://github.com/taichunmin/docker-serveo\" target=\"_blank\" rel=\"noopener\">https://github.com/taichunmin/docker-serveo</a></p>\n<h2 id=\"閃電秀-1\"><a href=\"#閃電秀-1\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h2><h3 id=\"感謝-Flex-Simulator-拯救了我-陳佳新\"><a href=\"#感謝-Flex-Simulator-拯救了我-陳佳新\" class=\"headerlink\" title=\"感謝 Flex Simulator 拯救了我 - 陳佳新\"></a>感謝 Flex Simulator 拯救了我 - 陳佳新</h3><p>身為中部負責人的佳新，介紹 LINE 的工具 - <a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a>，因為應用大量的 flex message 在自家產品「彰化旅行+」上，透過 LINE 的工具讓我們使用 flex message 上能夠叫得心應手。</p>\n<h3 id=\"ChatBot-製造-ChatBot-EJ-Lin\"><a href=\"#ChatBot-製造-ChatBot-EJ-Lin\" class=\"headerlink\" title=\"ChatBot 製造 ChatBot - EJ Lin\"></a>ChatBot 製造 ChatBot - EJ Lin</h3><p>近期加入 chatbot 志工的 EJ 製作了一個可以透過 chatbot 管理 chatbot 的服務，將使用者所註冊機器人的 secret 以及 token 放入後，就能訂閱 ptt 特定作者的文章，當作者只要發文就會透過 push message 通知訂閱的人，若這邊 500 則免費訊息用完的話就建議使用者在開新的 🤣</p>\n<h3 id=\"肌肉仔更新啦-NiJia-Lin\"><a href=\"#肌肉仔更新啦-NiJia-Lin\" class=\"headerlink\" title=\"肌肉仔更新啦 - NiJia Lin\"></a>肌肉仔更新啦 - NiJia Lin</h3><p>最後則是我前一陣子分享過的健身記錄機器人-<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a>，引入了最新更新的 flex message 站牌樣板，讓健身者在訓練的每筆紀錄變得更漂亮，讓健身者可以像是公車一樣一步一步的往下一站走！</p>\n<p>肌肉仔還是會持續更新，有興趣的朋友別忘了幫小弟按個星星 ⭐️ 鼓勵我繼續前進 😃</p>\n<ul>\n<li>連結：<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/muscle_man</a></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>臺北臺中連著兩天舉辦真的是很累，但是看到大家踴躍的互動讓我覺得不虛此行，接下來還需要大家的熱情支持，讓我們繼續辦下去 🚀</p>\n<hr>\n<p>Chatbot Taiwan 在台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot 與 AI，及大家共同關心的話題。歡迎大家踴躍分享、自由與會眾交流，同時也期望大家可以在分享中得到收獲。</p>\n<p>歡迎各位報名、推薦講者以及閃電秀，介紹自己開發的 chatbot 並分享 chatbot 相關的議題，若有相關需要合作歡迎與我聯繫 <a href=\"https://m.me/linnijia。\" target=\"_blank\" rel=\"noopener\">https://m.me/linnijia。</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://i.imgur.com/P3F7Xjp.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 NiJia，很榮幸被邀…是本來就負責 Chatbot meetup 的 Co-organizer，連續兩天參加了 meetup 真的是揮灑自己熱情兩邊跑(好 High)，希望藉由社群的分享讓大家可以吸收到不同的新知！</p>\n<ul>\n<li>北部小聚 #13 連結: <a href=\"https://chatbots.kktix.cc/events/chatb13ts\" target=\"_blank\" rel=\"noopener\">https://chatbots.kktix.cc/events/chatb13ts</a></li>\n<li>中部小聚 #3 連結: <a href=\"https://chatbots.kktix.cc/events/chatbots-taichung-003\" target=\"_blank\" rel=\"noopener\">https://chatbots.kktix.cc/events/chatbots-taichung-003</a></li>\n<li>共筆: <a href=\"https://beta.hackfoldr.org/chatbot/\" target=\"_blank\" rel=\"noopener\">https://beta.hackfoldr.org/chatbot/</a></li>\n</ul>\n<p>這次活動場地感謝 溫明輝 教授幫 chatbot 借了台北商業大學的場地，而台北商業大學最近有跟 LINE PROTOSTAR 聯合舉辦了 ”LINE Chatbot 對話機器人設計大賽”，覺得自己的機器人不錯嘛？歡迎大家踴躍報名參賽哦！</p>\n<h1 id=\"北部小聚-in-台北商業大學\"><a href=\"#北部小聚-in-台北商業大學\" class=\"headerlink\" title=\"北部小聚 in 台北商業大學\"></a>北部小聚 in 台北商業大學</h1><h2 id=\"LINE-Platform-Update-201910-Evan-Lin\"><a href=\"#LINE-Platform-Update-201910-Evan-Lin\" class=\"headerlink\" title=\"LINE Platform Update 201910 - Evan Lin\"></a>LINE Platform Update 201910 - Evan Lin</h2><script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"36b3e28d2a3f4e489250cbe7d84234a4\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>長期支持 Chatbot 社群的 <a href=\"https://www.evanlin.com/chatbot13/\" target=\"_blank\" rel=\"noopener\">Evan 大大</a>為大家帶來陣子 LINE 的更新內容，像我這種開發者最期待的就是 LIFF v2 終於上線了 🎉，當中增加了很多種應用讓嗷嗷待哺的工程師們終於可以生出更多種不一樣的應用啦，</p>\n<ul>\n<li>外部瀏覽器上使用 LIFF 🎉</li>\n<li>兼容 Login v2.1，取得使用者基本資訊</li>\n<li>可掃描 QR code</li>\n<li>在 LIFF 的 webview 下可獲取使用者的 OS/Language/AccessToken 等等的內容</li>\n</ul>\n<p>詳細參考: <a href=\"https://engineering.linecorp.com/ja/blog/liff-v2/\" target=\"_blank\" rel=\"noopener\">https://engineering.linecorp.com/ja/blog/liff-v2/</a></p>\n<p>試玩新功能：<br><img src=\"https://i.imgur.com/zHx9RcBm.png\" alt></p>\n<h2 id=\"LINE-Bot-上的表單驗證、搜尋以及分頁-郭佳甯\"><a href=\"#LINE-Bot-上的表單驗證、搜尋以及分頁-郭佳甯\" class=\"headerlink\" title=\"LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯\"></a>LINE Bot 上的表單驗證、搜尋以及分頁 - 郭佳甯</h2><h3 id=\"簡報連結\"><a href=\"#簡報連結\" class=\"headerlink\" title=\"簡報連結\"></a><a href=\"https://docs.google.com/presentation/d/1MNCbVIsMoLAWtPjg22e1-_3PLA2OpyHKSAIvw53Vdsk/edit#slide=id.g654c56bcd3_0_5\" target=\"_blank\" rel=\"noopener\">簡報連結</a></h3><p>身為卡米粉的我終於再度聽到卡米哥的議程啦，這次介紹的是從 COSCUP 之後一直更新的 <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">kamigo</a>，並完全使用這個套件做的寵物協尋機器人，此議程就已這隻機器人為主體介紹。</p>\n<p>在實作網頁的過程中最長需要弄的東西不外乎就是表單驗證、搜尋以及分頁，因為 kamigo 是讓使用者經由 LIFF 幫忙將表單回傳成一份 JSON 至使用者的的對話欄上，<br>再轉介給 controller 去解析並儲存進資料庫，但若使用者在操作的過程中少輸入會不會一樣送出？<br>此時 kamigo 透過 rails 原生既有的 <code>validates</code> 來驗證表單欄位內容，並藉由 Turbolinks ajax + js.erb 讓表單在送出時先透過 ajax 打到後端驗證，若驗證失敗後則回傳告知 LIFF 哪個欄位有問題，這個方法也讓我使用到這個套件的<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a>可以透過 rails 的鬼神方法幫我驗證表單，如此一來在表單的確認上就沒問題啦！🎉</p>\n<p>順手捐星星，救救卡米狗: <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">https://github.com/etrex/kamigo</a></p>\n<h2 id=\"不懂開發也能建立屬於自己的-Chatbot-白凱仁\"><a href=\"#不懂開發也能建立屬於自己的-Chatbot-白凱仁\" class=\"headerlink\" title=\"不懂開發也能建立屬於自己的 Chatbot - 白凱仁\"></a>不懂開發也能建立屬於自己的 Chatbot - 白凱仁</h2><script async class=\"speakerdeck-embed\" data-slide=\"1\" data-id=\"4386dd5577e74e528b353d1f56c8a201\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>接著由 Cloud Native Taiwan User Group Co-organizer - Kyle Bai 為大家帶來講題，藉由故事的敘述讓大家知道他是為甚麼啟動這個 idea 出來，並靈活運用圖片演示對話流程(筆記)，並因為打遊戲的困擾決定做一個機器人來解決朋友問題，運用 container 的技術來封裝 chatbot App，再用 k8s 透過 N 台機器來管理 container 讓它獲得不死之握能力，確保服務的可用性與延展性。</p>\n<p>最後再透過 live demo 的方式讓會眾們一飽眼福，若是對於 Cloud Native 相關技術有興趣的朋友別忘了<a href=\"https://www.facebook.com/groups/cloudnative.tw/\" target=\"_blank\" rel=\"noopener\">加入社群</a>，或是你已經有相關主題遲遲沒地方講？趕快搭上線讓你有舞台可以發揮 😎</p>\n<h2 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h2><p>這部分就參考 Evan 大大的<a href=\"https://www.evanlin.com/chatbot13/#閃電秀\" target=\"_blank\" rel=\"noopener\">文章</a></p>\n<ul>\n<li>Afore: 如何用 Chatbot 說 921 故事</li>\n<li>謝化挺: 921 Chatbot 開發心得</li>\n<li>C.T Lin: 介紹即將發佈的 Bottender v1</li>\n<li>kevin: 宣傳 DevFest 活動</li>\n<li>Demo: FunWater - It’s time to rethink about the “single-use plastic” product.</li>\n</ul>\n<h1 id=\"中部小聚-in-夢森林\"><a href=\"#中部小聚-in-夢森林\" class=\"headerlink\" title=\"中部小聚 in 夢森林\"></a>中部小聚 in 夢森林</h1><h2 id=\"LINE-Pay-串接全紀錄-KoKo\"><a href=\"#LINE-Pay-串接全紀錄-KoKo\" class=\"headerlink\" title=\"LINE Pay 串接全紀錄 - KoKo\"></a>LINE Pay 串接全紀錄 - KoKo</h2><p>身為通勤學的作者也是自由工作者的 KoKo 每次都熱情參加 Chatbot 的活動 👏，本次邀請來帶大家認識 LINE Pay，透過詳細的介紹 LINE Pay 帶著大家一步一步做並提醒大家當中需要注意的部分，有部分的會眾是金融相關背景也特地來了解 LINE Pay 的各種機制，透過 KoKo 解釋後讓會眾更清楚裡頭眉眉角角，此時真的是感受到滿滿的熱情，講者跟會眾踴躍的討論也讓整個活動更活絡，想了解更多議題的歡迎來許願或是來當講者體驗一下中部人真正的活力啊！</p>\n<h2 id=\"serveo-讓你用-Docker-開發-chatbot-也能過的去-Jimmy\"><a href=\"#serveo-讓你用-Docker-開發-chatbot-也能過的去-Jimmy\" class=\"headerlink\" title=\"serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy\"></a>serveo 讓你用 Docker 開發 chatbot 也能過的去 - Jimmy</h2><p>COSCUP 就來擔任 Chatbot Taiwan 講者的 Jimmy，本次來分享他包起來的 servo 的容器服務，主要原因是因為在開發機器人時大家都習慣用 ngrok，只是每次都要重新執行重新貼到 LINE Bot 或 LIFF 上，如此繁雜的步驟現在只要透過 container 以及自定義的 DNS 每次只要 docker 啟動後 Domain 啟動後即可開始寫機器人，根本不需要再進後台重新填寫，只能說工程師沒有極限啊！</p>\n<p>透過 Jimmy 將 serveo 打包的 container 就不會有連線不穩定的問題(我有經歷過 🤣)，這邊需要注意的問題 serveo 有 ssh 連線數的問題，但一般來說在開發人數不會太多，這樣理論上已經很夠用了～</p>\n<p>若對這服務有興趣的話：<a href=\"https://github.com/taichunmin/docker-serveo\" target=\"_blank\" rel=\"noopener\">https://github.com/taichunmin/docker-serveo</a></p>\n<h2 id=\"閃電秀-1\"><a href=\"#閃電秀-1\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h2><h3 id=\"感謝-Flex-Simulator-拯救了我-陳佳新\"><a href=\"#感謝-Flex-Simulator-拯救了我-陳佳新\" class=\"headerlink\" title=\"感謝 Flex Simulator 拯救了我 - 陳佳新\"></a>感謝 Flex Simulator 拯救了我 - 陳佳新</h3><p>身為中部負責人的佳新，介紹 LINE 的工具 - <a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a>，因為應用大量的 flex message 在自家產品「彰化旅行+」上，透過 LINE 的工具讓我們使用 flex message 上能夠叫得心應手。</p>\n<h3 id=\"ChatBot-製造-ChatBot-EJ-Lin\"><a href=\"#ChatBot-製造-ChatBot-EJ-Lin\" class=\"headerlink\" title=\"ChatBot 製造 ChatBot - EJ Lin\"></a>ChatBot 製造 ChatBot - EJ Lin</h3><p>近期加入 chatbot 志工的 EJ 製作了一個可以透過 chatbot 管理 chatbot 的服務，將使用者所註冊機器人的 secret 以及 token 放入後，就能訂閱 ptt 特定作者的文章，當作者只要發文就會透過 push message 通知訂閱的人，若這邊 500 則免費訊息用完的話就建議使用者在開新的 🤣</p>\n<h3 id=\"肌肉仔更新啦-NiJia-Lin\"><a href=\"#肌肉仔更新啦-NiJia-Lin\" class=\"headerlink\" title=\"肌肉仔更新啦 - NiJia Lin\"></a>肌肉仔更新啦 - NiJia Lin</h3><p>最後則是我前一陣子分享過的健身記錄機器人-<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">肌肉仔</a>，引入了最新更新的 flex message 站牌樣板，讓健身者在訓練的每筆紀錄變得更漂亮，讓健身者可以像是公車一樣一步一步的往下一站走！</p>\n<p>肌肉仔還是會持續更新，有興趣的朋友別忘了幫小弟按個星星 ⭐️ 鼓勵我繼續前進 😃</p>\n<ul>\n<li>連結：<a href=\"https://github.com/louis70109/muscle_man\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/muscle_man</a></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>臺北臺中連著兩天舉辦真的是很累，但是看到大家踴躍的互動讓我覺得不虛此行，接下來還需要大家的熱情支持，讓我們繼續辦下去 🚀</p>\n<hr>\n<p>Chatbot Taiwan 在台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot 與 AI，及大家共同關心的話題。歡迎大家踴躍分享、自由與會眾交流，同時也期望大家可以在分享中得到收獲。</p>\n<p>歡迎各位報名、推薦講者以及閃電秀，介紹自己開發的 chatbot 並分享 chatbot 相關的議題，若有相關需要合作歡迎與我聯繫 <a href=\"https://m.me/linnijia。\" target=\"_blank\" rel=\"noopener\">https://m.me/linnijia。</a></p>\n"},{"title":"Twitch Bot 全面升級！ 增加 LINE Notify 綁定與推播實現 LINE 的三項之力！","abbrlink":3750677153,"date":"2020-03-09T15:18:11.000Z","_content":"\n<img src=\"https://i.imgur.com/dOIsi7H.jpg\" width=\"2000\">\n\n> 滿滿的三項之力 🏋️‍♂️\n\n> 來幫我的 [Twitch Bot](https://github.com/louis70109/Twitch-Bot) 按個星星 ⭐️⭐️\n\n# 更新功能\n\n- 使用 LIFF 來綁定 Notify\n  <!-- more -->\n- 每個小時幫忙檢查訂閱的直播主開了沒\n  - 一天只推播一次絕對不吵你\n  - 還有 deep link 喔！\n\n# 點子來源\n\n最近卡米哥寫了兩篇文章\n\n- LINE Notify - [在 LINE 群組發送免費推播的方法大公開](https://medium.com/@EtrexKuo/%E7%A5%95%E6%8A%80-%E5%9C%A8-line-%E7%BE%A4%E7%B5%84%E7%99%BC%E9%80%81%E5%85%8D%E8%B2%BB%E6%8E%A8%E6%92%AD%E7%9A%84%E6%96%B9%E6%B3%95%E5%A4%A7%E5%85%AC%E9%96%8B-line%E5%AE%98%E6%96%B9%E5%B8%B3%E8%99%9F-2-0-%E9%9B%A3%E6%B0%91%E6%9C%89%E7%A6%8F%E4%BA%86-a4acd323769e)\n- [如何在 Bottender 中使用 LIFF](https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72)\n\n剛好我在同時期遇到了一個問題，就是我開始偷懶越來越少去按圖奇獸查直播了！！這樣感覺我做了這個 side project 就要石沈大海，\b 本篇就來介紹一下我增加了什麼功能～ 👀\n\n# 如何使用\n\n輸入`連結 LINE Notify` 或是點選 Richmenu 最右邊的 🔔 也會幫忙開網頁哦！\n此時 Twitch Bot 會給你一串綁定網址，直接給他點下去。\n![](https://i.imgur.com/OyZy8Ac.jpg)\n\n---\n\n接著到這個畫面之後選擇`透過1對1聊天`的選項，按下同意之後就完成連動囉！\n![](https://i.imgur.com/hHXtNv7l.png)\n\n---\n\n接著要怎麼樣才能讓機器人知道你想被推播什麼？輸入`follow`之後會看到有兩個按鈕，按下面的`綁定通知`的按鈕後 Twitch Bot 會告訴你綁定成功沒，如果已經綁定的話按鈕則會變成灰色，在按下去的話則就是取消綁定囉!\n![](https://i.imgur.com/fdMIr42l.jpg)\n\n---\n\n接著 Twitch Bot 每個小時會幫你去 Twitch API 找找是否有人開台了，只要已經上線的直播主就會被推播，而會分別給兩個連結(Deep link & 一般網址)，但一天只會推播一次同一個直播主，避免每個小時重複通知影響使用者 🙂\n![](https://i.imgur.com/lHoJHT4l.jpg)\n\n# 巧妙結合 LINE Notify 以及 LIFF\n\n有兩個使用方法可以讓 Bot 跟 Notify 結合:\n\n1. 準備打至 Notify 時在 state 欄位上塞入使用者 LINE id，再透過 callback 時帶回來給 api 在藉此存下來，但如此一來比較**方便**但**安全性較不足**些。\n2. 在 callback 後在 LIFF 上透過 client api 去取得當前使用者基本資料，在 call 自己的 api 來讓 Bot 與 Notify 連動，安全性較足但步驟較多。\n\n## 美中不足的結合問題 - query string\n\n在 Twitch Bot 中，我使用 LIFF 來開啟 Notify 是為了要透過 LINE 取得使用者的 ID，使用者選擇綁定之後，LIFF 會預設幫使用者加個 `state` 的 query string 欄位，但同時 Notify 也會把它的 `code` 以及 `state` 也加在 query string 上，如此組合起來網址就會變成：\n\n```\nhttps://liff.line.me?state=code={NOTIFY_CODE}&state={NOTIFY_STATE}\n```\n\n這樣的網址 api 接到之後一定會出問題，所以我就使用以下的 code 來幫我把它處理成我們認識的 query string:\n\n```javascript\nconst query = req.query[\"liff.state\"].split(\"?\")[1].split(\"&\");\nconst notifyPayload = { code: null, state: null };\nquery.forEach(el => {\n  const queryObj = el.split(\"=\");\n  if (queryObj[0] in notifyPayload) notifyPayload[queryObj[0]] = queryObj[1];\n});\n```\n\n這樣 `notifyPayload` 就是我們平常 api 接到的 object 了。\n\n## 使用 ejs 處理前端\n\n以前寫 Rails 很習慣後端直接很習慣後端直接傳值給前端渲染做些簡單的 UI 處理，會使用 ejs 是因為需要讓使用者點選之後透過 LIFF 導到 LINE Notify 去做綁定的動作，因為還是需要簡單的前端功能，就用 ejs 來幫我解決問題囉！\n\n> 以下我則是使用 express 搭配 ejs 做說明\n\n我設定使用者綁定的 api 入口與 LINE Notify 確認綁定完後(`callback`)的 api 入口為:\n\n1. /notify\n   這個 api 做的事情比較簡單，只要負責將環境變數 `CLIENT_ID`、`REDIRECT_URI`、`LIFF_ID` 給前端把使用者導至 LINE Notify 綁定頁面。\n2. /notify/confirm\n   LINE Notify callback 一定要先打到 `後端(backend)` 才行，否則會有 `跨域(CORS)` 的問題，處理的部分可以參考[我的 Github](https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/notifiesController.ts#L5)，處理完後一樣會導到前端畫面去做畫面渲染。\n\n## LIFF 網址設定\n\nLIFF 的申請與操作方法我就先不贅述，可以參考卡米哥的 [Bottender 結合 LIFF 文章](https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72)，但申請的時候要記得是在 LINE Login 申請喔！否則可能會有日後 migration 的問題。\n![Login LIFF](https://i.imgur.com/AcXEDeI.png)\n\n> Tips: 紅色框框名字的部分在轉貼給別人的時候會顯示在視窗上的縮圖喔\n\n在測試環境時 LINE Notify 設定這邊只要一次 LIFF 網址，往後只要在 LINE 後台去調整 webhook 的網址就好， Notify 這邊就不需要再掛心回來這裡設定，只要等到上線時申請再去弄一個即可。\n![LINE Notify callback](https://i.imgur.com/PNVmNmn.png)\n\n# 結論\n\n除了使用 LIFF 綁定 Notify 遇到 query string 部分的問題，其餘在串接上其實都沒障礙，而且也充分展現每個微服務的功能，雖然還是會希望可以讓 Twitch Bot 可以自己發推播，不過既然 LINE 有限制也有解決方案，那就找他們的方法去做吧！\n\n等接下來有空在接上 LINE 最近新出的 ShareTargetPicker 時再來擴增一下圖奇獸～\n\n> ShareTargetPicker 可以參考這個網址: [點我我我我](https://engineering.linecorp.com/zh-hant/blog/share-target-picker-liff/)\n\n三月 [Chatbot Taiwan 小聚](https://chatbots.kktix.cc/events/meetup-017)歡迎大家來參加哦！\n\n> 防疫期間記得要 `多洗手`、`戴口罩`、`保持清潔`！ 防疫從你我做起 🙂\n","source":"_posts/Twitch-Bot-全面升級！.md","raw":"---\ntitle: Twitch Bot 全面升級！ 增加 LINE Notify 綁定與推播實現 LINE 的三項之力！\ntags:\n  - LINE Bot\n  - LINE Notify\n  - LIFF\n  - Twitch\n  - Bottender\ncategories: Chatbot\nabbrlink: 3750677153\ndate: 2020-03-09 23:18:11\n---\n\n<img src=\"https://i.imgur.com/dOIsi7H.jpg\" width=\"2000\">\n\n> 滿滿的三項之力 🏋️‍♂️\n\n> 來幫我的 [Twitch Bot](https://github.com/louis70109/Twitch-Bot) 按個星星 ⭐️⭐️\n\n# 更新功能\n\n- 使用 LIFF 來綁定 Notify\n  <!-- more -->\n- 每個小時幫忙檢查訂閱的直播主開了沒\n  - 一天只推播一次絕對不吵你\n  - 還有 deep link 喔！\n\n# 點子來源\n\n最近卡米哥寫了兩篇文章\n\n- LINE Notify - [在 LINE 群組發送免費推播的方法大公開](https://medium.com/@EtrexKuo/%E7%A5%95%E6%8A%80-%E5%9C%A8-line-%E7%BE%A4%E7%B5%84%E7%99%BC%E9%80%81%E5%85%8D%E8%B2%BB%E6%8E%A8%E6%92%AD%E7%9A%84%E6%96%B9%E6%B3%95%E5%A4%A7%E5%85%AC%E9%96%8B-line%E5%AE%98%E6%96%B9%E5%B8%B3%E8%99%9F-2-0-%E9%9B%A3%E6%B0%91%E6%9C%89%E7%A6%8F%E4%BA%86-a4acd323769e)\n- [如何在 Bottender 中使用 LIFF](https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72)\n\n剛好我在同時期遇到了一個問題，就是我開始偷懶越來越少去按圖奇獸查直播了！！這樣感覺我做了這個 side project 就要石沈大海，\b 本篇就來介紹一下我增加了什麼功能～ 👀\n\n# 如何使用\n\n輸入`連結 LINE Notify` 或是點選 Richmenu 最右邊的 🔔 也會幫忙開網頁哦！\n此時 Twitch Bot 會給你一串綁定網址，直接給他點下去。\n![](https://i.imgur.com/OyZy8Ac.jpg)\n\n---\n\n接著到這個畫面之後選擇`透過1對1聊天`的選項，按下同意之後就完成連動囉！\n![](https://i.imgur.com/hHXtNv7l.png)\n\n---\n\n接著要怎麼樣才能讓機器人知道你想被推播什麼？輸入`follow`之後會看到有兩個按鈕，按下面的`綁定通知`的按鈕後 Twitch Bot 會告訴你綁定成功沒，如果已經綁定的話按鈕則會變成灰色，在按下去的話則就是取消綁定囉!\n![](https://i.imgur.com/fdMIr42l.jpg)\n\n---\n\n接著 Twitch Bot 每個小時會幫你去 Twitch API 找找是否有人開台了，只要已經上線的直播主就會被推播，而會分別給兩個連結(Deep link & 一般網址)，但一天只會推播一次同一個直播主，避免每個小時重複通知影響使用者 🙂\n![](https://i.imgur.com/lHoJHT4l.jpg)\n\n# 巧妙結合 LINE Notify 以及 LIFF\n\n有兩個使用方法可以讓 Bot 跟 Notify 結合:\n\n1. 準備打至 Notify 時在 state 欄位上塞入使用者 LINE id，再透過 callback 時帶回來給 api 在藉此存下來，但如此一來比較**方便**但**安全性較不足**些。\n2. 在 callback 後在 LIFF 上透過 client api 去取得當前使用者基本資料，在 call 自己的 api 來讓 Bot 與 Notify 連動，安全性較足但步驟較多。\n\n## 美中不足的結合問題 - query string\n\n在 Twitch Bot 中，我使用 LIFF 來開啟 Notify 是為了要透過 LINE 取得使用者的 ID，使用者選擇綁定之後，LIFF 會預設幫使用者加個 `state` 的 query string 欄位，但同時 Notify 也會把它的 `code` 以及 `state` 也加在 query string 上，如此組合起來網址就會變成：\n\n```\nhttps://liff.line.me?state=code={NOTIFY_CODE}&state={NOTIFY_STATE}\n```\n\n這樣的網址 api 接到之後一定會出問題，所以我就使用以下的 code 來幫我把它處理成我們認識的 query string:\n\n```javascript\nconst query = req.query[\"liff.state\"].split(\"?\")[1].split(\"&\");\nconst notifyPayload = { code: null, state: null };\nquery.forEach(el => {\n  const queryObj = el.split(\"=\");\n  if (queryObj[0] in notifyPayload) notifyPayload[queryObj[0]] = queryObj[1];\n});\n```\n\n這樣 `notifyPayload` 就是我們平常 api 接到的 object 了。\n\n## 使用 ejs 處理前端\n\n以前寫 Rails 很習慣後端直接很習慣後端直接傳值給前端渲染做些簡單的 UI 處理，會使用 ejs 是因為需要讓使用者點選之後透過 LIFF 導到 LINE Notify 去做綁定的動作，因為還是需要簡單的前端功能，就用 ejs 來幫我解決問題囉！\n\n> 以下我則是使用 express 搭配 ejs 做說明\n\n我設定使用者綁定的 api 入口與 LINE Notify 確認綁定完後(`callback`)的 api 入口為:\n\n1. /notify\n   這個 api 做的事情比較簡單，只要負責將環境變數 `CLIENT_ID`、`REDIRECT_URI`、`LIFF_ID` 給前端把使用者導至 LINE Notify 綁定頁面。\n2. /notify/confirm\n   LINE Notify callback 一定要先打到 `後端(backend)` 才行，否則會有 `跨域(CORS)` 的問題，處理的部分可以參考[我的 Github](https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/notifiesController.ts#L5)，處理完後一樣會導到前端畫面去做畫面渲染。\n\n## LIFF 網址設定\n\nLIFF 的申請與操作方法我就先不贅述，可以參考卡米哥的 [Bottender 結合 LIFF 文章](https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72)，但申請的時候要記得是在 LINE Login 申請喔！否則可能會有日後 migration 的問題。\n![Login LIFF](https://i.imgur.com/AcXEDeI.png)\n\n> Tips: 紅色框框名字的部分在轉貼給別人的時候會顯示在視窗上的縮圖喔\n\n在測試環境時 LINE Notify 設定這邊只要一次 LIFF 網址，往後只要在 LINE 後台去調整 webhook 的網址就好， Notify 這邊就不需要再掛心回來這裡設定，只要等到上線時申請再去弄一個即可。\n![LINE Notify callback](https://i.imgur.com/PNVmNmn.png)\n\n# 結論\n\n除了使用 LIFF 綁定 Notify 遇到 query string 部分的問題，其餘在串接上其實都沒障礙，而且也充分展現每個微服務的功能，雖然還是會希望可以讓 Twitch Bot 可以自己發推播，不過既然 LINE 有限制也有解決方案，那就找他們的方法去做吧！\n\n等接下來有空在接上 LINE 最近新出的 ShareTargetPicker 時再來擴增一下圖奇獸～\n\n> ShareTargetPicker 可以參考這個網址: [點我我我我](https://engineering.linecorp.com/zh-hant/blog/share-target-picker-liff/)\n\n三月 [Chatbot Taiwan 小聚](https://chatbots.kktix.cc/events/meetup-017)歡迎大家來參加哦！\n\n> 防疫期間記得要 `多洗手`、`戴口罩`、`保持清潔`！ 防疫從你我做起 🙂\n","slug":"Twitch-Bot-全面升級！","published":1,"updated":"2020-06-19T14:03:58.859Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kt00457crip8otm7fy","content":"<img src=\"https://i.imgur.com/dOIsi7H.jpg\" width=\"2000\">\n\n<blockquote>\n<p>滿滿的三項之力 🏋️‍♂️</p>\n</blockquote>\n<blockquote>\n<p>來幫我的 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch Bot</a> 按個星星 ⭐️⭐️</p>\n</blockquote>\n<h1 id=\"更新功能\"><a href=\"#更新功能\" class=\"headerlink\" title=\"更新功能\"></a>更新功能</h1><ul>\n<li>使用 LIFF 來綁定 Notify<a id=\"more\"></a></li>\n<li>每個小時幫忙檢查訂閱的直播主開了沒<ul>\n<li>一天只推播一次絕對不吵你</li>\n<li>還有 deep link 喔！</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"點子來源\"><a href=\"#點子來源\" class=\"headerlink\" title=\"點子來源\"></a>點子來源</h1><p>最近卡米哥寫了兩篇文章</p>\n<ul>\n<li>LINE Notify - <a href=\"https://medium.com/@EtrexKuo/%E7%A5%95%E6%8A%80-%E5%9C%A8-line-%E7%BE%A4%E7%B5%84%E7%99%BC%E9%80%81%E5%85%8D%E8%B2%BB%E6%8E%A8%E6%92%AD%E7%9A%84%E6%96%B9%E6%B3%95%E5%A4%A7%E5%85%AC%E9%96%8B-line%E5%AE%98%E6%96%B9%E5%B8%B3%E8%99%9F-2-0-%E9%9B%A3%E6%B0%91%E6%9C%89%E7%A6%8F%E4%BA%86-a4acd323769e\" target=\"_blank\" rel=\"noopener\">在 LINE 群組發送免費推播的方法大公開</a></li>\n<li><a href=\"https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72\" target=\"_blank\" rel=\"noopener\">如何在 Bottender 中使用 LIFF</a></li>\n</ul>\n<p>剛好我在同時期遇到了一個問題，就是我開始偷懶越來越少去按圖奇獸查直播了！！這樣感覺我做了這個 side project 就要石沈大海，\b 本篇就來介紹一下我增加了什麼功能～ 👀</p>\n<h1 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h1><p>輸入<code>連結 LINE Notify</code> 或是點選 Richmenu 最右邊的 🔔 也會幫忙開網頁哦！<br>此時 Twitch Bot 會給你一串綁定網址，直接給他點下去。<br><img src=\"https://i.imgur.com/OyZy8Ac.jpg\" alt></p>\n<hr>\n<p>接著到這個畫面之後選擇<code>透過1對1聊天</code>的選項，按下同意之後就完成連動囉！<br><img src=\"https://i.imgur.com/hHXtNv7l.png\" alt></p>\n<hr>\n<p>接著要怎麼樣才能讓機器人知道你想被推播什麼？輸入<code>follow</code>之後會看到有兩個按鈕，按下面的<code>綁定通知</code>的按鈕後 Twitch Bot 會告訴你綁定成功沒，如果已經綁定的話按鈕則會變成灰色，在按下去的話則就是取消綁定囉!<br><img src=\"https://i.imgur.com/fdMIr42l.jpg\" alt></p>\n<hr>\n<p>接著 Twitch Bot 每個小時會幫你去 Twitch API 找找是否有人開台了，只要已經上線的直播主就會被推播，而會分別給兩個連結(Deep link &amp; 一般網址)，但一天只會推播一次同一個直播主，避免每個小時重複通知影響使用者 🙂<br><img src=\"https://i.imgur.com/lHoJHT4l.jpg\" alt></p>\n<h1 id=\"巧妙結合-LINE-Notify-以及-LIFF\"><a href=\"#巧妙結合-LINE-Notify-以及-LIFF\" class=\"headerlink\" title=\"巧妙結合 LINE Notify 以及 LIFF\"></a>巧妙結合 LINE Notify 以及 LIFF</h1><p>有兩個使用方法可以讓 Bot 跟 Notify 結合:</p>\n<ol>\n<li>準備打至 Notify 時在 state 欄位上塞入使用者 LINE id，再透過 callback 時帶回來給 api 在藉此存下來，但如此一來比較<strong>方便</strong>但<strong>安全性較不足</strong>些。</li>\n<li>在 callback 後在 LIFF 上透過 client api 去取得當前使用者基本資料，在 call 自己的 api 來讓 Bot 與 Notify 連動，安全性較足但步驟較多。</li>\n</ol>\n<h2 id=\"美中不足的結合問題-query-string\"><a href=\"#美中不足的結合問題-query-string\" class=\"headerlink\" title=\"美中不足的結合問題 - query string\"></a>美中不足的結合問題 - query string</h2><p>在 Twitch Bot 中，我使用 LIFF 來開啟 Notify 是為了要透過 LINE 取得使用者的 ID，使用者選擇綁定之後，LIFF 會預設幫使用者加個 <code>state</code> 的 query string 欄位，但同時 Notify 也會把它的 <code>code</code> 以及 <code>state</code> 也加在 query string 上，如此組合起來網址就會變成：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://liff.line.me?state=code=&#123;NOTIFY_CODE&#125;&amp;state=&#123;NOTIFY_STATE&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這樣的網址 api 接到之後一定會出問題，所以我就使用以下的 code 來幫我把它處理成我們認識的 query string:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> query = req.query[<span class=\"string\">\"liff.state\"</span>].split(<span class=\"string\">\"?\"</span>)[<span class=\"number\">1</span>].split(<span class=\"string\">\"&amp;\"</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> notifyPayload = &#123; <span class=\"attr\">code</span>: <span class=\"literal\">null</span>, <span class=\"attr\">state</span>: <span class=\"literal\">null</span> &#125;;</span><br><span class=\"line\">query.forEach(<span class=\"function\"><span class=\"params\">el</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> queryObj = el.split(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (queryObj[<span class=\"number\">0</span>] <span class=\"keyword\">in</span> notifyPayload) notifyPayload[queryObj[<span class=\"number\">0</span>]] = queryObj[<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>這樣 <code>notifyPayload</code> 就是我們平常 api 接到的 object 了。</p>\n<h2 id=\"使用-ejs-處理前端\"><a href=\"#使用-ejs-處理前端\" class=\"headerlink\" title=\"使用 ejs 處理前端\"></a>使用 ejs 處理前端</h2><p>以前寫 Rails 很習慣後端直接很習慣後端直接傳值給前端渲染做些簡單的 UI 處理，會使用 ejs 是因為需要讓使用者點選之後透過 LIFF 導到 LINE Notify 去做綁定的動作，因為還是需要簡單的前端功能，就用 ejs 來幫我解決問題囉！</p>\n<blockquote>\n<p>以下我則是使用 express 搭配 ejs 做說明</p>\n</blockquote>\n<p>我設定使用者綁定的 api 入口與 LINE Notify 確認綁定完後(<code>callback</code>)的 api 入口為:</p>\n<ol>\n<li>/notify<br>這個 api 做的事情比較簡單，只要負責將環境變數 <code>CLIENT_ID</code>、<code>REDIRECT_URI</code>、<code>LIFF_ID</code> 給前端把使用者導至 LINE Notify 綁定頁面。</li>\n<li>/notify/confirm<br>LINE Notify callback 一定要先打到 <code>後端(backend)</code> 才行，否則會有 <code>跨域(CORS)</code> 的問題，處理的部分可以參考<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/notifiesController.ts#L5\" target=\"_blank\" rel=\"noopener\">我的 Github</a>，處理完後一樣會導到前端畫面去做畫面渲染。</li>\n</ol>\n<h2 id=\"LIFF-網址設定\"><a href=\"#LIFF-網址設定\" class=\"headerlink\" title=\"LIFF 網址設定\"></a>LIFF 網址設定</h2><p>LIFF 的申請與操作方法我就先不贅述，可以參考卡米哥的 <a href=\"https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72\" target=\"_blank\" rel=\"noopener\">Bottender 結合 LIFF 文章</a>，但申請的時候要記得是在 LINE Login 申請喔！否則可能會有日後 migration 的問題。<br><img src=\"https://i.imgur.com/AcXEDeI.png\" alt=\"Login LIFF\"></p>\n<blockquote>\n<p>Tips: 紅色框框名字的部分在轉貼給別人的時候會顯示在視窗上的縮圖喔</p>\n</blockquote>\n<p>在測試環境時 LINE Notify 設定這邊只要一次 LIFF 網址，往後只要在 LINE 後台去調整 webhook 的網址就好， Notify 這邊就不需要再掛心回來這裡設定，只要等到上線時申請再去弄一個即可。<br><img src=\"https://i.imgur.com/PNVmNmn.png\" alt=\"LINE Notify callback\"></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>除了使用 LIFF 綁定 Notify 遇到 query string 部分的問題，其餘在串接上其實都沒障礙，而且也充分展現每個微服務的功能，雖然還是會希望可以讓 Twitch Bot 可以自己發推播，不過既然 LINE 有限制也有解決方案，那就找他們的方法去做吧！</p>\n<p>等接下來有空在接上 LINE 最近新出的 ShareTargetPicker 時再來擴增一下圖奇獸～</p>\n<blockquote>\n<p>ShareTargetPicker 可以參考這個網址: <a href=\"https://engineering.linecorp.com/zh-hant/blog/share-target-picker-liff/\" target=\"_blank\" rel=\"noopener\">點我我我我</a></p>\n</blockquote>\n<p>三月 <a href=\"https://chatbots.kktix.cc/events/meetup-017\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan 小聚</a>歡迎大家來參加哦！</p>\n<blockquote>\n<p>防疫期間記得要 <code>多洗手</code>、<code>戴口罩</code>、<code>保持清潔</code>！ 防疫從你我做起 🙂</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<img src=\"https://i.imgur.com/dOIsi7H.jpg\" width=\"2000\">\n\n<blockquote>\n<p>滿滿的三項之力 🏋️‍♂️</p>\n</blockquote>\n<blockquote>\n<p>來幫我的 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch Bot</a> 按個星星 ⭐️⭐️</p>\n</blockquote>\n<h1 id=\"更新功能\"><a href=\"#更新功能\" class=\"headerlink\" title=\"更新功能\"></a>更新功能</h1><ul>\n<li>使用 LIFF 來綁定 Notify","more":"</li>\n<li>每個小時幫忙檢查訂閱的直播主開了沒<ul>\n<li>一天只推播一次絕對不吵你</li>\n<li>還有 deep link 喔！</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"點子來源\"><a href=\"#點子來源\" class=\"headerlink\" title=\"點子來源\"></a>點子來源</h1><p>最近卡米哥寫了兩篇文章</p>\n<ul>\n<li>LINE Notify - <a href=\"https://medium.com/@EtrexKuo/%E7%A5%95%E6%8A%80-%E5%9C%A8-line-%E7%BE%A4%E7%B5%84%E7%99%BC%E9%80%81%E5%85%8D%E8%B2%BB%E6%8E%A8%E6%92%AD%E7%9A%84%E6%96%B9%E6%B3%95%E5%A4%A7%E5%85%AC%E9%96%8B-line%E5%AE%98%E6%96%B9%E5%B8%B3%E8%99%9F-2-0-%E9%9B%A3%E6%B0%91%E6%9C%89%E7%A6%8F%E4%BA%86-a4acd323769e\" target=\"_blank\" rel=\"noopener\">在 LINE 群組發送免費推播的方法大公開</a></li>\n<li><a href=\"https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72\" target=\"_blank\" rel=\"noopener\">如何在 Bottender 中使用 LIFF</a></li>\n</ul>\n<p>剛好我在同時期遇到了一個問題，就是我開始偷懶越來越少去按圖奇獸查直播了！！這樣感覺我做了這個 side project 就要石沈大海，\b 本篇就來介紹一下我增加了什麼功能～ 👀</p>\n<h1 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h1><p>輸入<code>連結 LINE Notify</code> 或是點選 Richmenu 最右邊的 🔔 也會幫忙開網頁哦！<br>此時 Twitch Bot 會給你一串綁定網址，直接給他點下去。<br><img src=\"https://i.imgur.com/OyZy8Ac.jpg\" alt></p>\n<hr>\n<p>接著到這個畫面之後選擇<code>透過1對1聊天</code>的選項，按下同意之後就完成連動囉！<br><img src=\"https://i.imgur.com/hHXtNv7l.png\" alt></p>\n<hr>\n<p>接著要怎麼樣才能讓機器人知道你想被推播什麼？輸入<code>follow</code>之後會看到有兩個按鈕，按下面的<code>綁定通知</code>的按鈕後 Twitch Bot 會告訴你綁定成功沒，如果已經綁定的話按鈕則會變成灰色，在按下去的話則就是取消綁定囉!<br><img src=\"https://i.imgur.com/fdMIr42l.jpg\" alt></p>\n<hr>\n<p>接著 Twitch Bot 每個小時會幫你去 Twitch API 找找是否有人開台了，只要已經上線的直播主就會被推播，而會分別給兩個連結(Deep link &amp; 一般網址)，但一天只會推播一次同一個直播主，避免每個小時重複通知影響使用者 🙂<br><img src=\"https://i.imgur.com/lHoJHT4l.jpg\" alt></p>\n<h1 id=\"巧妙結合-LINE-Notify-以及-LIFF\"><a href=\"#巧妙結合-LINE-Notify-以及-LIFF\" class=\"headerlink\" title=\"巧妙結合 LINE Notify 以及 LIFF\"></a>巧妙結合 LINE Notify 以及 LIFF</h1><p>有兩個使用方法可以讓 Bot 跟 Notify 結合:</p>\n<ol>\n<li>準備打至 Notify 時在 state 欄位上塞入使用者 LINE id，再透過 callback 時帶回來給 api 在藉此存下來，但如此一來比較<strong>方便</strong>但<strong>安全性較不足</strong>些。</li>\n<li>在 callback 後在 LIFF 上透過 client api 去取得當前使用者基本資料，在 call 自己的 api 來讓 Bot 與 Notify 連動，安全性較足但步驟較多。</li>\n</ol>\n<h2 id=\"美中不足的結合問題-query-string\"><a href=\"#美中不足的結合問題-query-string\" class=\"headerlink\" title=\"美中不足的結合問題 - query string\"></a>美中不足的結合問題 - query string</h2><p>在 Twitch Bot 中，我使用 LIFF 來開啟 Notify 是為了要透過 LINE 取得使用者的 ID，使用者選擇綁定之後，LIFF 會預設幫使用者加個 <code>state</code> 的 query string 欄位，但同時 Notify 也會把它的 <code>code</code> 以及 <code>state</code> 也加在 query string 上，如此組合起來網址就會變成：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://liff.line.me?state=code=&#123;NOTIFY_CODE&#125;&amp;state=&#123;NOTIFY_STATE&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這樣的網址 api 接到之後一定會出問題，所以我就使用以下的 code 來幫我把它處理成我們認識的 query string:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> query = req.query[<span class=\"string\">\"liff.state\"</span>].split(<span class=\"string\">\"?\"</span>)[<span class=\"number\">1</span>].split(<span class=\"string\">\"&amp;\"</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> notifyPayload = &#123; <span class=\"attr\">code</span>: <span class=\"literal\">null</span>, <span class=\"attr\">state</span>: <span class=\"literal\">null</span> &#125;;</span><br><span class=\"line\">query.forEach(<span class=\"function\"><span class=\"params\">el</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> queryObj = el.split(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (queryObj[<span class=\"number\">0</span>] <span class=\"keyword\">in</span> notifyPayload) notifyPayload[queryObj[<span class=\"number\">0</span>]] = queryObj[<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>這樣 <code>notifyPayload</code> 就是我們平常 api 接到的 object 了。</p>\n<h2 id=\"使用-ejs-處理前端\"><a href=\"#使用-ejs-處理前端\" class=\"headerlink\" title=\"使用 ejs 處理前端\"></a>使用 ejs 處理前端</h2><p>以前寫 Rails 很習慣後端直接很習慣後端直接傳值給前端渲染做些簡單的 UI 處理，會使用 ejs 是因為需要讓使用者點選之後透過 LIFF 導到 LINE Notify 去做綁定的動作，因為還是需要簡單的前端功能，就用 ejs 來幫我解決問題囉！</p>\n<blockquote>\n<p>以下我則是使用 express 搭配 ejs 做說明</p>\n</blockquote>\n<p>我設定使用者綁定的 api 入口與 LINE Notify 確認綁定完後(<code>callback</code>)的 api 入口為:</p>\n<ol>\n<li>/notify<br>這個 api 做的事情比較簡單，只要負責將環境變數 <code>CLIENT_ID</code>、<code>REDIRECT_URI</code>、<code>LIFF_ID</code> 給前端把使用者導至 LINE Notify 綁定頁面。</li>\n<li>/notify/confirm<br>LINE Notify callback 一定要先打到 <code>後端(backend)</code> 才行，否則會有 <code>跨域(CORS)</code> 的問題，處理的部分可以參考<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/notifiesController.ts#L5\" target=\"_blank\" rel=\"noopener\">我的 Github</a>，處理完後一樣會導到前端畫面去做畫面渲染。</li>\n</ol>\n<h2 id=\"LIFF-網址設定\"><a href=\"#LIFF-網址設定\" class=\"headerlink\" title=\"LIFF 網址設定\"></a>LIFF 網址設定</h2><p>LIFF 的申請與操作方法我就先不贅述，可以參考卡米哥的 <a href=\"https://medium.com/@EtrexKuo/%E5%A6%82%E4%BD%95%E5%9C%A8-bottender-%E4%B8%AD%E4%BD%BF%E7%94%A8-liff-88634b187e72\" target=\"_blank\" rel=\"noopener\">Bottender 結合 LIFF 文章</a>，但申請的時候要記得是在 LINE Login 申請喔！否則可能會有日後 migration 的問題。<br><img src=\"https://i.imgur.com/AcXEDeI.png\" alt=\"Login LIFF\"></p>\n<blockquote>\n<p>Tips: 紅色框框名字的部分在轉貼給別人的時候會顯示在視窗上的縮圖喔</p>\n</blockquote>\n<p>在測試環境時 LINE Notify 設定這邊只要一次 LIFF 網址，往後只要在 LINE 後台去調整 webhook 的網址就好， Notify 這邊就不需要再掛心回來這裡設定，只要等到上線時申請再去弄一個即可。<br><img src=\"https://i.imgur.com/PNVmNmn.png\" alt=\"LINE Notify callback\"></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>除了使用 LIFF 綁定 Notify 遇到 query string 部分的問題，其餘在串接上其實都沒障礙，而且也充分展現每個微服務的功能，雖然還是會希望可以讓 Twitch Bot 可以自己發推播，不過既然 LINE 有限制也有解決方案，那就找他們的方法去做吧！</p>\n<p>等接下來有空在接上 LINE 最近新出的 ShareTargetPicker 時再來擴增一下圖奇獸～</p>\n<blockquote>\n<p>ShareTargetPicker 可以參考這個網址: <a href=\"https://engineering.linecorp.com/zh-hant/blog/share-target-picker-liff/\" target=\"_blank\" rel=\"noopener\">點我我我我</a></p>\n</blockquote>\n<p>三月 <a href=\"https://chatbots.kktix.cc/events/meetup-017\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan 小聚</a>歡迎大家來參加哦！</p>\n<blockquote>\n<p>防疫期間記得要 <code>多洗手</code>、<code>戴口罩</code>、<code>保持清潔</code>！ 防疫從你我做起 🙂</p>\n</blockquote>"},{"title":"Chatbot meetup #14 與 #15 小聚心得","abbrlink":1641980869,"date":"2019-12-22T12:48:54.000Z","_content":"\n![](https://i.imgur.com/9sLr17Z.png)\n\n# 前言\n\n大家好，我是 NiJia\n\n下半年度辛苦來參加小聚的各位了，最後一季場地一直變更，因為每次小聚都有熱情的夥伴提供場地給小聚，也一起尋找最適合各位的一個場地，若造成困擾小弟深感抱歉 <(\\_ \\_)>\n\n2019 年度活動資訊請參考 ➡️[Chatbot Taiwan GitHub](https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2019.md)\n\n# 小聚活動 & 簡報連結\n\n## [meetups 14](https://chatbots.kktix.cc/events/meetup-014)\n\n- [參考共筆](https://hackmd.io/@chatbot-tw/meetups-014)\n\n| Topic                                            | Speaker           | Link                                                                                                                                                                            |\n| ------------------------------------------------ | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| What's new in LIFF v2 and TECHPULSE 2019 preview | Evan Lin          | [link](https://speakerdeck.com/line_developers_tw/whats-new-in-liff-v2-and-techpulse-2019-preview?slide=2&fbclid=IwAR1pS22ELVfWptEmvIwn7G35uGeefPO1g6ncMfPsD0ssr7IBB6T7Q_Hbc4Q) |\n| Bottender 一路走來                               | 林承澤(C.T Lin)   | [link](https://drive.google.com/file/d/1yz38IWwolgv8AQPxIpuQBfNzSaKjGQVU/view?fbclid=IwAR2IHRd6ESvCnOCu-hleFvM-K1RTMT4l65ShoWB852XWhQ-wUj_ikegmnzw)                             |\n| 如何使用 kamigo 快速開發 LINE bot                | 林家煜(NiJia Lin) | [link](https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007?fbclid=IwAR1bkzmaOO5_tOBxNf9G5WVLboghJp6Mbl1G5wkOxPLk7RzOm707dNefd_M)                             |\n\n## 心得\n\n當時 LIFF v1 只能透過 Deep link 的方式讓很多需要 Web view 的動線設計上增加了許多困擾，而在 v2 上線後改善了這方面的問題，且也對外公布支援 Query string 讓開發者可以帶參數進去(雖然之前就已經在偷用了 😆)，雖然很不幸的因為 iOS 的政策問題導致 Scan QR code 的功能在接下來的版本硬生生被拔除，但整體下來其實 LIFF v2 對於在 LINE 上開發功能的朋友可以更有彈性的去應用了。\n\n> [iOS 政策問題參考](https://developer.apple.com/app-store/review/guidelines/#third-party-software)\n\n![](https://i.imgur.com/BtY1sLS.jpg)\n\nBottender 是在某次小聚聊到時才知道原來有這麼酷的開源專案，我覺得最特別的除了可以支援多平台之外，就是 `console` 模式了，像我最近做的 [ABL 台灣隊賽程機器人](https://github.com/louis70109/Taiwan-ABL-games)就只使用到純文字的功能，在`console`模式下很快速的就把功能弄好，部署時只要把相關 `Key` 放進去功能就完成了，這部分是真的很驚艷 😆\n上週去參加 GDG Hackthon 時介紹給其他寫前端的朋友使用，從來沒寫過後端的他們也覺得使用上真的很快就上手，所以有寫`Javascript`的朋友不妨參考試試囉！\n![](https://i.imgur.com/xMpRkLM.png)\n\n當初因為訓練時沒有一個可以幫我儲存記錄的地方，因此想到想做 LINE bot 來解決我的問題，但同時我又不喜歡處理一大堆 JSON 的問題，因此選用 [Kamigo](https://github.com/etrex/kamigo) 作為我開發 bot 的框架，除了框架幫忙轉打請求轉到對應的`controller`讓我不用寫一堆`if` `else`以外，最好用的功能就是 `Kamiflex` 了，當我們在 [Flex Message Simulator](https://developers.line.biz/console/fx/) 弄了一堆 JSON 出來時，同時我們需要從資料庫拉資料出來組裝產生大量的 JSON，在組裝時程式碼會很髒亂，所以使用 Kamiflex 來幫忙轉譯讓我在寫 Flex message 時可以更像在寫 Ruby code，讓整個 JSON 可能幾千行瞬間被濃縮成 100 行時這段 Flex message 在維護時也能更好的維護。\n![](https://i.imgur.com/4boRPgr.png)\n\n### Kamigo 流程\n\n```sequence\nUser->LINE: message\nLINE->Route: webhook\nRoute->Kamigo: event notify\nKamigo->Controller: send params\nController->View: send DB data\nView->Kamigo: generator flex template\nKamigo->Route: send template\nRoute->LINE: response\nLINE->User: reply\n```\n\n- [meetups 15](https://chatbots.kktix.cc/events/meetup-015)\n  - [參考共筆](https://hackmd.io/@chatbot-tw/meetups-015)\n\n| Topic                                           | Speaker    | Link                                                                                                        |\n| ----------------------------------------------- | ---------- | ----------------------------------------------------------------------------------------------------------- |\n| LINE Push / Message 開發經驗談                  | Caesar Chi |                                                                                                             |\n| 邊緣人救星！用 Laravel 打造私人定製的聊天機器人 | 李小胖     | [link](https://docs.google.com/presentation/d/1ImrH_2IziPceVnfHrTYTf8g3AivxQ3s4sNHkSQf6aBY/edit#slide=id.p) |\n| Chatbot builder                                 | Penny Sun  | [link](https://speakerdeck.com/line_developers_tw/automl-in-clova-chatbot-builder-framework?slide=56)       |\n\n## 心得\n\n我平時就有在看一些社群行銷朋友分享他們是如何對行為下標籤`tag`以及發放對應內容給使用者進而提升購買力，在 Caesar 大大的快速了解到這些商業行為背後的開發經驗為何，從設計到大量推送所需注意的問題以及服務器之間的溝通問題...在這次的議程中讓我學到很多付費內容才會聽到的題材，讓我對於 Push message 這件事情的做法與思路又重新被教育了一次 😆\n![](https://i.imgur.com/GqSiAmh.jpg)\n\n這次要請到一個月有一半時間都在參加小聚的小聚王小胖來為各位分享如何用`Laravel`做一隻專為自己客製化的機器人，雖然 Live demo 過程中了魔咒，好險後來也解決的一些 live demo 才會遇到的問題 🤣，總之若有使用 php 的朋友歡迎參考簡報哦～\n![](https://i.imgur.com/z2WgJvD.jpg)\n\n最後由 LINE 的資料工程師-Penny 為我們帶來在 LINE techpulse 上的議程，從介紹中 NLU 部分看起來功能會像是 `Dialogflow` 一樣，而在其他的部分則是提供一個介面讓使用者可以更快速的在網頁上設定自己想要的機器人樣式，只是目前功能只提供給合作的商家，期待未來 release 時的效益 🚀\n![](https://i.imgur.com/rdAzlEu.jpg)\n\n> 官方帳號已經有套用囉！想收到啲一手資訊或是想玩玩的朋友可以掃描加入 👾\n\n![](https://qr-official.line.me/L/9AirZgJAgb.png)\n\n> 所有小聚資訊接收藏在 -> [Chatbot Taiwan GitHub](https://github.com/Chatbot-Taiwan/meetups) 上哦！\n\n# 閃電秀\n\n## 14\n\n| Speaker | Topic                               | Link                                              |\n| ------- | ----------------------------------- | ------------------------------------------------- |\n| 陳佳新  | LINE Beacon，數位導覽的小幫手！     |                                                   |\n| Eric    | Flex box, 一起收集分享 Flex message | [link](https://github.com/eric0324/flex-box)      |\n| 徐郁涵  | 食農飽可夢                          |                                                   |\n| 郭佳甯  | 午餐隊長                            | [link](https://github.com/Yoctol/leader-of-lunch) |\n\n## 15\n\n| Speaker | Topic                           | Link                                                                                             |\n| ------- | ------------------------------- | ------------------------------------------------------------------------------------------------ |\n| Calvin  | LINE Beacon，數位導覽的小幫手！ | [link](https://docs.google.com/presentation/d/1a8Yaf_315mb4u8BcIvs6TqyNYkDiRR-T7mxNAnOuQCE/edit) |\n| JT      | ChatOps & Rasa                  | [link](https://slides.com/jimting/chatops_and_rasa#/)                                            |\n| NiJia   | ABL 台灣隊查詢機器人            | [link](https://github.com/louis70109/Taiwan-ABL-games)                                           |\n| 郭佳甯  | Bottender & Kamigo 介紹         | [link1](https://github.com/Yoctol/bottender)、[link2](https://github.com/etrex/kamigo)           |\n\n## 短評\n\n除了內容豐富的主議程外，閃電秀就是在每個社群最特別的部分了，從每次的閃電秀中都讓我對於 side project 的想法又重新被定義了一番，常常會看到很多不同的應用情境以及特殊的用法，歡迎大家踴躍報名閃電秀來互相交流，多方交流或許有機會蹦出不一樣的想法並讓機器人的其他用途 😁\n\n# 結論\n\n在舉辦每次的小聚活動都希望可以給每個來的朋友最豐富的內容，以及提供 Lighting talk 的舞台讓有作品的朋友可以上來分享，而最近有與其他社群的朋友聊到，發現似乎把議程塞太緊，導致影響到會眾與講者交流以及回家休息的時間，所以之後的小聚改善這個狀況並調整時間，再麻煩大家多支持 [Chatbot Taiwan](https://www.facebook.com/groups/chatbot.tw)🚀🚀🚀\n","source":"_posts/chatbot-meetup-2019Q4.md","raw":"---\ntitle: 'Chatbot meetup #14 與 #15 小聚心得'\ntags:\n  - chatbot\n  - meetup\ncategories: 研討會\nabbrlink: 1641980869\ndate: 2019-12-22 20:48:54\n---\n\n![](https://i.imgur.com/9sLr17Z.png)\n\n# 前言\n\n大家好，我是 NiJia\n\n下半年度辛苦來參加小聚的各位了，最後一季場地一直變更，因為每次小聚都有熱情的夥伴提供場地給小聚，也一起尋找最適合各位的一個場地，若造成困擾小弟深感抱歉 <(\\_ \\_)>\n\n2019 年度活動資訊請參考 ➡️[Chatbot Taiwan GitHub](https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2019.md)\n\n# 小聚活動 & 簡報連結\n\n## [meetups 14](https://chatbots.kktix.cc/events/meetup-014)\n\n- [參考共筆](https://hackmd.io/@chatbot-tw/meetups-014)\n\n| Topic                                            | Speaker           | Link                                                                                                                                                                            |\n| ------------------------------------------------ | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| What's new in LIFF v2 and TECHPULSE 2019 preview | Evan Lin          | [link](https://speakerdeck.com/line_developers_tw/whats-new-in-liff-v2-and-techpulse-2019-preview?slide=2&fbclid=IwAR1pS22ELVfWptEmvIwn7G35uGeefPO1g6ncMfPsD0ssr7IBB6T7Q_Hbc4Q) |\n| Bottender 一路走來                               | 林承澤(C.T Lin)   | [link](https://drive.google.com/file/d/1yz38IWwolgv8AQPxIpuQBfNzSaKjGQVU/view?fbclid=IwAR2IHRd6ESvCnOCu-hleFvM-K1RTMT4l65ShoWB852XWhQ-wUj_ikegmnzw)                             |\n| 如何使用 kamigo 快速開發 LINE bot                | 林家煜(NiJia Lin) | [link](https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007?fbclid=IwAR1bkzmaOO5_tOBxNf9G5WVLboghJp6Mbl1G5wkOxPLk7RzOm707dNefd_M)                             |\n\n## 心得\n\n當時 LIFF v1 只能透過 Deep link 的方式讓很多需要 Web view 的動線設計上增加了許多困擾，而在 v2 上線後改善了這方面的問題，且也對外公布支援 Query string 讓開發者可以帶參數進去(雖然之前就已經在偷用了 😆)，雖然很不幸的因為 iOS 的政策問題導致 Scan QR code 的功能在接下來的版本硬生生被拔除，但整體下來其實 LIFF v2 對於在 LINE 上開發功能的朋友可以更有彈性的去應用了。\n\n> [iOS 政策問題參考](https://developer.apple.com/app-store/review/guidelines/#third-party-software)\n\n![](https://i.imgur.com/BtY1sLS.jpg)\n\nBottender 是在某次小聚聊到時才知道原來有這麼酷的開源專案，我覺得最特別的除了可以支援多平台之外，就是 `console` 模式了，像我最近做的 [ABL 台灣隊賽程機器人](https://github.com/louis70109/Taiwan-ABL-games)就只使用到純文字的功能，在`console`模式下很快速的就把功能弄好，部署時只要把相關 `Key` 放進去功能就完成了，這部分是真的很驚艷 😆\n上週去參加 GDG Hackthon 時介紹給其他寫前端的朋友使用，從來沒寫過後端的他們也覺得使用上真的很快就上手，所以有寫`Javascript`的朋友不妨參考試試囉！\n![](https://i.imgur.com/xMpRkLM.png)\n\n當初因為訓練時沒有一個可以幫我儲存記錄的地方，因此想到想做 LINE bot 來解決我的問題，但同時我又不喜歡處理一大堆 JSON 的問題，因此選用 [Kamigo](https://github.com/etrex/kamigo) 作為我開發 bot 的框架，除了框架幫忙轉打請求轉到對應的`controller`讓我不用寫一堆`if` `else`以外，最好用的功能就是 `Kamiflex` 了，當我們在 [Flex Message Simulator](https://developers.line.biz/console/fx/) 弄了一堆 JSON 出來時，同時我們需要從資料庫拉資料出來組裝產生大量的 JSON，在組裝時程式碼會很髒亂，所以使用 Kamiflex 來幫忙轉譯讓我在寫 Flex message 時可以更像在寫 Ruby code，讓整個 JSON 可能幾千行瞬間被濃縮成 100 行時這段 Flex message 在維護時也能更好的維護。\n![](https://i.imgur.com/4boRPgr.png)\n\n### Kamigo 流程\n\n```sequence\nUser->LINE: message\nLINE->Route: webhook\nRoute->Kamigo: event notify\nKamigo->Controller: send params\nController->View: send DB data\nView->Kamigo: generator flex template\nKamigo->Route: send template\nRoute->LINE: response\nLINE->User: reply\n```\n\n- [meetups 15](https://chatbots.kktix.cc/events/meetup-015)\n  - [參考共筆](https://hackmd.io/@chatbot-tw/meetups-015)\n\n| Topic                                           | Speaker    | Link                                                                                                        |\n| ----------------------------------------------- | ---------- | ----------------------------------------------------------------------------------------------------------- |\n| LINE Push / Message 開發經驗談                  | Caesar Chi |                                                                                                             |\n| 邊緣人救星！用 Laravel 打造私人定製的聊天機器人 | 李小胖     | [link](https://docs.google.com/presentation/d/1ImrH_2IziPceVnfHrTYTf8g3AivxQ3s4sNHkSQf6aBY/edit#slide=id.p) |\n| Chatbot builder                                 | Penny Sun  | [link](https://speakerdeck.com/line_developers_tw/automl-in-clova-chatbot-builder-framework?slide=56)       |\n\n## 心得\n\n我平時就有在看一些社群行銷朋友分享他們是如何對行為下標籤`tag`以及發放對應內容給使用者進而提升購買力，在 Caesar 大大的快速了解到這些商業行為背後的開發經驗為何，從設計到大量推送所需注意的問題以及服務器之間的溝通問題...在這次的議程中讓我學到很多付費內容才會聽到的題材，讓我對於 Push message 這件事情的做法與思路又重新被教育了一次 😆\n![](https://i.imgur.com/GqSiAmh.jpg)\n\n這次要請到一個月有一半時間都在參加小聚的小聚王小胖來為各位分享如何用`Laravel`做一隻專為自己客製化的機器人，雖然 Live demo 過程中了魔咒，好險後來也解決的一些 live demo 才會遇到的問題 🤣，總之若有使用 php 的朋友歡迎參考簡報哦～\n![](https://i.imgur.com/z2WgJvD.jpg)\n\n最後由 LINE 的資料工程師-Penny 為我們帶來在 LINE techpulse 上的議程，從介紹中 NLU 部分看起來功能會像是 `Dialogflow` 一樣，而在其他的部分則是提供一個介面讓使用者可以更快速的在網頁上設定自己想要的機器人樣式，只是目前功能只提供給合作的商家，期待未來 release 時的效益 🚀\n![](https://i.imgur.com/rdAzlEu.jpg)\n\n> 官方帳號已經有套用囉！想收到啲一手資訊或是想玩玩的朋友可以掃描加入 👾\n\n![](https://qr-official.line.me/L/9AirZgJAgb.png)\n\n> 所有小聚資訊接收藏在 -> [Chatbot Taiwan GitHub](https://github.com/Chatbot-Taiwan/meetups) 上哦！\n\n# 閃電秀\n\n## 14\n\n| Speaker | Topic                               | Link                                              |\n| ------- | ----------------------------------- | ------------------------------------------------- |\n| 陳佳新  | LINE Beacon，數位導覽的小幫手！     |                                                   |\n| Eric    | Flex box, 一起收集分享 Flex message | [link](https://github.com/eric0324/flex-box)      |\n| 徐郁涵  | 食農飽可夢                          |                                                   |\n| 郭佳甯  | 午餐隊長                            | [link](https://github.com/Yoctol/leader-of-lunch) |\n\n## 15\n\n| Speaker | Topic                           | Link                                                                                             |\n| ------- | ------------------------------- | ------------------------------------------------------------------------------------------------ |\n| Calvin  | LINE Beacon，數位導覽的小幫手！ | [link](https://docs.google.com/presentation/d/1a8Yaf_315mb4u8BcIvs6TqyNYkDiRR-T7mxNAnOuQCE/edit) |\n| JT      | ChatOps & Rasa                  | [link](https://slides.com/jimting/chatops_and_rasa#/)                                            |\n| NiJia   | ABL 台灣隊查詢機器人            | [link](https://github.com/louis70109/Taiwan-ABL-games)                                           |\n| 郭佳甯  | Bottender & Kamigo 介紹         | [link1](https://github.com/Yoctol/bottender)、[link2](https://github.com/etrex/kamigo)           |\n\n## 短評\n\n除了內容豐富的主議程外，閃電秀就是在每個社群最特別的部分了，從每次的閃電秀中都讓我對於 side project 的想法又重新被定義了一番，常常會看到很多不同的應用情境以及特殊的用法，歡迎大家踴躍報名閃電秀來互相交流，多方交流或許有機會蹦出不一樣的想法並讓機器人的其他用途 😁\n\n# 結論\n\n在舉辦每次的小聚活動都希望可以給每個來的朋友最豐富的內容，以及提供 Lighting talk 的舞台讓有作品的朋友可以上來分享，而最近有與其他社群的朋友聊到，發現似乎把議程塞太緊，導致影響到會眾與講者交流以及回家休息的時間，所以之後的小聚改善這個狀況並調整時間，再麻煩大家多支持 [Chatbot Taiwan](https://www.facebook.com/groups/chatbot.tw)🚀🚀🚀\n","slug":"chatbot-meetup-2019Q4","published":1,"updated":"2020-06-19T14:03:58.863Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ku00487crix4bmdywf","content":"<p><img src=\"https://i.imgur.com/9sLr17Z.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 NiJia</p>\n<p>下半年度辛苦來參加小聚的各位了，最後一季場地一直變更，因為每次小聚都有熱情的夥伴提供場地給小聚，也一起尋找最適合各位的一個場地，若造成困擾小弟深感抱歉 &lt;(_ _)&gt;</p>\n<p>2019 年度活動資訊請參考 ➡️<a href=\"https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2019.md\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan GitHub</a></p>\n<h1 id=\"小聚活動-amp-簡報連結\"><a href=\"#小聚活動-amp-簡報連結\" class=\"headerlink\" title=\"小聚活動 &amp; 簡報連結\"></a>小聚活動 &amp; 簡報連結</h1><h2 id=\"meetups-14\"><a href=\"#meetups-14\" class=\"headerlink\" title=\"meetups 14\"></a><a href=\"https://chatbots.kktix.cc/events/meetup-014\" target=\"_blank\" rel=\"noopener\">meetups 14</a></h2><ul>\n<li><a href=\"https://hackmd.io/@chatbot-tw/meetups-014\" target=\"_blank\" rel=\"noopener\">參考共筆</a></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Topic</th>\n<th>Speaker</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>What’s new in LIFF v2 and TECHPULSE 2019 preview</td>\n<td>Evan Lin</td>\n<td><a href=\"https://speakerdeck.com/line_developers_tw/whats-new-in-liff-v2-and-techpulse-2019-preview?slide=2&fbclid=IwAR1pS22ELVfWptEmvIwn7G35uGeefPO1g6ncMfPsD0ssr7IBB6T7Q_Hbc4Q\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>Bottender 一路走來</td>\n<td>林承澤(C.T Lin)</td>\n<td><a href=\"https://drive.google.com/file/d/1yz38IWwolgv8AQPxIpuQBfNzSaKjGQVU/view?fbclid=IwAR2IHRd6ESvCnOCu-hleFvM-K1RTMT4l65ShoWB852XWhQ-wUj_ikegmnzw\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>如何使用 kamigo 快速開發 LINE bot</td>\n<td>林家煜(NiJia Lin)</td>\n<td><a href=\"https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007?fbclid=IwAR1bkzmaOO5_tOBxNf9G5WVLboghJp6Mbl1G5wkOxPLk7RzOm707dNefd_M\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"心得\"><a href=\"#心得\" class=\"headerlink\" title=\"心得\"></a>心得</h2><p>當時 LIFF v1 只能透過 Deep link 的方式讓很多需要 Web view 的動線設計上增加了許多困擾，而在 v2 上線後改善了這方面的問題，且也對外公布支援 Query string 讓開發者可以帶參數進去(雖然之前就已經在偷用了 😆)，雖然很不幸的因為 iOS 的政策問題導致 Scan QR code 的功能在接下來的版本硬生生被拔除，但整體下來其實 LIFF v2 對於在 LINE 上開發功能的朋友可以更有彈性的去應用了。</p>\n<blockquote>\n<p><a href=\"https://developer.apple.com/app-store/review/guidelines/#third-party-software\" target=\"_blank\" rel=\"noopener\">iOS 政策問題參考</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/BtY1sLS.jpg\" alt></p>\n<p>Bottender 是在某次小聚聊到時才知道原來有這麼酷的開源專案，我覺得最特別的除了可以支援多平台之外，就是 <code>console</code> 模式了，像我最近做的 <a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">ABL 台灣隊賽程機器人</a>就只使用到純文字的功能，在<code>console</code>模式下很快速的就把功能弄好，部署時只要把相關 <code>Key</code> 放進去功能就完成了，這部分是真的很驚艷 😆<br>上週去參加 GDG Hackthon 時介紹給其他寫前端的朋友使用，從來沒寫過後端的他們也覺得使用上真的很快就上手，所以有寫<code>Javascript</code>的朋友不妨參考試試囉！<br><img src=\"https://i.imgur.com/xMpRkLM.png\" alt></p>\n<p>當初因為訓練時沒有一個可以幫我儲存記錄的地方，因此想到想做 LINE bot 來解決我的問題，但同時我又不喜歡處理一大堆 JSON 的問題，因此選用 <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">Kamigo</a> 作為我開發 bot 的框架，除了框架幫忙轉打請求轉到對應的<code>controller</code>讓我不用寫一堆<code>if</code> <code>else</code>以外，最好用的功能就是 <code>Kamiflex</code> 了，當我們在 <a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a> 弄了一堆 JSON 出來時，同時我們需要從資料庫拉資料出來組裝產生大量的 JSON，在組裝時程式碼會很髒亂，所以使用 Kamiflex 來幫忙轉譯讓我在寫 Flex message 時可以更像在寫 Ruby code，讓整個 JSON 可能幾千行瞬間被濃縮成 100 行時這段 Flex message 在維護時也能更好的維護。<br><img src=\"https://i.imgur.com/4boRPgr.png\" alt></p>\n<h3 id=\"Kamigo-流程\"><a href=\"#Kamigo-流程\" class=\"headerlink\" title=\"Kamigo 流程\"></a>Kamigo 流程</h3><div id=\"sequence-0\"></div>\n\n<ul>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-015\" target=\"_blank\" rel=\"noopener\">meetups 15</a><ul>\n<li><a href=\"https://hackmd.io/@chatbot-tw/meetups-015\" target=\"_blank\" rel=\"noopener\">參考共筆</a></li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Topic</th>\n<th>Speaker</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>LINE Push / Message 開發經驗談</td>\n<td>Caesar Chi</td>\n<td></td>\n</tr>\n<tr>\n<td>邊緣人救星！用 Laravel 打造私人定製的聊天機器人</td>\n<td>李小胖</td>\n<td><a href=\"https://docs.google.com/presentation/d/1ImrH_2IziPceVnfHrTYTf8g3AivxQ3s4sNHkSQf6aBY/edit#slide=id.p\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>Chatbot builder</td>\n<td>Penny Sun</td>\n<td><a href=\"https://speakerdeck.com/line_developers_tw/automl-in-clova-chatbot-builder-framework?slide=56\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"心得-1\"><a href=\"#心得-1\" class=\"headerlink\" title=\"心得\"></a>心得</h2><p>我平時就有在看一些社群行銷朋友分享他們是如何對行為下標籤<code>tag</code>以及發放對應內容給使用者進而提升購買力，在 Caesar 大大的快速了解到這些商業行為背後的開發經驗為何，從設計到大量推送所需注意的問題以及服務器之間的溝通問題…在這次的議程中讓我學到很多付費內容才會聽到的題材，讓我對於 Push message 這件事情的做法與思路又重新被教育了一次 😆<br><img src=\"https://i.imgur.com/GqSiAmh.jpg\" alt></p>\n<p>這次要請到一個月有一半時間都在參加小聚的小聚王小胖來為各位分享如何用<code>Laravel</code>做一隻專為自己客製化的機器人，雖然 Live demo 過程中了魔咒，好險後來也解決的一些 live demo 才會遇到的問題 🤣，總之若有使用 php 的朋友歡迎參考簡報哦～<br><img src=\"https://i.imgur.com/z2WgJvD.jpg\" alt></p>\n<p>最後由 LINE 的資料工程師-Penny 為我們帶來在 LINE techpulse 上的議程，從介紹中 NLU 部分看起來功能會像是 <code>Dialogflow</code> 一樣，而在其他的部分則是提供一個介面讓使用者可以更快速的在網頁上設定自己想要的機器人樣式，只是目前功能只提供給合作的商家，期待未來 release 時的效益 🚀<br><img src=\"https://i.imgur.com/rdAzlEu.jpg\" alt></p>\n<blockquote>\n<p>官方帳號已經有套用囉！想收到啲一手資訊或是想玩玩的朋友可以掃描加入 👾</p>\n</blockquote>\n<p><img src=\"https://qr-official.line.me/L/9AirZgJAgb.png\" alt></p>\n<blockquote>\n<p>所有小聚資訊接收藏在 -&gt; <a href=\"https://github.com/Chatbot-Taiwan/meetups\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan GitHub</a> 上哦！</p>\n</blockquote>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><h2 id=\"14\"><a href=\"#14\" class=\"headerlink\" title=\"14\"></a>14</h2><table>\n<thead>\n<tr>\n<th>Speaker</th>\n<th>Topic</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>陳佳新</td>\n<td>LINE Beacon，數位導覽的小幫手！</td>\n<td></td>\n</tr>\n<tr>\n<td>Eric</td>\n<td>Flex box, 一起收集分享 Flex message</td>\n<td><a href=\"https://github.com/eric0324/flex-box\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>徐郁涵</td>\n<td>食農飽可夢</td>\n<td></td>\n</tr>\n<tr>\n<td>郭佳甯</td>\n<td>午餐隊長</td>\n<td><a href=\"https://github.com/Yoctol/leader-of-lunch\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"15\"><a href=\"#15\" class=\"headerlink\" title=\"15\"></a>15</h2><table>\n<thead>\n<tr>\n<th>Speaker</th>\n<th>Topic</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Calvin</td>\n<td>LINE Beacon，數位導覽的小幫手！</td>\n<td><a href=\"https://docs.google.com/presentation/d/1a8Yaf_315mb4u8BcIvs6TqyNYkDiRR-T7mxNAnOuQCE/edit\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>JT</td>\n<td>ChatOps &amp; Rasa</td>\n<td><a href=\"https://slides.com/jimting/chatops_and_rasa#/\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>NiJia</td>\n<td>ABL 台灣隊查詢機器人</td>\n<td><a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>郭佳甯</td>\n<td>Bottender &amp; Kamigo 介紹</td>\n<td><a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">link1</a>、<a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">link2</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"短評\"><a href=\"#短評\" class=\"headerlink\" title=\"短評\"></a>短評</h2><p>除了內容豐富的主議程外，閃電秀就是在每個社群最特別的部分了，從每次的閃電秀中都讓我對於 side project 的想法又重新被定義了一番，常常會看到很多不同的應用情境以及特殊的用法，歡迎大家踴躍報名閃電秀來互相交流，多方交流或許有機會蹦出不一樣的想法並讓機器人的其他用途 😁</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在舉辦每次的小聚活動都希望可以給每個來的朋友最豐富的內容，以及提供 Lighting talk 的舞台讓有作品的朋友可以上來分享，而最近有與其他社群的朋友聊到，發現似乎把議程塞太緊，導致影響到會眾與講者交流以及回家休息的時間，所以之後的小聚改善這個狀況並調整時間，再麻煩大家多支持 <a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan</a>🚀🚀🚀</p>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.27/webfontloader.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js\"></script><textarea id=\"sequence-0-code\" style=\"display: none\">User->LINE: message\nLINE->Route: webhook\nRoute->Kamigo: event notify\nKamigo->Controller: send params\nController->View: send DB data\nView->Kamigo: generator flex template\nKamigo->Route: send template\nRoute->LINE: response\nLINE->User: reply</textarea><textarea id=\"sequence-0-options\" style=\"display: none\">{\"theme\":\"simple\"}</textarea><script>  var code = document.getElementById(\"sequence-0-code\").value;  var options = JSON.parse(decodeURIComponent(document.getElementById(\"sequence-0-options\").value));  var diagram = Diagram.parse(code);  diagram.drawSVG(\"sequence-0\", options);</script>","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://i.imgur.com/9sLr17Z.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 NiJia</p>\n<p>下半年度辛苦來參加小聚的各位了，最後一季場地一直變更，因為每次小聚都有熱情的夥伴提供場地給小聚，也一起尋找最適合各位的一個場地，若造成困擾小弟深感抱歉 &lt;(_ _)&gt;</p>\n<p>2019 年度活動資訊請參考 ➡️<a href=\"https://github.com/Chatbot-Taiwan/meetups/blob/master/taipei/2019.md\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan GitHub</a></p>\n<h1 id=\"小聚活動-amp-簡報連結\"><a href=\"#小聚活動-amp-簡報連結\" class=\"headerlink\" title=\"小聚活動 &amp; 簡報連結\"></a>小聚活動 &amp; 簡報連結</h1><h2 id=\"meetups-14\"><a href=\"#meetups-14\" class=\"headerlink\" title=\"meetups 14\"></a><a href=\"https://chatbots.kktix.cc/events/meetup-014\" target=\"_blank\" rel=\"noopener\">meetups 14</a></h2><ul>\n<li><a href=\"https://hackmd.io/@chatbot-tw/meetups-014\" target=\"_blank\" rel=\"noopener\">參考共筆</a></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Topic</th>\n<th>Speaker</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>What’s new in LIFF v2 and TECHPULSE 2019 preview</td>\n<td>Evan Lin</td>\n<td><a href=\"https://speakerdeck.com/line_developers_tw/whats-new-in-liff-v2-and-techpulse-2019-preview?slide=2&fbclid=IwAR1pS22ELVfWptEmvIwn7G35uGeefPO1g6ncMfPsD0ssr7IBB6T7Q_Hbc4Q\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>Bottender 一路走來</td>\n<td>林承澤(C.T Lin)</td>\n<td><a href=\"https://drive.google.com/file/d/1yz38IWwolgv8AQPxIpuQBfNzSaKjGQVU/view?fbclid=IwAR2IHRd6ESvCnOCu-hleFvM-K1RTMT4l65ShoWB852XWhQ-wUj_ikegmnzw\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>如何使用 kamigo 快速開發 LINE bot</td>\n<td>林家煜(NiJia Lin)</td>\n<td><a href=\"https://www.slideshare.net/JiaYuLin6/kamigo-reviews-20191127-198374007?fbclid=IwAR1bkzmaOO5_tOBxNf9G5WVLboghJp6Mbl1G5wkOxPLk7RzOm707dNefd_M\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"心得\"><a href=\"#心得\" class=\"headerlink\" title=\"心得\"></a>心得</h2><p>當時 LIFF v1 只能透過 Deep link 的方式讓很多需要 Web view 的動線設計上增加了許多困擾，而在 v2 上線後改善了這方面的問題，且也對外公布支援 Query string 讓開發者可以帶參數進去(雖然之前就已經在偷用了 😆)，雖然很不幸的因為 iOS 的政策問題導致 Scan QR code 的功能在接下來的版本硬生生被拔除，但整體下來其實 LIFF v2 對於在 LINE 上開發功能的朋友可以更有彈性的去應用了。</p>\n<blockquote>\n<p><a href=\"https://developer.apple.com/app-store/review/guidelines/#third-party-software\" target=\"_blank\" rel=\"noopener\">iOS 政策問題參考</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/BtY1sLS.jpg\" alt></p>\n<p>Bottender 是在某次小聚聊到時才知道原來有這麼酷的開源專案，我覺得最特別的除了可以支援多平台之外，就是 <code>console</code> 模式了，像我最近做的 <a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">ABL 台灣隊賽程機器人</a>就只使用到純文字的功能，在<code>console</code>模式下很快速的就把功能弄好，部署時只要把相關 <code>Key</code> 放進去功能就完成了，這部分是真的很驚艷 😆<br>上週去參加 GDG Hackthon 時介紹給其他寫前端的朋友使用，從來沒寫過後端的他們也覺得使用上真的很快就上手，所以有寫<code>Javascript</code>的朋友不妨參考試試囉！<br><img src=\"https://i.imgur.com/xMpRkLM.png\" alt></p>\n<p>當初因為訓練時沒有一個可以幫我儲存記錄的地方，因此想到想做 LINE bot 來解決我的問題，但同時我又不喜歡處理一大堆 JSON 的問題，因此選用 <a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">Kamigo</a> 作為我開發 bot 的框架，除了框架幫忙轉打請求轉到對應的<code>controller</code>讓我不用寫一堆<code>if</code> <code>else</code>以外，最好用的功能就是 <code>Kamiflex</code> 了，當我們在 <a href=\"https://developers.line.biz/console/fx/\" target=\"_blank\" rel=\"noopener\">Flex Message Simulator</a> 弄了一堆 JSON 出來時，同時我們需要從資料庫拉資料出來組裝產生大量的 JSON，在組裝時程式碼會很髒亂，所以使用 Kamiflex 來幫忙轉譯讓我在寫 Flex message 時可以更像在寫 Ruby code，讓整個 JSON 可能幾千行瞬間被濃縮成 100 行時這段 Flex message 在維護時也能更好的維護。<br><img src=\"https://i.imgur.com/4boRPgr.png\" alt></p>\n<h3 id=\"Kamigo-流程\"><a href=\"#Kamigo-流程\" class=\"headerlink\" title=\"Kamigo 流程\"></a>Kamigo 流程</h3><div id=\"sequence-0\"></div>\n\n<ul>\n<li><a href=\"https://chatbots.kktix.cc/events/meetup-015\" target=\"_blank\" rel=\"noopener\">meetups 15</a><ul>\n<li><a href=\"https://hackmd.io/@chatbot-tw/meetups-015\" target=\"_blank\" rel=\"noopener\">參考共筆</a></li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Topic</th>\n<th>Speaker</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>LINE Push / Message 開發經驗談</td>\n<td>Caesar Chi</td>\n<td></td>\n</tr>\n<tr>\n<td>邊緣人救星！用 Laravel 打造私人定製的聊天機器人</td>\n<td>李小胖</td>\n<td><a href=\"https://docs.google.com/presentation/d/1ImrH_2IziPceVnfHrTYTf8g3AivxQ3s4sNHkSQf6aBY/edit#slide=id.p\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>Chatbot builder</td>\n<td>Penny Sun</td>\n<td><a href=\"https://speakerdeck.com/line_developers_tw/automl-in-clova-chatbot-builder-framework?slide=56\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"心得-1\"><a href=\"#心得-1\" class=\"headerlink\" title=\"心得\"></a>心得</h2><p>我平時就有在看一些社群行銷朋友分享他們是如何對行為下標籤<code>tag</code>以及發放對應內容給使用者進而提升購買力，在 Caesar 大大的快速了解到這些商業行為背後的開發經驗為何，從設計到大量推送所需注意的問題以及服務器之間的溝通問題…在這次的議程中讓我學到很多付費內容才會聽到的題材，讓我對於 Push message 這件事情的做法與思路又重新被教育了一次 😆<br><img src=\"https://i.imgur.com/GqSiAmh.jpg\" alt></p>\n<p>這次要請到一個月有一半時間都在參加小聚的小聚王小胖來為各位分享如何用<code>Laravel</code>做一隻專為自己客製化的機器人，雖然 Live demo 過程中了魔咒，好險後來也解決的一些 live demo 才會遇到的問題 🤣，總之若有使用 php 的朋友歡迎參考簡報哦～<br><img src=\"https://i.imgur.com/z2WgJvD.jpg\" alt></p>\n<p>最後由 LINE 的資料工程師-Penny 為我們帶來在 LINE techpulse 上的議程，從介紹中 NLU 部分看起來功能會像是 <code>Dialogflow</code> 一樣，而在其他的部分則是提供一個介面讓使用者可以更快速的在網頁上設定自己想要的機器人樣式，只是目前功能只提供給合作的商家，期待未來 release 時的效益 🚀<br><img src=\"https://i.imgur.com/rdAzlEu.jpg\" alt></p>\n<blockquote>\n<p>官方帳號已經有套用囉！想收到啲一手資訊或是想玩玩的朋友可以掃描加入 👾</p>\n</blockquote>\n<p><img src=\"https://qr-official.line.me/L/9AirZgJAgb.png\" alt></p>\n<blockquote>\n<p>所有小聚資訊接收藏在 -&gt; <a href=\"https://github.com/Chatbot-Taiwan/meetups\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan GitHub</a> 上哦！</p>\n</blockquote>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><h2 id=\"14\"><a href=\"#14\" class=\"headerlink\" title=\"14\"></a>14</h2><table>\n<thead>\n<tr>\n<th>Speaker</th>\n<th>Topic</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>陳佳新</td>\n<td>LINE Beacon，數位導覽的小幫手！</td>\n<td></td>\n</tr>\n<tr>\n<td>Eric</td>\n<td>Flex box, 一起收集分享 Flex message</td>\n<td><a href=\"https://github.com/eric0324/flex-box\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>徐郁涵</td>\n<td>食農飽可夢</td>\n<td></td>\n</tr>\n<tr>\n<td>郭佳甯</td>\n<td>午餐隊長</td>\n<td><a href=\"https://github.com/Yoctol/leader-of-lunch\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"15\"><a href=\"#15\" class=\"headerlink\" title=\"15\"></a>15</h2><table>\n<thead>\n<tr>\n<th>Speaker</th>\n<th>Topic</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Calvin</td>\n<td>LINE Beacon，數位導覽的小幫手！</td>\n<td><a href=\"https://docs.google.com/presentation/d/1a8Yaf_315mb4u8BcIvs6TqyNYkDiRR-T7mxNAnOuQCE/edit\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>JT</td>\n<td>ChatOps &amp; Rasa</td>\n<td><a href=\"https://slides.com/jimting/chatops_and_rasa#/\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>NiJia</td>\n<td>ABL 台灣隊查詢機器人</td>\n<td><a href=\"https://github.com/louis70109/Taiwan-ABL-games\" target=\"_blank\" rel=\"noopener\">link</a></td>\n</tr>\n<tr>\n<td>郭佳甯</td>\n<td>Bottender &amp; Kamigo 介紹</td>\n<td><a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">link1</a>、<a href=\"https://github.com/etrex/kamigo\" target=\"_blank\" rel=\"noopener\">link2</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"短評\"><a href=\"#短評\" class=\"headerlink\" title=\"短評\"></a>短評</h2><p>除了內容豐富的主議程外，閃電秀就是在每個社群最特別的部分了，從每次的閃電秀中都讓我對於 side project 的想法又重新被定義了一番，常常會看到很多不同的應用情境以及特殊的用法，歡迎大家踴躍報名閃電秀來互相交流，多方交流或許有機會蹦出不一樣的想法並讓機器人的其他用途 😁</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在舉辦每次的小聚活動都希望可以給每個來的朋友最豐富的內容，以及提供 Lighting talk 的舞台讓有作品的朋友可以上來分享，而最近有與其他社群的朋友聊到，發現似乎把議程塞太緊，導致影響到會眾與講者交流以及回家休息的時間，所以之後的小聚改善這個狀況並調整時間，再麻煩大家多支持 <a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\">Chatbot Taiwan</a>🚀🚀🚀</p>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.27/webfontloader.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js\"></script><textarea id=\"sequence-0-code\" style=\"display: none\">User->LINE: message\nLINE->Route: webhook\nRoute->Kamigo: event notify\nKamigo->Controller: send params\nController->View: send DB data\nView->Kamigo: generator flex template\nKamigo->Route: send template\nRoute->LINE: response\nLINE->User: reply</textarea><textarea id=\"sequence-0-options\" style=\"display: none\">{\"theme\":\"simple\"}</textarea><script>  var code = document.getElementById(\"sequence-0-code\").value;  var options = JSON.parse(decodeURIComponent(document.getElementById(\"sequence-0-options\").value));  var diagram = Diagram.parse(code);  diagram.drawSVG(\"sequence-0\", options);</script>"},{"title":"【Chatbot Taiwan 20】這次參加我又學到了什麼呢 @ LINE","abbrlink":19807,"date":"2020-06-23T18:54:28.000Z","_content":"\n![](https://i.imgur.com/eaU663s.png)\n\n# 前言\n\n疫情穩定並解封後終於迎來期待已久的第 20 場小聚，且這次更是來到我最喜歡的熊大寶殿 - LINE 裡頭辦活動，感謝場地方贊助熊大、美食、飲料讓大家吃飽喝足，並且我們邀請了許多大大來分享超超超精實的議程!!\n\n社群：https://www.facebook.com/groups/chatbot.tw/\n共筆：https://hackmd.io/@chatbot-tw/meetups-020\n直播回顧：https://youtu.be/VxcpDFHWOb8?t=2146\n\n那接下來就分享本次我參加的心得囉！🙂\n\n<!-- more -->\n\n# Keynote 1 - LINE API Update - Evan Lin\n\n> 直播錄影網址：https://youtu.be/gtpm4zKlsXI\n\n首先 LINE Taiwan 資深技術推廣工程師 Evan 為我們帶來 LINE API 六月的更新介紹。\n\n<script async class=\"speakerdeck-embed\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n> [簡報](https://speakerdeck.com/line_developers_tw/room-api-demo)\n\n- 06/09 Flex Message Simulator 教學文件釋出囉\n- 06/10 LINE API Update\n  - Get group summary\n  - Get members in group count\n  - Get members in room count\n- 06/15 LINE Login 可以透過連結(link)到 Official Account\n- 06/15 LIFF SDK error code\n\n## [群組] Get group summary & Get members in group count\n\n以往機器人只能取得個人資訊，而六月提供了這個 API 可以取得群組的資訊，跟使用者的資料格式差不多：\n![](https://i.imgur.com/3xEHM49.png)\n\n多了這個功能後能讓機器人在面對各個群組時能更有效地在後端管控來源群組，並且透過 `Get members in group count` 這個 API 來取得當前人數，做出類似行銷後台那樣讓使用者可以看到更完整的資訊。\n\n> Tip: 一個群組只能一隻機器人喔！\n\n## [聊天室] Get members in room count\n\n聊天室與群組的差異在於他不可以踢人，而功能上與群組差不多，一樣可以加機器人進來，可以透過這 API 知道當前群組有多少人，一樣可以管理除了群組以外的`聊天室們`。\n\n## Demo\n\nLINE bot group 範例(Golang): https://github.com/kkdai/linebot-group\n\nQR COde (部屬於 Heroku)：\n![](https://i.imgur.com/qbUsN2z.png)\n\n## 小技巧\n\n<script async class=\"speakerdeck-embed\" data-slide=\"10\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n### Join type\n\n常常會機器人加入群組後會發出一個`歡迎訊息`，透過 API 的方式會看到 JSON 裡有個 `type` 的欄位，判斷它是否為 `join` 即可回傳歡迎訊息。\n\n另外說明文件有提到，若是 room(聊天室) 需要在其他使用者發送文字(event) 觸發才能讓機器人第一次收到訊息後回傳歡迎訊息。\n\n### 如何確認 Group & Room\n\n<script async class=\"speakerdeck-embed\" data-slide=\"11\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n當機器人收到 event 時，在當中的 `source` 會有 type 來放入當前是何種性質的群組。\n\n## 小結\n\n透過每個月的講解讓大家都可以更清楚的了解到 LINE 的更新進度並獲得第一手消息，想知道更多訊息歡迎持續關注社團喔！\n\nLINE 若有更新時都會同步到 [GitHub issue](https://github.com/line/line-bot-sdk-python/issues/271) 上，所以不仿追隨一下有新的 issue 時就能第一手收到通知並送 PR 當貢獻者喔！\n\n# Keynote 2 - [專為高中生設計的管家型聊天機器人 - 廖煥杰](https://drive.google.com/file/d/10Qd-XvznwN_qVkZj2gXK3eLT3PPTqvc3/view?usp=sharing)\n\n> 直播錄影網址：https://youtu.be/HTXvpKWyNHE\n\n這個議程由高二的煥杰來分享，首先為什麼會做這個機器人三個主要原因：\n\n- 同學常常忘了帶考師準備的書籍。\n- 提醒學生未來幾天的考試行程，幫大家決定今天要帶的書回家。\n- 讓大家有效學習。\n\n## 設計理念\n\n- 為了避免被亂搞需要權限控制\n- 放學推播功能\n- 學校、老師有權限可以看到所有人的體溫\n\n## 遇到的問題\n\n當中講者也提到他們 SQL 的進化史，由於 google spreadsheet 每 100ms 只能有 100 請求導致服務出問題，因此就搬到 MySQL 上。\n\n當中也因為遇到疫情的關係所以開發出`體溫回報系統`，也有因為自己需求的關係而開發`放學前會推播今天的作業`，讓大家可以帶相關參考書回家。\n\n也需要依照不同季節提供不同的 Richmenu 選單。\n\n## 未來展望\n\n- 人臉辨識結合體溫測量\n- 重構程式碼，讓城市更漂亮\n- 評估改用 No SQL 來降低成本與請求速度\n- 網頁管理介面\n- 推廣到全台灣高中\n\n> [Github](https://github.com/cbfhss)\n\n## 小結\n\n很有想法的高中生，從生活中解決需求一直都是一個好的方向去實踐專案，希望這隻機器人可以趕快完成未來展望的部分，期待繼續在社團露臉 😁。\n\n# Keynote 3 - [LIFF & Firebase - Richard Lee](https://docs.google.com/presentation/d/1ZJIDpw9Cmte_9w1NxKHxzXtoaFBXsKVH7tQd4zlvb8k/edit?usp=sharing)\n\n![](https://i.imgur.com/pApsiyi.png)\n\n> 直播錄影網址： https://youtu.be/U_nPlkTuk9s\n\n一開始提到 LINE 在剛開始推出 LIFF 時其實沒那麼好用，然而隨著時間的推移 LINE 有聽到大家的心聲持續更新到今日挺好用的地步，也開發出特別的功能 - share target picker 來分享訊息，也因為類似的功能讓 LIFF 介於聊天機器人與行動網頁之間，且隨之而來 LIFF v2 也開始支援 web 囉！\n\n基本上 LIFF 的組成為 一個一般的 web app + LINE 的 \"user credentials\" 以及透過 SDK 去 get profile / send message。\n\n## Why Firebase hosting\n\n他有以下幾個特性：\n\n- 可以放置 web page\n- 幫助網頁開發的功能\n- 分析工具(FCM）\n- Firebase is a collection of mobile-related products\n- 一上去全球部署(CDN)，機房就在台灣/香港\n- No cold start\n\n在一番的火力展示後讓我瞭解到 Firebase 的完整性，其功能不僅擁有像是 AWS S3 的功能，同時擁有像是 AWS Lambda 的功能，並能夠在前端頁面 real time 去更新資料庫裡的值，讓大家能在這裡見識到這部分真的是賺到了！\n\n## Firebase Auth / Security rules\n\n設計再好的產品都會有沒注意到的地方，總不能讓我們放置的 LIFF 網頁被人家輕易的挖走東西，因此 Firebase 提供安全認證相關的機制，管理人員處理`新增`、`刪除`這類較危險的操作。\n\n## 小結\n\n能夠聽到含有 LAE & GDE 認證的專家分享這麼精實的內容實在是很賺，從中完美整合了 LINE 以及 Google 的服務讓我歎為觀止，讓我新的目標可以學新東西了！\n\n# Keynote 4 - [對話式表單架構設計 - 郭佳甯](https://docs.google.com/presentation/d/1np4_d6grkw6kMD-jSnMFFj2yH8FwT2SaEdNKKfA0w7w/edit)\n\n> 直播錄影網址：https://youtu.be/ScLQeFIJjLE\n\n本次再度邀請卡米哥前來分享主題，這次的主題很常會在討論區出現，在表單設計上一定是網頁(LIFF)來處理是較妥當的，但總不會每個需求都這麼完美，因此本次就分享在 Chatbot 上得多輪對話設計架構。\n\n![](https://i.imgur.com/OIb1vz9l.png)\n\n對話式表單常會有以下需求：\n\n- 多欄位填寫\n- 表單驗證\n- 代換詞(縮寫)\n- 對話跳脫\n\n利用了點飲料的需求清楚講解並帶大家認識整個對話的流程，接著就帶大家認識 DialogFlow，之前我有參加 chatbot taichung 工作坊，可以[參考文章](https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3)中的做法實作(細節可能有改要注意)。\n\n它帶來的好處可以迅速建立多欄位表單，但經由實測後有時跳脫後對話會跳不回去導至錯亂，且講者認為 Context 用於對話是表單違反直覺。\n\n## 認識[Bottender](https://bottender.js.org/)\n\n最後提到了我也很常用的 Bottender，它的三個主要脈絡為 Action、Chain、Routing，細節可以[參考文件](https://bottender.js.org/docs/zh-TW/getting-started)\n\n也因多輪對話需求越來越多，因此他們就有開出這樣的需求：\n![](https://i.imgur.com/la39kaZ.png)\n\n## proposal:\n\n- registerAction: 註冊 Action\n- getAction: 取得 Action\n- prompt: 向用戶發問\n- setField: 設定表單欄位\n- deleteField: 刪除欄位\n\n透過像是以上的 APIs 上開發者可以迅速建立對話式表單，並且處理`珍奶例子`的問題，雖然有提到 `缺乏高階語法糖`，但工具向來都是先求有再求好，也許未來會有不同的解決方案來處理這部分～\n\n## 小結\n\n透過生活中常遇到的例子帶入應用情境上讓大家更能融入其中，接著敘述實作上的問題並且提出目前如何處理這部分來解決必須在 Chatbot 中做對話的這件事上，\b 而 Bottender 持續貢獻於 open source 中，如果支持並有想贊助的朋友歡迎聯絡他們 🙂。\n\n# 閃電秀\n\n## 1. 奇步老爹（陳佳新）- [LIFF 圖片測試工具，設計師和工程師從此溝通無礙](https://www.slideshare.net/jarsing/20200623liffbgtester/jarsing/20200623liffbgtester)\n\n> 直播錄影網址： https://youtu.be/q2E9W4RDGW0\n\n在沒有設計師的情況下需要刻 UI 就只能使用工具，而講者即提供了 Chatbot 供大家測試使用。\n![](https://i.imgur.com/LpSvuUAl.jpg)\n\n操作流程：\n![](https://i.imgur.com/NnegZEB.jpg)\n\n## 2. 黃鈞亭 - [結合 LINE 和 Google Suite 來做定時回報系統](https://docs.google.com/presentation/d/1Xb6NWCLEqW5q74KOSjm51TWwokM-VXlBcOkpJqA2iTE/edit?usp=sharing)\n\n> 直播錄影網址：https://youtu.be/v6BNMJv782c\n\n因為軍中使用 LINE 回報時的 race condition 問題而讓講者動身實作一隻機器人處理問題，透過填寫 google 表單的方式也不會出現像前面講者所遇到的多輪對話問題。\n\n架構:\n![](https://i.imgur.com/KJdu5qd.png)\n\nGithub source: https://github.com/chungthuang/line-report-bot\n\n## 臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)\n\n> 直播錄影網址：https://youtu.be/4QcxQLVgiso\n\n主要解決讓不熟 APP 但熟悉即時通訊軟體的使用者來串接攝影機功能，結合 google 新出的開發版並讓使用者掃描裝置上的 QR Code 跟 LINE 做綁定，接著攝影機開始偵測後若發現有人經過時則會 push message 給用戶告知有問題。\n\n# 結論\n\n超精實的一天，難得疫情後的線下小聚還有 LINE 贊助場地與餐點，把握這次機會再次北上與大家一起舉辦社群活動，促進資訊交流並認識大家，接下來社群還是會持續舉辦月聚，請大家持續關注社群，會將第一手資訊發出來讓大家知道 🙂。\n","source":"_posts/chatbot-meetups-20-sharing.md","raw":"---\ntitle: 【Chatbot Taiwan 20】這次參加我又學到了什麼呢 @ LINE\ntags:\n  - Chatbot\n  - LINE\ncategories: 研討會\nabbrlink: 19807\ndate: 2020-06-24 02:54:28\n---\n\n![](https://i.imgur.com/eaU663s.png)\n\n# 前言\n\n疫情穩定並解封後終於迎來期待已久的第 20 場小聚，且這次更是來到我最喜歡的熊大寶殿 - LINE 裡頭辦活動，感謝場地方贊助熊大、美食、飲料讓大家吃飽喝足，並且我們邀請了許多大大來分享超超超精實的議程!!\n\n社群：https://www.facebook.com/groups/chatbot.tw/\n共筆：https://hackmd.io/@chatbot-tw/meetups-020\n直播回顧：https://youtu.be/VxcpDFHWOb8?t=2146\n\n那接下來就分享本次我參加的心得囉！🙂\n\n<!-- more -->\n\n# Keynote 1 - LINE API Update - Evan Lin\n\n> 直播錄影網址：https://youtu.be/gtpm4zKlsXI\n\n首先 LINE Taiwan 資深技術推廣工程師 Evan 為我們帶來 LINE API 六月的更新介紹。\n\n<script async class=\"speakerdeck-embed\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n> [簡報](https://speakerdeck.com/line_developers_tw/room-api-demo)\n\n- 06/09 Flex Message Simulator 教學文件釋出囉\n- 06/10 LINE API Update\n  - Get group summary\n  - Get members in group count\n  - Get members in room count\n- 06/15 LINE Login 可以透過連結(link)到 Official Account\n- 06/15 LIFF SDK error code\n\n## [群組] Get group summary & Get members in group count\n\n以往機器人只能取得個人資訊，而六月提供了這個 API 可以取得群組的資訊，跟使用者的資料格式差不多：\n![](https://i.imgur.com/3xEHM49.png)\n\n多了這個功能後能讓機器人在面對各個群組時能更有效地在後端管控來源群組，並且透過 `Get members in group count` 這個 API 來取得當前人數，做出類似行銷後台那樣讓使用者可以看到更完整的資訊。\n\n> Tip: 一個群組只能一隻機器人喔！\n\n## [聊天室] Get members in room count\n\n聊天室與群組的差異在於他不可以踢人，而功能上與群組差不多，一樣可以加機器人進來，可以透過這 API 知道當前群組有多少人，一樣可以管理除了群組以外的`聊天室們`。\n\n## Demo\n\nLINE bot group 範例(Golang): https://github.com/kkdai/linebot-group\n\nQR COde (部屬於 Heroku)：\n![](https://i.imgur.com/qbUsN2z.png)\n\n## 小技巧\n\n<script async class=\"speakerdeck-embed\" data-slide=\"10\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n### Join type\n\n常常會機器人加入群組後會發出一個`歡迎訊息`，透過 API 的方式會看到 JSON 裡有個 `type` 的欄位，判斷它是否為 `join` 即可回傳歡迎訊息。\n\n另外說明文件有提到，若是 room(聊天室) 需要在其他使用者發送文字(event) 觸發才能讓機器人第一次收到訊息後回傳歡迎訊息。\n\n### 如何確認 Group & Room\n\n<script async class=\"speakerdeck-embed\" data-slide=\"11\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n當機器人收到 event 時，在當中的 `source` 會有 type 來放入當前是何種性質的群組。\n\n## 小結\n\n透過每個月的講解讓大家都可以更清楚的了解到 LINE 的更新進度並獲得第一手消息，想知道更多訊息歡迎持續關注社團喔！\n\nLINE 若有更新時都會同步到 [GitHub issue](https://github.com/line/line-bot-sdk-python/issues/271) 上，所以不仿追隨一下有新的 issue 時就能第一手收到通知並送 PR 當貢獻者喔！\n\n# Keynote 2 - [專為高中生設計的管家型聊天機器人 - 廖煥杰](https://drive.google.com/file/d/10Qd-XvznwN_qVkZj2gXK3eLT3PPTqvc3/view?usp=sharing)\n\n> 直播錄影網址：https://youtu.be/HTXvpKWyNHE\n\n這個議程由高二的煥杰來分享，首先為什麼會做這個機器人三個主要原因：\n\n- 同學常常忘了帶考師準備的書籍。\n- 提醒學生未來幾天的考試行程，幫大家決定今天要帶的書回家。\n- 讓大家有效學習。\n\n## 設計理念\n\n- 為了避免被亂搞需要權限控制\n- 放學推播功能\n- 學校、老師有權限可以看到所有人的體溫\n\n## 遇到的問題\n\n當中講者也提到他們 SQL 的進化史，由於 google spreadsheet 每 100ms 只能有 100 請求導致服務出問題，因此就搬到 MySQL 上。\n\n當中也因為遇到疫情的關係所以開發出`體溫回報系統`，也有因為自己需求的關係而開發`放學前會推播今天的作業`，讓大家可以帶相關參考書回家。\n\n也需要依照不同季節提供不同的 Richmenu 選單。\n\n## 未來展望\n\n- 人臉辨識結合體溫測量\n- 重構程式碼，讓城市更漂亮\n- 評估改用 No SQL 來降低成本與請求速度\n- 網頁管理介面\n- 推廣到全台灣高中\n\n> [Github](https://github.com/cbfhss)\n\n## 小結\n\n很有想法的高中生，從生活中解決需求一直都是一個好的方向去實踐專案，希望這隻機器人可以趕快完成未來展望的部分，期待繼續在社團露臉 😁。\n\n# Keynote 3 - [LIFF & Firebase - Richard Lee](https://docs.google.com/presentation/d/1ZJIDpw9Cmte_9w1NxKHxzXtoaFBXsKVH7tQd4zlvb8k/edit?usp=sharing)\n\n![](https://i.imgur.com/pApsiyi.png)\n\n> 直播錄影網址： https://youtu.be/U_nPlkTuk9s\n\n一開始提到 LINE 在剛開始推出 LIFF 時其實沒那麼好用，然而隨著時間的推移 LINE 有聽到大家的心聲持續更新到今日挺好用的地步，也開發出特別的功能 - share target picker 來分享訊息，也因為類似的功能讓 LIFF 介於聊天機器人與行動網頁之間，且隨之而來 LIFF v2 也開始支援 web 囉！\n\n基本上 LIFF 的組成為 一個一般的 web app + LINE 的 \"user credentials\" 以及透過 SDK 去 get profile / send message。\n\n## Why Firebase hosting\n\n他有以下幾個特性：\n\n- 可以放置 web page\n- 幫助網頁開發的功能\n- 分析工具(FCM）\n- Firebase is a collection of mobile-related products\n- 一上去全球部署(CDN)，機房就在台灣/香港\n- No cold start\n\n在一番的火力展示後讓我瞭解到 Firebase 的完整性，其功能不僅擁有像是 AWS S3 的功能，同時擁有像是 AWS Lambda 的功能，並能夠在前端頁面 real time 去更新資料庫裡的值，讓大家能在這裡見識到這部分真的是賺到了！\n\n## Firebase Auth / Security rules\n\n設計再好的產品都會有沒注意到的地方，總不能讓我們放置的 LIFF 網頁被人家輕易的挖走東西，因此 Firebase 提供安全認證相關的機制，管理人員處理`新增`、`刪除`這類較危險的操作。\n\n## 小結\n\n能夠聽到含有 LAE & GDE 認證的專家分享這麼精實的內容實在是很賺，從中完美整合了 LINE 以及 Google 的服務讓我歎為觀止，讓我新的目標可以學新東西了！\n\n# Keynote 4 - [對話式表單架構設計 - 郭佳甯](https://docs.google.com/presentation/d/1np4_d6grkw6kMD-jSnMFFj2yH8FwT2SaEdNKKfA0w7w/edit)\n\n> 直播錄影網址：https://youtu.be/ScLQeFIJjLE\n\n本次再度邀請卡米哥前來分享主題，這次的主題很常會在討論區出現，在表單設計上一定是網頁(LIFF)來處理是較妥當的，但總不會每個需求都這麼完美，因此本次就分享在 Chatbot 上得多輪對話設計架構。\n\n![](https://i.imgur.com/OIb1vz9l.png)\n\n對話式表單常會有以下需求：\n\n- 多欄位填寫\n- 表單驗證\n- 代換詞(縮寫)\n- 對話跳脫\n\n利用了點飲料的需求清楚講解並帶大家認識整個對話的流程，接著就帶大家認識 DialogFlow，之前我有參加 chatbot taichung 工作坊，可以[參考文章](https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3)中的做法實作(細節可能有改要注意)。\n\n它帶來的好處可以迅速建立多欄位表單，但經由實測後有時跳脫後對話會跳不回去導至錯亂，且講者認為 Context 用於對話是表單違反直覺。\n\n## 認識[Bottender](https://bottender.js.org/)\n\n最後提到了我也很常用的 Bottender，它的三個主要脈絡為 Action、Chain、Routing，細節可以[參考文件](https://bottender.js.org/docs/zh-TW/getting-started)\n\n也因多輪對話需求越來越多，因此他們就有開出這樣的需求：\n![](https://i.imgur.com/la39kaZ.png)\n\n## proposal:\n\n- registerAction: 註冊 Action\n- getAction: 取得 Action\n- prompt: 向用戶發問\n- setField: 設定表單欄位\n- deleteField: 刪除欄位\n\n透過像是以上的 APIs 上開發者可以迅速建立對話式表單，並且處理`珍奶例子`的問題，雖然有提到 `缺乏高階語法糖`，但工具向來都是先求有再求好，也許未來會有不同的解決方案來處理這部分～\n\n## 小結\n\n透過生活中常遇到的例子帶入應用情境上讓大家更能融入其中，接著敘述實作上的問題並且提出目前如何處理這部分來解決必須在 Chatbot 中做對話的這件事上，\b 而 Bottender 持續貢獻於 open source 中，如果支持並有想贊助的朋友歡迎聯絡他們 🙂。\n\n# 閃電秀\n\n## 1. 奇步老爹（陳佳新）- [LIFF 圖片測試工具，設計師和工程師從此溝通無礙](https://www.slideshare.net/jarsing/20200623liffbgtester/jarsing/20200623liffbgtester)\n\n> 直播錄影網址： https://youtu.be/q2E9W4RDGW0\n\n在沒有設計師的情況下需要刻 UI 就只能使用工具，而講者即提供了 Chatbot 供大家測試使用。\n![](https://i.imgur.com/LpSvuUAl.jpg)\n\n操作流程：\n![](https://i.imgur.com/NnegZEB.jpg)\n\n## 2. 黃鈞亭 - [結合 LINE 和 Google Suite 來做定時回報系統](https://docs.google.com/presentation/d/1Xb6NWCLEqW5q74KOSjm51TWwokM-VXlBcOkpJqA2iTE/edit?usp=sharing)\n\n> 直播錄影網址：https://youtu.be/v6BNMJv782c\n\n因為軍中使用 LINE 回報時的 race condition 問題而讓講者動身實作一隻機器人處理問題，透過填寫 google 表單的方式也不會出現像前面講者所遇到的多輪對話問題。\n\n架構:\n![](https://i.imgur.com/KJdu5qd.png)\n\nGithub source: https://github.com/chungthuang/line-report-bot\n\n## 臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)\n\n> 直播錄影網址：https://youtu.be/4QcxQLVgiso\n\n主要解決讓不熟 APP 但熟悉即時通訊軟體的使用者來串接攝影機功能，結合 google 新出的開發版並讓使用者掃描裝置上的 QR Code 跟 LINE 做綁定，接著攝影機開始偵測後若發現有人經過時則會 push message 給用戶告知有問題。\n\n# 結論\n\n超精實的一天，難得疫情後的線下小聚還有 LINE 贊助場地與餐點，把握這次機會再次北上與大家一起舉辦社群活動，促進資訊交流並認識大家，接下來社群還是會持續舉辦月聚，請大家持續關注社群，會將第一手資訊發出來讓大家知道 🙂。\n","slug":"chatbot-meetups-20-sharing","published":1,"updated":"2020-06-24T15:57:55.783Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kv004c7crigzldkogf","content":"<p><img src=\"https://i.imgur.com/eaU663s.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>疫情穩定並解封後終於迎來期待已久的第 20 場小聚，且這次更是來到我最喜歡的熊大寶殿 - LINE 裡頭辦活動，感謝場地方贊助熊大、美食、飲料讓大家吃飽喝足，並且我們邀請了許多大大來分享超超超精實的議程!!</p>\n<p>社群：<a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">https://www.facebook.com/groups/chatbot.tw/</a><br>共筆：<a href=\"https://hackmd.io/@chatbot-tw/meetups-020\" target=\"_blank\" rel=\"noopener\">https://hackmd.io/@chatbot-tw/meetups-020</a><br>直播回顧：<a href=\"https://youtu.be/VxcpDFHWOb8?t=2146\" target=\"_blank\" rel=\"noopener\">https://youtu.be/VxcpDFHWOb8?t=2146</a></p>\n<p>那接下來就分享本次我參加的心得囉！🙂</p>\n<a id=\"more\"></a>\n\n<h1 id=\"Keynote-1-LINE-API-Update-Evan-Lin\"><a href=\"#Keynote-1-LINE-API-Update-Evan-Lin\" class=\"headerlink\" title=\"Keynote 1 - LINE API Update - Evan Lin\"></a>Keynote 1 - LINE API Update - Evan Lin</h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/gtpm4zKlsXI\" target=\"_blank\" rel=\"noopener\">https://youtu.be/gtpm4zKlsXI</a></p>\n</blockquote>\n<p>首先 LINE Taiwan 資深技術推廣工程師 Evan 為我們帶來 LINE API 六月的更新介紹。</p>\n<script async class=\"speakerdeck-embed\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<blockquote>\n<p><a href=\"https://speakerdeck.com/line_developers_tw/room-api-demo\" target=\"_blank\" rel=\"noopener\">簡報</a></p>\n</blockquote>\n<ul>\n<li>06/09 Flex Message Simulator 教學文件釋出囉</li>\n<li>06/10 LINE API Update<ul>\n<li>Get group summary</li>\n<li>Get members in group count</li>\n<li>Get members in room count</li>\n</ul>\n</li>\n<li>06/15 LINE Login 可以透過連結(link)到 Official Account</li>\n<li>06/15 LIFF SDK error code</li>\n</ul>\n<h2 id=\"群組-Get-group-summary-amp-Get-members-in-group-count\"><a href=\"#群組-Get-group-summary-amp-Get-members-in-group-count\" class=\"headerlink\" title=\"[群組] Get group summary &amp; Get members in group count\"></a>[群組] Get group summary &amp; Get members in group count</h2><p>以往機器人只能取得個人資訊，而六月提供了這個 API 可以取得群組的資訊，跟使用者的資料格式差不多：<br><img src=\"https://i.imgur.com/3xEHM49.png\" alt></p>\n<p>多了這個功能後能讓機器人在面對各個群組時能更有效地在後端管控來源群組，並且透過 <code>Get members in group count</code> 這個 API 來取得當前人數，做出類似行銷後台那樣讓使用者可以看到更完整的資訊。</p>\n<blockquote>\n<p>Tip: 一個群組只能一隻機器人喔！</p>\n</blockquote>\n<h2 id=\"聊天室-Get-members-in-room-count\"><a href=\"#聊天室-Get-members-in-room-count\" class=\"headerlink\" title=\"[聊天室] Get members in room count\"></a>[聊天室] Get members in room count</h2><p>聊天室與群組的差異在於他不可以踢人，而功能上與群組差不多，一樣可以加機器人進來，可以透過這 API 知道當前群組有多少人，一樣可以管理除了群組以外的<code>聊天室們</code>。</p>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>LINE bot group 範例(Golang): <a href=\"https://github.com/kkdai/linebot-group\" target=\"_blank\" rel=\"noopener\">https://github.com/kkdai/linebot-group</a></p>\n<p>QR COde (部屬於 Heroku)：<br><img src=\"https://i.imgur.com/qbUsN2z.png\" alt></p>\n<h2 id=\"小技巧\"><a href=\"#小技巧\" class=\"headerlink\" title=\"小技巧\"></a>小技巧</h2><script async class=\"speakerdeck-embed\" data-slide=\"10\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<h3 id=\"Join-type\"><a href=\"#Join-type\" class=\"headerlink\" title=\"Join type\"></a>Join type</h3><p>常常會機器人加入群組後會發出一個<code>歡迎訊息</code>，透過 API 的方式會看到 JSON 裡有個 <code>type</code> 的欄位，判斷它是否為 <code>join</code> 即可回傳歡迎訊息。</p>\n<p>另外說明文件有提到，若是 room(聊天室) 需要在其他使用者發送文字(event) 觸發才能讓機器人第一次收到訊息後回傳歡迎訊息。</p>\n<h3 id=\"如何確認-Group-amp-Room\"><a href=\"#如何確認-Group-amp-Room\" class=\"headerlink\" title=\"如何確認 Group &amp; Room\"></a>如何確認 Group &amp; Room</h3><script async class=\"speakerdeck-embed\" data-slide=\"11\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>當機器人收到 event 時，在當中的 <code>source</code> 會有 type 來放入當前是何種性質的群組。</p>\n<h2 id=\"小結\"><a href=\"#小結\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>透過每個月的講解讓大家都可以更清楚的了解到 LINE 的更新進度並獲得第一手消息，想知道更多訊息歡迎持續關注社團喔！</p>\n<p>LINE 若有更新時都會同步到 <a href=\"https://github.com/line/line-bot-sdk-python/issues/271\" target=\"_blank\" rel=\"noopener\">GitHub issue</a> 上，所以不仿追隨一下有新的 issue 時就能第一手收到通知並送 PR 當貢獻者喔！</p>\n<h1 id=\"Keynote-2-專為高中生設計的管家型聊天機器人-廖煥杰\"><a href=\"#Keynote-2-專為高中生設計的管家型聊天機器人-廖煥杰\" class=\"headerlink\" title=\"Keynote 2 - 專為高中生設計的管家型聊天機器人 - 廖煥杰\"></a>Keynote 2 - <a href=\"https://drive.google.com/file/d/10Qd-XvznwN_qVkZj2gXK3eLT3PPTqvc3/view?usp=sharing\" target=\"_blank\" rel=\"noopener\">專為高中生設計的管家型聊天機器人 - 廖煥杰</a></h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/HTXvpKWyNHE\" target=\"_blank\" rel=\"noopener\">https://youtu.be/HTXvpKWyNHE</a></p>\n</blockquote>\n<p>這個議程由高二的煥杰來分享，首先為什麼會做這個機器人三個主要原因：</p>\n<ul>\n<li>同學常常忘了帶考師準備的書籍。</li>\n<li>提醒學生未來幾天的考試行程，幫大家決定今天要帶的書回家。</li>\n<li>讓大家有效學習。</li>\n</ul>\n<h2 id=\"設計理念\"><a href=\"#設計理念\" class=\"headerlink\" title=\"設計理念\"></a>設計理念</h2><ul>\n<li>為了避免被亂搞需要權限控制</li>\n<li>放學推播功能</li>\n<li>學校、老師有權限可以看到所有人的體溫</li>\n</ul>\n<h2 id=\"遇到的問題\"><a href=\"#遇到的問題\" class=\"headerlink\" title=\"遇到的問題\"></a>遇到的問題</h2><p>當中講者也提到他們 SQL 的進化史，由於 google spreadsheet 每 100ms 只能有 100 請求導致服務出問題，因此就搬到 MySQL 上。</p>\n<p>當中也因為遇到疫情的關係所以開發出<code>體溫回報系統</code>，也有因為自己需求的關係而開發<code>放學前會推播今天的作業</code>，讓大家可以帶相關參考書回家。</p>\n<p>也需要依照不同季節提供不同的 Richmenu 選單。</p>\n<h2 id=\"未來展望\"><a href=\"#未來展望\" class=\"headerlink\" title=\"未來展望\"></a>未來展望</h2><ul>\n<li>人臉辨識結合體溫測量</li>\n<li>重構程式碼，讓城市更漂亮</li>\n<li>評估改用 No SQL 來降低成本與請求速度</li>\n<li>網頁管理介面</li>\n<li>推廣到全台灣高中</li>\n</ul>\n<blockquote>\n<p><a href=\"https://github.com/cbfhss\" target=\"_blank\" rel=\"noopener\">Github</a></p>\n</blockquote>\n<h2 id=\"小結-1\"><a href=\"#小結-1\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>很有想法的高中生，從生活中解決需求一直都是一個好的方向去實踐專案，希望這隻機器人可以趕快完成未來展望的部分，期待繼續在社團露臉 😁。</p>\n<h1 id=\"Keynote-3-LIFF-amp-Firebase-Richard-Lee\"><a href=\"#Keynote-3-LIFF-amp-Firebase-Richard-Lee\" class=\"headerlink\" title=\"Keynote 3 - LIFF &amp; Firebase - Richard Lee\"></a>Keynote 3 - <a href=\"https://docs.google.com/presentation/d/1ZJIDpw9Cmte_9w1NxKHxzXtoaFBXsKVH7tQd4zlvb8k/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">LIFF &amp; Firebase - Richard Lee</a></h1><p><img src=\"https://i.imgur.com/pApsiyi.png\" alt></p>\n<blockquote>\n<p>直播錄影網址： <a href=\"https://youtu.be/U_nPlkTuk9s\" target=\"_blank\" rel=\"noopener\">https://youtu.be/U_nPlkTuk9s</a></p>\n</blockquote>\n<p>一開始提到 LINE 在剛開始推出 LIFF 時其實沒那麼好用，然而隨著時間的推移 LINE 有聽到大家的心聲持續更新到今日挺好用的地步，也開發出特別的功能 - share target picker 來分享訊息，也因為類似的功能讓 LIFF 介於聊天機器人與行動網頁之間，且隨之而來 LIFF v2 也開始支援 web 囉！</p>\n<p>基本上 LIFF 的組成為 一個一般的 web app + LINE 的 “user credentials” 以及透過 SDK 去 get profile / send message。</p>\n<h2 id=\"Why-Firebase-hosting\"><a href=\"#Why-Firebase-hosting\" class=\"headerlink\" title=\"Why Firebase hosting\"></a>Why Firebase hosting</h2><p>他有以下幾個特性：</p>\n<ul>\n<li>可以放置 web page</li>\n<li>幫助網頁開發的功能</li>\n<li>分析工具(FCM）</li>\n<li>Firebase is a collection of mobile-related products</li>\n<li>一上去全球部署(CDN)，機房就在台灣/香港</li>\n<li>No cold start</li>\n</ul>\n<p>在一番的火力展示後讓我瞭解到 Firebase 的完整性，其功能不僅擁有像是 AWS S3 的功能，同時擁有像是 AWS Lambda 的功能，並能夠在前端頁面 real time 去更新資料庫裡的值，讓大家能在這裡見識到這部分真的是賺到了！</p>\n<h2 id=\"Firebase-Auth-Security-rules\"><a href=\"#Firebase-Auth-Security-rules\" class=\"headerlink\" title=\"Firebase Auth / Security rules\"></a>Firebase Auth / Security rules</h2><p>設計再好的產品都會有沒注意到的地方，總不能讓我們放置的 LIFF 網頁被人家輕易的挖走東西，因此 Firebase 提供安全認證相關的機制，管理人員處理<code>新增</code>、<code>刪除</code>這類較危險的操作。</p>\n<h2 id=\"小結-2\"><a href=\"#小結-2\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>能夠聽到含有 LAE &amp; GDE 認證的專家分享這麼精實的內容實在是很賺，從中完美整合了 LINE 以及 Google 的服務讓我歎為觀止，讓我新的目標可以學新東西了！</p>\n<h1 id=\"Keynote-4-對話式表單架構設計-郭佳甯\"><a href=\"#Keynote-4-對話式表單架構設計-郭佳甯\" class=\"headerlink\" title=\"Keynote 4 - 對話式表單架構設計 - 郭佳甯\"></a>Keynote 4 - <a href=\"https://docs.google.com/presentation/d/1np4_d6grkw6kMD-jSnMFFj2yH8FwT2SaEdNKKfA0w7w/edit\" target=\"_blank\" rel=\"noopener\">對話式表單架構設計 - 郭佳甯</a></h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/ScLQeFIJjLE\" target=\"_blank\" rel=\"noopener\">https://youtu.be/ScLQeFIJjLE</a></p>\n</blockquote>\n<p>本次再度邀請卡米哥前來分享主題，這次的主題很常會在討論區出現，在表單設計上一定是網頁(LIFF)來處理是較妥當的，但總不會每個需求都這麼完美，因此本次就分享在 Chatbot 上得多輪對話設計架構。</p>\n<p><img src=\"https://i.imgur.com/OIb1vz9l.png\" alt></p>\n<p>對話式表單常會有以下需求：</p>\n<ul>\n<li>多欄位填寫</li>\n<li>表單驗證</li>\n<li>代換詞(縮寫)</li>\n<li>對話跳脫</li>\n</ul>\n<p>利用了點飲料的需求清楚講解並帶大家認識整個對話的流程，接著就帶大家認識 DialogFlow，之前我有參加 chatbot taichung 工作坊，可以<a href=\"https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3\" target=\"_blank\" rel=\"noopener\">參考文章</a>中的做法實作(細節可能有改要注意)。</p>\n<p>它帶來的好處可以迅速建立多欄位表單，但經由實測後有時跳脫後對話會跳不回去導至錯亂，且講者認為 Context 用於對話是表單違反直覺。</p>\n<h2 id=\"認識Bottender\"><a href=\"#認識Bottender\" class=\"headerlink\" title=\"認識Bottender\"></a>認識<a href=\"https://bottender.js.org/\" target=\"_blank\" rel=\"noopener\">Bottender</a></h2><p>最後提到了我也很常用的 Bottender，它的三個主要脈絡為 Action、Chain、Routing，細節可以<a href=\"https://bottender.js.org/docs/zh-TW/getting-started\" target=\"_blank\" rel=\"noopener\">參考文件</a></p>\n<p>也因多輪對話需求越來越多，因此他們就有開出這樣的需求：<br><img src=\"https://i.imgur.com/la39kaZ.png\" alt></p>\n<h2 id=\"proposal\"><a href=\"#proposal\" class=\"headerlink\" title=\"proposal:\"></a>proposal:</h2><ul>\n<li>registerAction: 註冊 Action</li>\n<li>getAction: 取得 Action</li>\n<li>prompt: 向用戶發問</li>\n<li>setField: 設定表單欄位</li>\n<li>deleteField: 刪除欄位</li>\n</ul>\n<p>透過像是以上的 APIs 上開發者可以迅速建立對話式表單，並且處理<code>珍奶例子</code>的問題，雖然有提到 <code>缺乏高階語法糖</code>，但工具向來都是先求有再求好，也許未來會有不同的解決方案來處理這部分～</p>\n<h2 id=\"小結-3\"><a href=\"#小結-3\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>透過生活中常遇到的例子帶入應用情境上讓大家更能融入其中，接著敘述實作上的問題並且提出目前如何處理這部分來解決必須在 Chatbot 中做對話的這件事上，\b 而 Bottender 持續貢獻於 open source 中，如果支持並有想贊助的朋友歡迎聯絡他們 🙂。</p>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><h2 id=\"1-奇步老爹（陳佳新）-LIFF-圖片測試工具，設計師和工程師從此溝通無礙\"><a href=\"#1-奇步老爹（陳佳新）-LIFF-圖片測試工具，設計師和工程師從此溝通無礙\" class=\"headerlink\" title=\"1. 奇步老爹（陳佳新）- LIFF 圖片測試工具，設計師和工程師從此溝通無礙\"></a>1. 奇步老爹（陳佳新）- <a href=\"https://www.slideshare.net/jarsing/20200623liffbgtester/jarsing/20200623liffbgtester\" target=\"_blank\" rel=\"noopener\">LIFF 圖片測試工具，設計師和工程師從此溝通無礙</a></h2><blockquote>\n<p>直播錄影網址： <a href=\"https://youtu.be/q2E9W4RDGW0\" target=\"_blank\" rel=\"noopener\">https://youtu.be/q2E9W4RDGW0</a></p>\n</blockquote>\n<p>在沒有設計師的情況下需要刻 UI 就只能使用工具，而講者即提供了 Chatbot 供大家測試使用。<br><img src=\"https://i.imgur.com/LpSvuUAl.jpg\" alt></p>\n<p>操作流程：<br><img src=\"https://i.imgur.com/NnegZEB.jpg\" alt></p>\n<h2 id=\"2-黃鈞亭-結合-LINE-和-Google-Suite-來做定時回報系統\"><a href=\"#2-黃鈞亭-結合-LINE-和-Google-Suite-來做定時回報系統\" class=\"headerlink\" title=\"2. 黃鈞亭 - 結合 LINE 和 Google Suite 來做定時回報系統\"></a>2. 黃鈞亭 - <a href=\"https://docs.google.com/presentation/d/1Xb6NWCLEqW5q74KOSjm51TWwokM-VXlBcOkpJqA2iTE/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">結合 LINE 和 Google Suite 來做定時回報系統</a></h2><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/v6BNMJv782c\" target=\"_blank\" rel=\"noopener\">https://youtu.be/v6BNMJv782c</a></p>\n</blockquote>\n<p>因為軍中使用 LINE 回報時的 race condition 問題而讓講者動身實作一隻機器人處理問題，透過填寫 google 表單的方式也不會出現像前面講者所遇到的多輪對話問題。</p>\n<p>架構:<br><img src=\"https://i.imgur.com/KJdu5qd.png\" alt></p>\n<p>Github source: <a href=\"https://github.com/chungthuang/line-report-bot\" target=\"_blank\" rel=\"noopener\">https://github.com/chungthuang/line-report-bot</a></p>\n<h2 id=\"臺北科技大學-即時通智慧攝影機-EdgeTPU-碰上-LINE-Bot\"><a href=\"#臺北科技大學-即時通智慧攝影機-EdgeTPU-碰上-LINE-Bot\" class=\"headerlink\" title=\"臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)\"></a>臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)</h2><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/4QcxQLVgiso\" target=\"_blank\" rel=\"noopener\">https://youtu.be/4QcxQLVgiso</a></p>\n</blockquote>\n<p>主要解決讓不熟 APP 但熟悉即時通訊軟體的使用者來串接攝影機功能，結合 google 新出的開發版並讓使用者掃描裝置上的 QR Code 跟 LINE 做綁定，接著攝影機開始偵測後若發現有人經過時則會 push message 給用戶告知有問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>超精實的一天，難得疫情後的線下小聚還有 LINE 贊助場地與餐點，把握這次機會再次北上與大家一起舉辦社群活動，促進資訊交流並認識大家，接下來社群還是會持續舉辦月聚，請大家持續關注社群，會將第一手資訊發出來讓大家知道 🙂。</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/eaU663s.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>疫情穩定並解封後終於迎來期待已久的第 20 場小聚，且這次更是來到我最喜歡的熊大寶殿 - LINE 裡頭辦活動，感謝場地方贊助熊大、美食、飲料讓大家吃飽喝足，並且我們邀請了許多大大來分享超超超精實的議程!!</p>\n<p>社群：<a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">https://www.facebook.com/groups/chatbot.tw/</a><br>共筆：<a href=\"https://hackmd.io/@chatbot-tw/meetups-020\" target=\"_blank\" rel=\"noopener\">https://hackmd.io/@chatbot-tw/meetups-020</a><br>直播回顧：<a href=\"https://youtu.be/VxcpDFHWOb8?t=2146\" target=\"_blank\" rel=\"noopener\">https://youtu.be/VxcpDFHWOb8?t=2146</a></p>\n<p>那接下來就分享本次我參加的心得囉！🙂</p>","more":"<h1 id=\"Keynote-1-LINE-API-Update-Evan-Lin\"><a href=\"#Keynote-1-LINE-API-Update-Evan-Lin\" class=\"headerlink\" title=\"Keynote 1 - LINE API Update - Evan Lin\"></a>Keynote 1 - LINE API Update - Evan Lin</h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/gtpm4zKlsXI\" target=\"_blank\" rel=\"noopener\">https://youtu.be/gtpm4zKlsXI</a></p>\n</blockquote>\n<p>首先 LINE Taiwan 資深技術推廣工程師 Evan 為我們帶來 LINE API 六月的更新介紹。</p>\n<script async class=\"speakerdeck-embed\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<blockquote>\n<p><a href=\"https://speakerdeck.com/line_developers_tw/room-api-demo\" target=\"_blank\" rel=\"noopener\">簡報</a></p>\n</blockquote>\n<ul>\n<li>06/09 Flex Message Simulator 教學文件釋出囉</li>\n<li>06/10 LINE API Update<ul>\n<li>Get group summary</li>\n<li>Get members in group count</li>\n<li>Get members in room count</li>\n</ul>\n</li>\n<li>06/15 LINE Login 可以透過連結(link)到 Official Account</li>\n<li>06/15 LIFF SDK error code</li>\n</ul>\n<h2 id=\"群組-Get-group-summary-amp-Get-members-in-group-count\"><a href=\"#群組-Get-group-summary-amp-Get-members-in-group-count\" class=\"headerlink\" title=\"[群組] Get group summary &amp; Get members in group count\"></a>[群組] Get group summary &amp; Get members in group count</h2><p>以往機器人只能取得個人資訊，而六月提供了這個 API 可以取得群組的資訊，跟使用者的資料格式差不多：<br><img src=\"https://i.imgur.com/3xEHM49.png\" alt></p>\n<p>多了這個功能後能讓機器人在面對各個群組時能更有效地在後端管控來源群組，並且透過 <code>Get members in group count</code> 這個 API 來取得當前人數，做出類似行銷後台那樣讓使用者可以看到更完整的資訊。</p>\n<blockquote>\n<p>Tip: 一個群組只能一隻機器人喔！</p>\n</blockquote>\n<h2 id=\"聊天室-Get-members-in-room-count\"><a href=\"#聊天室-Get-members-in-room-count\" class=\"headerlink\" title=\"[聊天室] Get members in room count\"></a>[聊天室] Get members in room count</h2><p>聊天室與群組的差異在於他不可以踢人，而功能上與群組差不多，一樣可以加機器人進來，可以透過這 API 知道當前群組有多少人，一樣可以管理除了群組以外的<code>聊天室們</code>。</p>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>LINE bot group 範例(Golang): <a href=\"https://github.com/kkdai/linebot-group\" target=\"_blank\" rel=\"noopener\">https://github.com/kkdai/linebot-group</a></p>\n<p>QR COde (部屬於 Heroku)：<br><img src=\"https://i.imgur.com/qbUsN2z.png\" alt></p>\n<h2 id=\"小技巧\"><a href=\"#小技巧\" class=\"headerlink\" title=\"小技巧\"></a>小技巧</h2><script async class=\"speakerdeck-embed\" data-slide=\"10\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<h3 id=\"Join-type\"><a href=\"#Join-type\" class=\"headerlink\" title=\"Join type\"></a>Join type</h3><p>常常會機器人加入群組後會發出一個<code>歡迎訊息</code>，透過 API 的方式會看到 JSON 裡有個 <code>type</code> 的欄位，判斷它是否為 <code>join</code> 即可回傳歡迎訊息。</p>\n<p>另外說明文件有提到，若是 room(聊天室) 需要在其他使用者發送文字(event) 觸發才能讓機器人第一次收到訊息後回傳歡迎訊息。</p>\n<h3 id=\"如何確認-Group-amp-Room\"><a href=\"#如何確認-Group-amp-Room\" class=\"headerlink\" title=\"如何確認 Group &amp; Room\"></a>如何確認 Group &amp; Room</h3><script async class=\"speakerdeck-embed\" data-slide=\"11\" data-id=\"8517c0f0cbba4a18854c672827f71d86\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n<p>當機器人收到 event 時，在當中的 <code>source</code> 會有 type 來放入當前是何種性質的群組。</p>\n<h2 id=\"小結\"><a href=\"#小結\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>透過每個月的講解讓大家都可以更清楚的了解到 LINE 的更新進度並獲得第一手消息，想知道更多訊息歡迎持續關注社團喔！</p>\n<p>LINE 若有更新時都會同步到 <a href=\"https://github.com/line/line-bot-sdk-python/issues/271\" target=\"_blank\" rel=\"noopener\">GitHub issue</a> 上，所以不仿追隨一下有新的 issue 時就能第一手收到通知並送 PR 當貢獻者喔！</p>\n<h1 id=\"Keynote-2-專為高中生設計的管家型聊天機器人-廖煥杰\"><a href=\"#Keynote-2-專為高中生設計的管家型聊天機器人-廖煥杰\" class=\"headerlink\" title=\"Keynote 2 - 專為高中生設計的管家型聊天機器人 - 廖煥杰\"></a>Keynote 2 - <a href=\"https://drive.google.com/file/d/10Qd-XvznwN_qVkZj2gXK3eLT3PPTqvc3/view?usp=sharing\" target=\"_blank\" rel=\"noopener\">專為高中生設計的管家型聊天機器人 - 廖煥杰</a></h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/HTXvpKWyNHE\" target=\"_blank\" rel=\"noopener\">https://youtu.be/HTXvpKWyNHE</a></p>\n</blockquote>\n<p>這個議程由高二的煥杰來分享，首先為什麼會做這個機器人三個主要原因：</p>\n<ul>\n<li>同學常常忘了帶考師準備的書籍。</li>\n<li>提醒學生未來幾天的考試行程，幫大家決定今天要帶的書回家。</li>\n<li>讓大家有效學習。</li>\n</ul>\n<h2 id=\"設計理念\"><a href=\"#設計理念\" class=\"headerlink\" title=\"設計理念\"></a>設計理念</h2><ul>\n<li>為了避免被亂搞需要權限控制</li>\n<li>放學推播功能</li>\n<li>學校、老師有權限可以看到所有人的體溫</li>\n</ul>\n<h2 id=\"遇到的問題\"><a href=\"#遇到的問題\" class=\"headerlink\" title=\"遇到的問題\"></a>遇到的問題</h2><p>當中講者也提到他們 SQL 的進化史，由於 google spreadsheet 每 100ms 只能有 100 請求導致服務出問題，因此就搬到 MySQL 上。</p>\n<p>當中也因為遇到疫情的關係所以開發出<code>體溫回報系統</code>，也有因為自己需求的關係而開發<code>放學前會推播今天的作業</code>，讓大家可以帶相關參考書回家。</p>\n<p>也需要依照不同季節提供不同的 Richmenu 選單。</p>\n<h2 id=\"未來展望\"><a href=\"#未來展望\" class=\"headerlink\" title=\"未來展望\"></a>未來展望</h2><ul>\n<li>人臉辨識結合體溫測量</li>\n<li>重構程式碼，讓城市更漂亮</li>\n<li>評估改用 No SQL 來降低成本與請求速度</li>\n<li>網頁管理介面</li>\n<li>推廣到全台灣高中</li>\n</ul>\n<blockquote>\n<p><a href=\"https://github.com/cbfhss\" target=\"_blank\" rel=\"noopener\">Github</a></p>\n</blockquote>\n<h2 id=\"小結-1\"><a href=\"#小結-1\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>很有想法的高中生，從生活中解決需求一直都是一個好的方向去實踐專案，希望這隻機器人可以趕快完成未來展望的部分，期待繼續在社團露臉 😁。</p>\n<h1 id=\"Keynote-3-LIFF-amp-Firebase-Richard-Lee\"><a href=\"#Keynote-3-LIFF-amp-Firebase-Richard-Lee\" class=\"headerlink\" title=\"Keynote 3 - LIFF &amp; Firebase - Richard Lee\"></a>Keynote 3 - <a href=\"https://docs.google.com/presentation/d/1ZJIDpw9Cmte_9w1NxKHxzXtoaFBXsKVH7tQd4zlvb8k/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">LIFF &amp; Firebase - Richard Lee</a></h1><p><img src=\"https://i.imgur.com/pApsiyi.png\" alt></p>\n<blockquote>\n<p>直播錄影網址： <a href=\"https://youtu.be/U_nPlkTuk9s\" target=\"_blank\" rel=\"noopener\">https://youtu.be/U_nPlkTuk9s</a></p>\n</blockquote>\n<p>一開始提到 LINE 在剛開始推出 LIFF 時其實沒那麼好用，然而隨著時間的推移 LINE 有聽到大家的心聲持續更新到今日挺好用的地步，也開發出特別的功能 - share target picker 來分享訊息，也因為類似的功能讓 LIFF 介於聊天機器人與行動網頁之間，且隨之而來 LIFF v2 也開始支援 web 囉！</p>\n<p>基本上 LIFF 的組成為 一個一般的 web app + LINE 的 “user credentials” 以及透過 SDK 去 get profile / send message。</p>\n<h2 id=\"Why-Firebase-hosting\"><a href=\"#Why-Firebase-hosting\" class=\"headerlink\" title=\"Why Firebase hosting\"></a>Why Firebase hosting</h2><p>他有以下幾個特性：</p>\n<ul>\n<li>可以放置 web page</li>\n<li>幫助網頁開發的功能</li>\n<li>分析工具(FCM）</li>\n<li>Firebase is a collection of mobile-related products</li>\n<li>一上去全球部署(CDN)，機房就在台灣/香港</li>\n<li>No cold start</li>\n</ul>\n<p>在一番的火力展示後讓我瞭解到 Firebase 的完整性，其功能不僅擁有像是 AWS S3 的功能，同時擁有像是 AWS Lambda 的功能，並能夠在前端頁面 real time 去更新資料庫裡的值，讓大家能在這裡見識到這部分真的是賺到了！</p>\n<h2 id=\"Firebase-Auth-Security-rules\"><a href=\"#Firebase-Auth-Security-rules\" class=\"headerlink\" title=\"Firebase Auth / Security rules\"></a>Firebase Auth / Security rules</h2><p>設計再好的產品都會有沒注意到的地方，總不能讓我們放置的 LIFF 網頁被人家輕易的挖走東西，因此 Firebase 提供安全認證相關的機制，管理人員處理<code>新增</code>、<code>刪除</code>這類較危險的操作。</p>\n<h2 id=\"小結-2\"><a href=\"#小結-2\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>能夠聽到含有 LAE &amp; GDE 認證的專家分享這麼精實的內容實在是很賺，從中完美整合了 LINE 以及 Google 的服務讓我歎為觀止，讓我新的目標可以學新東西了！</p>\n<h1 id=\"Keynote-4-對話式表單架構設計-郭佳甯\"><a href=\"#Keynote-4-對話式表單架構設計-郭佳甯\" class=\"headerlink\" title=\"Keynote 4 - 對話式表單架構設計 - 郭佳甯\"></a>Keynote 4 - <a href=\"https://docs.google.com/presentation/d/1np4_d6grkw6kMD-jSnMFFj2yH8FwT2SaEdNKKfA0w7w/edit\" target=\"_blank\" rel=\"noopener\">對話式表單架構設計 - 郭佳甯</a></h1><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/ScLQeFIJjLE\" target=\"_blank\" rel=\"noopener\">https://youtu.be/ScLQeFIJjLE</a></p>\n</blockquote>\n<p>本次再度邀請卡米哥前來分享主題，這次的主題很常會在討論區出現，在表單設計上一定是網頁(LIFF)來處理是較妥當的，但總不會每個需求都這麼完美，因此本次就分享在 Chatbot 上得多輪對話設計架構。</p>\n<p><img src=\"https://i.imgur.com/OIb1vz9l.png\" alt></p>\n<p>對話式表單常會有以下需求：</p>\n<ul>\n<li>多欄位填寫</li>\n<li>表單驗證</li>\n<li>代換詞(縮寫)</li>\n<li>對話跳脫</li>\n</ul>\n<p>利用了點飲料的需求清楚講解並帶大家認識整個對話的流程，接著就帶大家認識 DialogFlow，之前我有參加 chatbot taichung 工作坊，可以<a href=\"https://medium.com/@nijia.lin/chatbot-taichung-2-%E5%B7%A5%E4%BD%9C%E5%9D%8A%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB-bc964fdc07c3\" target=\"_blank\" rel=\"noopener\">參考文章</a>中的做法實作(細節可能有改要注意)。</p>\n<p>它帶來的好處可以迅速建立多欄位表單，但經由實測後有時跳脫後對話會跳不回去導至錯亂，且講者認為 Context 用於對話是表單違反直覺。</p>\n<h2 id=\"認識Bottender\"><a href=\"#認識Bottender\" class=\"headerlink\" title=\"認識Bottender\"></a>認識<a href=\"https://bottender.js.org/\" target=\"_blank\" rel=\"noopener\">Bottender</a></h2><p>最後提到了我也很常用的 Bottender，它的三個主要脈絡為 Action、Chain、Routing，細節可以<a href=\"https://bottender.js.org/docs/zh-TW/getting-started\" target=\"_blank\" rel=\"noopener\">參考文件</a></p>\n<p>也因多輪對話需求越來越多，因此他們就有開出這樣的需求：<br><img src=\"https://i.imgur.com/la39kaZ.png\" alt></p>\n<h2 id=\"proposal\"><a href=\"#proposal\" class=\"headerlink\" title=\"proposal:\"></a>proposal:</h2><ul>\n<li>registerAction: 註冊 Action</li>\n<li>getAction: 取得 Action</li>\n<li>prompt: 向用戶發問</li>\n<li>setField: 設定表單欄位</li>\n<li>deleteField: 刪除欄位</li>\n</ul>\n<p>透過像是以上的 APIs 上開發者可以迅速建立對話式表單，並且處理<code>珍奶例子</code>的問題，雖然有提到 <code>缺乏高階語法糖</code>，但工具向來都是先求有再求好，也許未來會有不同的解決方案來處理這部分～</p>\n<h2 id=\"小結-3\"><a href=\"#小結-3\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>透過生活中常遇到的例子帶入應用情境上讓大家更能融入其中，接著敘述實作上的問題並且提出目前如何處理這部分來解決必須在 Chatbot 中做對話的這件事上，\b 而 Bottender 持續貢獻於 open source 中，如果支持並有想贊助的朋友歡迎聯絡他們 🙂。</p>\n<h1 id=\"閃電秀\"><a href=\"#閃電秀\" class=\"headerlink\" title=\"閃電秀\"></a>閃電秀</h1><h2 id=\"1-奇步老爹（陳佳新）-LIFF-圖片測試工具，設計師和工程師從此溝通無礙\"><a href=\"#1-奇步老爹（陳佳新）-LIFF-圖片測試工具，設計師和工程師從此溝通無礙\" class=\"headerlink\" title=\"1. 奇步老爹（陳佳新）- LIFF 圖片測試工具，設計師和工程師從此溝通無礙\"></a>1. 奇步老爹（陳佳新）- <a href=\"https://www.slideshare.net/jarsing/20200623liffbgtester/jarsing/20200623liffbgtester\" target=\"_blank\" rel=\"noopener\">LIFF 圖片測試工具，設計師和工程師從此溝通無礙</a></h2><blockquote>\n<p>直播錄影網址： <a href=\"https://youtu.be/q2E9W4RDGW0\" target=\"_blank\" rel=\"noopener\">https://youtu.be/q2E9W4RDGW0</a></p>\n</blockquote>\n<p>在沒有設計師的情況下需要刻 UI 就只能使用工具，而講者即提供了 Chatbot 供大家測試使用。<br><img src=\"https://i.imgur.com/LpSvuUAl.jpg\" alt></p>\n<p>操作流程：<br><img src=\"https://i.imgur.com/NnegZEB.jpg\" alt></p>\n<h2 id=\"2-黃鈞亭-結合-LINE-和-Google-Suite-來做定時回報系統\"><a href=\"#2-黃鈞亭-結合-LINE-和-Google-Suite-來做定時回報系統\" class=\"headerlink\" title=\"2. 黃鈞亭 - 結合 LINE 和 Google Suite 來做定時回報系統\"></a>2. 黃鈞亭 - <a href=\"https://docs.google.com/presentation/d/1Xb6NWCLEqW5q74KOSjm51TWwokM-VXlBcOkpJqA2iTE/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">結合 LINE 和 Google Suite 來做定時回報系統</a></h2><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/v6BNMJv782c\" target=\"_blank\" rel=\"noopener\">https://youtu.be/v6BNMJv782c</a></p>\n</blockquote>\n<p>因為軍中使用 LINE 回報時的 race condition 問題而讓講者動身實作一隻機器人處理問題，透過填寫 google 表單的方式也不會出現像前面講者所遇到的多輪對話問題。</p>\n<p>架構:<br><img src=\"https://i.imgur.com/KJdu5qd.png\" alt></p>\n<p>Github source: <a href=\"https://github.com/chungthuang/line-report-bot\" target=\"_blank\" rel=\"noopener\">https://github.com/chungthuang/line-report-bot</a></p>\n<h2 id=\"臺北科技大學-即時通智慧攝影機-EdgeTPU-碰上-LINE-Bot\"><a href=\"#臺北科技大學-即時通智慧攝影機-EdgeTPU-碰上-LINE-Bot\" class=\"headerlink\" title=\"臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)\"></a>臺北科技大學 - 即時通智慧攝影機(EdgeTPU 碰上 LINE Bot)</h2><blockquote>\n<p>直播錄影網址：<a href=\"https://youtu.be/4QcxQLVgiso\" target=\"_blank\" rel=\"noopener\">https://youtu.be/4QcxQLVgiso</a></p>\n</blockquote>\n<p>主要解決讓不熟 APP 但熟悉即時通訊軟體的使用者來串接攝影機功能，結合 google 新出的開發版並讓使用者掃描裝置上的 QR Code 跟 LINE 做綁定，接著攝影機開始偵測後若發現有人經過時則會 push message 給用戶告知有問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>超精實的一天，難得疫情後的線下小聚還有 LINE 贊助場地與餐點，把握這次機會再次北上與大家一起舉辦社群活動，促進資訊交流並認識大家，接下來社群還是會持續舉辦月聚，請大家持續關注社群，會將第一手資訊發出來讓大家知道 🙂。</p>"},{"title":"在 Hexo 樣式的部落格引入 PlantUML","abbrlink":715192278,"date":"2020-06-03T10:59:38.000Z","_content":"\n![](https://cdn.pixabay.com/photo/2015/03/04/16/11/sunset-659012_1280.jpg)\n\n# 前言\n\n我在上一篇的文章 - [從 Http 請求到認識 OAuth 以及 OpenID](https://nijialin.com/2020/06/01/%E5%BE%9E-Http-%E8%AB%8B%E6%B1%82%E5%88%B0%E8%AA%8D%E8%AD%98-OAuth-%E4%BB%A5%E5%8F%8A-OpenID/) 中引入了 `PlantUML`，主要是看了[這篇文章後](https://www.evanlin.com/til-vscode-plantuml/)啟發我使用 UML 來畫圖，除了可以動手畫流程讓自己更了解外，也不用到處去找適合的圖並且能讓文章的風格統一。\n\n但若要 Markdown 支援 PlantUML 的話還需要額外安裝套件，這邊就以我部落格的樣式 - Hexo 的 next Theme 來描述實作過程！🙂\n\n> 下載位置: [VScode PlantUML 套件](https://marketplace.visualstudio.com/items?itemName=jebbs.plantuml)\n\n<!-- more -->\n\n# 介紹\n\n因為是使用 hexo，從[官網的 Plugins](https://hexo.io/plugins/) 中找到後決定使用[hexo-filter-plantuml](https://github.com/miao1007/hexo-filter-plantuml)\n\n> 不得不說 [hexo 官網](https://hexo.io/plugins/)真的是很多特別又好玩的套件，大家可以上去找找看有沒有適合自己寫作風格的套件喔！\n\n## 寫作環境\n\n- VScode\n- MacOS\n- Hexo 樣板\n\n詳細的流程可以參考 Evan 的文章 - [[TIL] 在 vscode 上面安裝並且使用 PlantUML](https://www.evanlin.com/til-vscode-plantuml/)\n\n## 實例\n\n首先一般在編輯器上開發完應該會像這樣:\n![](https://i.imgur.com/CEoFn8h.jpg)\n\n想說寫好太棒了 🎉，我要把它放到部落格上，結果就會變成這樣:\n![](https://i.imgur.com/LwXokuE.png)\n\n這下可好了這樣是誰看得懂 😤！\n\n此時就使用 npm 來幫忙安裝(hexo 是基於 Node.js 開發的套件):\n\n```\nnpm install --save hexo-filter-plantuml\n```\n\n##### 避免不能畫其他圖的困擾，這邊也同步安裝:\n\n```\nbrew install graphviz\n```\n\n接下來因為我們只是輸入`標記符號`，但輸出是圖片格式，因此要讓 hexo 在網頁載入時先去轉換 base64-encoded 的圖片並下載至文章上。\n\n首先以為的部落格為例([GitHub](https://github.com/louis70109/nijia-blog-backup))，先進入到\n`themes/` ➡️ `next/` 找到 `_config.yml` 裡的任一行輸入:\n\n```\nplantuml:\n  render: \"PlantUMLServer\"\n```\n\n> 若還是不懂可參考[我的專案](https://github.com/louis70109/nijia-blog-backup/blob/master/themes/next/_config.yml#L139)寫法。\n\n以上是一個簡易的設定，要注意到它文件中是獨立的一層，不是在任何的子階層裡面，若想要更多客製化的功能可以參考[作者文件說明](https://github.com/miao1007/hexo-filter-plantuml#advanced-configuration)。\n\n最後部署上去後就會看到這樣的結果:\n\n![](https://i.imgur.com/gzcJJml.png)\n\n如此一來就大功告成囉！之後就可以拿著 UML 到處跟人家炫耀了 😆\n\n# 注意事項\n\n在寫的時候一定要在頓號後面加上`puml`的標記，這樣 hexo 才看得懂喔！\n\n````\n​```puml\n@startuml\n...省略\n@enduml\n​```\n````\n\n或是習慣另一種寫法的也可以這樣：\n\n```\n{% plantuml %}\n@startuml\n...省略\n@enduml\n{% endplantuml %}\n```\n\n# 用 Node 卻遇到 Java 的問題？\n\n若你不是 Java 的開發者，或許也會遇到這樣的問題：\n\n```\nNo Java runtime present, requesting install.\n```\n\n因為之前因為需要安裝 [openapi-generator](https://github.com/OpenAPITools/openapi-generator) 時有安裝過 Java 相關套件，此時需要至[官網抓取](https://www.oracle.com/java/technologies/)並安裝，之後再執行一次就沒問題囉！\n\n> 我當時是直接到 oracle 官方直接下載 Java SE，但如果這不還是不行可以嘗試看看[這個網站](https://java.com/en/download/mac_download.jsp)\n\n# 結論\n\n為什麼我要用`標記符號`顯示而不是直接`輸出圖片`呢？\n\n因為我們文章可能在發佈之後或是之後回來看時發現流程有錯誤時可以馬上針對特定內容直接修改，而不用再重新找當時寫的檔案位置-輸出圖片 這樣的順序，總之只要將流程圖畫好並透過`程式碼區塊`的語法就能將圖片輸出了，這樣對我寫作來說就能夠更順暢一些了！\n","source":"_posts/create-plant-uml-in-hexo.md","raw":"---\ntitle: 在 Hexo 樣式的部落格引入 PlantUML\ntags:\n  - PlantUML\n  - Hexo\n  - VScode\ncategories: 學習紀錄\nabbrlink: 715192278\ndate: 2020-06-03 18:59:38\n---\n\n![](https://cdn.pixabay.com/photo/2015/03/04/16/11/sunset-659012_1280.jpg)\n\n# 前言\n\n我在上一篇的文章 - [從 Http 請求到認識 OAuth 以及 OpenID](https://nijialin.com/2020/06/01/%E5%BE%9E-Http-%E8%AB%8B%E6%B1%82%E5%88%B0%E8%AA%8D%E8%AD%98-OAuth-%E4%BB%A5%E5%8F%8A-OpenID/) 中引入了 `PlantUML`，主要是看了[這篇文章後](https://www.evanlin.com/til-vscode-plantuml/)啟發我使用 UML 來畫圖，除了可以動手畫流程讓自己更了解外，也不用到處去找適合的圖並且能讓文章的風格統一。\n\n但若要 Markdown 支援 PlantUML 的話還需要額外安裝套件，這邊就以我部落格的樣式 - Hexo 的 next Theme 來描述實作過程！🙂\n\n> 下載位置: [VScode PlantUML 套件](https://marketplace.visualstudio.com/items?itemName=jebbs.plantuml)\n\n<!-- more -->\n\n# 介紹\n\n因為是使用 hexo，從[官網的 Plugins](https://hexo.io/plugins/) 中找到後決定使用[hexo-filter-plantuml](https://github.com/miao1007/hexo-filter-plantuml)\n\n> 不得不說 [hexo 官網](https://hexo.io/plugins/)真的是很多特別又好玩的套件，大家可以上去找找看有沒有適合自己寫作風格的套件喔！\n\n## 寫作環境\n\n- VScode\n- MacOS\n- Hexo 樣板\n\n詳細的流程可以參考 Evan 的文章 - [[TIL] 在 vscode 上面安裝並且使用 PlantUML](https://www.evanlin.com/til-vscode-plantuml/)\n\n## 實例\n\n首先一般在編輯器上開發完應該會像這樣:\n![](https://i.imgur.com/CEoFn8h.jpg)\n\n想說寫好太棒了 🎉，我要把它放到部落格上，結果就會變成這樣:\n![](https://i.imgur.com/LwXokuE.png)\n\n這下可好了這樣是誰看得懂 😤！\n\n此時就使用 npm 來幫忙安裝(hexo 是基於 Node.js 開發的套件):\n\n```\nnpm install --save hexo-filter-plantuml\n```\n\n##### 避免不能畫其他圖的困擾，這邊也同步安裝:\n\n```\nbrew install graphviz\n```\n\n接下來因為我們只是輸入`標記符號`，但輸出是圖片格式，因此要讓 hexo 在網頁載入時先去轉換 base64-encoded 的圖片並下載至文章上。\n\n首先以為的部落格為例([GitHub](https://github.com/louis70109/nijia-blog-backup))，先進入到\n`themes/` ➡️ `next/` 找到 `_config.yml` 裡的任一行輸入:\n\n```\nplantuml:\n  render: \"PlantUMLServer\"\n```\n\n> 若還是不懂可參考[我的專案](https://github.com/louis70109/nijia-blog-backup/blob/master/themes/next/_config.yml#L139)寫法。\n\n以上是一個簡易的設定，要注意到它文件中是獨立的一層，不是在任何的子階層裡面，若想要更多客製化的功能可以參考[作者文件說明](https://github.com/miao1007/hexo-filter-plantuml#advanced-configuration)。\n\n最後部署上去後就會看到這樣的結果:\n\n![](https://i.imgur.com/gzcJJml.png)\n\n如此一來就大功告成囉！之後就可以拿著 UML 到處跟人家炫耀了 😆\n\n# 注意事項\n\n在寫的時候一定要在頓號後面加上`puml`的標記，這樣 hexo 才看得懂喔！\n\n````\n​```puml\n@startuml\n...省略\n@enduml\n​```\n````\n\n或是習慣另一種寫法的也可以這樣：\n\n```\n{% plantuml %}\n@startuml\n...省略\n@enduml\n{% endplantuml %}\n```\n\n# 用 Node 卻遇到 Java 的問題？\n\n若你不是 Java 的開發者，或許也會遇到這樣的問題：\n\n```\nNo Java runtime present, requesting install.\n```\n\n因為之前因為需要安裝 [openapi-generator](https://github.com/OpenAPITools/openapi-generator) 時有安裝過 Java 相關套件，此時需要至[官網抓取](https://www.oracle.com/java/technologies/)並安裝，之後再執行一次就沒問題囉！\n\n> 我當時是直接到 oracle 官方直接下載 Java SE，但如果這不還是不行可以嘗試看看[這個網站](https://java.com/en/download/mac_download.jsp)\n\n# 結論\n\n為什麼我要用`標記符號`顯示而不是直接`輸出圖片`呢？\n\n因為我們文章可能在發佈之後或是之後回來看時發現流程有錯誤時可以馬上針對特定內容直接修改，而不用再重新找當時寫的檔案位置-輸出圖片 這樣的順序，總之只要將流程圖畫好並透過`程式碼區塊`的語法就能將圖片輸出了，這樣對我寫作來說就能夠更順暢一些了！\n","slug":"create-plant-uml-in-hexo","published":1,"updated":"2020-06-21T16:55:09.753Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31kw004f7crih984hxmi","content":"<p><img src=\"https://cdn.pixabay.com/photo/2015/03/04/16/11/sunset-659012_1280.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>我在上一篇的文章 - <a href=\"https://nijialin.com/2020/06/01/%E5%BE%9E-Http-%E8%AB%8B%E6%B1%82%E5%88%B0%E8%AA%8D%E8%AD%98-OAuth-%E4%BB%A5%E5%8F%8A-OpenID/\">從 Http 請求到認識 OAuth 以及 OpenID</a> 中引入了 <code>PlantUML</code>，主要是看了<a href=\"https://www.evanlin.com/til-vscode-plantuml/\" target=\"_blank\" rel=\"noopener\">這篇文章後</a>啟發我使用 UML 來畫圖，除了可以動手畫流程讓自己更了解外，也不用到處去找適合的圖並且能讓文章的風格統一。</p>\n<p>但若要 Markdown 支援 PlantUML 的話還需要額外安裝套件，這邊就以我部落格的樣式 - Hexo 的 next Theme 來描述實作過程！🙂</p>\n<blockquote>\n<p>下載位置: <a href=\"https://marketplace.visualstudio.com/items?itemName=jebbs.plantuml\" target=\"_blank\" rel=\"noopener\">VScode PlantUML 套件</a></p>\n</blockquote>\n<a id=\"more\"></a>\n\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>因為是使用 hexo，從<a href=\"https://hexo.io/plugins/\" target=\"_blank\" rel=\"noopener\">官網的 Plugins</a> 中找到後決定使用<a href=\"https://github.com/miao1007/hexo-filter-plantuml\" target=\"_blank\" rel=\"noopener\">hexo-filter-plantuml</a></p>\n<blockquote>\n<p>不得不說 <a href=\"https://hexo.io/plugins/\" target=\"_blank\" rel=\"noopener\">hexo 官網</a>真的是很多特別又好玩的套件，大家可以上去找找看有沒有適合自己寫作風格的套件喔！</p>\n</blockquote>\n<h2 id=\"寫作環境\"><a href=\"#寫作環境\" class=\"headerlink\" title=\"寫作環境\"></a>寫作環境</h2><ul>\n<li>VScode</li>\n<li>MacOS</li>\n<li>Hexo 樣板</li>\n</ul>\n<p>詳細的流程可以參考 Evan 的文章 - <a href=\"https://www.evanlin.com/til-vscode-plantuml/\" target=\"_blank\" rel=\"noopener\">[TIL] 在 vscode 上面安裝並且使用 PlantUML</a></p>\n<h2 id=\"實例\"><a href=\"#實例\" class=\"headerlink\" title=\"實例\"></a>實例</h2><p>首先一般在編輯器上開發完應該會像這樣:<br><img src=\"https://i.imgur.com/CEoFn8h.jpg\" alt></p>\n<p>想說寫好太棒了 🎉，我要把它放到部落格上，結果就會變成這樣:<br><img src=\"https://i.imgur.com/LwXokuE.png\" alt></p>\n<p>這下可好了這樣是誰看得懂 😤！</p>\n<p>此時就使用 npm 來幫忙安裝(hexo 是基於 Node.js 開發的套件):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-filter-plantuml</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"避免不能畫其他圖的困擾，這邊也同步安裝\"><a href=\"#避免不能畫其他圖的困擾，這邊也同步安裝\" class=\"headerlink\" title=\"避免不能畫其他圖的困擾，這邊也同步安裝:\"></a>避免不能畫其他圖的困擾，這邊也同步安裝:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install graphviz</span><br></pre></td></tr></table></figure>\n\n<p>接下來因為我們只是輸入<code>標記符號</code>，但輸出是圖片格式，因此要讓 hexo 在網頁載入時先去轉換 base64-encoded 的圖片並下載至文章上。</p>\n<p>首先以為的部落格為例(<a href=\"https://github.com/louis70109/nijia-blog-backup\" target=\"_blank\" rel=\"noopener\">GitHub</a>)，先進入到<br><code>themes/</code> ➡️ <code>next/</code> 找到 <code>_config.yml</code> 裡的任一行輸入:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plantuml:</span><br><span class=\"line\">  render: &quot;PlantUMLServer&quot;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>若還是不懂可參考<a href=\"https://github.com/louis70109/nijia-blog-backup/blob/master/themes/next/_config.yml#L139\" target=\"_blank\" rel=\"noopener\">我的專案</a>寫法。</p>\n</blockquote>\n<p>以上是一個簡易的設定，要注意到它文件中是獨立的一層，不是在任何的子階層裡面，若想要更多客製化的功能可以參考<a href=\"https://github.com/miao1007/hexo-filter-plantuml#advanced-configuration\" target=\"_blank\" rel=\"noopener\">作者文件說明</a>。</p>\n<p>最後部署上去後就會看到這樣的結果:</p>\n<p><img src=\"https://i.imgur.com/gzcJJml.png\" alt></p>\n<p>如此一來就大功告成囉！之後就可以拿著 UML 到處跟人家炫耀了 😆</p>\n<h1 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h1><p>在寫的時候一定要在頓號後面加上<code>puml</code>的標記，這樣 hexo 才看得懂喔！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">​&#123;% plantuml %&#125;@startuml</span><br><span class=\"line\">...省略</span><br><span class=\"line\">@enduml</span><br><span class=\"line\">​&#123;% endplantuml %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>或是習慣另一種寫法的也可以這樣：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% plantuml %&#125;</span><br><span class=\"line\">@startuml</span><br><span class=\"line\">...省略</span><br><span class=\"line\">@enduml</span><br><span class=\"line\">&#123;% endplantuml %&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"用-Node-卻遇到-Java-的問題？\"><a href=\"#用-Node-卻遇到-Java-的問題？\" class=\"headerlink\" title=\"用 Node 卻遇到 Java 的問題？\"></a>用 Node 卻遇到 Java 的問題？</h1><p>若你不是 Java 的開發者，或許也會遇到這樣的問題：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">No Java runtime present, requesting install.</span><br></pre></td></tr></table></figure>\n\n<p>因為之前因為需要安裝 <a href=\"https://github.com/OpenAPITools/openapi-generator\" target=\"_blank\" rel=\"noopener\">openapi-generator</a> 時有安裝過 Java 相關套件，此時需要至<a href=\"https://www.oracle.com/java/technologies/\" target=\"_blank\" rel=\"noopener\">官網抓取</a>並安裝，之後再執行一次就沒問題囉！</p>\n<blockquote>\n<p>我當時是直接到 oracle 官方直接下載 Java SE，但如果這不還是不行可以嘗試看看<a href=\"https://java.com/en/download/mac_download.jsp\" target=\"_blank\" rel=\"noopener\">這個網站</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為什麼我要用<code>標記符號</code>顯示而不是直接<code>輸出圖片</code>呢？</p>\n<p>因為我們文章可能在發佈之後或是之後回來看時發現流程有錯誤時可以馬上針對特定內容直接修改，而不用再重新找當時寫的檔案位置-輸出圖片 這樣的順序，總之只要將流程圖畫好並透過<code>程式碼區塊</code>的語法就能將圖片輸出了，這樣對我寫作來說就能夠更順暢一些了！</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://cdn.pixabay.com/photo/2015/03/04/16/11/sunset-659012_1280.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>我在上一篇的文章 - <a href=\"https://nijialin.com/2020/06/01/%E5%BE%9E-Http-%E8%AB%8B%E6%B1%82%E5%88%B0%E8%AA%8D%E8%AD%98-OAuth-%E4%BB%A5%E5%8F%8A-OpenID/\">從 Http 請求到認識 OAuth 以及 OpenID</a> 中引入了 <code>PlantUML</code>，主要是看了<a href=\"https://www.evanlin.com/til-vscode-plantuml/\" target=\"_blank\" rel=\"noopener\">這篇文章後</a>啟發我使用 UML 來畫圖，除了可以動手畫流程讓自己更了解外，也不用到處去找適合的圖並且能讓文章的風格統一。</p>\n<p>但若要 Markdown 支援 PlantUML 的話還需要額外安裝套件，這邊就以我部落格的樣式 - Hexo 的 next Theme 來描述實作過程！🙂</p>\n<blockquote>\n<p>下載位置: <a href=\"https://marketplace.visualstudio.com/items?itemName=jebbs.plantuml\" target=\"_blank\" rel=\"noopener\">VScode PlantUML 套件</a></p>\n</blockquote>","more":"<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>因為是使用 hexo，從<a href=\"https://hexo.io/plugins/\" target=\"_blank\" rel=\"noopener\">官網的 Plugins</a> 中找到後決定使用<a href=\"https://github.com/miao1007/hexo-filter-plantuml\" target=\"_blank\" rel=\"noopener\">hexo-filter-plantuml</a></p>\n<blockquote>\n<p>不得不說 <a href=\"https://hexo.io/plugins/\" target=\"_blank\" rel=\"noopener\">hexo 官網</a>真的是很多特別又好玩的套件，大家可以上去找找看有沒有適合自己寫作風格的套件喔！</p>\n</blockquote>\n<h2 id=\"寫作環境\"><a href=\"#寫作環境\" class=\"headerlink\" title=\"寫作環境\"></a>寫作環境</h2><ul>\n<li>VScode</li>\n<li>MacOS</li>\n<li>Hexo 樣板</li>\n</ul>\n<p>詳細的流程可以參考 Evan 的文章 - <a href=\"https://www.evanlin.com/til-vscode-plantuml/\" target=\"_blank\" rel=\"noopener\">[TIL] 在 vscode 上面安裝並且使用 PlantUML</a></p>\n<h2 id=\"實例\"><a href=\"#實例\" class=\"headerlink\" title=\"實例\"></a>實例</h2><p>首先一般在編輯器上開發完應該會像這樣:<br><img src=\"https://i.imgur.com/CEoFn8h.jpg\" alt></p>\n<p>想說寫好太棒了 🎉，我要把它放到部落格上，結果就會變成這樣:<br><img src=\"https://i.imgur.com/LwXokuE.png\" alt></p>\n<p>這下可好了這樣是誰看得懂 😤！</p>\n<p>此時就使用 npm 來幫忙安裝(hexo 是基於 Node.js 開發的套件):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-filter-plantuml</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"避免不能畫其他圖的困擾，這邊也同步安裝\"><a href=\"#避免不能畫其他圖的困擾，這邊也同步安裝\" class=\"headerlink\" title=\"避免不能畫其他圖的困擾，這邊也同步安裝:\"></a>避免不能畫其他圖的困擾，這邊也同步安裝:</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install graphviz</span><br></pre></td></tr></table></figure>\n\n<p>接下來因為我們只是輸入<code>標記符號</code>，但輸出是圖片格式，因此要讓 hexo 在網頁載入時先去轉換 base64-encoded 的圖片並下載至文章上。</p>\n<p>首先以為的部落格為例(<a href=\"https://github.com/louis70109/nijia-blog-backup\" target=\"_blank\" rel=\"noopener\">GitHub</a>)，先進入到<br><code>themes/</code> ➡️ <code>next/</code> 找到 <code>_config.yml</code> 裡的任一行輸入:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plantuml:</span><br><span class=\"line\">  render: &quot;PlantUMLServer&quot;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>若還是不懂可參考<a href=\"https://github.com/louis70109/nijia-blog-backup/blob/master/themes/next/_config.yml#L139\" target=\"_blank\" rel=\"noopener\">我的專案</a>寫法。</p>\n</blockquote>\n<p>以上是一個簡易的設定，要注意到它文件中是獨立的一層，不是在任何的子階層裡面，若想要更多客製化的功能可以參考<a href=\"https://github.com/miao1007/hexo-filter-plantuml#advanced-configuration\" target=\"_blank\" rel=\"noopener\">作者文件說明</a>。</p>\n<p>最後部署上去後就會看到這樣的結果:</p>\n<p><img src=\"https://i.imgur.com/gzcJJml.png\" alt></p>\n<p>如此一來就大功告成囉！之後就可以拿著 UML 到處跟人家炫耀了 😆</p>\n<h1 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h1><p>在寫的時候一定要在頓號後面加上<code>puml</code>的標記，這樣 hexo 才看得懂喔！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">​&#123;% plantuml %&#125;@startuml</span><br><span class=\"line\">...省略</span><br><span class=\"line\">@enduml</span><br><span class=\"line\">​&#123;% endplantuml %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>或是習慣另一種寫法的也可以這樣：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% plantuml %&#125;</span><br><span class=\"line\">@startuml</span><br><span class=\"line\">...省略</span><br><span class=\"line\">@enduml</span><br><span class=\"line\">&#123;% endplantuml %&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"用-Node-卻遇到-Java-的問題？\"><a href=\"#用-Node-卻遇到-Java-的問題？\" class=\"headerlink\" title=\"用 Node 卻遇到 Java 的問題？\"></a>用 Node 卻遇到 Java 的問題？</h1><p>若你不是 Java 的開發者，或許也會遇到這樣的問題：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">No Java runtime present, requesting install.</span><br></pre></td></tr></table></figure>\n\n<p>因為之前因為需要安裝 <a href=\"https://github.com/OpenAPITools/openapi-generator\" target=\"_blank\" rel=\"noopener\">openapi-generator</a> 時有安裝過 Java 相關套件，此時需要至<a href=\"https://www.oracle.com/java/technologies/\" target=\"_blank\" rel=\"noopener\">官網抓取</a>並安裝，之後再執行一次就沒問題囉！</p>\n<blockquote>\n<p>我當時是直接到 oracle 官方直接下載 Java SE，但如果這不還是不行可以嘗試看看<a href=\"https://java.com/en/download/mac_download.jsp\" target=\"_blank\" rel=\"noopener\">這個網站</a></p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為什麼我要用<code>標記符號</code>顯示而不是直接<code>輸出圖片</code>呢？</p>\n<p>因為我們文章可能在發佈之後或是之後回來看時發現流程有錯誤時可以馬上針對特定內容直接修改，而不用再重新找當時寫的檔案位置-輸出圖片 這樣的順序，總之只要將流程圖畫好並透過<code>程式碼區塊</code>的語法就能將圖片輸出了，這樣對我寫作來說就能夠更順暢一些了！</p>"},{"title":"Docker 學習筆記 - 將 Twitch Bot 容器化","abbrlink":2541820171,"date":"2020-01-27T10:36:05.000Z","_content":"\n# 前言\n\n最近剛好看到許多`EKS`、`GKE`相關的文章，趁著過年時刻先來補足一下 Docker 這個既熟悉又陌生的技能 😆，之後再接著研究如何串接至 [kubernetes](https://zh.wikipedia.org/zh-tw/Kubernetes) 並同時到雲平台上，接下來一起來看我從建立到建置的過程紀錄 🙂。\n\n以下就使用我的 side project - [Twitch-Bot](https://github.com/louis70109/Twitch-Bot) 做範例囉！\n\n> 主要使用的功能為 `node` 以及 `mongo`\n\n# 新增檔案\n\n這邊我使用 vscode 的 [Docker extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker) 來幫助我快速建立 docker 相關的檔案:\n\n- Dockerfile\n- docer-compose.yml\n- .dockerignore\n\n> 透過以下的 gif 可以快速建立以上三個檔案\n\n![](https://github.com/microsoft/vscode-docker/raw/master/resources/readme/generateFiles.gif)\n\n操作方式為 `Cmd+Shift+P` >`docker: add` > `選擇語言(Node)` > `設定輸出 Port`\n\n## 處理 dockerfile\n\n藉由 extension 來幫我們產生檔案第一步就完成了，接著對 Dockerfile 稍做修改:\n\n```dockerfile=\nFROM node:10.13-alpine\nMAINTAINER NiJia <louis70109@gmail.com>\nENV NODE_ENV production\nWORKDIR /app\nCOPY [\"package.json\", \"package-lock.json*\", \"/app/\"]\nRUN npm install\nCOPY . /app/\nEXPOSE 5000\nCMD [\"npm\", \"start\"]\n```\n\n- FROM: 來自什麼映像檔，這裡使用預設給的 node 版。\n- MAINTAINER: 寫描述的位置，這邊我標註我的名稱與 EMail。\n- ENV: 環境變數寫在這，不過這個專案是放在 Github 上，所以我就沒把 chatbot 平台的密鑰放在這了。\n- WORKDIR: 當前在一個乾淨的環境下，而你預想的工作路目錄要叫什麼就在這設定，同時也會一起幫你建立好 (我用`/app`這個工作資料夾當作範例)。\n- COPY: 把檔案複製到想要放的地方，這裡為了先讓容器安裝完相依套件，因此先把 `package.json` 以及 `package-lock.json` 先複製進 `/app/` 這個資料夾內。\n- RUN: 執行終端機指令，在上面檔案複製過來之後，這裡我就來安裝相依套件庫。\n- COPY: 安裝完產生 node_modules 之後把原本的有的東西都複製過來。\n  - `.` = 當前目錄\n  - /app/ = 欲複製前往的地方\n- EXPOSE: 容器要打出去的 Port 出口，在前面呼叫 extension 時就已經輸入完這欄了。\n- CMD: 幫我執行指令 (參考: [CMD 與 ENTRYPOINT 的差別](http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/))\n\n## docker-compose.yml\n\n這邊我將預設的修改為:\n\n```yaml\nversion: '3'\n\nservices:\n  twitch-bot:\n    image: twitch-bot\n    restart: always\n    build: .\n    environment:\n      NODE_ENV: production\n    ports:\n      - 5000:5000\n    depends_on:\n      - mongo\n    networks:\n      - chatbot-network\n  mongo:\n    image: mongo\n    restart: always\n    volumes:\n      - ./data/db:/data/db\n    networks:\n      - chatbot-network\n\nnetworks:\n  chatbot-network:\n    driver: bridge\n```\n\n首先將`version`改成 `3`，有向下相容的話當然就是要使用新的囉！\n\n接著會建立兩個 container (services):\n\n1. twitch-bot\n   `build` 後面接著 `.` 是指說建立在當前位置，`depends_on` 則是依賴哪個 container，最後則透過 networks (`chatbot-network`) 來讓服務互相溝通。\n2. mongo\n   這邊則就直接去 dockerhub 裡面抓，`restart`鐵定是必要設定，不然會沒有資料庫 🤣，`volumes`則是設定說你想映射的檔案位置在哪，這邊我設定**當前目錄的/data/db** (./data/db)裡面，對應到映像檔裡面的 **/data/db** 的位置，然後一樣透過 networks (`chatbot-network`) 來讓服務溝通。\n\nnetworks 這邊就有點像主機設定網卡一樣，我設定一個 `chatbot-network` 的網卡它是使用橋接(`bridge`)模式來驅動(`driver`)\n\n> 這部分是參考[知乎](https://zhuanlan.zhihu.com/p/69536325)，對照改出來的\n\n> 補給站: 一般看到 `5000:5000` 或是 `./data/db:/data/db` 的寫法，它意思是 本地端位置 對應「`:`」到 容器的位置，像上述檔案就有 port 以及 資料庫位置，這邊就會因應服務而對應到不同的功能。\n\n## 修改 .dockerignore\n\n這邊因為我很偷懶不想把`.env`裡的環境變數寫進`dockerfile`😆，因此在這就把檔案中的`**/.env`拔掉方便做事 🤣\n\n# 測試容器\n\n### 啟動\n\n```sh\ndocker-compose up -d\n```\n\n- `-d` 表示讓容器跑在背景，如果沒加的話就會在終端機上看到容器們的行為。\n- 會建立本地端的 container image。\n\n### 關閉\n\n```sh\ndocker-compose down\n```\n\n- 若是使用 [Twitch-bot](https://github.com/louis70109/Twitch-Bot) 來試玩的話，則需要多開一個視窗執行 `npx ngrok http 5000` 來建立一個暫時含有 SSL 的 URL。\n\n# 建置(build)\n\n如果是按照原本 docker-compose.yml 的打法：\n\n```yaml\nservices:\n  twitch-bot:\n    image: twitch-bot\n```\n\n這樣的話 docker 預設會幫忙下一個 `latest` 版號的 tag。\n\n如果是按造以下做法的話在 build 就會幫忙建立 `帳號/容器名`，並下一個 `0.1` 的 tag\n\n```yaml\nservices:\n  twitch-bot:\n    image: louis70109/twitch-bot:0.1\n```\n\n![](https://i.imgur.com/7Ftfpeh.png)\n\n接下來就執行 `docker-compose build` 幫忙建立一個有版本號(tag)的容器映像檔(container image)。\n\n![](https://i.imgur.com/JiifOjy.png)\n\n> 補給站:\n>\n> - 記得要 `docker login` 哦！\n> - 到 dockerhub 或其他私有倉庫建立 container repository\n\n# 結碖\n\n趁著春節的零碎時間來跟這個熟悉陌生技能打個招呼 😆，同時也體會到大家說到 docker 好用的地方以及給予的彈性，之前都是有需要測試某些功能才會用到，對於 `dockerfile` 以及 `docker-compose.yml` 就甚少了解，藉著年假空檔練習，之後只要在熟悉一下整體的使用方法應該就能好好的～用它來幫忙做事了 🚀。\n\n# references\n\n[連線 mongo container](https://github.com/lmjben/cdfang-spider/blob/master/src/nodeuii/config/index.ts#L3)\n[docker CMD 使用](http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/)\n[Overview of Docker Compose](https://docs.docker.com/compose/)\n[Twitch-Bot](https://github.com/louis70109/Twitch-Bot)\n","source":"_posts/learn-docker-with-twitch-bot.md","raw":"---\ntitle: Docker 學習筆記 - 將 Twitch Bot 容器化\ntags:\n  - Docker\n  - container\n  - docker-compose\ncategories: Docker\nabbrlink: 2541820171\ndate: 2020-01-27 18:36:05\n---\n\n# 前言\n\n最近剛好看到許多`EKS`、`GKE`相關的文章，趁著過年時刻先來補足一下 Docker 這個既熟悉又陌生的技能 😆，之後再接著研究如何串接至 [kubernetes](https://zh.wikipedia.org/zh-tw/Kubernetes) 並同時到雲平台上，接下來一起來看我從建立到建置的過程紀錄 🙂。\n\n以下就使用我的 side project - [Twitch-Bot](https://github.com/louis70109/Twitch-Bot) 做範例囉！\n\n> 主要使用的功能為 `node` 以及 `mongo`\n\n# 新增檔案\n\n這邊我使用 vscode 的 [Docker extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker) 來幫助我快速建立 docker 相關的檔案:\n\n- Dockerfile\n- docer-compose.yml\n- .dockerignore\n\n> 透過以下的 gif 可以快速建立以上三個檔案\n\n![](https://github.com/microsoft/vscode-docker/raw/master/resources/readme/generateFiles.gif)\n\n操作方式為 `Cmd+Shift+P` >`docker: add` > `選擇語言(Node)` > `設定輸出 Port`\n\n## 處理 dockerfile\n\n藉由 extension 來幫我們產生檔案第一步就完成了，接著對 Dockerfile 稍做修改:\n\n```dockerfile=\nFROM node:10.13-alpine\nMAINTAINER NiJia <louis70109@gmail.com>\nENV NODE_ENV production\nWORKDIR /app\nCOPY [\"package.json\", \"package-lock.json*\", \"/app/\"]\nRUN npm install\nCOPY . /app/\nEXPOSE 5000\nCMD [\"npm\", \"start\"]\n```\n\n- FROM: 來自什麼映像檔，這裡使用預設給的 node 版。\n- MAINTAINER: 寫描述的位置，這邊我標註我的名稱與 EMail。\n- ENV: 環境變數寫在這，不過這個專案是放在 Github 上，所以我就沒把 chatbot 平台的密鑰放在這了。\n- WORKDIR: 當前在一個乾淨的環境下，而你預想的工作路目錄要叫什麼就在這設定，同時也會一起幫你建立好 (我用`/app`這個工作資料夾當作範例)。\n- COPY: 把檔案複製到想要放的地方，這裡為了先讓容器安裝完相依套件，因此先把 `package.json` 以及 `package-lock.json` 先複製進 `/app/` 這個資料夾內。\n- RUN: 執行終端機指令，在上面檔案複製過來之後，這裡我就來安裝相依套件庫。\n- COPY: 安裝完產生 node_modules 之後把原本的有的東西都複製過來。\n  - `.` = 當前目錄\n  - /app/ = 欲複製前往的地方\n- EXPOSE: 容器要打出去的 Port 出口，在前面呼叫 extension 時就已經輸入完這欄了。\n- CMD: 幫我執行指令 (參考: [CMD 與 ENTRYPOINT 的差別](http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/))\n\n## docker-compose.yml\n\n這邊我將預設的修改為:\n\n```yaml\nversion: '3'\n\nservices:\n  twitch-bot:\n    image: twitch-bot\n    restart: always\n    build: .\n    environment:\n      NODE_ENV: production\n    ports:\n      - 5000:5000\n    depends_on:\n      - mongo\n    networks:\n      - chatbot-network\n  mongo:\n    image: mongo\n    restart: always\n    volumes:\n      - ./data/db:/data/db\n    networks:\n      - chatbot-network\n\nnetworks:\n  chatbot-network:\n    driver: bridge\n```\n\n首先將`version`改成 `3`，有向下相容的話當然就是要使用新的囉！\n\n接著會建立兩個 container (services):\n\n1. twitch-bot\n   `build` 後面接著 `.` 是指說建立在當前位置，`depends_on` 則是依賴哪個 container，最後則透過 networks (`chatbot-network`) 來讓服務互相溝通。\n2. mongo\n   這邊則就直接去 dockerhub 裡面抓，`restart`鐵定是必要設定，不然會沒有資料庫 🤣，`volumes`則是設定說你想映射的檔案位置在哪，這邊我設定**當前目錄的/data/db** (./data/db)裡面，對應到映像檔裡面的 **/data/db** 的位置，然後一樣透過 networks (`chatbot-network`) 來讓服務溝通。\n\nnetworks 這邊就有點像主機設定網卡一樣，我設定一個 `chatbot-network` 的網卡它是使用橋接(`bridge`)模式來驅動(`driver`)\n\n> 這部分是參考[知乎](https://zhuanlan.zhihu.com/p/69536325)，對照改出來的\n\n> 補給站: 一般看到 `5000:5000` 或是 `./data/db:/data/db` 的寫法，它意思是 本地端位置 對應「`:`」到 容器的位置，像上述檔案就有 port 以及 資料庫位置，這邊就會因應服務而對應到不同的功能。\n\n## 修改 .dockerignore\n\n這邊因為我很偷懶不想把`.env`裡的環境變數寫進`dockerfile`😆，因此在這就把檔案中的`**/.env`拔掉方便做事 🤣\n\n# 測試容器\n\n### 啟動\n\n```sh\ndocker-compose up -d\n```\n\n- `-d` 表示讓容器跑在背景，如果沒加的話就會在終端機上看到容器們的行為。\n- 會建立本地端的 container image。\n\n### 關閉\n\n```sh\ndocker-compose down\n```\n\n- 若是使用 [Twitch-bot](https://github.com/louis70109/Twitch-Bot) 來試玩的話，則需要多開一個視窗執行 `npx ngrok http 5000` 來建立一個暫時含有 SSL 的 URL。\n\n# 建置(build)\n\n如果是按照原本 docker-compose.yml 的打法：\n\n```yaml\nservices:\n  twitch-bot:\n    image: twitch-bot\n```\n\n這樣的話 docker 預設會幫忙下一個 `latest` 版號的 tag。\n\n如果是按造以下做法的話在 build 就會幫忙建立 `帳號/容器名`，並下一個 `0.1` 的 tag\n\n```yaml\nservices:\n  twitch-bot:\n    image: louis70109/twitch-bot:0.1\n```\n\n![](https://i.imgur.com/7Ftfpeh.png)\n\n接下來就執行 `docker-compose build` 幫忙建立一個有版本號(tag)的容器映像檔(container image)。\n\n![](https://i.imgur.com/JiifOjy.png)\n\n> 補給站:\n>\n> - 記得要 `docker login` 哦！\n> - 到 dockerhub 或其他私有倉庫建立 container repository\n\n# 結碖\n\n趁著春節的零碎時間來跟這個熟悉陌生技能打個招呼 😆，同時也體會到大家說到 docker 好用的地方以及給予的彈性，之前都是有需要測試某些功能才會用到，對於 `dockerfile` 以及 `docker-compose.yml` 就甚少了解，藉著年假空檔練習，之後只要在熟悉一下整體的使用方法應該就能好好的～用它來幫忙做事了 🚀。\n\n# references\n\n[連線 mongo container](https://github.com/lmjben/cdfang-spider/blob/master/src/nodeuii/config/index.ts#L3)\n[docker CMD 使用](http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/)\n[Overview of Docker Compose](https://docs.docker.com/compose/)\n[Twitch-Bot](https://github.com/louis70109/Twitch-Bot)\n","slug":"learn-docker-with-twitch-bot","published":1,"updated":"2020-06-19T14:03:58.862Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ky004i7crid9fonrdp","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近剛好看到許多<code>EKS</code>、<code>GKE</code>相關的文章，趁著過年時刻先來補足一下 Docker 這個既熟悉又陌生的技能 😆，之後再接著研究如何串接至 <a href=\"https://zh.wikipedia.org/zh-tw/Kubernetes\" target=\"_blank\" rel=\"noopener\">kubernetes</a> 並同時到雲平台上，接下來一起來看我從建立到建置的過程紀錄 🙂。</p>\n<p>以下就使用我的 side project - <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a> 做範例囉！</p>\n<blockquote>\n<p>主要使用的功能為 <code>node</code> 以及 <code>mongo</code></p>\n</blockquote>\n<h1 id=\"新增檔案\"><a href=\"#新增檔案\" class=\"headerlink\" title=\"新增檔案\"></a>新增檔案</h1><p>這邊我使用 vscode 的 <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker\" target=\"_blank\" rel=\"noopener\">Docker extension</a> 來幫助我快速建立 docker 相關的檔案:</p>\n<ul>\n<li>Dockerfile</li>\n<li>docer-compose.yml</li>\n<li>.dockerignore</li>\n</ul>\n<blockquote>\n<p>透過以下的 gif 可以快速建立以上三個檔案</p>\n</blockquote>\n<p><img src=\"https://github.com/microsoft/vscode-docker/raw/master/resources/readme/generateFiles.gif\" alt></p>\n<p>操作方式為 <code>Cmd+Shift+P</code> &gt;<code>docker: add</code> &gt; <code>選擇語言(Node)</code> &gt; <code>設定輸出 Port</code></p>\n<h2 id=\"處理-dockerfile\"><a href=\"#處理-dockerfile\" class=\"headerlink\" title=\"處理 dockerfile\"></a>處理 dockerfile</h2><p>藉由 extension 來幫我們產生檔案第一步就完成了，接著對 Dockerfile 稍做修改:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> node:<span class=\"number\">10.13</span>-alpine</span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> NiJia &lt;louis70109@gmail.com&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> NODE_ENV production</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [<span class=\"string\">\"package.json\"</span>, <span class=\"string\">\"package-lock.json*\"</span>, <span class=\"string\">\"/app/\"</span>]</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> npm install</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . /app/</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">5000</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"npm\"</span>, <span class=\"string\">\"start\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>FROM: 來自什麼映像檔，這裡使用預設給的 node 版。</li>\n<li>MAINTAINER: 寫描述的位置，這邊我標註我的名稱與 EMail。</li>\n<li>ENV: 環境變數寫在這，不過這個專案是放在 Github 上，所以我就沒把 chatbot 平台的密鑰放在這了。</li>\n<li>WORKDIR: 當前在一個乾淨的環境下，而你預想的工作路目錄要叫什麼就在這設定，同時也會一起幫你建立好 (我用<code>/app</code>這個工作資料夾當作範例)。</li>\n<li>COPY: 把檔案複製到想要放的地方，這裡為了先讓容器安裝完相依套件，因此先把 <code>package.json</code> 以及 <code>package-lock.json</code> 先複製進 <code>/app/</code> 這個資料夾內。</li>\n<li>RUN: 執行終端機指令，在上面檔案複製過來之後，這裡我就來安裝相依套件庫。</li>\n<li>COPY: 安裝完產生 node_modules 之後把原本的有的東西都複製過來。<ul>\n<li><code>.</code> = 當前目錄</li>\n<li>/app/ = 欲複製前往的地方</li>\n</ul>\n</li>\n<li>EXPOSE: 容器要打出去的 Port 出口，在前面呼叫 extension 時就已經輸入完這欄了。</li>\n<li>CMD: 幫我執行指令 (參考: <a href=\"http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/\" target=\"_blank\" rel=\"noopener\">CMD 與 ENTRYPOINT 的差別</a>)</li>\n</ul>\n<h2 id=\"docker-compose-yml\"><a href=\"#docker-compose-yml\" class=\"headerlink\" title=\"docker-compose.yml\"></a>docker-compose.yml</h2><p>這邊我將預設的修改為:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">twitch-bot</span></span><br><span class=\"line\"><span class=\"attr\">    restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\"><span class=\"attr\">    build:</span> <span class=\"string\">.</span></span><br><span class=\"line\"><span class=\"attr\">    environment:</span></span><br><span class=\"line\"><span class=\"attr\">      NODE_ENV:</span> <span class=\"string\">production</span></span><br><span class=\"line\"><span class=\"attr\">    ports:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"number\">5000</span><span class=\"string\">:5000</span></span><br><span class=\"line\"><span class=\"attr\">    depends_on:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">mongo</span></span><br><span class=\"line\"><span class=\"attr\">    networks:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">chatbot-network</span></span><br><span class=\"line\"><span class=\"attr\">  mongo:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">mongo</span></span><br><span class=\"line\"><span class=\"attr\">    restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\"><span class=\"attr\">    volumes:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">./data/db:/data/db</span></span><br><span class=\"line\"><span class=\"attr\">    networks:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">chatbot-network</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">networks:</span></span><br><span class=\"line\"><span class=\"attr\">  chatbot-network:</span></span><br><span class=\"line\"><span class=\"attr\">    driver:</span> <span class=\"string\">bridge</span></span><br></pre></td></tr></table></figure>\n\n<p>首先將<code>version</code>改成 <code>3</code>，有向下相容的話當然就是要使用新的囉！</p>\n<p>接著會建立兩個 container (services):</p>\n<ol>\n<li>twitch-bot<br><code>build</code> 後面接著 <code>.</code> 是指說建立在當前位置，<code>depends_on</code> 則是依賴哪個 container，最後則透過 networks (<code>chatbot-network</code>) 來讓服務互相溝通。</li>\n<li>mongo<br>這邊則就直接去 dockerhub 裡面抓，<code>restart</code>鐵定是必要設定，不然會沒有資料庫 🤣，<code>volumes</code>則是設定說你想映射的檔案位置在哪，這邊我設定<strong>當前目錄的/data/db</strong> (./data/db)裡面，對應到映像檔裡面的 <strong>/data/db</strong> 的位置，然後一樣透過 networks (<code>chatbot-network</code>) 來讓服務溝通。</li>\n</ol>\n<p>networks 這邊就有點像主機設定網卡一樣，我設定一個 <code>chatbot-network</code> 的網卡它是使用橋接(<code>bridge</code>)模式來驅動(<code>driver</code>)</p>\n<blockquote>\n<p>這部分是參考<a href=\"https://zhuanlan.zhihu.com/p/69536325\" target=\"_blank\" rel=\"noopener\">知乎</a>，對照改出來的</p>\n</blockquote>\n<blockquote>\n<p>補給站: 一般看到 <code>5000:5000</code> 或是 <code>./data/db:/data/db</code> 的寫法，它意思是 本地端位置 對應「<code>:</code>」到 容器的位置，像上述檔案就有 port 以及 資料庫位置，這邊就會因應服務而對應到不同的功能。</p>\n</blockquote>\n<h2 id=\"修改-dockerignore\"><a href=\"#修改-dockerignore\" class=\"headerlink\" title=\"修改 .dockerignore\"></a>修改 .dockerignore</h2><p>這邊因為我很偷懶不想把<code>.env</code>裡的環境變數寫進<code>dockerfile</code>😆，因此在這就把檔案中的<code>**/.env</code>拔掉方便做事 🤣</p>\n<h1 id=\"測試容器\"><a href=\"#測試容器\" class=\"headerlink\" title=\"測試容器\"></a>測試容器</h1><h3 id=\"啟動\"><a href=\"#啟動\" class=\"headerlink\" title=\"啟動\"></a>啟動</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>-d</code> 表示讓容器跑在背景，如果沒加的話就會在終端機上看到容器們的行為。</li>\n<li>會建立本地端的 container image。</li>\n</ul>\n<h3 id=\"關閉\"><a href=\"#關閉\" class=\"headerlink\" title=\"關閉\"></a>關閉</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose down</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>若是使用 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-bot</a> 來試玩的話，則需要多開一個視窗執行 <code>npx ngrok http 5000</code> 來建立一個暫時含有 SSL 的 URL。</li>\n</ul>\n<h1 id=\"建置-build\"><a href=\"#建置-build\" class=\"headerlink\" title=\"建置(build)\"></a>建置(build)</h1><p>如果是按照原本 docker-compose.yml 的打法：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">twitch-bot</span></span><br></pre></td></tr></table></figure>\n\n<p>這樣的話 docker 預設會幫忙下一個 <code>latest</code> 版號的 tag。</p>\n<p>如果是按造以下做法的話在 build 就會幫忙建立 <code>帳號/容器名</code>，並下一個 <code>0.1</code> 的 tag</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">louis70109/twitch-bot:0.1</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/7Ftfpeh.png\" alt></p>\n<p>接下來就執行 <code>docker-compose build</code> 幫忙建立一個有版本號(tag)的容器映像檔(container image)。</p>\n<p><img src=\"https://i.imgur.com/JiifOjy.png\" alt></p>\n<blockquote>\n<p>補給站:</p>\n<ul>\n<li>記得要 <code>docker login</code> 哦！</li>\n<li>到 dockerhub 或其他私有倉庫建立 container repository</li>\n</ul>\n</blockquote>\n<h1 id=\"結碖\"><a href=\"#結碖\" class=\"headerlink\" title=\"結碖\"></a>結碖</h1><p>趁著春節的零碎時間來跟這個熟悉陌生技能打個招呼 😆，同時也體會到大家說到 docker 好用的地方以及給予的彈性，之前都是有需要測試某些功能才會用到，對於 <code>dockerfile</code> 以及 <code>docker-compose.yml</code> 就甚少了解，藉著年假空檔練習，之後只要在熟悉一下整體的使用方法應該就能好好的～用它來幫忙做事了 🚀。</p>\n<h1 id=\"references\"><a href=\"#references\" class=\"headerlink\" title=\"references\"></a>references</h1><p><a href=\"https://github.com/lmjben/cdfang-spider/blob/master/src/nodeuii/config/index.ts#L3\" target=\"_blank\" rel=\"noopener\">連線 mongo container</a><br><a href=\"http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/\" target=\"_blank\" rel=\"noopener\">docker CMD 使用</a><br><a href=\"https://docs.docker.com/compose/\" target=\"_blank\" rel=\"noopener\">Overview of Docker Compose</a><br><a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近剛好看到許多<code>EKS</code>、<code>GKE</code>相關的文章，趁著過年時刻先來補足一下 Docker 這個既熟悉又陌生的技能 😆，之後再接著研究如何串接至 <a href=\"https://zh.wikipedia.org/zh-tw/Kubernetes\" target=\"_blank\" rel=\"noopener\">kubernetes</a> 並同時到雲平台上，接下來一起來看我從建立到建置的過程紀錄 🙂。</p>\n<p>以下就使用我的 side project - <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a> 做範例囉！</p>\n<blockquote>\n<p>主要使用的功能為 <code>node</code> 以及 <code>mongo</code></p>\n</blockquote>\n<h1 id=\"新增檔案\"><a href=\"#新增檔案\" class=\"headerlink\" title=\"新增檔案\"></a>新增檔案</h1><p>這邊我使用 vscode 的 <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker\" target=\"_blank\" rel=\"noopener\">Docker extension</a> 來幫助我快速建立 docker 相關的檔案:</p>\n<ul>\n<li>Dockerfile</li>\n<li>docer-compose.yml</li>\n<li>.dockerignore</li>\n</ul>\n<blockquote>\n<p>透過以下的 gif 可以快速建立以上三個檔案</p>\n</blockquote>\n<p><img src=\"https://github.com/microsoft/vscode-docker/raw/master/resources/readme/generateFiles.gif\" alt></p>\n<p>操作方式為 <code>Cmd+Shift+P</code> &gt;<code>docker: add</code> &gt; <code>選擇語言(Node)</code> &gt; <code>設定輸出 Port</code></p>\n<h2 id=\"處理-dockerfile\"><a href=\"#處理-dockerfile\" class=\"headerlink\" title=\"處理 dockerfile\"></a>處理 dockerfile</h2><p>藉由 extension 來幫我們產生檔案第一步就完成了，接著對 Dockerfile 稍做修改:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> node:<span class=\"number\">10.13</span>-alpine</span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> NiJia &lt;louis70109@gmail.com&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> NODE_ENV production</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [<span class=\"string\">\"package.json\"</span>, <span class=\"string\">\"package-lock.json*\"</span>, <span class=\"string\">\"/app/\"</span>]</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> npm install</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . /app/</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">5000</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"npm\"</span>, <span class=\"string\">\"start\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>FROM: 來自什麼映像檔，這裡使用預設給的 node 版。</li>\n<li>MAINTAINER: 寫描述的位置，這邊我標註我的名稱與 EMail。</li>\n<li>ENV: 環境變數寫在這，不過這個專案是放在 Github 上，所以我就沒把 chatbot 平台的密鑰放在這了。</li>\n<li>WORKDIR: 當前在一個乾淨的環境下，而你預想的工作路目錄要叫什麼就在這設定，同時也會一起幫你建立好 (我用<code>/app</code>這個工作資料夾當作範例)。</li>\n<li>COPY: 把檔案複製到想要放的地方，這裡為了先讓容器安裝完相依套件，因此先把 <code>package.json</code> 以及 <code>package-lock.json</code> 先複製進 <code>/app/</code> 這個資料夾內。</li>\n<li>RUN: 執行終端機指令，在上面檔案複製過來之後，這裡我就來安裝相依套件庫。</li>\n<li>COPY: 安裝完產生 node_modules 之後把原本的有的東西都複製過來。<ul>\n<li><code>.</code> = 當前目錄</li>\n<li>/app/ = 欲複製前往的地方</li>\n</ul>\n</li>\n<li>EXPOSE: 容器要打出去的 Port 出口，在前面呼叫 extension 時就已經輸入完這欄了。</li>\n<li>CMD: 幫我執行指令 (參考: <a href=\"http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/\" target=\"_blank\" rel=\"noopener\">CMD 與 ENTRYPOINT 的差別</a>)</li>\n</ul>\n<h2 id=\"docker-compose-yml\"><a href=\"#docker-compose-yml\" class=\"headerlink\" title=\"docker-compose.yml\"></a>docker-compose.yml</h2><p>這邊我將預設的修改為:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">twitch-bot</span></span><br><span class=\"line\"><span class=\"attr\">    restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\"><span class=\"attr\">    build:</span> <span class=\"string\">.</span></span><br><span class=\"line\"><span class=\"attr\">    environment:</span></span><br><span class=\"line\"><span class=\"attr\">      NODE_ENV:</span> <span class=\"string\">production</span></span><br><span class=\"line\"><span class=\"attr\">    ports:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"number\">5000</span><span class=\"string\">:5000</span></span><br><span class=\"line\"><span class=\"attr\">    depends_on:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">mongo</span></span><br><span class=\"line\"><span class=\"attr\">    networks:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">chatbot-network</span></span><br><span class=\"line\"><span class=\"attr\">  mongo:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">mongo</span></span><br><span class=\"line\"><span class=\"attr\">    restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\"><span class=\"attr\">    volumes:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">./data/db:/data/db</span></span><br><span class=\"line\"><span class=\"attr\">    networks:</span></span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">chatbot-network</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">networks:</span></span><br><span class=\"line\"><span class=\"attr\">  chatbot-network:</span></span><br><span class=\"line\"><span class=\"attr\">    driver:</span> <span class=\"string\">bridge</span></span><br></pre></td></tr></table></figure>\n\n<p>首先將<code>version</code>改成 <code>3</code>，有向下相容的話當然就是要使用新的囉！</p>\n<p>接著會建立兩個 container (services):</p>\n<ol>\n<li>twitch-bot<br><code>build</code> 後面接著 <code>.</code> 是指說建立在當前位置，<code>depends_on</code> 則是依賴哪個 container，最後則透過 networks (<code>chatbot-network</code>) 來讓服務互相溝通。</li>\n<li>mongo<br>這邊則就直接去 dockerhub 裡面抓，<code>restart</code>鐵定是必要設定，不然會沒有資料庫 🤣，<code>volumes</code>則是設定說你想映射的檔案位置在哪，這邊我設定<strong>當前目錄的/data/db</strong> (./data/db)裡面，對應到映像檔裡面的 <strong>/data/db</strong> 的位置，然後一樣透過 networks (<code>chatbot-network</code>) 來讓服務溝通。</li>\n</ol>\n<p>networks 這邊就有點像主機設定網卡一樣，我設定一個 <code>chatbot-network</code> 的網卡它是使用橋接(<code>bridge</code>)模式來驅動(<code>driver</code>)</p>\n<blockquote>\n<p>這部分是參考<a href=\"https://zhuanlan.zhihu.com/p/69536325\" target=\"_blank\" rel=\"noopener\">知乎</a>，對照改出來的</p>\n</blockquote>\n<blockquote>\n<p>補給站: 一般看到 <code>5000:5000</code> 或是 <code>./data/db:/data/db</code> 的寫法，它意思是 本地端位置 對應「<code>:</code>」到 容器的位置，像上述檔案就有 port 以及 資料庫位置，這邊就會因應服務而對應到不同的功能。</p>\n</blockquote>\n<h2 id=\"修改-dockerignore\"><a href=\"#修改-dockerignore\" class=\"headerlink\" title=\"修改 .dockerignore\"></a>修改 .dockerignore</h2><p>這邊因為我很偷懶不想把<code>.env</code>裡的環境變數寫進<code>dockerfile</code>😆，因此在這就把檔案中的<code>**/.env</code>拔掉方便做事 🤣</p>\n<h1 id=\"測試容器\"><a href=\"#測試容器\" class=\"headerlink\" title=\"測試容器\"></a>測試容器</h1><h3 id=\"啟動\"><a href=\"#啟動\" class=\"headerlink\" title=\"啟動\"></a>啟動</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>-d</code> 表示讓容器跑在背景，如果沒加的話就會在終端機上看到容器們的行為。</li>\n<li>會建立本地端的 container image。</li>\n</ul>\n<h3 id=\"關閉\"><a href=\"#關閉\" class=\"headerlink\" title=\"關閉\"></a>關閉</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose down</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>若是使用 <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-bot</a> 來試玩的話，則需要多開一個視窗執行 <code>npx ngrok http 5000</code> 來建立一個暫時含有 SSL 的 URL。</li>\n</ul>\n<h1 id=\"建置-build\"><a href=\"#建置-build\" class=\"headerlink\" title=\"建置(build)\"></a>建置(build)</h1><p>如果是按照原本 docker-compose.yml 的打法：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">twitch-bot</span></span><br></pre></td></tr></table></figure>\n\n<p>這樣的話 docker 預設會幫忙下一個 <code>latest</code> 版號的 tag。</p>\n<p>如果是按造以下做法的話在 build 就會幫忙建立 <code>帳號/容器名</code>，並下一個 <code>0.1</code> 的 tag</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\"><span class=\"attr\">  twitch-bot:</span></span><br><span class=\"line\"><span class=\"attr\">    image:</span> <span class=\"string\">louis70109/twitch-bot:0.1</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/7Ftfpeh.png\" alt></p>\n<p>接下來就執行 <code>docker-compose build</code> 幫忙建立一個有版本號(tag)的容器映像檔(container image)。</p>\n<p><img src=\"https://i.imgur.com/JiifOjy.png\" alt></p>\n<blockquote>\n<p>補給站:</p>\n<ul>\n<li>記得要 <code>docker login</code> 哦！</li>\n<li>到 dockerhub 或其他私有倉庫建立 container repository</li>\n</ul>\n</blockquote>\n<h1 id=\"結碖\"><a href=\"#結碖\" class=\"headerlink\" title=\"結碖\"></a>結碖</h1><p>趁著春節的零碎時間來跟這個熟悉陌生技能打個招呼 😆，同時也體會到大家說到 docker 好用的地方以及給予的彈性，之前都是有需要測試某些功能才會用到，對於 <code>dockerfile</code> 以及 <code>docker-compose.yml</code> 就甚少了解，藉著年假空檔練習，之後只要在熟悉一下整體的使用方法應該就能好好的～用它來幫忙做事了 🚀。</p>\n<h1 id=\"references\"><a href=\"#references\" class=\"headerlink\" title=\"references\"></a>references</h1><p><a href=\"https://github.com/lmjben/cdfang-spider/blob/master/src/nodeuii/config/index.ts#L3\" target=\"_blank\" rel=\"noopener\">連線 mongo container</a><br><a href=\"http://jenkins.readbook.tw/docker/basic/104-dockerfile/entrypoint/\" target=\"_blank\" rel=\"noopener\">docker CMD 使用</a><br><a href=\"https://docs.docker.com/compose/\" target=\"_blank\" rel=\"noopener\">Overview of Docker Compose</a><br><a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a></p>\n"},{"title":"【Javascript】你知道你常用的 Promise 嗎?","abbrlink":1394405821,"date":"2020-06-13T14:12:08.000Z","_content":"\n# 前言\n\n在寫 Javascript 時一定會看到有套件或是範例有使用到 callback function，在過往的 coding 過程中最擔心的問題就是遇到 Callback Hell(也就是俗稱的波動拳)，最常見的範例為：\n\n```\ndoSomething(function(result) {\n  doSomethingElse(result, function(newResult) {\n    doThirdThing(newResult, function(finalResult) {\n      console.log('Got the final result: ' + finalResult);\n    }, failureCallback);\n  }, failureCallback);\n}, failureCallback);\n```\n\n> Sample from [MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Using_promises)\n\n為了降低波動拳的出現機率，因此就就誕生了 `Promise` 來幫忙處理 Hell world 的問題，至於如何處理就透過接下來就說明並介紹用法。\n\n<!-- more -->\n\n# 介紹\n\nPromise 是 Javascript 的`非同步運算的物件`，並且包含 `resolve`(成功)、`reject`(失敗)、`pending`(處理中)三種狀態，接下來就看看介紹吧！\n\n## Promise 提供了什麼？\n\n主要提供了 `.then()` 以及 `.catch()` 方法讓使用者可以做 Promise Chain 去串聯方法，它的用意是讓之前的 Chain 在做完之後去執行接下來的事情，以 [Axios](https://github.com/axios/axios) 為例：\n\n```\naxios.get('https://www.example.com')\n  .then(function(result) {...})\n  .catch(function(error) {...})\n```\n\n可以在輪到 `get()` 執行後若成功則進去 `.then()`，反之錯誤則 `.catch()`，若只看這樣不清楚還是不懂，那來與以前的寫法比對：\n\n```\nfunction successCallback(result) {...}\nfunction failureCallback(error) {...}\n\n\bGetExampleCode(callExampleUrl, successCallback, failureCallback)\n```\n\n看完以前的的寫法，使用 Promise 邏輯是不是比較順暢且直覺呢？\b\n\n看完範例後，接著看一下怎麼實作一個 Promise 吧！\n\n## 製作一個【判斷數字】的 Promise\n\n### 了解 Promise 參數\n\n新增一個 `Promise` 時一定要兩個參數(`resolve` & `reject`)，`resolve` 用在當 Promise 裡的判斷式成功後所需要回傳的物件，而 `reject` 顧名思義就是當答案**非預期**時的回傳物件。\n\n### 實作 Implementation\n\n看完解釋之後，接著使用 Chrome 作為範例，首先按下 `F12` 並至 `Console` 畫面：\n![](https://i.imgur.com/0bUzvKS.png)\n\n接著我們來定義範例的 numberCondition 函式：\n\n```\nfunction numberCondition(num){\n  let result = new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n  return result\n}\n```\n\n#### Bonus - 使用 early return 讓程式碼更簡潔些\n\n這個方法依照我的經驗在 Ruby、Javascript、Python 都有用過，但 Javascript 這邊用的是最平凡，若看到其他 project 的程式碼有這樣使用時千萬別慌張，其實只是合在一起寫而已。\n\n```\nfunction numberCondition(num){\n  return new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n}\n```\n\n上述範例當 `num` 等於 0 時就回傳一組字串告訴使用者答對，反之則回傳錯誤訊息的 Error 物件，最後則是把結果 return 回去。\n\n### 結果\n\n\b\bPromise 寫完了，接下來就來呼叫他吧！\n\n```\nnumberCondition(999)\n  .then(function(result) { console.log(\"答對了！\") })\n  .catch(function(error) { console.log(\"糟糕，答錯了\") })\n```\n\n貼到 Chrome 開發者工具列(Console)上吧！接著再把 999 改成 0 會就會跑到 `.then` 囉。\n![](https://i.imgur.com/6456opd.png)\n\n> 這樣有沒有發現平常就在使用 Promise 呢 🙂！\n\n# 我知道 Promise 了，那 Async/Await 跟它有什麼關係？\n\n自己做了一個 Promise 後，使用它需要一直 `.then()`、`.catch()`，接下來就來介紹一下 `async/await` 在 Promise 之後才誕生的語法糖。\n\n## 動手做 Implementation\n\n首先我們先複製前面的 Promise code 過來:\n\n```\nfunction numberCondition(num){\n  let result = new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n  return result\n}\n```\n\n這邊就把 `.then()` 的寫法並使用 [IIFE](https://developer.mozilla.org/zh-TW/docs/Glossary/IIFE) 搭配`匿名函式`直接執行:\n\n```\n(async function (){\n    const result = await numberCondition(0)\n    console.log(result)\n})()\n```\n\n以上是原生的寫法搭配 IIFE，以下則是使用 Arrow Function 做範例:\n\n```\n(async () => {\n    const result = await numberCondition(0)\n    console.log(result)\n})()\n```\n\n> 當 function 裡有使用到 await 時，外面一定要有 async 的字眼，否則會出錯。\n\n一樣貼至 Chrome 的開發者工具列：\n\n![](https://i.imgur.com/HT9eGlC.png)\n\n與 Promise 的觸發方式是一樣的，若到 `resolve` 成功階段時則附值於 `result`，反之則直接 throw Error()。\n\n> 在這邊的錯誤處理需要使用 try...catch 去 handle error\n\n## 好處\n\n若是從其他語言來的朋友，使用 async/await 的寫法邏輯上會較通順，而若使用一般的 Promise 則容易搞混當前程式執行位置，而 async/await 語法糖除了讓其他語言開發者可以更快速理解以外，也能讓程式邏輯能夠直接順下去，當然最後要加入 Javascript 這個家庭時了解 `Callback` 仍是開發 Javascript 裡必要的功能 👍。\n\n## 待討論部分\n\n由於是在 Promise 之後才出現的語法，若接手的專案本身並未支援到 async/await 語法時則需要將相關邏輯轉換使用 `.then()`、`.catch()` 去處理 Promise，在專案的`支援度`上這部分則需要多考慮。\n\n# 結論\n\n因為接觸到 [Bottender](https://github.com/Yoctol/bottender) 才接觸到 Promise 以及 async/await 這系列的工具，在理解上也花了好長一段時間才轉換過來，藉由本篇紀錄我釐清的過程，透過這些例子希望讓大家能夠更快速的了解 Promise 🙂。\n","source":"_posts/learn-javascript-promise.md","raw":"---\ntitle: 【Javascript】你知道你常用的 Promise 嗎?\ntags:\n  - Promise\n  - IIFE\n  - Arrow Function\n  - Callback\ncategories: Javascript\nabbrlink: 1394405821\ndate: 2020-06-13 22:12:08\n---\n\n# 前言\n\n在寫 Javascript 時一定會看到有套件或是範例有使用到 callback function，在過往的 coding 過程中最擔心的問題就是遇到 Callback Hell(也就是俗稱的波動拳)，最常見的範例為：\n\n```\ndoSomething(function(result) {\n  doSomethingElse(result, function(newResult) {\n    doThirdThing(newResult, function(finalResult) {\n      console.log('Got the final result: ' + finalResult);\n    }, failureCallback);\n  }, failureCallback);\n}, failureCallback);\n```\n\n> Sample from [MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Using_promises)\n\n為了降低波動拳的出現機率，因此就就誕生了 `Promise` 來幫忙處理 Hell world 的問題，至於如何處理就透過接下來就說明並介紹用法。\n\n<!-- more -->\n\n# 介紹\n\nPromise 是 Javascript 的`非同步運算的物件`，並且包含 `resolve`(成功)、`reject`(失敗)、`pending`(處理中)三種狀態，接下來就看看介紹吧！\n\n## Promise 提供了什麼？\n\n主要提供了 `.then()` 以及 `.catch()` 方法讓使用者可以做 Promise Chain 去串聯方法，它的用意是讓之前的 Chain 在做完之後去執行接下來的事情，以 [Axios](https://github.com/axios/axios) 為例：\n\n```\naxios.get('https://www.example.com')\n  .then(function(result) {...})\n  .catch(function(error) {...})\n```\n\n可以在輪到 `get()` 執行後若成功則進去 `.then()`，反之錯誤則 `.catch()`，若只看這樣不清楚還是不懂，那來與以前的寫法比對：\n\n```\nfunction successCallback(result) {...}\nfunction failureCallback(error) {...}\n\n\bGetExampleCode(callExampleUrl, successCallback, failureCallback)\n```\n\n看完以前的的寫法，使用 Promise 邏輯是不是比較順暢且直覺呢？\b\n\n看完範例後，接著看一下怎麼實作一個 Promise 吧！\n\n## 製作一個【判斷數字】的 Promise\n\n### 了解 Promise 參數\n\n新增一個 `Promise` 時一定要兩個參數(`resolve` & `reject`)，`resolve` 用在當 Promise 裡的判斷式成功後所需要回傳的物件，而 `reject` 顧名思義就是當答案**非預期**時的回傳物件。\n\n### 實作 Implementation\n\n看完解釋之後，接著使用 Chrome 作為範例，首先按下 `F12` 並至 `Console` 畫面：\n![](https://i.imgur.com/0bUzvKS.png)\n\n接著我們來定義範例的 numberCondition 函式：\n\n```\nfunction numberCondition(num){\n  let result = new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n  return result\n}\n```\n\n#### Bonus - 使用 early return 讓程式碼更簡潔些\n\n這個方法依照我的經驗在 Ruby、Javascript、Python 都有用過，但 Javascript 這邊用的是最平凡，若看到其他 project 的程式碼有這樣使用時千萬別慌張，其實只是合在一起寫而已。\n\n```\nfunction numberCondition(num){\n  return new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n}\n```\n\n上述範例當 `num` 等於 0 時就回傳一組字串告訴使用者答對，反之則回傳錯誤訊息的 Error 物件，最後則是把結果 return 回去。\n\n### 結果\n\n\b\bPromise 寫完了，接下來就來呼叫他吧！\n\n```\nnumberCondition(999)\n  .then(function(result) { console.log(\"答對了！\") })\n  .catch(function(error) { console.log(\"糟糕，答錯了\") })\n```\n\n貼到 Chrome 開發者工具列(Console)上吧！接著再把 999 改成 0 會就會跑到 `.then` 囉。\n![](https://i.imgur.com/6456opd.png)\n\n> 這樣有沒有發現平常就在使用 Promise 呢 🙂！\n\n# 我知道 Promise 了，那 Async/Await 跟它有什麼關係？\n\n自己做了一個 Promise 後，使用它需要一直 `.then()`、`.catch()`，接下來就來介紹一下 `async/await` 在 Promise 之後才誕生的語法糖。\n\n## 動手做 Implementation\n\n首先我們先複製前面的 Promise code 過來:\n\n```\nfunction numberCondition(num){\n  let result = new Promise(function(resolve, reject){\n    if(num === 0){\n      resolve(\"Yeah you got it, the number is 0\")\n    }else{\n     reject(new Error('No No, your number is wrong'))\n    }\n  })\n  return result\n}\n```\n\n這邊就把 `.then()` 的寫法並使用 [IIFE](https://developer.mozilla.org/zh-TW/docs/Glossary/IIFE) 搭配`匿名函式`直接執行:\n\n```\n(async function (){\n    const result = await numberCondition(0)\n    console.log(result)\n})()\n```\n\n以上是原生的寫法搭配 IIFE，以下則是使用 Arrow Function 做範例:\n\n```\n(async () => {\n    const result = await numberCondition(0)\n    console.log(result)\n})()\n```\n\n> 當 function 裡有使用到 await 時，外面一定要有 async 的字眼，否則會出錯。\n\n一樣貼至 Chrome 的開發者工具列：\n\n![](https://i.imgur.com/HT9eGlC.png)\n\n與 Promise 的觸發方式是一樣的，若到 `resolve` 成功階段時則附值於 `result`，反之則直接 throw Error()。\n\n> 在這邊的錯誤處理需要使用 try...catch 去 handle error\n\n## 好處\n\n若是從其他語言來的朋友，使用 async/await 的寫法邏輯上會較通順，而若使用一般的 Promise 則容易搞混當前程式執行位置，而 async/await 語法糖除了讓其他語言開發者可以更快速理解以外，也能讓程式邏輯能夠直接順下去，當然最後要加入 Javascript 這個家庭時了解 `Callback` 仍是開發 Javascript 裡必要的功能 👍。\n\n## 待討論部分\n\n由於是在 Promise 之後才出現的語法，若接手的專案本身並未支援到 async/await 語法時則需要將相關邏輯轉換使用 `.then()`、`.catch()` 去處理 Promise，在專案的`支援度`上這部分則需要多考慮。\n\n# 結論\n\n因為接觸到 [Bottender](https://github.com/Yoctol/bottender) 才接觸到 Promise 以及 async/await 這系列的工具，在理解上也花了好長一段時間才轉換過來，藉由本篇紀錄我釐清的過程，透過這些例子希望讓大家能夠更快速的了解 Promise 🙂。\n","slug":"learn-javascript-promise","published":1,"updated":"2020-06-19T15:13:05.205Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31l0004l7cri97356dzf","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在寫 Javascript 時一定會看到有套件或是範例有使用到 callback function，在過往的 coding 過程中最擔心的問題就是遇到 Callback Hell(也就是俗稱的波動拳)，最常見的範例為：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">doSomething(function(result) &#123;</span><br><span class=\"line\">  doSomethingElse(result, function(newResult) &#123;</span><br><span class=\"line\">    doThirdThing(newResult, function(finalResult) &#123;</span><br><span class=\"line\">      console.log(&apos;Got the final result: &apos; + finalResult);</span><br><span class=\"line\">    &#125;, failureCallback);</span><br><span class=\"line\">  &#125;, failureCallback);</span><br><span class=\"line\">&#125;, failureCallback);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Sample from <a href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Using_promises\" target=\"_blank\" rel=\"noopener\">MDN</a></p>\n</blockquote>\n<p>為了降低波動拳的出現機率，因此就就誕生了 <code>Promise</code> 來幫忙處理 Hell world 的問題，至於如何處理就透過接下來就說明並介紹用法。</p>\n<a id=\"more\"></a>\n\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>Promise 是 Javascript 的<code>非同步運算的物件</code>，並且包含 <code>resolve</code>(成功)、<code>reject</code>(失敗)、<code>pending</code>(處理中)三種狀態，接下來就看看介紹吧！</p>\n<h2 id=\"Promise-提供了什麼？\"><a href=\"#Promise-提供了什麼？\" class=\"headerlink\" title=\"Promise 提供了什麼？\"></a>Promise 提供了什麼？</h2><p>主要提供了 <code>.then()</code> 以及 <code>.catch()</code> 方法讓使用者可以做 Promise Chain 去串聯方法，它的用意是讓之前的 Chain 在做完之後去執行接下來的事情，以 <a href=\"https://github.com/axios/axios\" target=\"_blank\" rel=\"noopener\">Axios</a> 為例：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.get(&apos;https://www.example.com&apos;)</span><br><span class=\"line\">  .then(function(result) &#123;...&#125;)</span><br><span class=\"line\">  .catch(function(error) &#123;...&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>可以在輪到 <code>get()</code> 執行後若成功則進去 <code>.then()</code>，反之錯誤則 <code>.catch()</code>，若只看這樣不清楚還是不懂，那來與以前的寫法比對：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function successCallback(result) &#123;...&#125;</span><br><span class=\"line\">function failureCallback(error) &#123;...&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\bGetExampleCode(callExampleUrl, successCallback, failureCallback)</span><br></pre></td></tr></table></figure>\n\n<p>看完以前的的寫法，使用 Promise 邏輯是不是比較順暢且直覺呢？\b</p>\n<p>看完範例後，接著看一下怎麼實作一個 Promise 吧！</p>\n<h2 id=\"製作一個【判斷數字】的-Promise\"><a href=\"#製作一個【判斷數字】的-Promise\" class=\"headerlink\" title=\"製作一個【判斷數字】的 Promise\"></a>製作一個【判斷數字】的 Promise</h2><h3 id=\"了解-Promise-參數\"><a href=\"#了解-Promise-參數\" class=\"headerlink\" title=\"了解 Promise 參數\"></a>了解 Promise 參數</h3><p>新增一個 <code>Promise</code> 時一定要兩個參數(<code>resolve</code> &amp; <code>reject</code>)，<code>resolve</code> 用在當 Promise 裡的判斷式成功後所需要回傳的物件，而 <code>reject</code> 顧名思義就是當答案<strong>非預期</strong>時的回傳物件。</p>\n<h3 id=\"實作-Implementation\"><a href=\"#實作-Implementation\" class=\"headerlink\" title=\"實作 Implementation\"></a>實作 Implementation</h3><p>看完解釋之後，接著使用 Chrome 作為範例，首先按下 <code>F12</code> 並至 <code>Console</code> 畫面：<br><img src=\"https://i.imgur.com/0bUzvKS.png\" alt></p>\n<p>接著我們來定義範例的 numberCondition 函式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  let result = new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  return result</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Bonus-使用-early-return-讓程式碼更簡潔些\"><a href=\"#Bonus-使用-early-return-讓程式碼更簡潔些\" class=\"headerlink\" title=\"Bonus - 使用 early return 讓程式碼更簡潔些\"></a>Bonus - 使用 early return 讓程式碼更簡潔些</h4><p>這個方法依照我的經驗在 Ruby、Javascript、Python 都有用過，但 Javascript 這邊用的是最平凡，若看到其他 project 的程式碼有這樣使用時千萬別慌張，其實只是合在一起寫而已。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  return new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上述範例當 <code>num</code> 等於 0 時就回傳一組字串告訴使用者答對，反之則回傳錯誤訊息的 Error 物件，最後則是把結果 return 回去。</p>\n<h3 id=\"結果\"><a href=\"#結果\" class=\"headerlink\" title=\"結果\"></a>結果</h3><p>\b\bPromise 寫完了，接下來就來呼叫他吧！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numberCondition(999)</span><br><span class=\"line\">  .then(function(result) &#123; console.log(&quot;答對了！&quot;) &#125;)</span><br><span class=\"line\">  .catch(function(error) &#123; console.log(&quot;糟糕，答錯了&quot;) &#125;)</span><br></pre></td></tr></table></figure>\n\n<p>貼到 Chrome 開發者工具列(Console)上吧！接著再把 999 改成 0 會就會跑到 <code>.then</code> 囉。<br><img src=\"https://i.imgur.com/6456opd.png\" alt></p>\n<blockquote>\n<p>這樣有沒有發現平常就在使用 Promise 呢 🙂！</p>\n</blockquote>\n<h1 id=\"我知道-Promise-了，那-Async-Await-跟它有什麼關係？\"><a href=\"#我知道-Promise-了，那-Async-Await-跟它有什麼關係？\" class=\"headerlink\" title=\"我知道 Promise 了，那 Async/Await 跟它有什麼關係？\"></a>我知道 Promise 了，那 Async/Await 跟它有什麼關係？</h1><p>自己做了一個 Promise 後，使用它需要一直 <code>.then()</code>、<code>.catch()</code>，接下來就來介紹一下 <code>async/await</code> 在 Promise 之後才誕生的語法糖。</p>\n<h2 id=\"動手做-Implementation\"><a href=\"#動手做-Implementation\" class=\"headerlink\" title=\"動手做 Implementation\"></a>動手做 Implementation</h2><p>首先我們先複製前面的 Promise code 過來:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  let result = new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  return result</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這邊就把 <code>.then()</code> 的寫法並使用 <a href=\"https://developer.mozilla.org/zh-TW/docs/Glossary/IIFE\" target=\"_blank\" rel=\"noopener\">IIFE</a> 搭配<code>匿名函式</code>直接執行:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(async function ()&#123;</span><br><span class=\"line\">    const result = await numberCondition(0)</span><br><span class=\"line\">    console.log(result)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<p>以上是原生的寫法搭配 IIFE，以下則是使用 Arrow Function 做範例:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(async () =&gt; &#123;</span><br><span class=\"line\">    const result = await numberCondition(0)</span><br><span class=\"line\">    console.log(result)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>當 function 裡有使用到 await 時，外面一定要有 async 的字眼，否則會出錯。</p>\n</blockquote>\n<p>一樣貼至 Chrome 的開發者工具列：</p>\n<p><img src=\"https://i.imgur.com/HT9eGlC.png\" alt></p>\n<p>與 Promise 的觸發方式是一樣的，若到 <code>resolve</code> 成功階段時則附值於 <code>result</code>，反之則直接 throw Error()。</p>\n<blockquote>\n<p>在這邊的錯誤處理需要使用 try…catch 去 handle error</p>\n</blockquote>\n<h2 id=\"好處\"><a href=\"#好處\" class=\"headerlink\" title=\"好處\"></a>好處</h2><p>若是從其他語言來的朋友，使用 async/await 的寫法邏輯上會較通順，而若使用一般的 Promise 則容易搞混當前程式執行位置，而 async/await 語法糖除了讓其他語言開發者可以更快速理解以外，也能讓程式邏輯能夠直接順下去，當然最後要加入 Javascript 這個家庭時了解 <code>Callback</code> 仍是開發 Javascript 裡必要的功能 👍。</p>\n<h2 id=\"待討論部分\"><a href=\"#待討論部分\" class=\"headerlink\" title=\"待討論部分\"></a>待討論部分</h2><p>由於是在 Promise 之後才出現的語法，若接手的專案本身並未支援到 async/await 語法時則需要將相關邏輯轉換使用 <code>.then()</code>、<code>.catch()</code> 去處理 Promise，在專案的<code>支援度</code>上這部分則需要多考慮。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>因為接觸到 <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">Bottender</a> 才接觸到 Promise 以及 async/await 這系列的工具，在理解上也花了好長一段時間才轉換過來，藉由本篇紀錄我釐清的過程，透過這些例子希望讓大家能夠更快速的了解 Promise 🙂。</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在寫 Javascript 時一定會看到有套件或是範例有使用到 callback function，在過往的 coding 過程中最擔心的問題就是遇到 Callback Hell(也就是俗稱的波動拳)，最常見的範例為：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">doSomething(function(result) &#123;</span><br><span class=\"line\">  doSomethingElse(result, function(newResult) &#123;</span><br><span class=\"line\">    doThirdThing(newResult, function(finalResult) &#123;</span><br><span class=\"line\">      console.log(&apos;Got the final result: &apos; + finalResult);</span><br><span class=\"line\">    &#125;, failureCallback);</span><br><span class=\"line\">  &#125;, failureCallback);</span><br><span class=\"line\">&#125;, failureCallback);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Sample from <a href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Using_promises\" target=\"_blank\" rel=\"noopener\">MDN</a></p>\n</blockquote>\n<p>為了降低波動拳的出現機率，因此就就誕生了 <code>Promise</code> 來幫忙處理 Hell world 的問題，至於如何處理就透過接下來就說明並介紹用法。</p>","more":"<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>Promise 是 Javascript 的<code>非同步運算的物件</code>，並且包含 <code>resolve</code>(成功)、<code>reject</code>(失敗)、<code>pending</code>(處理中)三種狀態，接下來就看看介紹吧！</p>\n<h2 id=\"Promise-提供了什麼？\"><a href=\"#Promise-提供了什麼？\" class=\"headerlink\" title=\"Promise 提供了什麼？\"></a>Promise 提供了什麼？</h2><p>主要提供了 <code>.then()</code> 以及 <code>.catch()</code> 方法讓使用者可以做 Promise Chain 去串聯方法，它的用意是讓之前的 Chain 在做完之後去執行接下來的事情，以 <a href=\"https://github.com/axios/axios\" target=\"_blank\" rel=\"noopener\">Axios</a> 為例：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.get(&apos;https://www.example.com&apos;)</span><br><span class=\"line\">  .then(function(result) &#123;...&#125;)</span><br><span class=\"line\">  .catch(function(error) &#123;...&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>可以在輪到 <code>get()</code> 執行後若成功則進去 <code>.then()</code>，反之錯誤則 <code>.catch()</code>，若只看這樣不清楚還是不懂，那來與以前的寫法比對：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function successCallback(result) &#123;...&#125;</span><br><span class=\"line\">function failureCallback(error) &#123;...&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\bGetExampleCode(callExampleUrl, successCallback, failureCallback)</span><br></pre></td></tr></table></figure>\n\n<p>看完以前的的寫法，使用 Promise 邏輯是不是比較順暢且直覺呢？\b</p>\n<p>看完範例後，接著看一下怎麼實作一個 Promise 吧！</p>\n<h2 id=\"製作一個【判斷數字】的-Promise\"><a href=\"#製作一個【判斷數字】的-Promise\" class=\"headerlink\" title=\"製作一個【判斷數字】的 Promise\"></a>製作一個【判斷數字】的 Promise</h2><h3 id=\"了解-Promise-參數\"><a href=\"#了解-Promise-參數\" class=\"headerlink\" title=\"了解 Promise 參數\"></a>了解 Promise 參數</h3><p>新增一個 <code>Promise</code> 時一定要兩個參數(<code>resolve</code> &amp; <code>reject</code>)，<code>resolve</code> 用在當 Promise 裡的判斷式成功後所需要回傳的物件，而 <code>reject</code> 顧名思義就是當答案<strong>非預期</strong>時的回傳物件。</p>\n<h3 id=\"實作-Implementation\"><a href=\"#實作-Implementation\" class=\"headerlink\" title=\"實作 Implementation\"></a>實作 Implementation</h3><p>看完解釋之後，接著使用 Chrome 作為範例，首先按下 <code>F12</code> 並至 <code>Console</code> 畫面：<br><img src=\"https://i.imgur.com/0bUzvKS.png\" alt></p>\n<p>接著我們來定義範例的 numberCondition 函式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  let result = new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  return result</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Bonus-使用-early-return-讓程式碼更簡潔些\"><a href=\"#Bonus-使用-early-return-讓程式碼更簡潔些\" class=\"headerlink\" title=\"Bonus - 使用 early return 讓程式碼更簡潔些\"></a>Bonus - 使用 early return 讓程式碼更簡潔些</h4><p>這個方法依照我的經驗在 Ruby、Javascript、Python 都有用過，但 Javascript 這邊用的是最平凡，若看到其他 project 的程式碼有這樣使用時千萬別慌張，其實只是合在一起寫而已。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  return new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上述範例當 <code>num</code> 等於 0 時就回傳一組字串告訴使用者答對，反之則回傳錯誤訊息的 Error 物件，最後則是把結果 return 回去。</p>\n<h3 id=\"結果\"><a href=\"#結果\" class=\"headerlink\" title=\"結果\"></a>結果</h3><p>\b\bPromise 寫完了，接下來就來呼叫他吧！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numberCondition(999)</span><br><span class=\"line\">  .then(function(result) &#123; console.log(&quot;答對了！&quot;) &#125;)</span><br><span class=\"line\">  .catch(function(error) &#123; console.log(&quot;糟糕，答錯了&quot;) &#125;)</span><br></pre></td></tr></table></figure>\n\n<p>貼到 Chrome 開發者工具列(Console)上吧！接著再把 999 改成 0 會就會跑到 <code>.then</code> 囉。<br><img src=\"https://i.imgur.com/6456opd.png\" alt></p>\n<blockquote>\n<p>這樣有沒有發現平常就在使用 Promise 呢 🙂！</p>\n</blockquote>\n<h1 id=\"我知道-Promise-了，那-Async-Await-跟它有什麼關係？\"><a href=\"#我知道-Promise-了，那-Async-Await-跟它有什麼關係？\" class=\"headerlink\" title=\"我知道 Promise 了，那 Async/Await 跟它有什麼關係？\"></a>我知道 Promise 了，那 Async/Await 跟它有什麼關係？</h1><p>自己做了一個 Promise 後，使用它需要一直 <code>.then()</code>、<code>.catch()</code>，接下來就來介紹一下 <code>async/await</code> 在 Promise 之後才誕生的語法糖。</p>\n<h2 id=\"動手做-Implementation\"><a href=\"#動手做-Implementation\" class=\"headerlink\" title=\"動手做 Implementation\"></a>動手做 Implementation</h2><p>首先我們先複製前面的 Promise code 過來:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function numberCondition(num)&#123;</span><br><span class=\"line\">  let result = new Promise(function(resolve, reject)&#123;</span><br><span class=\"line\">    if(num === 0)&#123;</span><br><span class=\"line\">      resolve(&quot;Yeah you got it, the number is 0&quot;)</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">     reject(new Error(&apos;No No, your number is wrong&apos;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  return result</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這邊就把 <code>.then()</code> 的寫法並使用 <a href=\"https://developer.mozilla.org/zh-TW/docs/Glossary/IIFE\" target=\"_blank\" rel=\"noopener\">IIFE</a> 搭配<code>匿名函式</code>直接執行:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(async function ()&#123;</span><br><span class=\"line\">    const result = await numberCondition(0)</span><br><span class=\"line\">    console.log(result)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<p>以上是原生的寫法搭配 IIFE，以下則是使用 Arrow Function 做範例:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(async () =&gt; &#123;</span><br><span class=\"line\">    const result = await numberCondition(0)</span><br><span class=\"line\">    console.log(result)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>當 function 裡有使用到 await 時，外面一定要有 async 的字眼，否則會出錯。</p>\n</blockquote>\n<p>一樣貼至 Chrome 的開發者工具列：</p>\n<p><img src=\"https://i.imgur.com/HT9eGlC.png\" alt></p>\n<p>與 Promise 的觸發方式是一樣的，若到 <code>resolve</code> 成功階段時則附值於 <code>result</code>，反之則直接 throw Error()。</p>\n<blockquote>\n<p>在這邊的錯誤處理需要使用 try…catch 去 handle error</p>\n</blockquote>\n<h2 id=\"好處\"><a href=\"#好處\" class=\"headerlink\" title=\"好處\"></a>好處</h2><p>若是從其他語言來的朋友，使用 async/await 的寫法邏輯上會較通順，而若使用一般的 Promise 則容易搞混當前程式執行位置，而 async/await 語法糖除了讓其他語言開發者可以更快速理解以外，也能讓程式邏輯能夠直接順下去，當然最後要加入 Javascript 這個家庭時了解 <code>Callback</code> 仍是開發 Javascript 裡必要的功能 👍。</p>\n<h2 id=\"待討論部分\"><a href=\"#待討論部分\" class=\"headerlink\" title=\"待討論部分\"></a>待討論部分</h2><p>由於是在 Promise 之後才出現的語法，若接手的專案本身並未支援到 async/await 語法時則需要將相關邏輯轉換使用 <code>.then()</code>、<code>.catch()</code> 去處理 Promise，在專案的<code>支援度</code>上這部分則需要多考慮。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>因為接觸到 <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">Bottender</a> 才接觸到 Promise 以及 async/await 這系列的工具，在理解上也花了好長一段時間才轉換過來，藉由本篇紀錄我釐清的過程，透過這些例子希望讓大家能夠更快速的了解 Promise 🙂。</p>"},{"title":"解決 node-gyp rebuild error 問題","abbrlink":2114632633,"date":"2020-02-01T16:51:46.000Z","_content":"\n# 前言\n\n我對這錯誤的印象是某次在練習寫測試時裝 [jest](https://jestjs.io/) 後出現的，檢查了`package-lock.json`後看起來`jest-haste-map`這個套件有用到 [fsevents](https://www.npmjs.com/package/fsevents)，而之後使用`npm install`或者`yarn install`皆會出現以下這個訊息：\n![node-gyp rebuild error](https://i.imgur.com/zH6Mbzo.png)\n\n> 環境為 Mac OS Catalina version 10.15.2\n\n看起來是在執行階段時`node-gyp`出了問題，接著它自己重新執行了`node-gyp rebuild`後出錯，起初我認為是套件的問題並找到了[這個回答](https://github.com/nodejs/node-gyp/issues/94#issuecomment-222482140)並執行:\n\n```sh\nsudo npm uninstall node-gyp -g\nsudo npm uninstall node-gyp\n```\n\n但從來沒有全域安裝`node-gyp`過，也有些網友執行`node-gyp configure`是可以的，而我執行後還是失敗，狀態跟這個 [issue](https://github.com/nodejs/node-gyp/issues/94#issuecomment-269909621) 差不多。\n\n後來看到 fsevents 在套件說明裡有寫到:\n\n> The FSEvents API in MacOS allows applications to register for notifications of changes to a given directory tree. It is a very fast and lightweight alternative to kqueue.\n\n並且注意到剛剛圖裡面有訊息是跟 xcode 以及 apple 相關，最後找到了這個 [issue](https://github.com/schnerd/d3-scale-cluster/issues/7)\n\n# 我的解決方案\n\n有些人可能是有重灌或環境重設導致沒有安裝 xcode，此時只要執行 `xcode-select --install` 即可([參考說明](https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-402541605))。\n\n這邊我使用的解決方案為這個 [issue](https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-550579897)，執行以下兩個指令來重新安裝 xcode:\n\n```sh\nsudo rm -rf $(xcode-select -print-path)\nxcode-select --install\n```\n\n原因可能是因為我重舊版本向上更新之後 xcode 沒有相容當前版本，所以我使用以上指令來刪除重新安裝。\n\n> 不過這個指令很暴力的使用 `rm -rf`，使用它相對危險，使用前請詳閱公開說明書 😆。\n\n# 結論\n\n為了練習測試安裝了 jest 卻讓我看著一堆 warning 實在是恨得牙癢癢，所幸目前這樣解決完後是可以用的，就看接下來些新的 side project 後會不會有其他問題再來更新，\n\n另一方面也可能因為我在寫 side project 時安裝了一堆有的沒的東西導致這個結果，看來也得找時間來整理一下環境了～\n\n# 參考\n\n[清除 npm 快取](https://blog.csdn.net/XuM222222/article/details/94976298)\n","source":"_posts/node-gyp-rebuild-error.md","raw":"---\ntitle: 解決 node-gyp rebuild error 問題\ntags:\n  - node-gyp\n  - MacOS\n  - Xcode\n  - jest\n  - npm\n  - yarn\ncategories: 學習紀錄\nabbrlink: 2114632633\ndate: 2020-02-02 00:51:46\n---\n\n# 前言\n\n我對這錯誤的印象是某次在練習寫測試時裝 [jest](https://jestjs.io/) 後出現的，檢查了`package-lock.json`後看起來`jest-haste-map`這個套件有用到 [fsevents](https://www.npmjs.com/package/fsevents)，而之後使用`npm install`或者`yarn install`皆會出現以下這個訊息：\n![node-gyp rebuild error](https://i.imgur.com/zH6Mbzo.png)\n\n> 環境為 Mac OS Catalina version 10.15.2\n\n看起來是在執行階段時`node-gyp`出了問題，接著它自己重新執行了`node-gyp rebuild`後出錯，起初我認為是套件的問題並找到了[這個回答](https://github.com/nodejs/node-gyp/issues/94#issuecomment-222482140)並執行:\n\n```sh\nsudo npm uninstall node-gyp -g\nsudo npm uninstall node-gyp\n```\n\n但從來沒有全域安裝`node-gyp`過，也有些網友執行`node-gyp configure`是可以的，而我執行後還是失敗，狀態跟這個 [issue](https://github.com/nodejs/node-gyp/issues/94#issuecomment-269909621) 差不多。\n\n後來看到 fsevents 在套件說明裡有寫到:\n\n> The FSEvents API in MacOS allows applications to register for notifications of changes to a given directory tree. It is a very fast and lightweight alternative to kqueue.\n\n並且注意到剛剛圖裡面有訊息是跟 xcode 以及 apple 相關，最後找到了這個 [issue](https://github.com/schnerd/d3-scale-cluster/issues/7)\n\n# 我的解決方案\n\n有些人可能是有重灌或環境重設導致沒有安裝 xcode，此時只要執行 `xcode-select --install` 即可([參考說明](https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-402541605))。\n\n這邊我使用的解決方案為這個 [issue](https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-550579897)，執行以下兩個指令來重新安裝 xcode:\n\n```sh\nsudo rm -rf $(xcode-select -print-path)\nxcode-select --install\n```\n\n原因可能是因為我重舊版本向上更新之後 xcode 沒有相容當前版本，所以我使用以上指令來刪除重新安裝。\n\n> 不過這個指令很暴力的使用 `rm -rf`，使用它相對危險，使用前請詳閱公開說明書 😆。\n\n# 結論\n\n為了練習測試安裝了 jest 卻讓我看著一堆 warning 實在是恨得牙癢癢，所幸目前這樣解決完後是可以用的，就看接下來些新的 side project 後會不會有其他問題再來更新，\n\n另一方面也可能因為我在寫 side project 時安裝了一堆有的沒的東西導致這個結果，看來也得找時間來整理一下環境了～\n\n# 參考\n\n[清除 npm 快取](https://blog.csdn.net/XuM222222/article/details/94976298)\n","slug":"node-gyp-rebuild-error","published":1,"updated":"2020-06-19T14:03:58.864Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31l2004p7cri9k2kny2v","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>我對這錯誤的印象是某次在練習寫測試時裝 <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">jest</a> 後出現的，檢查了<code>package-lock.json</code>後看起來<code>jest-haste-map</code>這個套件有用到 <a href=\"https://www.npmjs.com/package/fsevents\" target=\"_blank\" rel=\"noopener\">fsevents</a>，而之後使用<code>npm install</code>或者<code>yarn install</code>皆會出現以下這個訊息：<br><img src=\"https://i.imgur.com/zH6Mbzo.png\" alt=\"node-gyp rebuild error\"></p>\n<blockquote>\n<p>環境為 Mac OS Catalina version 10.15.2</p>\n</blockquote>\n<p>看起來是在執行階段時<code>node-gyp</code>出了問題，接著它自己重新執行了<code>node-gyp rebuild</code>後出錯，起初我認為是套件的問題並找到了<a href=\"https://github.com/nodejs/node-gyp/issues/94#issuecomment-222482140\" target=\"_blank\" rel=\"noopener\">這個回答</a>並執行:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm uninstall node-gyp -g</span><br><span class=\"line\">sudo npm uninstall node-gyp</span><br></pre></td></tr></table></figure>\n\n<p>但從來沒有全域安裝<code>node-gyp</code>過，也有些網友執行<code>node-gyp configure</code>是可以的，而我執行後還是失敗，狀態跟這個 <a href=\"https://github.com/nodejs/node-gyp/issues/94#issuecomment-269909621\" target=\"_blank\" rel=\"noopener\">issue</a> 差不多。</p>\n<p>後來看到 fsevents 在套件說明裡有寫到:</p>\n<blockquote>\n<p>The FSEvents API in MacOS allows applications to register for notifications of changes to a given directory tree. It is a very fast and lightweight alternative to kqueue.</p>\n</blockquote>\n<p>並且注意到剛剛圖裡面有訊息是跟 xcode 以及 apple 相關，最後找到了這個 <a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7\" target=\"_blank\" rel=\"noopener\">issue</a></p>\n<h1 id=\"我的解決方案\"><a href=\"#我的解決方案\" class=\"headerlink\" title=\"我的解決方案\"></a>我的解決方案</h1><p>有些人可能是有重灌或環境重設導致沒有安裝 xcode，此時只要執行 <code>xcode-select --install</code> 即可(<a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-402541605\" target=\"_blank\" rel=\"noopener\">參考說明</a>)。</p>\n<p>這邊我使用的解決方案為這個 <a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-550579897\" target=\"_blank\" rel=\"noopener\">issue</a>，執行以下兩個指令來重新安裝 xcode:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm -rf $(xcode-select -<span class=\"built_in\">print</span>-path)</span><br><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure>\n\n<p>原因可能是因為我重舊版本向上更新之後 xcode 沒有相容當前版本，所以我使用以上指令來刪除重新安裝。</p>\n<blockquote>\n<p>不過這個指令很暴力的使用 <code>rm -rf</code>，使用它相對危險，使用前請詳閱公開說明書 😆。</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為了練習測試安裝了 jest 卻讓我看著一堆 warning 實在是恨得牙癢癢，所幸目前這樣解決完後是可以用的，就看接下來些新的 side project 後會不會有其他問題再來更新，</p>\n<p>另一方面也可能因為我在寫 side project 時安裝了一堆有的沒的東西導致這個結果，看來也得找時間來整理一下環境了～</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://blog.csdn.net/XuM222222/article/details/94976298\" target=\"_blank\" rel=\"noopener\">清除 npm 快取</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>我對這錯誤的印象是某次在練習寫測試時裝 <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">jest</a> 後出現的，檢查了<code>package-lock.json</code>後看起來<code>jest-haste-map</code>這個套件有用到 <a href=\"https://www.npmjs.com/package/fsevents\" target=\"_blank\" rel=\"noopener\">fsevents</a>，而之後使用<code>npm install</code>或者<code>yarn install</code>皆會出現以下這個訊息：<br><img src=\"https://i.imgur.com/zH6Mbzo.png\" alt=\"node-gyp rebuild error\"></p>\n<blockquote>\n<p>環境為 Mac OS Catalina version 10.15.2</p>\n</blockquote>\n<p>看起來是在執行階段時<code>node-gyp</code>出了問題，接著它自己重新執行了<code>node-gyp rebuild</code>後出錯，起初我認為是套件的問題並找到了<a href=\"https://github.com/nodejs/node-gyp/issues/94#issuecomment-222482140\" target=\"_blank\" rel=\"noopener\">這個回答</a>並執行:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm uninstall node-gyp -g</span><br><span class=\"line\">sudo npm uninstall node-gyp</span><br></pre></td></tr></table></figure>\n\n<p>但從來沒有全域安裝<code>node-gyp</code>過，也有些網友執行<code>node-gyp configure</code>是可以的，而我執行後還是失敗，狀態跟這個 <a href=\"https://github.com/nodejs/node-gyp/issues/94#issuecomment-269909621\" target=\"_blank\" rel=\"noopener\">issue</a> 差不多。</p>\n<p>後來看到 fsevents 在套件說明裡有寫到:</p>\n<blockquote>\n<p>The FSEvents API in MacOS allows applications to register for notifications of changes to a given directory tree. It is a very fast and lightweight alternative to kqueue.</p>\n</blockquote>\n<p>並且注意到剛剛圖裡面有訊息是跟 xcode 以及 apple 相關，最後找到了這個 <a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7\" target=\"_blank\" rel=\"noopener\">issue</a></p>\n<h1 id=\"我的解決方案\"><a href=\"#我的解決方案\" class=\"headerlink\" title=\"我的解決方案\"></a>我的解決方案</h1><p>有些人可能是有重灌或環境重設導致沒有安裝 xcode，此時只要執行 <code>xcode-select --install</code> 即可(<a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-402541605\" target=\"_blank\" rel=\"noopener\">參考說明</a>)。</p>\n<p>這邊我使用的解決方案為這個 <a href=\"https://github.com/schnerd/d3-scale-cluster/issues/7#issuecomment-550579897\" target=\"_blank\" rel=\"noopener\">issue</a>，執行以下兩個指令來重新安裝 xcode:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm -rf $(xcode-select -<span class=\"built_in\">print</span>-path)</span><br><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure>\n\n<p>原因可能是因為我重舊版本向上更新之後 xcode 沒有相容當前版本，所以我使用以上指令來刪除重新安裝。</p>\n<blockquote>\n<p>不過這個指令很暴力的使用 <code>rm -rf</code>，使用它相對危險，使用前請詳閱公開說明書 😆。</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為了練習測試安裝了 jest 卻讓我看著一堆 warning 實在是恨得牙癢癢，所幸目前這樣解決完後是可以用的，就看接下來些新的 side project 後會不會有其他問題再來更新，</p>\n<p>另一方面也可能因為我在寫 side project 時安裝了一堆有的沒的東西導致這個結果，看來也得找時間來整理一下環境了～</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><p><a href=\"https://blog.csdn.net/XuM222222/article/details/94976298\" target=\"_blank\" rel=\"noopener\">清除 npm 快取</a></p>\n"},{"title":"【Python】類別(Class)中的變數層級位置有差嗎？","abbrlink":3330516601,"date":"2020-06-16T16:52:22.000Z","_content":"\n![](https://media.istockphoto.com/photos/taiwan-on-map-picture-id153498409)\n\n# 前言\n\n常常在寫程式時沒搞清楚作用域時很容易留坑或邏輯混亂，因此花時間理解每個語言的作用域也很重要。\n\n之前因為專案有踩過一些坑，而大家在看套件時很能很常看到類似以下的 code：\n\n<!-- more -->\n\n```python\nclass Client:\n    CLIENT_ID = os.environ.get('LINE_NOTIFY_CLIENT_ID')\n    CLIENT_SECRET = os.environ.get('LINE_NOTIFY_CLIENT_SECRET')\n    REDIRECT_URI = os.environ.get('LINE_NOTIFY_REDIRECT_URI')\n\n    def __init__(self,\n                 client_id=None,\n                 client_secret=None,\n                 redirect_uri=None):\n        self.client_id = client_id or self.CLIENT_ID\n        self.client_secret = client_secret or self.CLIENT_SECRET\n        self.redirect_uri = redirect_uri or self.REDIRECT_URI\n```\n\n> [Lotify](https://github.com/louis70109/lotify/blob/master/lotify/client.py#L9) 當中的片段\n\n因時常會搞不清楚為什麼參數會到處定義，接下來就介紹一下 Class 與 Instance 層級變數的差異。\n\n# 介紹\n\n以上述例子而言，在 Class 宣告完後會看到 CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數，在這層的變數就是 `\"Class Level\"`，而在 \\_\\_init\\_\\_ 下面三個變數 self.client_id、self.client_secret、self.redirect_url 就是待會會提到的 `\"Instance Level\"`。\n\n## Class Level\n\nCLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數是被所有有初始化 Client 的 Instances 使用，也就是說當數值改變時其他的 Instance 裡的 Class Level 參數也會跟著改變，在這層操作參數時要特別小心，因為只要改動到值是大家一起改，所以說若有一個地方給錯就其他的 Instance 都會一起錯。\n\n## Instance Level\n\nInstance 作用域只會在初始化後的那個物件身上，每個物件的`參數`間都是獨立的，而 Python 裡面定義的參數位置就在 \\_\\_init\\_\\_ 裡面，因此會大部分的程式碼定義的層級幾乎都會在 Instance Level。\n\n> 若在這還是看不懂的話現在會有實作範例。\n\n## Bonus - self 到底在指誰？\n\n初學的一定很容易搞混這個部分，因為兩個層級基本上是共用同一個 `self`，因此在變數的宣告上 class level 我一般習慣用全大寫，意指在 Class level 這層的「全域變數」，而小寫則是在 Instance level 中的「區域變數」，這個習慣基本上在每個語言間都是通用，因此在定義變數時若發現大小寫時記得要注意喔！\n\n# 實作一個範例\n\n製作一個 Example 的類別，包含著 `class_variable` 以及 `instance_variable` 兩個變數，其中 `instance_variable` 首次附值若初始化沒定義 instance_variable 的話則為 class_variable 的值 `123`：\n\n```python\nclass Example:\n     class_variable = 123\n     def __init__(self, instance_variable=None):\n         self.instance_variable = instance_variable or type(self).class_variable\n```\n\nExample 的類別(Class)物件值如下：\n\n```puml\n@startuml\nobject Example\nExample : class_variable = \"123\"\nExample : instance_variable = \"123\"\n@enduml\n```\n\n接著宣告`s1` & `s2` 兩個 Instance 來做實驗：\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"123\"\ns1 : instance_variable = \"123\"\n\nobject s2\ns2 : class_variable = \"123\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n```python\ns1 = Example()\ns2 = Example(456)\n\ns1.class_variable     # 123\ns2.class_variable     # 123\n```\n\n此時因為初始化所以值都會 `123`，接下來直接改 Example 的 class 為 `\"I am CLASS !!\"`：\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"I am CLASS !!\"\ns1 : instance_variable = \"123\"\n\nobject s2\ns2 : class_variable = \"I am CLASS !!\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n```python\n#  直接改 Example 類別的值\nExample.class_variable = \"I am CLASS !!\"\n\n#  印出 class_variable & instance_variable\nprint(s1.class_variable)     # 'I am CLASS !!'\nprint(s1.instance_variable)  # 123\nprint(s2.class_variable)     # 'I am CLASS !!'\nprint(s2.instance_variable)  # 456\n```\n\n從上述實驗中驗證了 class Level 層級的變數在 s1 以及 s2 這兩個 Instance 中是共用的，接著來實驗 Instance 層級的變數：\n\n```python\nprint(s1.instance_variable)  # 123\nprint(s2.instance_variable)  # 456\n\n# 修改 s1 的值\ns1.instance_variable = \"I am S1 variable\"\n\nprint(s1.instance_variable)  # \"I am S1 variable\"\nprint(s2.instance_variable)  # 456\n```\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"I am CLASS !!\"\ns1 : instance_variable = \"I am S1 variable\"\n\nobject s2\ns2 : class_variable = \"I am CLASS !!\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n從這實驗中能看到個別 Instance 之間的參數不會互相影響，因此再更改變數值前記得要先了解當前的層級在哪才不會失手改錯造成問題。\n\n# 結論\n\nClass 層級的變數很適合給`環境變數`、`系統參數`，通常這兩個值影響都會是整個專案，而 Instance 之間因為不會互相影響所以適用於獨立情境中，例如 `Model 定義`、`JSON 物件` 就很適合。\n\n```python\nclass Client:\n    CLIENT_ID = os.environ.get('LINE_NOTIFY_CLIENT_ID')\n    CLIENT_SECRET = os.environ.get('LINE_NOTIFY_CLIENT_SECRET')\n    REDIRECT_URI = os.environ.get('LINE_NOTIFY_REDIRECT_URI')\n```\n\n> 參考 [Lotify 範例](https://github.com/louis70109/lotify/blob/master/lotify/client.py)\n\n透過幾個簡單的例子也了解到變數在定義時的位置是`很重要的`，因此不管在寫套件或是專案時要注意一下變數的位置以防出問題喔！\n","source":"_posts/python-class-instance-level-diff.md","raw":"---\ntitle: 【Python】類別(Class)中的變數層級位置有差嗎？\ntags:\n  - Python\n  - Class level\n  - Instance level\ncategories: Python\nabbrlink: 3330516601\ndate: 2020-06-17 00:52:22\n---\n\n![](https://media.istockphoto.com/photos/taiwan-on-map-picture-id153498409)\n\n# 前言\n\n常常在寫程式時沒搞清楚作用域時很容易留坑或邏輯混亂，因此花時間理解每個語言的作用域也很重要。\n\n之前因為專案有踩過一些坑，而大家在看套件時很能很常看到類似以下的 code：\n\n<!-- more -->\n\n```python\nclass Client:\n    CLIENT_ID = os.environ.get('LINE_NOTIFY_CLIENT_ID')\n    CLIENT_SECRET = os.environ.get('LINE_NOTIFY_CLIENT_SECRET')\n    REDIRECT_URI = os.environ.get('LINE_NOTIFY_REDIRECT_URI')\n\n    def __init__(self,\n                 client_id=None,\n                 client_secret=None,\n                 redirect_uri=None):\n        self.client_id = client_id or self.CLIENT_ID\n        self.client_secret = client_secret or self.CLIENT_SECRET\n        self.redirect_uri = redirect_uri or self.REDIRECT_URI\n```\n\n> [Lotify](https://github.com/louis70109/lotify/blob/master/lotify/client.py#L9) 當中的片段\n\n因時常會搞不清楚為什麼參數會到處定義，接下來就介紹一下 Class 與 Instance 層級變數的差異。\n\n# 介紹\n\n以上述例子而言，在 Class 宣告完後會看到 CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數，在這層的變數就是 `\"Class Level\"`，而在 \\_\\_init\\_\\_ 下面三個變數 self.client_id、self.client_secret、self.redirect_url 就是待會會提到的 `\"Instance Level\"`。\n\n## Class Level\n\nCLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數是被所有有初始化 Client 的 Instances 使用，也就是說當數值改變時其他的 Instance 裡的 Class Level 參數也會跟著改變，在這層操作參數時要特別小心，因為只要改動到值是大家一起改，所以說若有一個地方給錯就其他的 Instance 都會一起錯。\n\n## Instance Level\n\nInstance 作用域只會在初始化後的那個物件身上，每個物件的`參數`間都是獨立的，而 Python 裡面定義的參數位置就在 \\_\\_init\\_\\_ 裡面，因此會大部分的程式碼定義的層級幾乎都會在 Instance Level。\n\n> 若在這還是看不懂的話現在會有實作範例。\n\n## Bonus - self 到底在指誰？\n\n初學的一定很容易搞混這個部分，因為兩個層級基本上是共用同一個 `self`，因此在變數的宣告上 class level 我一般習慣用全大寫，意指在 Class level 這層的「全域變數」，而小寫則是在 Instance level 中的「區域變數」，這個習慣基本上在每個語言間都是通用，因此在定義變數時若發現大小寫時記得要注意喔！\n\n# 實作一個範例\n\n製作一個 Example 的類別，包含著 `class_variable` 以及 `instance_variable` 兩個變數，其中 `instance_variable` 首次附值若初始化沒定義 instance_variable 的話則為 class_variable 的值 `123`：\n\n```python\nclass Example:\n     class_variable = 123\n     def __init__(self, instance_variable=None):\n         self.instance_variable = instance_variable or type(self).class_variable\n```\n\nExample 的類別(Class)物件值如下：\n\n```puml\n@startuml\nobject Example\nExample : class_variable = \"123\"\nExample : instance_variable = \"123\"\n@enduml\n```\n\n接著宣告`s1` & `s2` 兩個 Instance 來做實驗：\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"123\"\ns1 : instance_variable = \"123\"\n\nobject s2\ns2 : class_variable = \"123\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n```python\ns1 = Example()\ns2 = Example(456)\n\ns1.class_variable     # 123\ns2.class_variable     # 123\n```\n\n此時因為初始化所以值都會 `123`，接下來直接改 Example 的 class 為 `\"I am CLASS !!\"`：\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"I am CLASS !!\"\ns1 : instance_variable = \"123\"\n\nobject s2\ns2 : class_variable = \"I am CLASS !!\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n```python\n#  直接改 Example 類別的值\nExample.class_variable = \"I am CLASS !!\"\n\n#  印出 class_variable & instance_variable\nprint(s1.class_variable)     # 'I am CLASS !!'\nprint(s1.instance_variable)  # 123\nprint(s2.class_variable)     # 'I am CLASS !!'\nprint(s2.instance_variable)  # 456\n```\n\n從上述實驗中驗證了 class Level 層級的變數在 s1 以及 s2 這兩個 Instance 中是共用的，接著來實驗 Instance 層級的變數：\n\n```python\nprint(s1.instance_variable)  # 123\nprint(s2.instance_variable)  # 456\n\n# 修改 s1 的值\ns1.instance_variable = \"I am S1 variable\"\n\nprint(s1.instance_variable)  # \"I am S1 variable\"\nprint(s2.instance_variable)  # 456\n```\n\n```puml\n@startuml\n\nobject s1\ns1 : class_variable = \"I am CLASS !!\"\ns1 : instance_variable = \"I am S1 variable\"\n\nobject s2\ns2 : class_variable = \"I am CLASS !!\"\ns2 : instance_variable = \"456\"\n@enduml\n```\n\n從這實驗中能看到個別 Instance 之間的參數不會互相影響，因此再更改變數值前記得要先了解當前的層級在哪才不會失手改錯造成問題。\n\n# 結論\n\nClass 層級的變數很適合給`環境變數`、`系統參數`，通常這兩個值影響都會是整個專案，而 Instance 之間因為不會互相影響所以適用於獨立情境中，例如 `Model 定義`、`JSON 物件` 就很適合。\n\n```python\nclass Client:\n    CLIENT_ID = os.environ.get('LINE_NOTIFY_CLIENT_ID')\n    CLIENT_SECRET = os.environ.get('LINE_NOTIFY_CLIENT_SECRET')\n    REDIRECT_URI = os.environ.get('LINE_NOTIFY_REDIRECT_URI')\n```\n\n> 參考 [Lotify 範例](https://github.com/louis70109/lotify/blob/master/lotify/client.py)\n\n透過幾個簡單的例子也了解到變數在定義時的位置是`很重要的`，因此不管在寫套件或是專案時要注意一下變數的位置以防出問題喔！\n","slug":"python-class-instance-level-diff","published":1,"updated":"2020-06-19T15:14:17.809Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31l4004t7cridjgyl6x1","content":"<p><img src=\"https://media.istockphoto.com/photos/taiwan-on-map-picture-id153498409\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>常常在寫程式時沒搞清楚作用域時很容易留坑或邏輯混亂，因此花時間理解每個語言的作用域也很重要。</p>\n<p>之前因為專案有踩過一些坑，而大家在看套件時很能很常看到類似以下的 code：</p>\n<a id=\"more\"></a>\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span>:</span></span><br><span class=\"line\">    CLIENT_ID = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_ID'</span>)</span><br><span class=\"line\">    CLIENT_SECRET = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_SECRET'</span>)</span><br><span class=\"line\">    REDIRECT_URI = os.environ.get(<span class=\"string\">'LINE_NOTIFY_REDIRECT_URI'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 client_id=None,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 client_secret=None,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 redirect_uri=None)</span>:</span></span><br><span class=\"line\">        self.client_id = client_id <span class=\"keyword\">or</span> self.CLIENT_ID</span><br><span class=\"line\">        self.client_secret = client_secret <span class=\"keyword\">or</span> self.CLIENT_SECRET</span><br><span class=\"line\">        self.redirect_uri = redirect_uri <span class=\"keyword\">or</span> self.REDIRECT_URI</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://github.com/louis70109/lotify/blob/master/lotify/client.py#L9\" target=\"_blank\" rel=\"noopener\">Lotify</a> 當中的片段</p>\n</blockquote>\n<p>因時常會搞不清楚為什麼參數會到處定義，接下來就介紹一下 Class 與 Instance 層級變數的差異。</p>\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以上述例子而言，在 Class 宣告完後會看到 CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數，在這層的變數就是 <code>&quot;Class Level&quot;</code>，而在 __init__ 下面三個變數 self.client_id、self.client_secret、self.redirect_url 就是待會會提到的 <code>&quot;Instance Level&quot;</code>。</p>\n<h2 id=\"Class-Level\"><a href=\"#Class-Level\" class=\"headerlink\" title=\"Class Level\"></a>Class Level</h2><p>CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數是被所有有初始化 Client 的 Instances 使用，也就是說當數值改變時其他的 Instance 裡的 Class Level 參數也會跟著改變，在這層操作參數時要特別小心，因為只要改動到值是大家一起改，所以說若有一個地方給錯就其他的 Instance 都會一起錯。</p>\n<h2 id=\"Instance-Level\"><a href=\"#Instance-Level\" class=\"headerlink\" title=\"Instance Level\"></a>Instance Level</h2><p>Instance 作用域只會在初始化後的那個物件身上，每個物件的<code>參數</code>間都是獨立的，而 Python 裡面定義的參數位置就在 __init__ 裡面，因此會大部分的程式碼定義的層級幾乎都會在 Instance Level。</p>\n<blockquote>\n<p>若在這還是看不懂的話現在會有實作範例。</p>\n</blockquote>\n<h2 id=\"Bonus-self-到底在指誰？\"><a href=\"#Bonus-self-到底在指誰？\" class=\"headerlink\" title=\"Bonus - self 到底在指誰？\"></a>Bonus - self 到底在指誰？</h2><p>初學的一定很容易搞混這個部分，因為兩個層級基本上是共用同一個 <code>self</code>，因此在變數的宣告上 class level 我一般習慣用全大寫，意指在 Class level 這層的「全域變數」，而小寫則是在 Instance level 中的「區域變數」，這個習慣基本上在每個語言間都是通用，因此在定義變數時若發現大小寫時記得要注意喔！</p>\n<h1 id=\"實作一個範例\"><a href=\"#實作一個範例\" class=\"headerlink\" title=\"實作一個範例\"></a>實作一個範例</h1><p>製作一個 Example 的類別，包含著 <code>class_variable</code> 以及 <code>instance_variable</code> 兩個變數，其中 <code>instance_variable</code> 首次附值若初始化沒定義 instance_variable 的話則為 class_variable 的值 <code>123</code>：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Example</span>:</span></span><br><span class=\"line\">     class_variable = <span class=\"number\">123</span></span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, instance_variable=None)</span>:</span></span><br><span class=\"line\">         self.instance_variable = instance_variable <span class=\"keyword\">or</span> type(self).class_variable</span><br></pre></td></tr></table></figure>\n\n<p>Example 的類別(Class)物件值如下：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjE3N3B4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTc3IDc1IiB3aWR0aD0iMTc3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmUya2cyamVzamxxMyIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmUya2cyamVzamxxMykiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1MSIgeD0iNyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjUxIiB4PSI1NyIgeT0iMjAuMTM4NyI+RXhhbXBsZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSI4IiB4Mj0iMTU3IiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMTkiIHg9IjEzIiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIjEyMyI8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTM5IiB4PSIxMyIgeT0iNDkuODkxNiI+aW5zdGFuY2VfdmFyaWFibGUgPSAiMTIzIjwvdGV4dD48IS0tTUQ1PVszNDgwNzlhZTU5MjA1OTQ4YTQ4NTE5OWQ4NzkxZjY1N10KQHN0YXJ0dW1sDQpvYmplY3QgRXhhbXBsZQ0KRXhhbXBsZSA6IGNsYXNzX3ZhcmlhYmxlID0gIjEyMyINCkV4YW1wbGUgOiBpbnN0YW5jZV92YXJpYWJsZSA9ICIxMjMiDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>接著宣告<code>s1</code> &amp; <code>s2</code> 兩個 Instance 來做實驗：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjM2M3B4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMzYzIDc1IiB3aWR0aD0iMzYzcHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjFtcTc2cTExNjN3bzkiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxbXE3NnExMTYzd285KSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTUxIiB4PSI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTQiIHg9Ijc1LjUiIHk9IjIwLjEzODciPnMxPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgeDE9IjgiIHgyPSIxNTciIHkxPSIyNC45Njg4IiB5Mj0iMjQuOTY4OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjExOSIgeD0iMTMiIHk9IjM4LjI1MSI+Y2xhc3NfdmFyaWFibGUgPSAiMTIzIjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMzkiIHg9IjEzIiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICIxMjMiPC90ZXh0PjxyZWN0IGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMW1xNzZxMTE2M3dvOSkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1MSIgeD0iMTkzIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTUiIHg9IjI2MSIgeT0iMjAuMTM4NyI+czI8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB4MT0iMTk0IiB4Mj0iMzQzIiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMTkiIHg9IjE5OSIgeT0iMzguMjUxIj5jbGFzc192YXJpYWJsZSA9ICIxMjMiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMTk5IiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICI0NTYiPC90ZXh0PjwhLS1NRDU9W2Q4NDQ0YWFmNWJhZGU2NmFhNjM2YjBmNTM0YzVkZjU2XQpAc3RhcnR1bWwNCm9iamVjdCBzMQ0KczEgOiBjbGFzc192YXJpYWJsZSA9ICIxMjMiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyINCg0Kb2JqZWN0IHMyDQpzMiA6IGNsYXNzX3ZhcmlhYmxlID0gIjEyMyINCnMyIDogaW5zdGFuY2VfdmFyaWFibGUgPSAiNDU2Ig0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIwLjEzKFNhdCBKdW4gMTMgMTI6MjY6MzggVVRDIDIwMjApCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+\">\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s1 = Example()</span><br><span class=\"line\">s2 = Example(<span class=\"number\">456</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">s1.class_variable     <span class=\"comment\"># 123</span></span><br><span class=\"line\">s2.class_variable     <span class=\"comment\"># 123</span></span><br></pre></td></tr></table></figure>\n\n<p>此時因為初始化所以值都會 <code>123</code>，接下來直接改 Example 的 class 為 <code>&quot;I am CLASS !!&quot;</code>：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjQyOXB4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDI5IDc1IiB3aWR0aD0iNDI5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjFlcWhoc2N0b2EzemwiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxZXFoaHNjdG9hM3psKSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTg0IiB4PSI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTQiIHg9IjkyIiB5PSIyMC4xMzg3Ij5zMTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSI4IiB4Mj0iMTkwIiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzIiIHg9IjEzIiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMTMiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyI8L3RleHQ+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxZXFoaHNjdG9hM3psKSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTg0IiB4PSIyMjYiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNSIgeD0iMzEwLjUiIHk9IjIwLjEzODciPnMyPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgeDE9IjIyNyIgeDI9IjQwOSIgeTE9IjI0Ljk2ODgiIHkyPSIyNC45Njg4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTcyIiB4PSIyMzIiIHk9IjM4LjI1MSI+Y2xhc3NfdmFyaWFibGUgPSAiSSBhbSBDTEFTUyAhISI8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTM5IiB4PSIyMzIiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiI8L3RleHQ+PCEtLU1ENT1bNWVmYmFlNWMyN2JjN2Y3OTE5MDQ0MjliYzA3NjhkOTddCkBzdGFydHVtbA0Kb2JqZWN0IHMxDQpzMSA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyINCg0Kb2JqZWN0IHMyDQpzMiA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMiA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiINCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4xNWJldGExKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg==\">\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  直接改 Example 類別的值</span></span><br><span class=\"line\">Example.class_variable = <span class=\"string\">\"I am CLASS !!\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  印出 class_variable &amp; instance_variable</span></span><br><span class=\"line\">print(s1.class_variable)     <span class=\"comment\"># 'I am CLASS !!'</span></span><br><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># 123</span></span><br><span class=\"line\">print(s2.class_variable)     <span class=\"comment\"># 'I am CLASS !!'</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br></pre></td></tr></table></figure>\n\n<p>從上述實驗中驗證了 class Level 層級的變數在 s1 以及 s2 這兩個 Instance 中是共用的，接著來實驗 Instance 層級的變數：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># 123</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 修改 s1 的值</span></span><br><span class=\"line\">s1.instance_variable = <span class=\"string\">\"I am S1 variable\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># \"I am S1 variable\"</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br></pre></td></tr></table></figure>\n\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjQ2NHB4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDY0IDc1IiB3aWR0aD0iNDY0cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmRieGs2emxmc2wzMCIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRieGs2emxmc2wzMCkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjIxOSIgeD0iNyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE0IiB4PSIxMDkuNSIgeT0iMjAuMTM4NyI+czE8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB4MT0iOCIgeDI9IjIyNSIgeTE9IjI0Ljk2ODgiIHkyPSIyNC45Njg4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTcyIiB4PSIxMyIgeT0iMzguMjUxIj5jbGFzc192YXJpYWJsZSA9ICJJIGFtIENMQVNTICEhIjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyMDciIHg9IjEzIiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICJJIGFtIFMxIHZhcmlhYmxlIjwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRieGs2emxmc2wzMCkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE4NCIgeD0iMjYxLjUiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNSIgeD0iMzQ2IiB5PSIyMC4xMzg3Ij5zMjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSIyNjIuNSIgeDI9IjQ0NC41IiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzIiIHg9IjI2Ny41IiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMjY3LjUiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiI8L3RleHQ+PCEtLU1ENT1bZDMwNTg1NjNmYzc0MzYwMDNjNzhhM2NlYzA3Y2IwNjFdCkBzdGFydHVtbA0Kb2JqZWN0IHMxDQpzMSA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIkkgYW0gUzEgdmFyaWFibGUiDQoNCm9iamVjdCBzMg0KczIgOiBjbGFzc192YXJpYWJsZSA9ICJJIGFtIENMQVNTICEhIg0KczIgOiBpbnN0YW5jZV92YXJpYWJsZSA9ICI0NTYiDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>從這實驗中能看到個別 Instance 之間的參數不會互相影響，因此再更改變數值前記得要先了解當前的層級在哪才不會失手改錯造成問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>Class 層級的變數很適合給<code>環境變數</code>、<code>系統參數</code>，通常這兩個值影響都會是整個專案，而 Instance 之間因為不會互相影響所以適用於獨立情境中，例如 <code>Model 定義</code>、<code>JSON 物件</code> 就很適合。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span>:</span></span><br><span class=\"line\">    CLIENT_ID = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_ID'</span>)</span><br><span class=\"line\">    CLIENT_SECRET = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_SECRET'</span>)</span><br><span class=\"line\">    REDIRECT_URI = os.environ.get(<span class=\"string\">'LINE_NOTIFY_REDIRECT_URI'</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>參考 <a href=\"https://github.com/louis70109/lotify/blob/master/lotify/client.py\" target=\"_blank\" rel=\"noopener\">Lotify 範例</a></p>\n</blockquote>\n<p>透過幾個簡單的例子也了解到變數在定義時的位置是<code>很重要的</code>，因此不管在寫套件或是專案時要注意一下變數的位置以防出問題喔！</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://media.istockphoto.com/photos/taiwan-on-map-picture-id153498409\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>常常在寫程式時沒搞清楚作用域時很容易留坑或邏輯混亂，因此花時間理解每個語言的作用域也很重要。</p>\n<p>之前因為專案有踩過一些坑，而大家在看套件時很能很常看到類似以下的 code：</p>","more":"<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span>:</span></span><br><span class=\"line\">    CLIENT_ID = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_ID'</span>)</span><br><span class=\"line\">    CLIENT_SECRET = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_SECRET'</span>)</span><br><span class=\"line\">    REDIRECT_URI = os.environ.get(<span class=\"string\">'LINE_NOTIFY_REDIRECT_URI'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 client_id=None,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 client_secret=None,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                 redirect_uri=None)</span>:</span></span><br><span class=\"line\">        self.client_id = client_id <span class=\"keyword\">or</span> self.CLIENT_ID</span><br><span class=\"line\">        self.client_secret = client_secret <span class=\"keyword\">or</span> self.CLIENT_SECRET</span><br><span class=\"line\">        self.redirect_uri = redirect_uri <span class=\"keyword\">or</span> self.REDIRECT_URI</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://github.com/louis70109/lotify/blob/master/lotify/client.py#L9\" target=\"_blank\" rel=\"noopener\">Lotify</a> 當中的片段</p>\n</blockquote>\n<p>因時常會搞不清楚為什麼參數會到處定義，接下來就介紹一下 Class 與 Instance 層級變數的差異。</p>\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以上述例子而言，在 Class 宣告完後會看到 CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數，在這層的變數就是 <code>&quot;Class Level&quot;</code>，而在 __init__ 下面三個變數 self.client_id、self.client_secret、self.redirect_url 就是待會會提到的 <code>&quot;Instance Level&quot;</code>。</p>\n<h2 id=\"Class-Level\"><a href=\"#Class-Level\" class=\"headerlink\" title=\"Class Level\"></a>Class Level</h2><p>CLIENT_ID、CLIENT_SECRET、REDIRECT_URI 這三個參數是被所有有初始化 Client 的 Instances 使用，也就是說當數值改變時其他的 Instance 裡的 Class Level 參數也會跟著改變，在這層操作參數時要特別小心，因為只要改動到值是大家一起改，所以說若有一個地方給錯就其他的 Instance 都會一起錯。</p>\n<h2 id=\"Instance-Level\"><a href=\"#Instance-Level\" class=\"headerlink\" title=\"Instance Level\"></a>Instance Level</h2><p>Instance 作用域只會在初始化後的那個物件身上，每個物件的<code>參數</code>間都是獨立的，而 Python 裡面定義的參數位置就在 __init__ 裡面，因此會大部分的程式碼定義的層級幾乎都會在 Instance Level。</p>\n<blockquote>\n<p>若在這還是看不懂的話現在會有實作範例。</p>\n</blockquote>\n<h2 id=\"Bonus-self-到底在指誰？\"><a href=\"#Bonus-self-到底在指誰？\" class=\"headerlink\" title=\"Bonus - self 到底在指誰？\"></a>Bonus - self 到底在指誰？</h2><p>初學的一定很容易搞混這個部分，因為兩個層級基本上是共用同一個 <code>self</code>，因此在變數的宣告上 class level 我一般習慣用全大寫，意指在 Class level 這層的「全域變數」，而小寫則是在 Instance level 中的「區域變數」，這個習慣基本上在每個語言間都是通用，因此在定義變數時若發現大小寫時記得要注意喔！</p>\n<h1 id=\"實作一個範例\"><a href=\"#實作一個範例\" class=\"headerlink\" title=\"實作一個範例\"></a>實作一個範例</h1><p>製作一個 Example 的類別，包含著 <code>class_variable</code> 以及 <code>instance_variable</code> 兩個變數，其中 <code>instance_variable</code> 首次附值若初始化沒定義 instance_variable 的話則為 class_variable 的值 <code>123</code>：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Example</span>:</span></span><br><span class=\"line\">     class_variable = <span class=\"number\">123</span></span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, instance_variable=None)</span>:</span></span><br><span class=\"line\">         self.instance_variable = instance_variable <span class=\"keyword\">or</span> type(self).class_variable</span><br></pre></td></tr></table></figure>\n\n<p>Example 的類別(Class)物件值如下：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjE3N3B4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTc3IDc1IiB3aWR0aD0iMTc3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmUya2cyamVzamxxMyIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmUya2cyamVzamxxMykiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1MSIgeD0iNyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjUxIiB4PSI1NyIgeT0iMjAuMTM4NyI+RXhhbXBsZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSI4IiB4Mj0iMTU3IiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMTkiIHg9IjEzIiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIjEyMyI8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTM5IiB4PSIxMyIgeT0iNDkuODkxNiI+aW5zdGFuY2VfdmFyaWFibGUgPSAiMTIzIjwvdGV4dD48IS0tTUQ1PVszNDgwNzlhZTU5MjA1OTQ4YTQ4NTE5OWQ4NzkxZjY1N10KQHN0YXJ0dW1sDQpvYmplY3QgRXhhbXBsZQ0KRXhhbXBsZSA6IGNsYXNzX3ZhcmlhYmxlID0gIjEyMyINCkV4YW1wbGUgOiBpbnN0YW5jZV92YXJpYWJsZSA9ICIxMjMiDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>接著宣告<code>s1</code> &amp; <code>s2</code> 兩個 Instance 來做實驗：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjM2M3B4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMzYzIDc1IiB3aWR0aD0iMzYzcHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjFtcTc2cTExNjN3bzkiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxbXE3NnExMTYzd285KSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTUxIiB4PSI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTQiIHg9Ijc1LjUiIHk9IjIwLjEzODciPnMxPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgeDE9IjgiIHgyPSIxNTciIHkxPSIyNC45Njg4IiB5Mj0iMjQuOTY4OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjExOSIgeD0iMTMiIHk9IjM4LjI1MSI+Y2xhc3NfdmFyaWFibGUgPSAiMTIzIjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMzkiIHg9IjEzIiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICIxMjMiPC90ZXh0PjxyZWN0IGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMW1xNzZxMTE2M3dvOSkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1MSIgeD0iMTkzIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTUiIHg9IjI2MSIgeT0iMjAuMTM4NyI+czI8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB4MT0iMTk0IiB4Mj0iMzQzIiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMTkiIHg9IjE5OSIgeT0iMzguMjUxIj5jbGFzc192YXJpYWJsZSA9ICIxMjMiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMTk5IiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICI0NTYiPC90ZXh0PjwhLS1NRDU9W2Q4NDQ0YWFmNWJhZGU2NmFhNjM2YjBmNTM0YzVkZjU2XQpAc3RhcnR1bWwNCm9iamVjdCBzMQ0KczEgOiBjbGFzc192YXJpYWJsZSA9ICIxMjMiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyINCg0Kb2JqZWN0IHMyDQpzMiA6IGNsYXNzX3ZhcmlhYmxlID0gIjEyMyINCnMyIDogaW5zdGFuY2VfdmFyaWFibGUgPSAiNDU2Ig0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIwLjEzKFNhdCBKdW4gMTMgMTI6MjY6MzggVVRDIDIwMjApCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+\">\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s1 = Example()</span><br><span class=\"line\">s2 = Example(<span class=\"number\">456</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">s1.class_variable     <span class=\"comment\"># 123</span></span><br><span class=\"line\">s2.class_variable     <span class=\"comment\"># 123</span></span><br></pre></td></tr></table></figure>\n\n<p>此時因為初始化所以值都會 <code>123</code>，接下來直接改 Example 的 class 為 <code>&quot;I am CLASS !!&quot;</code>：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjQyOXB4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDI5IDc1IiB3aWR0aD0iNDI5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjFlcWhoc2N0b2EzemwiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxZXFoaHNjdG9hM3psKSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTg0IiB4PSI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTQiIHg9IjkyIiB5PSIyMC4xMzg3Ij5zMTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSI4IiB4Mj0iMTkwIiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzIiIHg9IjEzIiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMTMiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyI8L3RleHQ+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxZXFoaHNjdG9hM3psKSIgaGVpZ2h0PSI0OS4yNSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTg0IiB4PSIyMjYiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNSIgeD0iMzEwLjUiIHk9IjIwLjEzODciPnMyPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgeDE9IjIyNyIgeDI9IjQwOSIgeTE9IjI0Ljk2ODgiIHkyPSIyNC45Njg4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTcyIiB4PSIyMzIiIHk9IjM4LjI1MSI+Y2xhc3NfdmFyaWFibGUgPSAiSSBhbSBDTEFTUyAhISI8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTM5IiB4PSIyMzIiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiI8L3RleHQ+PCEtLU1ENT1bNWVmYmFlNWMyN2JjN2Y3OTE5MDQ0MjliYzA3NjhkOTddCkBzdGFydHVtbA0Kb2JqZWN0IHMxDQpzMSA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjEyMyINCg0Kb2JqZWN0IHMyDQpzMiA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMiA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiINCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4xNWJldGExKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg==\">\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  直接改 Example 類別的值</span></span><br><span class=\"line\">Example.class_variable = <span class=\"string\">\"I am CLASS !!\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  印出 class_variable &amp; instance_variable</span></span><br><span class=\"line\">print(s1.class_variable)     <span class=\"comment\"># 'I am CLASS !!'</span></span><br><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># 123</span></span><br><span class=\"line\">print(s2.class_variable)     <span class=\"comment\"># 'I am CLASS !!'</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br></pre></td></tr></table></figure>\n\n<p>從上述實驗中驗證了 class Level 層級的變數在 s1 以及 s2 這兩個 Instance 中是共用的，接著來實驗 Instance 層級的變數：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># 123</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 修改 s1 的值</span></span><br><span class=\"line\">s1.instance_variable = <span class=\"string\">\"I am S1 variable\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">print(s1.instance_variable)  <span class=\"comment\"># \"I am S1 variable\"</span></span><br><span class=\"line\">print(s2.instance_variable)  <span class=\"comment\"># 456</span></span><br></pre></td></tr></table></figure>\n\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjQ2NHB4O2hlaWdodDo3NXB4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDY0IDc1IiB3aWR0aD0iNDY0cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmRieGs2emxmc2wzMCIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRieGs2emxmc2wzMCkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjIxOSIgeD0iNyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE0IiB4PSIxMDkuNSIgeT0iMjAuMTM4NyI+czE8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB4MT0iOCIgeDI9IjIyNSIgeTE9IjI0Ljk2ODgiIHkyPSIyNC45Njg4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTcyIiB4PSIxMyIgeT0iMzguMjUxIj5jbGFzc192YXJpYWJsZSA9ICJJIGFtIENMQVNTICEhIjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyMDciIHg9IjEzIiB5PSI0OS44OTE2Ij5pbnN0YW5jZV92YXJpYWJsZSA9ICJJIGFtIFMxIHZhcmlhYmxlIjwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRieGs2emxmc2wzMCkiIGhlaWdodD0iNDkuMjUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE4NCIgeD0iMjYxLjUiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNSIgeD0iMzQ2IiB5PSIyMC4xMzg3Ij5zMjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHgxPSIyNjIuNSIgeDI9IjQ0NC41IiB5MT0iMjQuOTY4OCIgeTI9IjI0Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzIiIHg9IjI2Ny41IiB5PSIzOC4yNTEiPmNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEzOSIgeD0iMjY3LjUiIHk9IjQ5Ljg5MTYiPmluc3RhbmNlX3ZhcmlhYmxlID0gIjQ1NiI8L3RleHQ+PCEtLU1ENT1bZDMwNTg1NjNmYzc0MzYwMDNjNzhhM2NlYzA3Y2IwNjFdCkBzdGFydHVtbA0Kb2JqZWN0IHMxDQpzMSA6IGNsYXNzX3ZhcmlhYmxlID0gIkkgYW0gQ0xBU1MgISEiDQpzMSA6IGluc3RhbmNlX3ZhcmlhYmxlID0gIkkgYW0gUzEgdmFyaWFibGUiDQoNCm9iamVjdCBzMg0KczIgOiBjbGFzc192YXJpYWJsZSA9ICJJIGFtIENMQVNTICEhIg0KczIgOiBpbnN0YW5jZV92YXJpYWJsZSA9ICI0NTYiDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>從這實驗中能看到個別 Instance 之間的參數不會互相影響，因此再更改變數值前記得要先了解當前的層級在哪才不會失手改錯造成問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>Class 層級的變數很適合給<code>環境變數</code>、<code>系統參數</code>，通常這兩個值影響都會是整個專案，而 Instance 之間因為不會互相影響所以適用於獨立情境中，例如 <code>Model 定義</code>、<code>JSON 物件</code> 就很適合。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span>:</span></span><br><span class=\"line\">    CLIENT_ID = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_ID'</span>)</span><br><span class=\"line\">    CLIENT_SECRET = os.environ.get(<span class=\"string\">'LINE_NOTIFY_CLIENT_SECRET'</span>)</span><br><span class=\"line\">    REDIRECT_URI = os.environ.get(<span class=\"string\">'LINE_NOTIFY_REDIRECT_URI'</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>參考 <a href=\"https://github.com/louis70109/lotify/blob/master/lotify/client.py\" target=\"_blank\" rel=\"noopener\">Lotify 範例</a></p>\n</blockquote>\n<p>透過幾個簡單的例子也了解到變數在定義時的位置是<code>很重要的</code>，因此不管在寫套件或是專案時要注意一下變數的位置以防出問題喔！</p>"},{"title":"使用 Sentry 收集錯誤並將訊息送至 Slack","abbrlink":3673111655,"date":"2019-11-12T09:50:13.000Z","_content":"\n\n# 前言\n大家好，我是 [Chatbot TW](https://www.facebook.com/groups/chatbot.tw/) 的 NiJia\n\n當產品開發完上線後難免會遇到可能是邏輯上的 Bug、例外錯誤或是想記錄使用上的錯誤，當沒有工具時都只能等錯誤出來時乖乖的去翻 Log 找問題，對於每次出錯要 Debug 的我就覺得很困擾😭。\n\n公司強者寫 APP 的同事他們都很開心的在使用 Crashlytics 幫他們將 APP 出問題時將錯誤訊息丟上去，看了實在時羨慕，但那們寫 Web 的朋友要怎麼辦！\n\n最近就發現了`Sentry`這個玩意兒(**應該是有段時間的產品了**)，支援了幾乎支持現在市場上主流的各種框架以及語言，且串接上也都很簡單就能實現，文件也都清楚解釋每個 API 的功能如何使用，以下就來介紹如何使用它吧😎\n![](https://i.imgur.com/xVHa6qg.png)\n> 這邊顯示較常用的語言，還有支援很多其他種類的框架及語言\n\n## 說明\n- 文章的範例專案在此 -> https://github.com/louis70109/aws-sentry-flask-example\n- 本篇是使用 flask 將 Sentry 透過 serverless 部署至 AWS 上🗿\n\n# 如何使用\n首先先到 https://sentry.io/welcome/ `Get start`\n\n![](https://i.imgur.com/LRIVYDH.jpg)\n\n---\n\n這邊可以整合了`GitHub`或者`Azure DevOps`兩種 OAuth 的登入方式\n![](https://i.imgur.com/eIYugOF.png)\n\n---\n接著就照著步驟來囉！\n![](https://i.imgur.com/5EDwA0N.png)\n\n---\n選擇自己所使用的語言，這邊我使用 Flask(python) 框架來實作\n![](https://i.imgur.com/piHNxXB.png)\n\n---\n接著官方會有個簡單的文件告訴你要如何實作這塊，這邊就先使用`pip`在本地安裝套件\n```bash\npip install --upgrade \"sentry-sdk[flask]==0.13.2\"\n```\n\n> 若是使用雲端服務的話需要將`sentry-sdk[flask]==0.13.2`放入 requirements.txt 中\n\n將以下 init code 放入 api.py 裡，在 `app = Flask(__name__)` 之前\n\n> 這邊我將 Sentry 的 DSN 放入 .env 裡，若有參考這部分的朋友需要注意環境變數的地方喔！\n\n```python\nimport sentry_sdk\nfrom sentry_sdk.integrations.flask import FlaskIntegration\n\nsentry_sdk.init(\n    dsn=os.environ.get('SENTRY_DSN'),\n    integrations=[FlaskIntegration()]\n)\n```\n![](https://i.imgur.com/u9WJkZL.png)\n\n---\n接著就開始丟錯誤上去看看狀態，我的專案上是串著 LINE Bot，功能只是當個應聲蟲，**在這情況下只需要丟個貼圖給它就會出錯**。\n\n當錯誤丟出來之後原本監聽的紅色燈號就會打勾囉✅\n\n> Sentry 預設都會寄信通知，所以若有錯誤記得看信箱哦！\n\n![](https://i.imgur.com/JXfV97e.png)\n\n---\n\n點進去後就可以很清楚的看到程式是錯在第幾行，寫到這有種莫名的感動，平常都是在 LOG 海裡找看看到底報錯在哪邊，終於有個地方能幫我接下來了🎉\n![](https://i.imgur.com/JvVeSdd.png)\n\n到這邊基本串接已經完成了，但身為免費導向的工程師怎麼能讓 5000/月 限制我！接下來就要去過濾一下來的錯誤內容，若不是系統造成的錯誤就不上傳。\n\n我選擇判斷 Log 達到`Waring`或是`Internal`就回報，並照著官方的指示新增以下內容:\n- [before_send](https://docs.sentry.io/platforms/python/#filter-events--custom-logic)\n- [logging](https://docs.sentry.io/platforms/python/logging/)\n\n```python=\nimport sentry_sdk\nfrom sentry_sdk.integrations.flask import FlaskIntegration\n+ import logging\n+ from http.client import HTTPException\n+ from sentry_sdk.integrations.logging import LoggingIntegration\n\n\n+ def strip_sensitive_data(event, hint):\n+     if \"exc_info\" in hint:\n+         instance = hint['exc_info'][1]\n+         if isinstance(instance, HTTPException) and instance.code < 500:\n+             return None\n+     return event\n\n\n+ sentry_logging = LoggingIntegration(\n+     level=logging.INFO,\n+     event_level=logging.WARNING\n+ )\n\nsentry_sdk.init(\n    dsn=os.environ.get('SENTRY_DSN'),\n+    before_send=strip_sensitive_data,\n+    integrations=[FlaskIntegration(), sentry_logging]\n)\n```\n\n- `strip_sensitive_data`: 過濾來自 Http 的 Exception 錯誤碼是否大於`500`，否則不回傳。\n- `sentry_logging`: 使用 SDK 的 `LoggingIntegration` 來定義 log 回傳事件時的層級到哪層才上傳錯誤訊息，這邊我設定`Waring`等級，並加入到 init 的 `integrations` 裡。\n\n\n此時不管你打上都會將訊息送上 Sentry：\n```python\nlogging.waring(\"i am waring\")\nlogging.error(\"i am error\")\n```\n或者是\n```python\nraise InternalServerError(\"Hi Error\")\n```\n> 或者！！自己手殘讓程式崩潰也會送通知\n\n到這基本上已經完成串接完成並能過濾錯誤訊息，接下來則為將服務串至 Slack 上。\n\n# Slack bot 串接\n\n首先來到`Settings`按下`Integrations`會看到以下畫面，並安裝一下`Slack`\n![](https://i.imgur.com/Sbib4sv.png)\n\n---\n接著就要跟 Slack 連動囉\n![](https://i.imgur.com/6wHC4Ci.png)\n\n---\n連動完成後再按下`configure`來設定以下內容\n![](https://i.imgur.com/dSOV9KP.png)\n\n---\n\n到了`Alerts`頁面後就開始設定以下內容囉，這部分參考[官方文件](https://docs.sentry.io/workflow/integrations/global-integrations/#slack)\n![](https://i.imgur.com/qd05OJO.png)\n\n---\n\n可以指定透過哪個`group`去傳送至哪個`tag`，我就直接送到預設的`#general`\n![](https://i.imgur.com/22Z3pV9.png)\n\n---\n\n測試就直接送出貼圖來讓 bot 報錯，結果就收到`key`的錯誤啦～\n![](https://i.imgur.com/FAvjMwy.png)\n\n# 結論\n最後就能透過`sls deploy`將專案部署到 AWS 上，透過這次的紀錄對 Sentry SDK 運作在框架上的問題更加了解，同時也找到了一個不僅可以紀錄錯誤還能通知我錯誤訊息的地方，可以在第一時間直接進去分析 log，若完成了可以直接在 slack 上按`Reslove`來完成這個 issue。\n\n本來有在考慮要串接`LINE Notify`，不過看著 Sentry 對 Slack 的整合比較好，也就放棄了這個念頭了🤣，但串接哪個平台其實就看公司的需求，Sentry 一樣可以透過 webhook 將錯誤訊息傳至 Server。\n\n此外它一樣可以整合`Github`、`GitLab`、`Azure DevOps`...等等，若錯誤處理好的話可以讓 Sentry 幫你送 Issue 上去，不僅整個超炫砲😎，若是 open source 的專案也可以大家一起去修這個問題，真的是一舉兩得啊！！！","source":"_posts/sentry-in-serverless.md","raw":"---\ntitle: 使用 Sentry 收集錯誤並將訊息送至 Slack\ntags:\n  - Sentry\n  - Serverless\ncategories: Third Party\nabbrlink: 3673111655\ndate: 2019-11-12 17:50:13\n---\n\n\n# 前言\n大家好，我是 [Chatbot TW](https://www.facebook.com/groups/chatbot.tw/) 的 NiJia\n\n當產品開發完上線後難免會遇到可能是邏輯上的 Bug、例外錯誤或是想記錄使用上的錯誤，當沒有工具時都只能等錯誤出來時乖乖的去翻 Log 找問題，對於每次出錯要 Debug 的我就覺得很困擾😭。\n\n公司強者寫 APP 的同事他們都很開心的在使用 Crashlytics 幫他們將 APP 出問題時將錯誤訊息丟上去，看了實在時羨慕，但那們寫 Web 的朋友要怎麼辦！\n\n最近就發現了`Sentry`這個玩意兒(**應該是有段時間的產品了**)，支援了幾乎支持現在市場上主流的各種框架以及語言，且串接上也都很簡單就能實現，文件也都清楚解釋每個 API 的功能如何使用，以下就來介紹如何使用它吧😎\n![](https://i.imgur.com/xVHa6qg.png)\n> 這邊顯示較常用的語言，還有支援很多其他種類的框架及語言\n\n## 說明\n- 文章的範例專案在此 -> https://github.com/louis70109/aws-sentry-flask-example\n- 本篇是使用 flask 將 Sentry 透過 serverless 部署至 AWS 上🗿\n\n# 如何使用\n首先先到 https://sentry.io/welcome/ `Get start`\n\n![](https://i.imgur.com/LRIVYDH.jpg)\n\n---\n\n這邊可以整合了`GitHub`或者`Azure DevOps`兩種 OAuth 的登入方式\n![](https://i.imgur.com/eIYugOF.png)\n\n---\n接著就照著步驟來囉！\n![](https://i.imgur.com/5EDwA0N.png)\n\n---\n選擇自己所使用的語言，這邊我使用 Flask(python) 框架來實作\n![](https://i.imgur.com/piHNxXB.png)\n\n---\n接著官方會有個簡單的文件告訴你要如何實作這塊，這邊就先使用`pip`在本地安裝套件\n```bash\npip install --upgrade \"sentry-sdk[flask]==0.13.2\"\n```\n\n> 若是使用雲端服務的話需要將`sentry-sdk[flask]==0.13.2`放入 requirements.txt 中\n\n將以下 init code 放入 api.py 裡，在 `app = Flask(__name__)` 之前\n\n> 這邊我將 Sentry 的 DSN 放入 .env 裡，若有參考這部分的朋友需要注意環境變數的地方喔！\n\n```python\nimport sentry_sdk\nfrom sentry_sdk.integrations.flask import FlaskIntegration\n\nsentry_sdk.init(\n    dsn=os.environ.get('SENTRY_DSN'),\n    integrations=[FlaskIntegration()]\n)\n```\n![](https://i.imgur.com/u9WJkZL.png)\n\n---\n接著就開始丟錯誤上去看看狀態，我的專案上是串著 LINE Bot，功能只是當個應聲蟲，**在這情況下只需要丟個貼圖給它就會出錯**。\n\n當錯誤丟出來之後原本監聽的紅色燈號就會打勾囉✅\n\n> Sentry 預設都會寄信通知，所以若有錯誤記得看信箱哦！\n\n![](https://i.imgur.com/JXfV97e.png)\n\n---\n\n點進去後就可以很清楚的看到程式是錯在第幾行，寫到這有種莫名的感動，平常都是在 LOG 海裡找看看到底報錯在哪邊，終於有個地方能幫我接下來了🎉\n![](https://i.imgur.com/JvVeSdd.png)\n\n到這邊基本串接已經完成了，但身為免費導向的工程師怎麼能讓 5000/月 限制我！接下來就要去過濾一下來的錯誤內容，若不是系統造成的錯誤就不上傳。\n\n我選擇判斷 Log 達到`Waring`或是`Internal`就回報，並照著官方的指示新增以下內容:\n- [before_send](https://docs.sentry.io/platforms/python/#filter-events--custom-logic)\n- [logging](https://docs.sentry.io/platforms/python/logging/)\n\n```python=\nimport sentry_sdk\nfrom sentry_sdk.integrations.flask import FlaskIntegration\n+ import logging\n+ from http.client import HTTPException\n+ from sentry_sdk.integrations.logging import LoggingIntegration\n\n\n+ def strip_sensitive_data(event, hint):\n+     if \"exc_info\" in hint:\n+         instance = hint['exc_info'][1]\n+         if isinstance(instance, HTTPException) and instance.code < 500:\n+             return None\n+     return event\n\n\n+ sentry_logging = LoggingIntegration(\n+     level=logging.INFO,\n+     event_level=logging.WARNING\n+ )\n\nsentry_sdk.init(\n    dsn=os.environ.get('SENTRY_DSN'),\n+    before_send=strip_sensitive_data,\n+    integrations=[FlaskIntegration(), sentry_logging]\n)\n```\n\n- `strip_sensitive_data`: 過濾來自 Http 的 Exception 錯誤碼是否大於`500`，否則不回傳。\n- `sentry_logging`: 使用 SDK 的 `LoggingIntegration` 來定義 log 回傳事件時的層級到哪層才上傳錯誤訊息，這邊我設定`Waring`等級，並加入到 init 的 `integrations` 裡。\n\n\n此時不管你打上都會將訊息送上 Sentry：\n```python\nlogging.waring(\"i am waring\")\nlogging.error(\"i am error\")\n```\n或者是\n```python\nraise InternalServerError(\"Hi Error\")\n```\n> 或者！！自己手殘讓程式崩潰也會送通知\n\n到這基本上已經完成串接完成並能過濾錯誤訊息，接下來則為將服務串至 Slack 上。\n\n# Slack bot 串接\n\n首先來到`Settings`按下`Integrations`會看到以下畫面，並安裝一下`Slack`\n![](https://i.imgur.com/Sbib4sv.png)\n\n---\n接著就要跟 Slack 連動囉\n![](https://i.imgur.com/6wHC4Ci.png)\n\n---\n連動完成後再按下`configure`來設定以下內容\n![](https://i.imgur.com/dSOV9KP.png)\n\n---\n\n到了`Alerts`頁面後就開始設定以下內容囉，這部分參考[官方文件](https://docs.sentry.io/workflow/integrations/global-integrations/#slack)\n![](https://i.imgur.com/qd05OJO.png)\n\n---\n\n可以指定透過哪個`group`去傳送至哪個`tag`，我就直接送到預設的`#general`\n![](https://i.imgur.com/22Z3pV9.png)\n\n---\n\n測試就直接送出貼圖來讓 bot 報錯，結果就收到`key`的錯誤啦～\n![](https://i.imgur.com/FAvjMwy.png)\n\n# 結論\n最後就能透過`sls deploy`將專案部署到 AWS 上，透過這次的紀錄對 Sentry SDK 運作在框架上的問題更加了解，同時也找到了一個不僅可以紀錄錯誤還能通知我錯誤訊息的地方，可以在第一時間直接進去分析 log，若完成了可以直接在 slack 上按`Reslove`來完成這個 issue。\n\n本來有在考慮要串接`LINE Notify`，不過看著 Sentry 對 Slack 的整合比較好，也就放棄了這個念頭了🤣，但串接哪個平台其實就看公司的需求，Sentry 一樣可以透過 webhook 將錯誤訊息傳至 Server。\n\n此外它一樣可以整合`Github`、`GitLab`、`Azure DevOps`...等等，若錯誤處理好的話可以讓 Sentry 幫你送 Issue 上去，不僅整個超炫砲😎，若是 open source 的專案也可以大家一起去修這個問題，真的是一舉兩得啊！！！","slug":"sentry-in-serverless","published":1,"updated":"2020-06-19T14:03:58.865Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31l6004w7crimwsffyta","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot TW</a> 的 NiJia</p>\n<p>當產品開發完上線後難免會遇到可能是邏輯上的 Bug、例外錯誤或是想記錄使用上的錯誤，當沒有工具時都只能等錯誤出來時乖乖的去翻 Log 找問題，對於每次出錯要 Debug 的我就覺得很困擾😭。</p>\n<p>公司強者寫 APP 的同事他們都很開心的在使用 Crashlytics 幫他們將 APP 出問題時將錯誤訊息丟上去，看了實在時羨慕，但那們寫 Web 的朋友要怎麼辦！</p>\n<p>最近就發現了<code>Sentry</code>這個玩意兒(<strong>應該是有段時間的產品了</strong>)，支援了幾乎支持現在市場上主流的各種框架以及語言，且串接上也都很簡單就能實現，文件也都清楚解釋每個 API 的功能如何使用，以下就來介紹如何使用它吧😎<br><img src=\"https://i.imgur.com/xVHa6qg.png\" alt></p>\n<blockquote>\n<p>這邊顯示較常用的語言，還有支援很多其他種類的框架及語言</p>\n</blockquote>\n<h2 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h2><ul>\n<li>文章的範例專案在此 -&gt; <a href=\"https://github.com/louis70109/aws-sentry-flask-example\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/aws-sentry-flask-example</a></li>\n<li>本篇是使用 flask 將 Sentry 透過 serverless 部署至 AWS 上🗿</li>\n</ul>\n<h1 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h1><p>首先先到 <a href=\"https://sentry.io/welcome/\" target=\"_blank\" rel=\"noopener\">https://sentry.io/welcome/</a> <code>Get start</code></p>\n<p><img src=\"https://i.imgur.com/LRIVYDH.jpg\" alt></p>\n<hr>\n<p>這邊可以整合了<code>GitHub</code>或者<code>Azure DevOps</code>兩種 OAuth 的登入方式<br><img src=\"https://i.imgur.com/eIYugOF.png\" alt></p>\n<hr>\n<p>接著就照著步驟來囉！<br><img src=\"https://i.imgur.com/5EDwA0N.png\" alt></p>\n<hr>\n<p>選擇自己所使用的語言，這邊我使用 Flask(python) 框架來實作<br><img src=\"https://i.imgur.com/piHNxXB.png\" alt></p>\n<hr>\n<p>接著官方會有個簡單的文件告訴你要如何實作這塊，這邊就先使用<code>pip</code>在本地安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install --upgrade <span class=\"string\">\"sentry-sdk[flask]==0.13.2\"</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>若是使用雲端服務的話需要將<code>sentry-sdk[flask]==0.13.2</code>放入 requirements.txt 中</p>\n</blockquote>\n<p>將以下 init code 放入 api.py 裡，在 <code>app = Flask(__name__)</code> 之前</p>\n<blockquote>\n<p>這邊我將 Sentry 的 DSN 放入 .env 裡，若有參考這部分的朋友需要注意環境變數的地方喔！</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sentry_sdk</span><br><span class=\"line\"><span class=\"keyword\">from</span> sentry_sdk.integrations.flask <span class=\"keyword\">import</span> FlaskIntegration</span><br><span class=\"line\"></span><br><span class=\"line\">sentry_sdk.init(</span><br><span class=\"line\">    dsn=os.environ.get(<span class=\"string\">'SENTRY_DSN'</span>),</span><br><span class=\"line\">    integrations=[FlaskIntegration()]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/u9WJkZL.png\" alt></p>\n<hr>\n<p>接著就開始丟錯誤上去看看狀態，我的專案上是串著 LINE Bot，功能只是當個應聲蟲，<strong>在這情況下只需要丟個貼圖給它就會出錯</strong>。</p>\n<p>當錯誤丟出來之後原本監聽的紅色燈號就會打勾囉✅</p>\n<blockquote>\n<p>Sentry 預設都會寄信通知，所以若有錯誤記得看信箱哦！</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/JXfV97e.png\" alt></p>\n<hr>\n<p>點進去後就可以很清楚的看到程式是錯在第幾行，寫到這有種莫名的感動，平常都是在 LOG 海裡找看看到底報錯在哪邊，終於有個地方能幫我接下來了🎉<br><img src=\"https://i.imgur.com/JvVeSdd.png\" alt></p>\n<p>到這邊基本串接已經完成了，但身為免費導向的工程師怎麼能讓 5000/月 限制我！接下來就要去過濾一下來的錯誤內容，若不是系統造成的錯誤就不上傳。</p>\n<p>我選擇判斷 Log 達到<code>Waring</code>或是<code>Internal</code>就回報，並照著官方的指示新增以下內容:</p>\n<ul>\n<li><a href=\"https://docs.sentry.io/platforms/python/#filter-events--custom-logic\" target=\"_blank\" rel=\"noopener\">before_send</a></li>\n<li><a href=\"https://docs.sentry.io/platforms/python/logging/\" target=\"_blank\" rel=\"noopener\">logging</a></li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sentry_sdk</span><br><span class=\"line\"><span class=\"keyword\">from</span> sentry_sdk.integrations.flask <span class=\"keyword\">import</span> FlaskIntegration</span><br><span class=\"line\">+ <span class=\"keyword\">import</span> logging</span><br><span class=\"line\">+ <span class=\"keyword\">from</span> http.client <span class=\"keyword\">import</span> HTTPException</span><br><span class=\"line\">+ <span class=\"keyword\">from</span> sentry_sdk.integrations.logging <span class=\"keyword\">import</span> LoggingIntegration</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+ <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">strip_sensitive_data</span><span class=\"params\">(event, hint)</span>:</span></span><br><span class=\"line\">+     <span class=\"keyword\">if</span> <span class=\"string\">\"exc_info\"</span> <span class=\"keyword\">in</span> hint:</span><br><span class=\"line\">+         instance = hint[<span class=\"string\">'exc_info'</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">+         <span class=\"keyword\">if</span> isinstance(instance, HTTPException) <span class=\"keyword\">and</span> instance.code &lt; <span class=\"number\">500</span>:</span><br><span class=\"line\">+             <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">+     <span class=\"keyword\">return</span> event</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+ sentry_logging = LoggingIntegration(</span><br><span class=\"line\">+     level=logging.INFO,</span><br><span class=\"line\">+     event_level=logging.WARNING</span><br><span class=\"line\">+ )</span><br><span class=\"line\"></span><br><span class=\"line\">sentry_sdk.init(</span><br><span class=\"line\">    dsn=os.environ.get(<span class=\"string\">'SENTRY_DSN'</span>),</span><br><span class=\"line\">+    before_send=strip_sensitive_data,</span><br><span class=\"line\">+    integrations=[FlaskIntegration(), sentry_logging]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>strip_sensitive_data</code>: 過濾來自 Http 的 Exception 錯誤碼是否大於<code>500</code>，否則不回傳。</li>\n<li><code>sentry_logging</code>: 使用 SDK 的 <code>LoggingIntegration</code> 來定義 log 回傳事件時的層級到哪層才上傳錯誤訊息，這邊我設定<code>Waring</code>等級，並加入到 init 的 <code>integrations</code> 裡。</li>\n</ul>\n<p>此時不管你打上都會將訊息送上 Sentry：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">logging.waring(<span class=\"string\">\"i am waring\"</span>)</span><br><span class=\"line\">logging.error(<span class=\"string\">\"i am error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>或者是</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">raise</span> InternalServerError(<span class=\"string\">\"Hi Error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>或者！！自己手殘讓程式崩潰也會送通知</p>\n</blockquote>\n<p>到這基本上已經完成串接完成並能過濾錯誤訊息，接下來則為將服務串至 Slack 上。</p>\n<h1 id=\"Slack-bot-串接\"><a href=\"#Slack-bot-串接\" class=\"headerlink\" title=\"Slack bot 串接\"></a>Slack bot 串接</h1><p>首先來到<code>Settings</code>按下<code>Integrations</code>會看到以下畫面，並安裝一下<code>Slack</code><br><img src=\"https://i.imgur.com/Sbib4sv.png\" alt></p>\n<hr>\n<p>接著就要跟 Slack 連動囉<br><img src=\"https://i.imgur.com/6wHC4Ci.png\" alt></p>\n<hr>\n<p>連動完成後再按下<code>configure</code>來設定以下內容<br><img src=\"https://i.imgur.com/dSOV9KP.png\" alt></p>\n<hr>\n<p>到了<code>Alerts</code>頁面後就開始設定以下內容囉，這部分參考<a href=\"https://docs.sentry.io/workflow/integrations/global-integrations/#slack\" target=\"_blank\" rel=\"noopener\">官方文件</a><br><img src=\"https://i.imgur.com/qd05OJO.png\" alt></p>\n<hr>\n<p>可以指定透過哪個<code>group</code>去傳送至哪個<code>tag</code>，我就直接送到預設的<code>#general</code><br><img src=\"https://i.imgur.com/22Z3pV9.png\" alt></p>\n<hr>\n<p>測試就直接送出貼圖來讓 bot 報錯，結果就收到<code>key</code>的錯誤啦～<br><img src=\"https://i.imgur.com/FAvjMwy.png\" alt></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>最後就能透過<code>sls deploy</code>將專案部署到 AWS 上，透過這次的紀錄對 Sentry SDK 運作在框架上的問題更加了解，同時也找到了一個不僅可以紀錄錯誤還能通知我錯誤訊息的地方，可以在第一時間直接進去分析 log，若完成了可以直接在 slack 上按<code>Reslove</code>來完成這個 issue。</p>\n<p>本來有在考慮要串接<code>LINE Notify</code>，不過看著 Sentry 對 Slack 的整合比較好，也就放棄了這個念頭了🤣，但串接哪個平台其實就看公司的需求，Sentry 一樣可以透過 webhook 將錯誤訊息傳至 Server。</p>\n<p>此外它一樣可以整合<code>Github</code>、<code>GitLab</code>、<code>Azure DevOps</code>…等等，若錯誤處理好的話可以讓 Sentry 幫你送 Issue 上去，不僅整個超炫砲😎，若是 open source 的專案也可以大家一起去修這個問題，真的是一舉兩得啊！！！</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>大家好，我是 <a href=\"https://www.facebook.com/groups/chatbot.tw/\" target=\"_blank\" rel=\"noopener\">Chatbot TW</a> 的 NiJia</p>\n<p>當產品開發完上線後難免會遇到可能是邏輯上的 Bug、例外錯誤或是想記錄使用上的錯誤，當沒有工具時都只能等錯誤出來時乖乖的去翻 Log 找問題，對於每次出錯要 Debug 的我就覺得很困擾😭。</p>\n<p>公司強者寫 APP 的同事他們都很開心的在使用 Crashlytics 幫他們將 APP 出問題時將錯誤訊息丟上去，看了實在時羨慕，但那們寫 Web 的朋友要怎麼辦！</p>\n<p>最近就發現了<code>Sentry</code>這個玩意兒(<strong>應該是有段時間的產品了</strong>)，支援了幾乎支持現在市場上主流的各種框架以及語言，且串接上也都很簡單就能實現，文件也都清楚解釋每個 API 的功能如何使用，以下就來介紹如何使用它吧😎<br><img src=\"https://i.imgur.com/xVHa6qg.png\" alt></p>\n<blockquote>\n<p>這邊顯示較常用的語言，還有支援很多其他種類的框架及語言</p>\n</blockquote>\n<h2 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h2><ul>\n<li>文章的範例專案在此 -&gt; <a href=\"https://github.com/louis70109/aws-sentry-flask-example\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/aws-sentry-flask-example</a></li>\n<li>本篇是使用 flask 將 Sentry 透過 serverless 部署至 AWS 上🗿</li>\n</ul>\n<h1 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h1><p>首先先到 <a href=\"https://sentry.io/welcome/\" target=\"_blank\" rel=\"noopener\">https://sentry.io/welcome/</a> <code>Get start</code></p>\n<p><img src=\"https://i.imgur.com/LRIVYDH.jpg\" alt></p>\n<hr>\n<p>這邊可以整合了<code>GitHub</code>或者<code>Azure DevOps</code>兩種 OAuth 的登入方式<br><img src=\"https://i.imgur.com/eIYugOF.png\" alt></p>\n<hr>\n<p>接著就照著步驟來囉！<br><img src=\"https://i.imgur.com/5EDwA0N.png\" alt></p>\n<hr>\n<p>選擇自己所使用的語言，這邊我使用 Flask(python) 框架來實作<br><img src=\"https://i.imgur.com/piHNxXB.png\" alt></p>\n<hr>\n<p>接著官方會有個簡單的文件告訴你要如何實作這塊，這邊就先使用<code>pip</code>在本地安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install --upgrade <span class=\"string\">\"sentry-sdk[flask]==0.13.2\"</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>若是使用雲端服務的話需要將<code>sentry-sdk[flask]==0.13.2</code>放入 requirements.txt 中</p>\n</blockquote>\n<p>將以下 init code 放入 api.py 裡，在 <code>app = Flask(__name__)</code> 之前</p>\n<blockquote>\n<p>這邊我將 Sentry 的 DSN 放入 .env 裡，若有參考這部分的朋友需要注意環境變數的地方喔！</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sentry_sdk</span><br><span class=\"line\"><span class=\"keyword\">from</span> sentry_sdk.integrations.flask <span class=\"keyword\">import</span> FlaskIntegration</span><br><span class=\"line\"></span><br><span class=\"line\">sentry_sdk.init(</span><br><span class=\"line\">    dsn=os.environ.get(<span class=\"string\">'SENTRY_DSN'</span>),</span><br><span class=\"line\">    integrations=[FlaskIntegration()]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/u9WJkZL.png\" alt></p>\n<hr>\n<p>接著就開始丟錯誤上去看看狀態，我的專案上是串著 LINE Bot，功能只是當個應聲蟲，<strong>在這情況下只需要丟個貼圖給它就會出錯</strong>。</p>\n<p>當錯誤丟出來之後原本監聽的紅色燈號就會打勾囉✅</p>\n<blockquote>\n<p>Sentry 預設都會寄信通知，所以若有錯誤記得看信箱哦！</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/JXfV97e.png\" alt></p>\n<hr>\n<p>點進去後就可以很清楚的看到程式是錯在第幾行，寫到這有種莫名的感動，平常都是在 LOG 海裡找看看到底報錯在哪邊，終於有個地方能幫我接下來了🎉<br><img src=\"https://i.imgur.com/JvVeSdd.png\" alt></p>\n<p>到這邊基本串接已經完成了，但身為免費導向的工程師怎麼能讓 5000/月 限制我！接下來就要去過濾一下來的錯誤內容，若不是系統造成的錯誤就不上傳。</p>\n<p>我選擇判斷 Log 達到<code>Waring</code>或是<code>Internal</code>就回報，並照著官方的指示新增以下內容:</p>\n<ul>\n<li><a href=\"https://docs.sentry.io/platforms/python/#filter-events--custom-logic\" target=\"_blank\" rel=\"noopener\">before_send</a></li>\n<li><a href=\"https://docs.sentry.io/platforms/python/logging/\" target=\"_blank\" rel=\"noopener\">logging</a></li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sentry_sdk</span><br><span class=\"line\"><span class=\"keyword\">from</span> sentry_sdk.integrations.flask <span class=\"keyword\">import</span> FlaskIntegration</span><br><span class=\"line\">+ <span class=\"keyword\">import</span> logging</span><br><span class=\"line\">+ <span class=\"keyword\">from</span> http.client <span class=\"keyword\">import</span> HTTPException</span><br><span class=\"line\">+ <span class=\"keyword\">from</span> sentry_sdk.integrations.logging <span class=\"keyword\">import</span> LoggingIntegration</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+ <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">strip_sensitive_data</span><span class=\"params\">(event, hint)</span>:</span></span><br><span class=\"line\">+     <span class=\"keyword\">if</span> <span class=\"string\">\"exc_info\"</span> <span class=\"keyword\">in</span> hint:</span><br><span class=\"line\">+         instance = hint[<span class=\"string\">'exc_info'</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">+         <span class=\"keyword\">if</span> isinstance(instance, HTTPException) <span class=\"keyword\">and</span> instance.code &lt; <span class=\"number\">500</span>:</span><br><span class=\"line\">+             <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">+     <span class=\"keyword\">return</span> event</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+ sentry_logging = LoggingIntegration(</span><br><span class=\"line\">+     level=logging.INFO,</span><br><span class=\"line\">+     event_level=logging.WARNING</span><br><span class=\"line\">+ )</span><br><span class=\"line\"></span><br><span class=\"line\">sentry_sdk.init(</span><br><span class=\"line\">    dsn=os.environ.get(<span class=\"string\">'SENTRY_DSN'</span>),</span><br><span class=\"line\">+    before_send=strip_sensitive_data,</span><br><span class=\"line\">+    integrations=[FlaskIntegration(), sentry_logging]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>strip_sensitive_data</code>: 過濾來自 Http 的 Exception 錯誤碼是否大於<code>500</code>，否則不回傳。</li>\n<li><code>sentry_logging</code>: 使用 SDK 的 <code>LoggingIntegration</code> 來定義 log 回傳事件時的層級到哪層才上傳錯誤訊息，這邊我設定<code>Waring</code>等級，並加入到 init 的 <code>integrations</code> 裡。</li>\n</ul>\n<p>此時不管你打上都會將訊息送上 Sentry：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">logging.waring(<span class=\"string\">\"i am waring\"</span>)</span><br><span class=\"line\">logging.error(<span class=\"string\">\"i am error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>或者是</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">raise</span> InternalServerError(<span class=\"string\">\"Hi Error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>或者！！自己手殘讓程式崩潰也會送通知</p>\n</blockquote>\n<p>到這基本上已經完成串接完成並能過濾錯誤訊息，接下來則為將服務串至 Slack 上。</p>\n<h1 id=\"Slack-bot-串接\"><a href=\"#Slack-bot-串接\" class=\"headerlink\" title=\"Slack bot 串接\"></a>Slack bot 串接</h1><p>首先來到<code>Settings</code>按下<code>Integrations</code>會看到以下畫面，並安裝一下<code>Slack</code><br><img src=\"https://i.imgur.com/Sbib4sv.png\" alt></p>\n<hr>\n<p>接著就要跟 Slack 連動囉<br><img src=\"https://i.imgur.com/6wHC4Ci.png\" alt></p>\n<hr>\n<p>連動完成後再按下<code>configure</code>來設定以下內容<br><img src=\"https://i.imgur.com/dSOV9KP.png\" alt></p>\n<hr>\n<p>到了<code>Alerts</code>頁面後就開始設定以下內容囉，這部分參考<a href=\"https://docs.sentry.io/workflow/integrations/global-integrations/#slack\" target=\"_blank\" rel=\"noopener\">官方文件</a><br><img src=\"https://i.imgur.com/qd05OJO.png\" alt></p>\n<hr>\n<p>可以指定透過哪個<code>group</code>去傳送至哪個<code>tag</code>，我就直接送到預設的<code>#general</code><br><img src=\"https://i.imgur.com/22Z3pV9.png\" alt></p>\n<hr>\n<p>測試就直接送出貼圖來讓 bot 報錯，結果就收到<code>key</code>的錯誤啦～<br><img src=\"https://i.imgur.com/FAvjMwy.png\" alt></p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>最後就能透過<code>sls deploy</code>將專案部署到 AWS 上，透過這次的紀錄對 Sentry SDK 運作在框架上的問題更加了解，同時也找到了一個不僅可以紀錄錯誤還能通知我錯誤訊息的地方，可以在第一時間直接進去分析 log，若完成了可以直接在 slack 上按<code>Reslove</code>來完成這個 issue。</p>\n<p>本來有在考慮要串接<code>LINE Notify</code>，不過看著 Sentry 對 Slack 的整合比較好，也就放棄了這個念頭了🤣，但串接哪個平台其實就看公司的需求，Sentry 一樣可以透過 webhook 將錯誤訊息傳至 Server。</p>\n<p>此外它一樣可以整合<code>Github</code>、<code>GitLab</code>、<code>Azure DevOps</code>…等等，若錯誤處理好的話可以讓 Sentry 幫你送 Issue 上去，不僅整個超炫砲😎，若是 open source 的專案也可以大家一起去修這個問題，真的是一舉兩得啊！！！</p>\n"},{"title":"Serverless cold start 問題","abbrlink":3995325371,"date":"2020-02-15T17:30:03.000Z","_content":"\n![workload](https://i.imgur.com/gjLODpG.jpg)\n\n# 前言\n\n之前鐵人賽寫了一篇文章有提到 [Cold Start 的問題](https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/)，不過只有粗略介紹，最近看到大家忽然又開始討論這個話題，這次就來好好的搜尋資料介紹一下。\n\n平常在做 open source 時比較常遇到休眠狀態應該就是 `Heroku`，而開頭要先澄清一下他是屬於 `PaaS` 的架構，而 AWS、Google、Azure 裡提供的 `Lambda`、`Cloud Run`、`Azure Function` 這些則屬於 FaaS 架構，而最常討論 `Cold start` 時最常會在 FaaS 上討論，只是剛好 Heroku 使用起來也是一樣，這次文章就把他一起抓進來討論啦～\n\n> 有很多各式各樣的服務，SaaS、FaaS、KaaS、IaaS... 等各式各樣的架構，每個都是為了解決某個問題所誕生的，至於好或不好其實就是看使用場景而定，所以大家在選用時要注意一下你使用的場景哦！\n\n# 為什麼會休眠\n\n一般會有休眠機制是因為這些供應商在提供服務都是提供按次計費的方案，讓開發者在用時可以需要才喚醒使用，也就是說這些服務都是 `事件驅動`(`Event-Driven`)導向，意指是當前服務若收到訊息後，會呼叫對應的 Function 來處理對應服務所接收到的資料(Queue、Notify ...)，但相對的就是會有`休眠`讓服務暫停，進而讓較少使用的服務不會因為掛在線上而一直被收費用，而重新啟動這件事就是本篇要提的`Cold start`。\n\n# Cold start 流程\n\n在處理資料之後過一段時間若沒有繼續執行，雲端供應商會將模組暫停，此時 function 會處於 inactive 狀態(cold)，而當 function 再度被觸發時(`cold start`)則會再啟動模組來執行對應 function 來處理事件，在模組與 function 之間的關係可以稱他們為 `Function chain`。\n\n### 休眠狀態喚醒流程\n\n![[參考](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)](https://i.imgur.com/DQoGYns.png)\n\n以 AWS 為例，在喚醒時會到 S3 去取得檔案，接著找到相關的 Lambda 並載入相關模組套件，然後再執行觸發的事件，整理過後的下:\n\n> 事件處理 ➡️ 過段時間 ➡️ 暫停 function 模組(休眠) ➡️ 觸發 ➡️ 啟動 function 模組 ➡️ 事件處理...\n\n這整個流程就是俗稱的 `cold start`，因為在這個過程中會花些時間，所以若是拿來處理 api 相關問題的話就會有第一批請求很久，然後之後的請求卻特別快的狀態，請大家莫急莫慌莫害怕呀！\n\n# 平台比較表\n\n| 平台                   | 多少時間後暫停                                                                                 |\n| ---------------------- | ---------------------------------------------------------------------------------------------- |\n| AWS Lambda             | 10 minutes                                                                                     |\n| Google Cloud Functions | [介於 3 minutes 之間 5+ hours 都有](https://mikhail.io/2018/08/serverless-cold-start-war/#gcp) |\n| Azure Functions        | [20 minutes](https://mikhail.io/2018/08/serverless-cold-start-war/#azure)                      |\n| Heroku                 | [30 minutes](<(https://devcenter.heroku.com/articles/free-dyno-hours#dyno-sleeping)>)          |\n\n> 前三個為 `FaaS` 架構，而 Heroku 則為 `PaaS` 架構喔！\n\n下圖則來自 2019/09 的[一篇文章](https://mikhail.io/serverless/coldstarts/big3/)，較深色的部分則為啟動時間。\n![FaaS platform cold start time](https://i.imgur.com/yZxWvlL.png)\n\n# 如何處理或是盡可能避免？\n\n以我熟悉使用 [serverless framework](https://serverless.com/) 部署到 AWS 來說，他們提供了一個 [warm-up](https://serverless.com/plugins/serverless-plugin-warmup/) 的套件，可以設定排程時間讓這個 function 固定去戳其他 function，避免他們進入休眠的狀態，雖然這樣子就能達到跟一般服務一樣的常駐狀態，不過相對來說就要注意次數的使用問題，若是流量還小的話沒什麼問題，但若有一定的流量就須注意一下帳單，因為這些在互戳的過程中還是有算進費用的喔！使用上還要多注意才行。\n\n另一方面要注意相依套件的問題，引用 google [文件的其中一段](https://cloud.google.com/run/docs/tips#optimizing_performance):\n\n謹慎使用依附元件，如果您使用動態語言搭配相依的程式庫，例如匯入使用 Node.js 的模型，這些模組的載入時間會增加冷啟動期間的延遲時間。您可以透過以下方式縮短啟動延遲時間：\n\n- 儘可能減少相依元件的數量和大小以建置精簡的服務。\n- 只有在必要時才載入不常用的程式碼 (如果您使用的語言支援)。\n- 使用程式碼載入的最佳化，例如 PHP 的 composer 自動載入器最佳化。\n\n> 畢竟在載入模組的時候相依套件也是要一起抓進來，若是程式本身太多依賴的話也是會導致 cold start 的時間變長哦！\n\n最後就在幫大家整理一下三大平台的 warm-up 資源：\n\n- [warm-up](https://serverless.com/plugins/serverless-plugin-warmup/)\n- [Google App Engine warm up](https://cloud.google.com/appengine/docs/standard/python/configuring-warmup-requests)\n- [Google Schedule](https://www.serverlessnotes.com/docs/scheduling-with-azure-functions)\n- [Scheduling with Azure Functions](https://www.serverlessnotes.com/docs/scheduling-with-azure-functions)\n\n# 結論\n\n為什麼要有 cold start 的機制，以供應商的角度來說他們可以提供一定的量讓使用者免費在平台上先建置服務，但若要免費就是服務會被暫時暫停，畢竟現在流量就是錢嗎 💰，像我常用的 Heroku 就會是這樣，而當你流量大的時候就看你要不要搬家，不過一般應該都懶得搬，就會形成所謂的`養、套、殺`🤣(離題)。\n\n總而言之，若是需要服務時常活著，就是需要付出點流量的錢 💰，也或許你的作品服務時間可能不用那麼長，只要在服勤時間內長駐活著就可以在省下一些費用，如果有需要的話還是付一些錢給供應商，畢竟人家也幫你保管了服務你說是不是？\n\n# 參考\n\n- [On the Serverless cold start problem](https://medium.com/faun/on-the-serverless-cold-start-problem-2fc0797da5cc)\n- [Lambda Warm-up](https://serverless.com/blog/keep-your-lambdas-warm/#installing-the-warmup-plugin)\n- [Heroku cold start](https://devcenter.heroku.com/articles/free-dyno-hours)\n- [serverless 啟動流程](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)\n- [Function Chain 來源](https://www.nuweba.com/blog/when-are-cold-starts-problem)\n- [cloud run cold start](https://github.com/ahmetb/cloud-run-faq#cold-starts)\n","source":"_posts/serverless-cold-start.md","raw":"---\ntitle: Serverless cold start 問題\ncategories: 學習紀錄\ntags:\n  - AWS\n  - GCP\n  - Azure\n  - Heroku\n  - cold start\nabbrlink: 3995325371\ndate: 2020-02-16 01:30:03\n---\n\n![workload](https://i.imgur.com/gjLODpG.jpg)\n\n# 前言\n\n之前鐵人賽寫了一篇文章有提到 [Cold Start 的問題](https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/)，不過只有粗略介紹，最近看到大家忽然又開始討論這個話題，這次就來好好的搜尋資料介紹一下。\n\n平常在做 open source 時比較常遇到休眠狀態應該就是 `Heroku`，而開頭要先澄清一下他是屬於 `PaaS` 的架構，而 AWS、Google、Azure 裡提供的 `Lambda`、`Cloud Run`、`Azure Function` 這些則屬於 FaaS 架構，而最常討論 `Cold start` 時最常會在 FaaS 上討論，只是剛好 Heroku 使用起來也是一樣，這次文章就把他一起抓進來討論啦～\n\n> 有很多各式各樣的服務，SaaS、FaaS、KaaS、IaaS... 等各式各樣的架構，每個都是為了解決某個問題所誕生的，至於好或不好其實就是看使用場景而定，所以大家在選用時要注意一下你使用的場景哦！\n\n# 為什麼會休眠\n\n一般會有休眠機制是因為這些供應商在提供服務都是提供按次計費的方案，讓開發者在用時可以需要才喚醒使用，也就是說這些服務都是 `事件驅動`(`Event-Driven`)導向，意指是當前服務若收到訊息後，會呼叫對應的 Function 來處理對應服務所接收到的資料(Queue、Notify ...)，但相對的就是會有`休眠`讓服務暫停，進而讓較少使用的服務不會因為掛在線上而一直被收費用，而重新啟動這件事就是本篇要提的`Cold start`。\n\n# Cold start 流程\n\n在處理資料之後過一段時間若沒有繼續執行，雲端供應商會將模組暫停，此時 function 會處於 inactive 狀態(cold)，而當 function 再度被觸發時(`cold start`)則會再啟動模組來執行對應 function 來處理事件，在模組與 function 之間的關係可以稱他們為 `Function chain`。\n\n### 休眠狀態喚醒流程\n\n![[參考](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)](https://i.imgur.com/DQoGYns.png)\n\n以 AWS 為例，在喚醒時會到 S3 去取得檔案，接著找到相關的 Lambda 並載入相關模組套件，然後再執行觸發的事件，整理過後的下:\n\n> 事件處理 ➡️ 過段時間 ➡️ 暫停 function 模組(休眠) ➡️ 觸發 ➡️ 啟動 function 模組 ➡️ 事件處理...\n\n這整個流程就是俗稱的 `cold start`，因為在這個過程中會花些時間，所以若是拿來處理 api 相關問題的話就會有第一批請求很久，然後之後的請求卻特別快的狀態，請大家莫急莫慌莫害怕呀！\n\n# 平台比較表\n\n| 平台                   | 多少時間後暫停                                                                                 |\n| ---------------------- | ---------------------------------------------------------------------------------------------- |\n| AWS Lambda             | 10 minutes                                                                                     |\n| Google Cloud Functions | [介於 3 minutes 之間 5+ hours 都有](https://mikhail.io/2018/08/serverless-cold-start-war/#gcp) |\n| Azure Functions        | [20 minutes](https://mikhail.io/2018/08/serverless-cold-start-war/#azure)                      |\n| Heroku                 | [30 minutes](<(https://devcenter.heroku.com/articles/free-dyno-hours#dyno-sleeping)>)          |\n\n> 前三個為 `FaaS` 架構，而 Heroku 則為 `PaaS` 架構喔！\n\n下圖則來自 2019/09 的[一篇文章](https://mikhail.io/serverless/coldstarts/big3/)，較深色的部分則為啟動時間。\n![FaaS platform cold start time](https://i.imgur.com/yZxWvlL.png)\n\n# 如何處理或是盡可能避免？\n\n以我熟悉使用 [serverless framework](https://serverless.com/) 部署到 AWS 來說，他們提供了一個 [warm-up](https://serverless.com/plugins/serverless-plugin-warmup/) 的套件，可以設定排程時間讓這個 function 固定去戳其他 function，避免他們進入休眠的狀態，雖然這樣子就能達到跟一般服務一樣的常駐狀態，不過相對來說就要注意次數的使用問題，若是流量還小的話沒什麼問題，但若有一定的流量就須注意一下帳單，因為這些在互戳的過程中還是有算進費用的喔！使用上還要多注意才行。\n\n另一方面要注意相依套件的問題，引用 google [文件的其中一段](https://cloud.google.com/run/docs/tips#optimizing_performance):\n\n謹慎使用依附元件，如果您使用動態語言搭配相依的程式庫，例如匯入使用 Node.js 的模型，這些模組的載入時間會增加冷啟動期間的延遲時間。您可以透過以下方式縮短啟動延遲時間：\n\n- 儘可能減少相依元件的數量和大小以建置精簡的服務。\n- 只有在必要時才載入不常用的程式碼 (如果您使用的語言支援)。\n- 使用程式碼載入的最佳化，例如 PHP 的 composer 自動載入器最佳化。\n\n> 畢竟在載入模組的時候相依套件也是要一起抓進來，若是程式本身太多依賴的話也是會導致 cold start 的時間變長哦！\n\n最後就在幫大家整理一下三大平台的 warm-up 資源：\n\n- [warm-up](https://serverless.com/plugins/serverless-plugin-warmup/)\n- [Google App Engine warm up](https://cloud.google.com/appengine/docs/standard/python/configuring-warmup-requests)\n- [Google Schedule](https://www.serverlessnotes.com/docs/scheduling-with-azure-functions)\n- [Scheduling with Azure Functions](https://www.serverlessnotes.com/docs/scheduling-with-azure-functions)\n\n# 結論\n\n為什麼要有 cold start 的機制，以供應商的角度來說他們可以提供一定的量讓使用者免費在平台上先建置服務，但若要免費就是服務會被暫時暫停，畢竟現在流量就是錢嗎 💰，像我常用的 Heroku 就會是這樣，而當你流量大的時候就看你要不要搬家，不過一般應該都懶得搬，就會形成所謂的`養、套、殺`🤣(離題)。\n\n總而言之，若是需要服務時常活著，就是需要付出點流量的錢 💰，也或許你的作品服務時間可能不用那麼長，只要在服勤時間內長駐活著就可以在省下一些費用，如果有需要的話還是付一些錢給供應商，畢竟人家也幫你保管了服務你說是不是？\n\n# 參考\n\n- [On the Serverless cold start problem](https://medium.com/faun/on-the-serverless-cold-start-problem-2fc0797da5cc)\n- [Lambda Warm-up](https://serverless.com/blog/keep-your-lambdas-warm/#installing-the-warmup-plugin)\n- [Heroku cold start](https://devcenter.heroku.com/articles/free-dyno-hours)\n- [serverless 啟動流程](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)\n- [Function Chain 來源](https://www.nuweba.com/blog/when-are-cold-starts-problem)\n- [cloud run cold start](https://github.com/ahmetb/cloud-run-faq#cold-starts)\n","slug":"serverless-cold-start","published":1,"updated":"2020-06-19T14:03:58.865Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31l7004y7cri7ypfw8kr","content":"<p><img src=\"https://i.imgur.com/gjLODpG.jpg\" alt=\"workload\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>之前鐵人賽寫了一篇文章有提到 <a href=\"https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/\">Cold Start 的問題</a>，不過只有粗略介紹，最近看到大家忽然又開始討論這個話題，這次就來好好的搜尋資料介紹一下。</p>\n<p>平常在做 open source 時比較常遇到休眠狀態應該就是 <code>Heroku</code>，而開頭要先澄清一下他是屬於 <code>PaaS</code> 的架構，而 AWS、Google、Azure 裡提供的 <code>Lambda</code>、<code>Cloud Run</code>、<code>Azure Function</code> 這些則屬於 FaaS 架構，而最常討論 <code>Cold start</code> 時最常會在 FaaS 上討論，只是剛好 Heroku 使用起來也是一樣，這次文章就把他一起抓進來討論啦～</p>\n<blockquote>\n<p>有很多各式各樣的服務，SaaS、FaaS、KaaS、IaaS… 等各式各樣的架構，每個都是為了解決某個問題所誕生的，至於好或不好其實就是看使用場景而定，所以大家在選用時要注意一下你使用的場景哦！</p>\n</blockquote>\n<h1 id=\"為什麼會休眠\"><a href=\"#為什麼會休眠\" class=\"headerlink\" title=\"為什麼會休眠\"></a>為什麼會休眠</h1><p>一般會有休眠機制是因為這些供應商在提供服務都是提供按次計費的方案，讓開發者在用時可以需要才喚醒使用，也就是說這些服務都是 <code>事件驅動</code>(<code>Event-Driven</code>)導向，意指是當前服務若收到訊息後，會呼叫對應的 Function 來處理對應服務所接收到的資料(Queue、Notify …)，但相對的就是會有<code>休眠</code>讓服務暫停，進而讓較少使用的服務不會因為掛在線上而一直被收費用，而重新啟動這件事就是本篇要提的<code>Cold start</code>。</p>\n<h1 id=\"Cold-start-流程\"><a href=\"#Cold-start-流程\" class=\"headerlink\" title=\"Cold start 流程\"></a>Cold start 流程</h1><p>在處理資料之後過一段時間若沒有繼續執行，雲端供應商會將模組暫停，此時 function 會處於 inactive 狀態(cold)，而當 function 再度被觸發時(<code>cold start</code>)則會再啟動模組來執行對應 function 來處理事件，在模組與 function 之間的關係可以稱他們為 <code>Function chain</code>。</p>\n<h3 id=\"休眠狀態喚醒流程\"><a href=\"#休眠狀態喚醒流程\" class=\"headerlink\" title=\"休眠狀態喚醒流程\"></a>休眠狀態喚醒流程</h3><p><img src=\"https://i.imgur.com/DQoGYns.png\" alt=\"[參考](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)\"></p>\n<p>以 AWS 為例，在喚醒時會到 S3 去取得檔案，接著找到相關的 Lambda 並載入相關模組套件，然後再執行觸發的事件，整理過後的下:</p>\n<blockquote>\n<p>事件處理 ➡️ 過段時間 ➡️ 暫停 function 模組(休眠) ➡️ 觸發 ➡️ 啟動 function 模組 ➡️ 事件處理…</p>\n</blockquote>\n<p>這整個流程就是俗稱的 <code>cold start</code>，因為在這個過程中會花些時間，所以若是拿來處理 api 相關問題的話就會有第一批請求很久，然後之後的請求卻特別快的狀態，請大家莫急莫慌莫害怕呀！</p>\n<h1 id=\"平台比較表\"><a href=\"#平台比較表\" class=\"headerlink\" title=\"平台比較表\"></a>平台比較表</h1><table>\n<thead>\n<tr>\n<th>平台</th>\n<th>多少時間後暫停</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AWS Lambda</td>\n<td>10 minutes</td>\n</tr>\n<tr>\n<td>Google Cloud Functions</td>\n<td><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#gcp\" target=\"_blank\" rel=\"noopener\">介於 3 minutes 之間 5+ hours 都有</a></td>\n</tr>\n<tr>\n<td>Azure Functions</td>\n<td><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#azure\" target=\"_blank\" rel=\"noopener\">20 minutes</a></td>\n</tr>\n<tr>\n<td>Heroku</td>\n<td><a href=\"(https://devcenter.heroku.com/articles/free-dyno-hours#dyno-sleeping)\">30 minutes</a></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>前三個為 <code>FaaS</code> 架構，而 Heroku 則為 <code>PaaS</code> 架構喔！</p>\n</blockquote>\n<p>下圖則來自 2019/09 的<a href=\"https://mikhail.io/serverless/coldstarts/big3/\" target=\"_blank\" rel=\"noopener\">一篇文章</a>，較深色的部分則為啟動時間。<br><img src=\"https://i.imgur.com/yZxWvlL.png\" alt=\"FaaS platform cold start time\"></p>\n<h1 id=\"如何處理或是盡可能避免？\"><a href=\"#如何處理或是盡可能避免？\" class=\"headerlink\" title=\"如何處理或是盡可能避免？\"></a>如何處理或是盡可能避免？</h1><p>以我熟悉使用 <a href=\"https://serverless.com/\" target=\"_blank\" rel=\"noopener\">serverless framework</a> 部署到 AWS 來說，他們提供了一個 <a href=\"https://serverless.com/plugins/serverless-plugin-warmup/\" target=\"_blank\" rel=\"noopener\">warm-up</a> 的套件，可以設定排程時間讓這個 function 固定去戳其他 function，避免他們進入休眠的狀態，雖然這樣子就能達到跟一般服務一樣的常駐狀態，不過相對來說就要注意次數的使用問題，若是流量還小的話沒什麼問題，但若有一定的流量就須注意一下帳單，因為這些在互戳的過程中還是有算進費用的喔！使用上還要多注意才行。</p>\n<p>另一方面要注意相依套件的問題，引用 google <a href=\"https://cloud.google.com/run/docs/tips#optimizing_performance\" target=\"_blank\" rel=\"noopener\">文件的其中一段</a>:</p>\n<p>謹慎使用依附元件，如果您使用動態語言搭配相依的程式庫，例如匯入使用 Node.js 的模型，這些模組的載入時間會增加冷啟動期間的延遲時間。您可以透過以下方式縮短啟動延遲時間：</p>\n<ul>\n<li>儘可能減少相依元件的數量和大小以建置精簡的服務。</li>\n<li>只有在必要時才載入不常用的程式碼 (如果您使用的語言支援)。</li>\n<li>使用程式碼載入的最佳化，例如 PHP 的 composer 自動載入器最佳化。</li>\n</ul>\n<blockquote>\n<p>畢竟在載入模組的時候相依套件也是要一起抓進來，若是程式本身太多依賴的話也是會導致 cold start 的時間變長哦！</p>\n</blockquote>\n<p>最後就在幫大家整理一下三大平台的 warm-up 資源：</p>\n<ul>\n<li><a href=\"https://serverless.com/plugins/serverless-plugin-warmup/\" target=\"_blank\" rel=\"noopener\">warm-up</a></li>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/python/configuring-warmup-requests\" target=\"_blank\" rel=\"noopener\">Google App Engine warm up</a></li>\n<li><a href=\"https://www.serverlessnotes.com/docs/scheduling-with-azure-functions\" target=\"_blank\" rel=\"noopener\">Google Schedule</a></li>\n<li><a href=\"https://www.serverlessnotes.com/docs/scheduling-with-azure-functions\" target=\"_blank\" rel=\"noopener\">Scheduling with Azure Functions</a></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為什麼要有 cold start 的機制，以供應商的角度來說他們可以提供一定的量讓使用者免費在平台上先建置服務，但若要免費就是服務會被暫時暫停，畢竟現在流量就是錢嗎 💰，像我常用的 Heroku 就會是這樣，而當你流量大的時候就看你要不要搬家，不過一般應該都懶得搬，就會形成所謂的<code>養、套、殺</code>🤣(離題)。</p>\n<p>總而言之，若是需要服務時常活著，就是需要付出點流量的錢 💰，也或許你的作品服務時間可能不用那麼長，只要在服勤時間內長駐活著就可以在省下一些費用，如果有需要的話還是付一些錢給供應商，畢竟人家也幫你保管了服務你說是不是？</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://medium.com/faun/on-the-serverless-cold-start-problem-2fc0797da5cc\" target=\"_blank\" rel=\"noopener\">On the Serverless cold start problem</a></li>\n<li><a href=\"https://serverless.com/blog/keep-your-lambdas-warm/#installing-the-warmup-plugin\" target=\"_blank\" rel=\"noopener\">Lambda Warm-up</a></li>\n<li><a href=\"https://devcenter.heroku.com/articles/free-dyno-hours\" target=\"_blank\" rel=\"noopener\">Heroku cold start</a></li>\n<li><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-\" target=\"_blank\" rel=\"noopener\">serverless 啟動流程</a></li>\n<li><a href=\"https://www.nuweba.com/blog/when-are-cold-starts-problem\" target=\"_blank\" rel=\"noopener\">Function Chain 來源</a></li>\n<li><a href=\"https://github.com/ahmetb/cloud-run-faq#cold-starts\" target=\"_blank\" rel=\"noopener\">cloud run cold start</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://i.imgur.com/gjLODpG.jpg\" alt=\"workload\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>之前鐵人賽寫了一篇文章有提到 <a href=\"https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/\">Cold Start 的問題</a>，不過只有粗略介紹，最近看到大家忽然又開始討論這個話題，這次就來好好的搜尋資料介紹一下。</p>\n<p>平常在做 open source 時比較常遇到休眠狀態應該就是 <code>Heroku</code>，而開頭要先澄清一下他是屬於 <code>PaaS</code> 的架構，而 AWS、Google、Azure 裡提供的 <code>Lambda</code>、<code>Cloud Run</code>、<code>Azure Function</code> 這些則屬於 FaaS 架構，而最常討論 <code>Cold start</code> 時最常會在 FaaS 上討論，只是剛好 Heroku 使用起來也是一樣，這次文章就把他一起抓進來討論啦～</p>\n<blockquote>\n<p>有很多各式各樣的服務，SaaS、FaaS、KaaS、IaaS… 等各式各樣的架構，每個都是為了解決某個問題所誕生的，至於好或不好其實就是看使用場景而定，所以大家在選用時要注意一下你使用的場景哦！</p>\n</blockquote>\n<h1 id=\"為什麼會休眠\"><a href=\"#為什麼會休眠\" class=\"headerlink\" title=\"為什麼會休眠\"></a>為什麼會休眠</h1><p>一般會有休眠機制是因為這些供應商在提供服務都是提供按次計費的方案，讓開發者在用時可以需要才喚醒使用，也就是說這些服務都是 <code>事件驅動</code>(<code>Event-Driven</code>)導向，意指是當前服務若收到訊息後，會呼叫對應的 Function 來處理對應服務所接收到的資料(Queue、Notify …)，但相對的就是會有<code>休眠</code>讓服務暫停，進而讓較少使用的服務不會因為掛在線上而一直被收費用，而重新啟動這件事就是本篇要提的<code>Cold start</code>。</p>\n<h1 id=\"Cold-start-流程\"><a href=\"#Cold-start-流程\" class=\"headerlink\" title=\"Cold start 流程\"></a>Cold start 流程</h1><p>在處理資料之後過一段時間若沒有繼續執行，雲端供應商會將模組暫停，此時 function 會處於 inactive 狀態(cold)，而當 function 再度被觸發時(<code>cold start</code>)則會再啟動模組來執行對應 function 來處理事件，在模組與 function 之間的關係可以稱他們為 <code>Function chain</code>。</p>\n<h3 id=\"休眠狀態喚醒流程\"><a href=\"#休眠狀態喚醒流程\" class=\"headerlink\" title=\"休眠狀態喚醒流程\"></a>休眠狀態喚醒流程</h3><p><img src=\"https://i.imgur.com/DQoGYns.png\" alt=\"[參考](https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-)\"></p>\n<p>以 AWS 為例，在喚醒時會到 S3 去取得檔案，接著找到相關的 Lambda 並載入相關模組套件，然後再執行觸發的事件，整理過後的下:</p>\n<blockquote>\n<p>事件處理 ➡️ 過段時間 ➡️ 暫停 function 模組(休眠) ➡️ 觸發 ➡️ 啟動 function 模組 ➡️ 事件處理…</p>\n</blockquote>\n<p>這整個流程就是俗稱的 <code>cold start</code>，因為在這個過程中會花些時間，所以若是拿來處理 api 相關問題的話就會有第一批請求很久，然後之後的請求卻特別快的狀態，請大家莫急莫慌莫害怕呀！</p>\n<h1 id=\"平台比較表\"><a href=\"#平台比較表\" class=\"headerlink\" title=\"平台比較表\"></a>平台比較表</h1><table>\n<thead>\n<tr>\n<th>平台</th>\n<th>多少時間後暫停</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AWS Lambda</td>\n<td>10 minutes</td>\n</tr>\n<tr>\n<td>Google Cloud Functions</td>\n<td><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#gcp\" target=\"_blank\" rel=\"noopener\">介於 3 minutes 之間 5+ hours 都有</a></td>\n</tr>\n<tr>\n<td>Azure Functions</td>\n<td><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#azure\" target=\"_blank\" rel=\"noopener\">20 minutes</a></td>\n</tr>\n<tr>\n<td>Heroku</td>\n<td><a href=\"(https://devcenter.heroku.com/articles/free-dyno-hours#dyno-sleeping)\">30 minutes</a></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>前三個為 <code>FaaS</code> 架構，而 Heroku 則為 <code>PaaS</code> 架構喔！</p>\n</blockquote>\n<p>下圖則來自 2019/09 的<a href=\"https://mikhail.io/serverless/coldstarts/big3/\" target=\"_blank\" rel=\"noopener\">一篇文章</a>，較深色的部分則為啟動時間。<br><img src=\"https://i.imgur.com/yZxWvlL.png\" alt=\"FaaS platform cold start time\"></p>\n<h1 id=\"如何處理或是盡可能避免？\"><a href=\"#如何處理或是盡可能避免？\" class=\"headerlink\" title=\"如何處理或是盡可能避免？\"></a>如何處理或是盡可能避免？</h1><p>以我熟悉使用 <a href=\"https://serverless.com/\" target=\"_blank\" rel=\"noopener\">serverless framework</a> 部署到 AWS 來說，他們提供了一個 <a href=\"https://serverless.com/plugins/serverless-plugin-warmup/\" target=\"_blank\" rel=\"noopener\">warm-up</a> 的套件，可以設定排程時間讓這個 function 固定去戳其他 function，避免他們進入休眠的狀態，雖然這樣子就能達到跟一般服務一樣的常駐狀態，不過相對來說就要注意次數的使用問題，若是流量還小的話沒什麼問題，但若有一定的流量就須注意一下帳單，因為這些在互戳的過程中還是有算進費用的喔！使用上還要多注意才行。</p>\n<p>另一方面要注意相依套件的問題，引用 google <a href=\"https://cloud.google.com/run/docs/tips#optimizing_performance\" target=\"_blank\" rel=\"noopener\">文件的其中一段</a>:</p>\n<p>謹慎使用依附元件，如果您使用動態語言搭配相依的程式庫，例如匯入使用 Node.js 的模型，這些模組的載入時間會增加冷啟動期間的延遲時間。您可以透過以下方式縮短啟動延遲時間：</p>\n<ul>\n<li>儘可能減少相依元件的數量和大小以建置精簡的服務。</li>\n<li>只有在必要時才載入不常用的程式碼 (如果您使用的語言支援)。</li>\n<li>使用程式碼載入的最佳化，例如 PHP 的 composer 自動載入器最佳化。</li>\n</ul>\n<blockquote>\n<p>畢竟在載入模組的時候相依套件也是要一起抓進來，若是程式本身太多依賴的話也是會導致 cold start 的時間變長哦！</p>\n</blockquote>\n<p>最後就在幫大家整理一下三大平台的 warm-up 資源：</p>\n<ul>\n<li><a href=\"https://serverless.com/plugins/serverless-plugin-warmup/\" target=\"_blank\" rel=\"noopener\">warm-up</a></li>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/python/configuring-warmup-requests\" target=\"_blank\" rel=\"noopener\">Google App Engine warm up</a></li>\n<li><a href=\"https://www.serverlessnotes.com/docs/scheduling-with-azure-functions\" target=\"_blank\" rel=\"noopener\">Google Schedule</a></li>\n<li><a href=\"https://www.serverlessnotes.com/docs/scheduling-with-azure-functions\" target=\"_blank\" rel=\"noopener\">Scheduling with Azure Functions</a></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>為什麼要有 cold start 的機制，以供應商的角度來說他們可以提供一定的量讓使用者免費在平台上先建置服務，但若要免費就是服務會被暫時暫停，畢竟現在流量就是錢嗎 💰，像我常用的 Heroku 就會是這樣，而當你流量大的時候就看你要不要搬家，不過一般應該都懶得搬，就會形成所謂的<code>養、套、殺</code>🤣(離題)。</p>\n<p>總而言之，若是需要服務時常活著，就是需要付出點流量的錢 💰，也或許你的作品服務時間可能不用那麼長，只要在服勤時間內長駐活著就可以在省下一些費用，如果有需要的話還是付一些錢給供應商，畢竟人家也幫你保管了服務你說是不是？</p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://medium.com/faun/on-the-serverless-cold-start-problem-2fc0797da5cc\" target=\"_blank\" rel=\"noopener\">On the Serverless cold start problem</a></li>\n<li><a href=\"https://serverless.com/blog/keep-your-lambdas-warm/#installing-the-warmup-plugin\" target=\"_blank\" rel=\"noopener\">Lambda Warm-up</a></li>\n<li><a href=\"https://devcenter.heroku.com/articles/free-dyno-hours\" target=\"_blank\" rel=\"noopener\">Heroku cold start</a></li>\n<li><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/#how-do-languages-compare-\" target=\"_blank\" rel=\"noopener\">serverless 啟動流程</a></li>\n<li><a href=\"https://www.nuweba.com/blog/when-are-cold-starts-problem\" target=\"_blank\" rel=\"noopener\">Function Chain 來源</a></li>\n<li><a href=\"https://github.com/ahmetb/cloud-run-faq#cold-starts\" target=\"_blank\" rel=\"noopener\">cloud run cold start</a></li>\n</ul>\n"},{"title":"Welcome to LINE API Expert and first thing — LINE Developer Day","abbrlink":1142565030,"date":"2019-10-10T09:26:16.000Z","_content":"\n# 前言\n\n人品爆發的下半年有幸被選為 LINE API Expert，謝謝過程中給我指點、意見還有每位來參加每個 chatbot TW 活動的朋友，你們支持讓我可以更努力去辦各種活動，社團裡歡迎大家踴躍提點子討論，抑或是來參加小聚跟大家互相交流，台北台中都有小聚哦！若有不清楚的地方歡迎詢問😃\nChatbot Developers Taiwan：https://www.facebook.com/groups/chatbot.tw\n\n# 迎新\n\n在 welcome party 中身為 Rookie of LINE API Expert 一定是要被每一位大神輪流 “熱情關照” 一波🤣，想想之前在開發時還在看卡米狗 卡卡米 的 IT 30 鐵人賽、寫 golang 看著 Evan Lin 的部落格、看保哥 Will Huang 在議程中各種秀高速開發技能 … 等等的，沒有到偶像們就直接坐在旁邊，看著看著我就快不行了😝。跟大神們聊完覺得自己做的事還只是冰山一角，看著大家都那麼有影響力下還是這麼努力向前進，做為菜鳥的我當然不能就這樣滿足！繼續抱著大神們的腿前進。(喂！放開自己走啊！)\n![](https://i.imgur.com/bkefPAh.jpg)\n\n# 成為 LAE 後的第一場開發者日\n\n緊接著第一場大型活動就是參加 LINE 的年度大會 — LINE Developer Day，過往都只能看著前輩們分享文章在電腦前面乾過癮，看著大家可以在國際間跟各路的開發者交流，這一直是我很羨慕的事情之一。但是！現在終於有機會以 LAE 的身分出發啦(媽我在這)！聽說去年有 60 場各種主題的座談會，而今年 LINE 主要會以推廣 人工智慧 為主軸，並且搭配其他在 LINE 中重要的技術形成了這次的 developer day，也開始漸漸露出在新聞版面了，看起來想拓展的企圖心也越來越強了🚀\n以下是其他 LAE 以及社群創始人 Clement Tang 在 2018 年參加 LINE Dev Day 的文章分享\n- [2018 年度大戲 LINE API expert 之旅](https://medium.com/@wolkesau/2018-%E5%B9%B4%E5%BA%A6%E5%A4%A7%E6%88%B2-line-api-expert-%E4%B9%8B%E6%97%85-4a12a79a0c04)\n- [從 LINE Developer Day Keynote 一窺 LINE生態系的願景 — AI 篇](https://medium.com/@dlackty/%E5%BE%9E-line-developer-day-keynote-%E4%B8%80%E7%AA%BA-line%E7%94%9F%E6%85%8B%E7%B3%BB%E7%9A%84%E9%A1%98%E6%99%AF-ai-%E7%AF%87-f5be69e9c682)\n- [LINE Developer Day 2018 東京豐盛技術之旅(下)](http://studyhost.blogspot.com/2018/11/line-developer-day-2018_24.html?source=post_page-----6c69fdfc991d----------------------)\n- [LINE Developer Day 2018 - 活動見聞與 Keynote 紀錄](https://medium.com/@clementtang/line-developer-day-2018-%E6%B4%BB%E5%8B%95%E8%A6%8B%E8%81%9E%E8%88%87-keynote-%E7%B4%80%E9%8C%84-6469de55c3f8)\n\n2019 的 Dev Day 資訊出來囉，\n活動時間： 2019/11/20、21, 10:00~21:00 (日本時間)\n活動地點：東京台場日航大酒店Grand Nikko Tokyo Daiba （2–6–1 Daiba, Minato-ku, Tokyo）\n活動入場費用：免費\n參加方式：繳交報名表、預先報名\n> 活動則環繞在開發工程(Engineering)以及產品開發(Production)上\n\n[「LINE DEVELOPER DAY」開發者大會將於11/20、21東京登場 | T客邦](https://www.techbang.com/posts/73284-lines-first-expansion-will-be-held-on-november-20th-and-21st-for-two-day-line-developer-day-2019?source=post_page-----6c69fdfc991d----------------------)\n\n> 屆時我會分享文章出來，還請各位多多關注😀\n\n# 結論\n說了這麼多，還不去申請一波 LINE API Expert？讓自己的努力有個機會被 LINE 看見：\n[LINE developers community | Expert Request](https://www.line-community.me/contributors/request?source=post_page-----6c69fdfc991d----------------------)\n或是你還不清楚要怎麼開始第一步，來小聚跟我們聊聊吧，社群的每位大大都很熱心跟各位分享，千萬別錯過這些機會哦！\n[Chatb13ts meetup 聊天機器人小聚 #13 @ 台北商業大學](https://chatbots.kktix.cc/events/chatb13ts?source=post_page-----6c69fdfc991d----------------------)\n▎活動型態 Chatbots meetup 社群台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot。\n\n","source":"_posts/welcome-line-api-expert.md","raw":"---\ntitle: Welcome to LINE API Expert and first thing — LINE Developer Day\ntags:\n  - LINE\ncategories: 日記\nabbrlink: 1142565030\ndate: 2019-10-10 17:26:16\n---\n\n# 前言\n\n人品爆發的下半年有幸被選為 LINE API Expert，謝謝過程中給我指點、意見還有每位來參加每個 chatbot TW 活動的朋友，你們支持讓我可以更努力去辦各種活動，社團裡歡迎大家踴躍提點子討論，抑或是來參加小聚跟大家互相交流，台北台中都有小聚哦！若有不清楚的地方歡迎詢問😃\nChatbot Developers Taiwan：https://www.facebook.com/groups/chatbot.tw\n\n# 迎新\n\n在 welcome party 中身為 Rookie of LINE API Expert 一定是要被每一位大神輪流 “熱情關照” 一波🤣，想想之前在開發時還在看卡米狗 卡卡米 的 IT 30 鐵人賽、寫 golang 看著 Evan Lin 的部落格、看保哥 Will Huang 在議程中各種秀高速開發技能 … 等等的，沒有到偶像們就直接坐在旁邊，看著看著我就快不行了😝。跟大神們聊完覺得自己做的事還只是冰山一角，看著大家都那麼有影響力下還是這麼努力向前進，做為菜鳥的我當然不能就這樣滿足！繼續抱著大神們的腿前進。(喂！放開自己走啊！)\n![](https://i.imgur.com/bkefPAh.jpg)\n\n# 成為 LAE 後的第一場開發者日\n\n緊接著第一場大型活動就是參加 LINE 的年度大會 — LINE Developer Day，過往都只能看著前輩們分享文章在電腦前面乾過癮，看著大家可以在國際間跟各路的開發者交流，這一直是我很羨慕的事情之一。但是！現在終於有機會以 LAE 的身分出發啦(媽我在這)！聽說去年有 60 場各種主題的座談會，而今年 LINE 主要會以推廣 人工智慧 為主軸，並且搭配其他在 LINE 中重要的技術形成了這次的 developer day，也開始漸漸露出在新聞版面了，看起來想拓展的企圖心也越來越強了🚀\n以下是其他 LAE 以及社群創始人 Clement Tang 在 2018 年參加 LINE Dev Day 的文章分享\n- [2018 年度大戲 LINE API expert 之旅](https://medium.com/@wolkesau/2018-%E5%B9%B4%E5%BA%A6%E5%A4%A7%E6%88%B2-line-api-expert-%E4%B9%8B%E6%97%85-4a12a79a0c04)\n- [從 LINE Developer Day Keynote 一窺 LINE生態系的願景 — AI 篇](https://medium.com/@dlackty/%E5%BE%9E-line-developer-day-keynote-%E4%B8%80%E7%AA%BA-line%E7%94%9F%E6%85%8B%E7%B3%BB%E7%9A%84%E9%A1%98%E6%99%AF-ai-%E7%AF%87-f5be69e9c682)\n- [LINE Developer Day 2018 東京豐盛技術之旅(下)](http://studyhost.blogspot.com/2018/11/line-developer-day-2018_24.html?source=post_page-----6c69fdfc991d----------------------)\n- [LINE Developer Day 2018 - 活動見聞與 Keynote 紀錄](https://medium.com/@clementtang/line-developer-day-2018-%E6%B4%BB%E5%8B%95%E8%A6%8B%E8%81%9E%E8%88%87-keynote-%E7%B4%80%E9%8C%84-6469de55c3f8)\n\n2019 的 Dev Day 資訊出來囉，\n活動時間： 2019/11/20、21, 10:00~21:00 (日本時間)\n活動地點：東京台場日航大酒店Grand Nikko Tokyo Daiba （2–6–1 Daiba, Minato-ku, Tokyo）\n活動入場費用：免費\n參加方式：繳交報名表、預先報名\n> 活動則環繞在開發工程(Engineering)以及產品開發(Production)上\n\n[「LINE DEVELOPER DAY」開發者大會將於11/20、21東京登場 | T客邦](https://www.techbang.com/posts/73284-lines-first-expansion-will-be-held-on-november-20th-and-21st-for-two-day-line-developer-day-2019?source=post_page-----6c69fdfc991d----------------------)\n\n> 屆時我會分享文章出來，還請各位多多關注😀\n\n# 結論\n說了這麼多，還不去申請一波 LINE API Expert？讓自己的努力有個機會被 LINE 看見：\n[LINE developers community | Expert Request](https://www.line-community.me/contributors/request?source=post_page-----6c69fdfc991d----------------------)\n或是你還不清楚要怎麼開始第一步，來小聚跟我們聊聊吧，社群的每位大大都很熱心跟各位分享，千萬別錯過這些機會哦！\n[Chatb13ts meetup 聊天機器人小聚 #13 @ 台北商業大學](https://chatbots.kktix.cc/events/chatb13ts?source=post_page-----6c69fdfc991d----------------------)\n▎活動型態 Chatbots meetup 社群台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot。\n\n","slug":"welcome-line-api-expert","published":1,"updated":"2020-06-19T14:03:58.867Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31la00527cri7n0ox0c4","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>人品爆發的下半年有幸被選為 LINE API Expert，謝謝過程中給我指點、意見還有每位來參加每個 chatbot TW 活動的朋友，你們支持讓我可以更努力去辦各種活動，社團裡歡迎大家踴躍提點子討論，抑或是來參加小聚跟大家互相交流，台北台中都有小聚哦！若有不清楚的地方歡迎詢問😃<br>Chatbot Developers Taiwan：<a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\">https://www.facebook.com/groups/chatbot.tw</a></p>\n<h1 id=\"迎新\"><a href=\"#迎新\" class=\"headerlink\" title=\"迎新\"></a>迎新</h1><p>在 welcome party 中身為 Rookie of LINE API Expert 一定是要被每一位大神輪流 “熱情關照” 一波🤣，想想之前在開發時還在看卡米狗 卡卡米 的 IT 30 鐵人賽、寫 golang 看著 Evan Lin 的部落格、看保哥 Will Huang 在議程中各種秀高速開發技能 … 等等的，沒有到偶像們就直接坐在旁邊，看著看著我就快不行了😝。跟大神們聊完覺得自己做的事還只是冰山一角，看著大家都那麼有影響力下還是這麼努力向前進，做為菜鳥的我當然不能就這樣滿足！繼續抱著大神們的腿前進。(喂！放開自己走啊！)<br><img src=\"https://i.imgur.com/bkefPAh.jpg\" alt></p>\n<h1 id=\"成為-LAE-後的第一場開發者日\"><a href=\"#成為-LAE-後的第一場開發者日\" class=\"headerlink\" title=\"成為 LAE 後的第一場開發者日\"></a>成為 LAE 後的第一場開發者日</h1><p>緊接著第一場大型活動就是參加 LINE 的年度大會 — LINE Developer Day，過往都只能看著前輩們分享文章在電腦前面乾過癮，看著大家可以在國際間跟各路的開發者交流，這一直是我很羨慕的事情之一。但是！現在終於有機會以 LAE 的身分出發啦(媽我在這)！聽說去年有 60 場各種主題的座談會，而今年 LINE 主要會以推廣 人工智慧 為主軸，並且搭配其他在 LINE 中重要的技術形成了這次的 developer day，也開始漸漸露出在新聞版面了，看起來想拓展的企圖心也越來越強了🚀<br>以下是其他 LAE 以及社群創始人 Clement Tang 在 2018 年參加 LINE Dev Day 的文章分享</p>\n<ul>\n<li><a href=\"https://medium.com/@wolkesau/2018-%E5%B9%B4%E5%BA%A6%E5%A4%A7%E6%88%B2-line-api-expert-%E4%B9%8B%E6%97%85-4a12a79a0c04\" target=\"_blank\" rel=\"noopener\">2018 年度大戲 LINE API expert 之旅</a></li>\n<li><a href=\"https://medium.com/@dlackty/%E5%BE%9E-line-developer-day-keynote-%E4%B8%80%E7%AA%BA-line%E7%94%9F%E6%85%8B%E7%B3%BB%E7%9A%84%E9%A1%98%E6%99%AF-ai-%E7%AF%87-f5be69e9c682\" target=\"_blank\" rel=\"noopener\">從 LINE Developer Day Keynote 一窺 LINE生態系的願景 — AI 篇</a></li>\n<li><a href=\"http://studyhost.blogspot.com/2018/11/line-developer-day-2018_24.html?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">LINE Developer Day 2018 東京豐盛技術之旅(下)</a></li>\n<li><a href=\"https://medium.com/@clementtang/line-developer-day-2018-%E6%B4%BB%E5%8B%95%E8%A6%8B%E8%81%9E%E8%88%87-keynote-%E7%B4%80%E9%8C%84-6469de55c3f8\" target=\"_blank\" rel=\"noopener\">LINE Developer Day 2018 - 活動見聞與 Keynote 紀錄</a></li>\n</ul>\n<p>2019 的 Dev Day 資訊出來囉，<br>活動時間： 2019/11/20、21, 10:00~21:00 (日本時間)<br>活動地點：東京台場日航大酒店Grand Nikko Tokyo Daiba （2–6–1 Daiba, Minato-ku, Tokyo）<br>活動入場費用：免費<br>參加方式：繳交報名表、預先報名</p>\n<blockquote>\n<p>活動則環繞在開發工程(Engineering)以及產品開發(Production)上</p>\n</blockquote>\n<p><a href=\"https://www.techbang.com/posts/73284-lines-first-expansion-will-be-held-on-november-20th-and-21st-for-two-day-line-developer-day-2019?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">「LINE DEVELOPER DAY」開發者大會將於11/20、21東京登場 | T客邦</a></p>\n<blockquote>\n<p>屆時我會分享文章出來，還請各位多多關注😀</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>說了這麼多，還不去申請一波 LINE API Expert？讓自己的努力有個機會被 LINE 看見：<br><a href=\"https://www.line-community.me/contributors/request?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">LINE developers community | Expert Request</a><br>或是你還不清楚要怎麼開始第一步，來小聚跟我們聊聊吧，社群的每位大大都很熱心跟各位分享，千萬別錯過這些機會哦！<br><a href=\"https://chatbots.kktix.cc/events/chatb13ts?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">Chatb13ts meetup 聊天機器人小聚 #13 @ 台北商業大學</a><br>▎活動型態 Chatbots meetup 社群台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>人品爆發的下半年有幸被選為 LINE API Expert，謝謝過程中給我指點、意見還有每位來參加每個 chatbot TW 活動的朋友，你們支持讓我可以更努力去辦各種活動，社團裡歡迎大家踴躍提點子討論，抑或是來參加小聚跟大家互相交流，台北台中都有小聚哦！若有不清楚的地方歡迎詢問😃<br>Chatbot Developers Taiwan：<a href=\"https://www.facebook.com/groups/chatbot.tw\" target=\"_blank\" rel=\"noopener\">https://www.facebook.com/groups/chatbot.tw</a></p>\n<h1 id=\"迎新\"><a href=\"#迎新\" class=\"headerlink\" title=\"迎新\"></a>迎新</h1><p>在 welcome party 中身為 Rookie of LINE API Expert 一定是要被每一位大神輪流 “熱情關照” 一波🤣，想想之前在開發時還在看卡米狗 卡卡米 的 IT 30 鐵人賽、寫 golang 看著 Evan Lin 的部落格、看保哥 Will Huang 在議程中各種秀高速開發技能 … 等等的，沒有到偶像們就直接坐在旁邊，看著看著我就快不行了😝。跟大神們聊完覺得自己做的事還只是冰山一角，看著大家都那麼有影響力下還是這麼努力向前進，做為菜鳥的我當然不能就這樣滿足！繼續抱著大神們的腿前進。(喂！放開自己走啊！)<br><img src=\"https://i.imgur.com/bkefPAh.jpg\" alt></p>\n<h1 id=\"成為-LAE-後的第一場開發者日\"><a href=\"#成為-LAE-後的第一場開發者日\" class=\"headerlink\" title=\"成為 LAE 後的第一場開發者日\"></a>成為 LAE 後的第一場開發者日</h1><p>緊接著第一場大型活動就是參加 LINE 的年度大會 — LINE Developer Day，過往都只能看著前輩們分享文章在電腦前面乾過癮，看著大家可以在國際間跟各路的開發者交流，這一直是我很羨慕的事情之一。但是！現在終於有機會以 LAE 的身分出發啦(媽我在這)！聽說去年有 60 場各種主題的座談會，而今年 LINE 主要會以推廣 人工智慧 為主軸，並且搭配其他在 LINE 中重要的技術形成了這次的 developer day，也開始漸漸露出在新聞版面了，看起來想拓展的企圖心也越來越強了🚀<br>以下是其他 LAE 以及社群創始人 Clement Tang 在 2018 年參加 LINE Dev Day 的文章分享</p>\n<ul>\n<li><a href=\"https://medium.com/@wolkesau/2018-%E5%B9%B4%E5%BA%A6%E5%A4%A7%E6%88%B2-line-api-expert-%E4%B9%8B%E6%97%85-4a12a79a0c04\" target=\"_blank\" rel=\"noopener\">2018 年度大戲 LINE API expert 之旅</a></li>\n<li><a href=\"https://medium.com/@dlackty/%E5%BE%9E-line-developer-day-keynote-%E4%B8%80%E7%AA%BA-line%E7%94%9F%E6%85%8B%E7%B3%BB%E7%9A%84%E9%A1%98%E6%99%AF-ai-%E7%AF%87-f5be69e9c682\" target=\"_blank\" rel=\"noopener\">從 LINE Developer Day Keynote 一窺 LINE生態系的願景 — AI 篇</a></li>\n<li><a href=\"http://studyhost.blogspot.com/2018/11/line-developer-day-2018_24.html?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">LINE Developer Day 2018 東京豐盛技術之旅(下)</a></li>\n<li><a href=\"https://medium.com/@clementtang/line-developer-day-2018-%E6%B4%BB%E5%8B%95%E8%A6%8B%E8%81%9E%E8%88%87-keynote-%E7%B4%80%E9%8C%84-6469de55c3f8\" target=\"_blank\" rel=\"noopener\">LINE Developer Day 2018 - 活動見聞與 Keynote 紀錄</a></li>\n</ul>\n<p>2019 的 Dev Day 資訊出來囉，<br>活動時間： 2019/11/20、21, 10:00~21:00 (日本時間)<br>活動地點：東京台場日航大酒店Grand Nikko Tokyo Daiba （2–6–1 Daiba, Minato-ku, Tokyo）<br>活動入場費用：免費<br>參加方式：繳交報名表、預先報名</p>\n<blockquote>\n<p>活動則環繞在開發工程(Engineering)以及產品開發(Production)上</p>\n</blockquote>\n<p><a href=\"https://www.techbang.com/posts/73284-lines-first-expansion-will-be-held-on-november-20th-and-21st-for-two-day-line-developer-day-2019?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">「LINE DEVELOPER DAY」開發者大會將於11/20、21東京登場 | T客邦</a></p>\n<blockquote>\n<p>屆時我會分享文章出來，還請各位多多關注😀</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>說了這麼多，還不去申請一波 LINE API Expert？讓自己的努力有個機會被 LINE 看見：<br><a href=\"https://www.line-community.me/contributors/request?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">LINE developers community | Expert Request</a><br>或是你還不清楚要怎麼開始第一步，來小聚跟我們聊聊吧，社群的每位大大都很熱心跟各位分享，千萬別錯過這些機會哦！<br><a href=\"https://chatbots.kktix.cc/events/chatb13ts?source=post_page-----6c69fdfc991d----------------------\" target=\"_blank\" rel=\"noopener\">Chatb13ts meetup 聊天機器人小聚 #13 @ 台北商業大學</a><br>▎活動型態 Chatbots meetup 社群台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot。</p>\n"},{"title":"我從 Lint 中學到了什麼？","abbrlink":23350,"date":"2020-06-21T16:49:42.000Z","_content":"\n\n![](https://cdn.pixabay.com/photo/2017/08/12/17/14/taiwan-2634743_1280.jpg)\n\n# 前言\n\n從前我在改以前寫程式時都會有幾個問題，『排版好亂』、『這變數(a1)是？』諸如此類的問題，但就在加入社群後認識很多圈內的朋友並與之討論後才體悟到 Lint 的重要性，首先在跟人家解釋程式時從`變數`、`函式`名稱時就能讓對方更快速知道用途，不用解釋 a1 a2 個別代表什麼，大大的降低溝通成本。\n\n## 優點\n\n<!-- more -->\n\n- 開發風格統一\n- 不會有 tab、space 的問題\n- 後續接手的人心力可以放更多在商業邏輯上\n- 培養命名習慣，更謹慎地處理\n\n## 缺點\n\n- 容易打擊剛加入開發領域的朋友\n  - Ａ：明明邏輯是對的但怎麼紅字一堆？\n- 設定太嚴謹時會為了修問題延誤邏輯開發時間\n  - 時程很趕但 CI 一直擋住\n\n# 介紹\n\n以下會介紹三個我使用過的 Lint，並分享使用經驗。\n\n## SonarQube\n\nSonarQube 是我在之前的公司時所使用的 Lint，裡面的功能真的很完整，除了一些基本檢查以外，最有印象的就是它會找出`淺在風險`、`Code 品質`、`花多久時間可以看懂`...很多很特別的部分，也許這些功能可能只是參考，但看著數字很淒慘時工程魂就會上身，想要把它數值降低點別出現這麼可怕的數字 😅。\n\n![](https://i.imgur.com/PDyOvLF.png)\n\n> Azure + Sonar 參考[董老師的影片](https://www.facebook.com/DotNetWalker/posts/3277105698995647?__xts__[0]=68.ARBkAILNJPiUfPxM6Prkqnc5a38h0vuBEmxvcb8WQRW1xbbJnMhddEwi7Lj2OudXHSJ2hrZ4jGtMMKEYzbF7GcdcZ0CoglZWSiexYSjlseEXBnReh6OoE5ZGIhlGTh75wVn5mHQ2B-bkTfatl-vIP-k83-G6yeoXm0ZcboLrq_e0gZqQLLTY0FPsbB_ROKWvYuYBbxY5-Vj2kpvVBU528mFDTCKDGTk5ih16hbuzlrxY0boNZUVuIcaT4zdnHBaAUFTminhF03jkys7pSpDeiBVz_A6z3jjPJChlAI9pZzZTrlmupgRR6yDzzQrjZ2CR6R2kWOZi5Liz7RfO9GkxZz4G6g&__tn__=-R)\n\n免費版具有容量限制，若是團隊人多的話我認為值得花錢買的 Lint，讓大家 Commit 的程式碼可以被檢查，而 SonarQube 應該是我目前遇到數一數二真的是在鞭打我 code 的一個凶狠 Lint 工具...\n\n## ESLint\n\n起初我初學 Vue 時，在初始化專案時覺得是工程師就是要 Lint，就直接選 ESLint，且當時對於 config 設定檔一竅不通，因此除了執行時滿滿的錯字以外，也讓我對於寫 code quality 的成就感大大折損，對於 coding 年紀還年輕的朋友可以先養成對於 coding 有興趣後再來使用 Lint 我認為對於整個發展會比較健全(但還是看人)。\n\n接著過了一陣子後，我開始修改一個 side project - [Twitch-Bot](https://github.com/louis70109/Twitch-Bot)，這時期因參加社群一陣子也得知 Bottender 這個使用 Javascript 開發 Chatbot 框架，就依照 [Bottender 的初始化](https://bottender.js.org/docs/en/getting-started)方式加上 ESLint，並且搭配 TypeScript 動態檢查所有 code。\n\n> 可以看[當時的 PR 連結](https://github.com/louis70109/Twitch-Bot/pull/16/files)，讓其他人改 code 時也是透過一樣的方式來貢獻，就不會有太多檔案被修改的問題了。\n\n在一開始因為還不熟悉 Javascript 相關開發風格，而我使用很多 pythonic 的方式撰寫 Bot，導致整個專案被狠狠教訓了一遍，不過藉由 Lint 校正的好處是讓我再隔一段時間回來時修改 issue 時不會因為 coding style 不統一而引發的問題，再開發的過程中也會透過小蚯蚓告訴你命名或是哪邊有排版問題，只要遵守 Lint 的規則整份 code 沒有被標記起來就覺得神清氣爽 😆。\n\n以下節錄我的 VSCode ESLint 相關設定：\n\n```javascript\n{\n  // 儲存時 format\n  \"editor.formatOnSave\": true,\n\n  // 單引號設定\n  \"javascript.preferences.quoteStyle\": \"single\",\n  \"typescript.preferences.quoteStyle\": \"single\",\n\n  // ESLint 設定\n  \"eslint.autoFixOnSave\": true,\n  \"eslint.enable\": true,\n  \"eslint.validate\": [\"javascript\", \"typescript\"],\n  \"eslint.format.enable\": true,\n  \"editor.codeActionsOnSave\": {\n    \"source.fixAll.eslint\": true\n  }\n}\n```\n\n> [參考我的 Gist](https://gist.github.com/louis70109/8ea88b9b26570d521c81922572f8309d)\n\n### Bonus - VSCode settings\n\n開啟編輯器後的左上角按下`喜好設定`，英文則是 `Performance`\n![](https://i.imgur.com/01XOZHL.png)\n\n接著右上角有個`轉換檔案的圖案`按下去就可以看到 setting.json 囉！\n![](https://i.imgur.com/ut4sH60.png)\n\n## Flake8\n\n當初會知道怎麼使用 Flake8 的原因是我去貢獻 [LINE SDK](https://github.com/line/line-bot-sdk-python)，它們是使用 tox 來跑多版本的檢查(py2.7、3.4~3.7)，\n\n以我前一陣子的寫的 [Lotify](https://github.com/louis70109/lotify#contributing) 來說，在每次的上版前都一定要跑 flake8 檢查：\n\n```python\npython -m pytest --flake8 tests/\n```\n\n> 上述範例是跑測試時要搭配 flake8 的格式。\n\n透過 flak8 的檢查讓我在 CI 環境時就可以檢查出錯誤，規範貢獻者們的開發風格(包含自己)，如此一來過陣子再回來修改 Lotify 時就可以駕輕就熟 😆，且其他的貢獻者也可以遵守這個規範下去開發。\n\n# 結論\n\nLint 是集結各方工程師們的血汗結晶所產生的規則，在這開源的時代跟著大家的規則走能減少許多溝通成本，讓心思可以在(商業、工程)邏輯上。另一部分我則認為是對自我的要求，透過固定的格式再經過 `N 週/月` 後會來看 code 時不會因為一直因為不統一的 coding style 而導致連自己都看不懂的程式碼窘境，因此適當地遵循也是會對以後開發更有幫助喔！\n\n每個工具沒有絕對的好壞，我認為適當的遵循是好的，但別一昧的堅持才能開發出好的程式碼。\n","source":"_posts/why-i-need-lint.md","raw":"---\ntitle: 我從 Lint 中學到了什麼？\ntags:\n  - Lint\n  - Flake8\n  - SonarQube\n  - ESLint\ncategories: 學習紀錄\nabbrlink: 23350\ndate: 2020-06-22 00:49:42\n---\n\n\n![](https://cdn.pixabay.com/photo/2017/08/12/17/14/taiwan-2634743_1280.jpg)\n\n# 前言\n\n從前我在改以前寫程式時都會有幾個問題，『排版好亂』、『這變數(a1)是？』諸如此類的問題，但就在加入社群後認識很多圈內的朋友並與之討論後才體悟到 Lint 的重要性，首先在跟人家解釋程式時從`變數`、`函式`名稱時就能讓對方更快速知道用途，不用解釋 a1 a2 個別代表什麼，大大的降低溝通成本。\n\n## 優點\n\n<!-- more -->\n\n- 開發風格統一\n- 不會有 tab、space 的問題\n- 後續接手的人心力可以放更多在商業邏輯上\n- 培養命名習慣，更謹慎地處理\n\n## 缺點\n\n- 容易打擊剛加入開發領域的朋友\n  - Ａ：明明邏輯是對的但怎麼紅字一堆？\n- 設定太嚴謹時會為了修問題延誤邏輯開發時間\n  - 時程很趕但 CI 一直擋住\n\n# 介紹\n\n以下會介紹三個我使用過的 Lint，並分享使用經驗。\n\n## SonarQube\n\nSonarQube 是我在之前的公司時所使用的 Lint，裡面的功能真的很完整，除了一些基本檢查以外，最有印象的就是它會找出`淺在風險`、`Code 品質`、`花多久時間可以看懂`...很多很特別的部分，也許這些功能可能只是參考，但看著數字很淒慘時工程魂就會上身，想要把它數值降低點別出現這麼可怕的數字 😅。\n\n![](https://i.imgur.com/PDyOvLF.png)\n\n> Azure + Sonar 參考[董老師的影片](https://www.facebook.com/DotNetWalker/posts/3277105698995647?__xts__[0]=68.ARBkAILNJPiUfPxM6Prkqnc5a38h0vuBEmxvcb8WQRW1xbbJnMhddEwi7Lj2OudXHSJ2hrZ4jGtMMKEYzbF7GcdcZ0CoglZWSiexYSjlseEXBnReh6OoE5ZGIhlGTh75wVn5mHQ2B-bkTfatl-vIP-k83-G6yeoXm0ZcboLrq_e0gZqQLLTY0FPsbB_ROKWvYuYBbxY5-Vj2kpvVBU528mFDTCKDGTk5ih16hbuzlrxY0boNZUVuIcaT4zdnHBaAUFTminhF03jkys7pSpDeiBVz_A6z3jjPJChlAI9pZzZTrlmupgRR6yDzzQrjZ2CR6R2kWOZi5Liz7RfO9GkxZz4G6g&__tn__=-R)\n\n免費版具有容量限制，若是團隊人多的話我認為值得花錢買的 Lint，讓大家 Commit 的程式碼可以被檢查，而 SonarQube 應該是我目前遇到數一數二真的是在鞭打我 code 的一個凶狠 Lint 工具...\n\n## ESLint\n\n起初我初學 Vue 時，在初始化專案時覺得是工程師就是要 Lint，就直接選 ESLint，且當時對於 config 設定檔一竅不通，因此除了執行時滿滿的錯字以外，也讓我對於寫 code quality 的成就感大大折損，對於 coding 年紀還年輕的朋友可以先養成對於 coding 有興趣後再來使用 Lint 我認為對於整個發展會比較健全(但還是看人)。\n\n接著過了一陣子後，我開始修改一個 side project - [Twitch-Bot](https://github.com/louis70109/Twitch-Bot)，這時期因參加社群一陣子也得知 Bottender 這個使用 Javascript 開發 Chatbot 框架，就依照 [Bottender 的初始化](https://bottender.js.org/docs/en/getting-started)方式加上 ESLint，並且搭配 TypeScript 動態檢查所有 code。\n\n> 可以看[當時的 PR 連結](https://github.com/louis70109/Twitch-Bot/pull/16/files)，讓其他人改 code 時也是透過一樣的方式來貢獻，就不會有太多檔案被修改的問題了。\n\n在一開始因為還不熟悉 Javascript 相關開發風格，而我使用很多 pythonic 的方式撰寫 Bot，導致整個專案被狠狠教訓了一遍，不過藉由 Lint 校正的好處是讓我再隔一段時間回來時修改 issue 時不會因為 coding style 不統一而引發的問題，再開發的過程中也會透過小蚯蚓告訴你命名或是哪邊有排版問題，只要遵守 Lint 的規則整份 code 沒有被標記起來就覺得神清氣爽 😆。\n\n以下節錄我的 VSCode ESLint 相關設定：\n\n```javascript\n{\n  // 儲存時 format\n  \"editor.formatOnSave\": true,\n\n  // 單引號設定\n  \"javascript.preferences.quoteStyle\": \"single\",\n  \"typescript.preferences.quoteStyle\": \"single\",\n\n  // ESLint 設定\n  \"eslint.autoFixOnSave\": true,\n  \"eslint.enable\": true,\n  \"eslint.validate\": [\"javascript\", \"typescript\"],\n  \"eslint.format.enable\": true,\n  \"editor.codeActionsOnSave\": {\n    \"source.fixAll.eslint\": true\n  }\n}\n```\n\n> [參考我的 Gist](https://gist.github.com/louis70109/8ea88b9b26570d521c81922572f8309d)\n\n### Bonus - VSCode settings\n\n開啟編輯器後的左上角按下`喜好設定`，英文則是 `Performance`\n![](https://i.imgur.com/01XOZHL.png)\n\n接著右上角有個`轉換檔案的圖案`按下去就可以看到 setting.json 囉！\n![](https://i.imgur.com/ut4sH60.png)\n\n## Flake8\n\n當初會知道怎麼使用 Flake8 的原因是我去貢獻 [LINE SDK](https://github.com/line/line-bot-sdk-python)，它們是使用 tox 來跑多版本的檢查(py2.7、3.4~3.7)，\n\n以我前一陣子的寫的 [Lotify](https://github.com/louis70109/lotify#contributing) 來說，在每次的上版前都一定要跑 flake8 檢查：\n\n```python\npython -m pytest --flake8 tests/\n```\n\n> 上述範例是跑測試時要搭配 flake8 的格式。\n\n透過 flak8 的檢查讓我在 CI 環境時就可以檢查出錯誤，規範貢獻者們的開發風格(包含自己)，如此一來過陣子再回來修改 Lotify 時就可以駕輕就熟 😆，且其他的貢獻者也可以遵守這個規範下去開發。\n\n# 結論\n\nLint 是集結各方工程師們的血汗結晶所產生的規則，在這開源的時代跟著大家的規則走能減少許多溝通成本，讓心思可以在(商業、工程)邏輯上。另一部分我則認為是對自我的要求，透過固定的格式再經過 `N 週/月` 後會來看 code 時不會因為一直因為不統一的 coding style 而導致連自己都看不懂的程式碼窘境，因此適當地遵循也是會對以後開發更有幫助喔！\n\n每個工具沒有絕對的好壞，我認為適當的遵循是好的，但別一昧的堅持才能開發出好的程式碼。\n","slug":"why-i-need-lint","published":1,"updated":"2020-06-21T16:50:09.321Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lc00557crio1lfno1c","content":"<p><img src=\"https://cdn.pixabay.com/photo/2017/08/12/17/14/taiwan-2634743_1280.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>從前我在改以前寫程式時都會有幾個問題，『排版好亂』、『這變數(a1)是？』諸如此類的問題，但就在加入社群後認識很多圈內的朋友並與之討論後才體悟到 Lint 的重要性，首先在跟人家解釋程式時從<code>變數</code>、<code>函式</code>名稱時就能讓對方更快速知道用途，不用解釋 a1 a2 個別代表什麼，大大的降低溝通成本。</p>\n<h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2><a id=\"more\"></a>\n\n<ul>\n<li>開發風格統一</li>\n<li>不會有 tab、space 的問題</li>\n<li>後續接手的人心力可以放更多在商業邏輯上</li>\n<li>培養命名習慣，更謹慎地處理</li>\n</ul>\n<h2 id=\"缺點\"><a href=\"#缺點\" class=\"headerlink\" title=\"缺點\"></a>缺點</h2><ul>\n<li>容易打擊剛加入開發領域的朋友<ul>\n<li>Ａ：明明邏輯是對的但怎麼紅字一堆？</li>\n</ul>\n</li>\n<li>設定太嚴謹時會為了修問題延誤邏輯開發時間<ul>\n<li>時程很趕但 CI 一直擋住</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以下會介紹三個我使用過的 Lint，並分享使用經驗。</p>\n<h2 id=\"SonarQube\"><a href=\"#SonarQube\" class=\"headerlink\" title=\"SonarQube\"></a>SonarQube</h2><p>SonarQube 是我在之前的公司時所使用的 Lint，裡面的功能真的很完整，除了一些基本檢查以外，最有印象的就是它會找出<code>淺在風險</code>、<code>Code 品質</code>、<code>花多久時間可以看懂</code>…很多很特別的部分，也許這些功能可能只是參考，但看著數字很淒慘時工程魂就會上身，想要把它數值降低點別出現這麼可怕的數字 😅。</p>\n<p><img src=\"https://i.imgur.com/PDyOvLF.png\" alt></p>\n<blockquote>\n<p>Azure + Sonar 參考<a href=\"https://www.facebook.com/DotNetWalker/posts/3277105698995647?__xts__[0]=68.ARBkAILNJPiUfPxM6Prkqnc5a38h0vuBEmxvcb8WQRW1xbbJnMhddEwi7Lj2OudXHSJ2hrZ4jGtMMKEYzbF7GcdcZ0CoglZWSiexYSjlseEXBnReh6OoE5ZGIhlGTh75wVn5mHQ2B-bkTfatl-vIP-k83-G6yeoXm0ZcboLrq_e0gZqQLLTY0FPsbB_ROKWvYuYBbxY5-Vj2kpvVBU528mFDTCKDGTk5ih16hbuzlrxY0boNZUVuIcaT4zdnHBaAUFTminhF03jkys7pSpDeiBVz_A6z3jjPJChlAI9pZzZTrlmupgRR6yDzzQrjZ2CR6R2kWOZi5Liz7RfO9GkxZz4G6g&__tn__=-R\" target=\"_blank\" rel=\"noopener\">董老師的影片</a></p>\n</blockquote>\n<p>免費版具有容量限制，若是團隊人多的話我認為值得花錢買的 Lint，讓大家 Commit 的程式碼可以被檢查，而 SonarQube 應該是我目前遇到數一數二真的是在鞭打我 code 的一個凶狠 Lint 工具…</p>\n<h2 id=\"ESLint\"><a href=\"#ESLint\" class=\"headerlink\" title=\"ESLint\"></a>ESLint</h2><p>起初我初學 Vue 時，在初始化專案時覺得是工程師就是要 Lint，就直接選 ESLint，且當時對於 config 設定檔一竅不通，因此除了執行時滿滿的錯字以外，也讓我對於寫 code quality 的成就感大大折損，對於 coding 年紀還年輕的朋友可以先養成對於 coding 有興趣後再來使用 Lint 我認為對於整個發展會比較健全(但還是看人)。</p>\n<p>接著過了一陣子後，我開始修改一個 side project - <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a>，這時期因參加社群一陣子也得知 Bottender 這個使用 Javascript 開發 Chatbot 框架，就依照 <a href=\"https://bottender.js.org/docs/en/getting-started\" target=\"_blank\" rel=\"noopener\">Bottender 的初始化</a>方式加上 ESLint，並且搭配 TypeScript 動態檢查所有 code。</p>\n<blockquote>\n<p>可以看<a href=\"https://github.com/louis70109/Twitch-Bot/pull/16/files\" target=\"_blank\" rel=\"noopener\">當時的 PR 連結</a>，讓其他人改 code 時也是透過一樣的方式來貢獻，就不會有太多檔案被修改的問題了。</p>\n</blockquote>\n<p>在一開始因為還不熟悉 Javascript 相關開發風格，而我使用很多 pythonic 的方式撰寫 Bot，導致整個專案被狠狠教訓了一遍，不過藉由 Lint 校正的好處是讓我再隔一段時間回來時修改 issue 時不會因為 coding style 不統一而引發的問題，再開發的過程中也會透過小蚯蚓告訴你命名或是哪邊有排版問題，只要遵守 Lint 的規則整份 code 沒有被標記起來就覺得神清氣爽 😆。</p>\n<p>以下節錄我的 VSCode ESLint 相關設定：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 儲存時 format</span></span><br><span class=\"line\">  <span class=\"string\">\"editor.formatOnSave\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 單引號設定</span></span><br><span class=\"line\">  <span class=\"string\">\"javascript.preferences.quoteStyle\"</span>: <span class=\"string\">\"single\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"typescript.preferences.quoteStyle\"</span>: <span class=\"string\">\"single\"</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// ESLint 設定</span></span><br><span class=\"line\">  <span class=\"string\">\"eslint.autoFixOnSave\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"eslint.enable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"eslint.validate\"</span>: [<span class=\"string\">\"javascript\"</span>, <span class=\"string\">\"typescript\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"eslint.format.enable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"editor.codeActionsOnSave\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"source.fixAll.eslint\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://gist.github.com/louis70109/8ea88b9b26570d521c81922572f8309d\" target=\"_blank\" rel=\"noopener\">參考我的 Gist</a></p>\n</blockquote>\n<h3 id=\"Bonus-VSCode-settings\"><a href=\"#Bonus-VSCode-settings\" class=\"headerlink\" title=\"Bonus - VSCode settings\"></a>Bonus - VSCode settings</h3><p>開啟編輯器後的左上角按下<code>喜好設定</code>，英文則是 <code>Performance</code><br><img src=\"https://i.imgur.com/01XOZHL.png\" alt></p>\n<p>接著右上角有個<code>轉換檔案的圖案</code>按下去就可以看到 setting.json 囉！<br><img src=\"https://i.imgur.com/ut4sH60.png\" alt></p>\n<h2 id=\"Flake8\"><a href=\"#Flake8\" class=\"headerlink\" title=\"Flake8\"></a>Flake8</h2><p>當初會知道怎麼使用 Flake8 的原因是我去貢獻 <a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">LINE SDK</a>，它們是使用 tox 來跑多版本的檢查(py2.7、3.4~3.7)，</p>\n<p>以我前一陣子的寫的 <a href=\"https://github.com/louis70109/lotify#contributing\" target=\"_blank\" rel=\"noopener\">Lotify</a> 來說，在每次的上版前都一定要跑 flake8 檢查：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m pytest --flake8 tests/</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>上述範例是跑測試時要搭配 flake8 的格式。</p>\n</blockquote>\n<p>透過 flak8 的檢查讓我在 CI 環境時就可以檢查出錯誤，規範貢獻者們的開發風格(包含自己)，如此一來過陣子再回來修改 Lotify 時就可以駕輕就熟 😆，且其他的貢獻者也可以遵守這個規範下去開發。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>Lint 是集結各方工程師們的血汗結晶所產生的規則，在這開源的時代跟著大家的規則走能減少許多溝通成本，讓心思可以在(商業、工程)邏輯上。另一部分我則認為是對自我的要求，透過固定的格式再經過 <code>N 週/月</code> 後會來看 code 時不會因為一直因為不統一的 coding style 而導致連自己都看不懂的程式碼窘境，因此適當地遵循也是會對以後開發更有幫助喔！</p>\n<p>每個工具沒有絕對的好壞，我認為適當的遵循是好的，但別一昧的堅持才能開發出好的程式碼。</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://cdn.pixabay.com/photo/2017/08/12/17/14/taiwan-2634743_1280.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>從前我在改以前寫程式時都會有幾個問題，『排版好亂』、『這變數(a1)是？』諸如此類的問題，但就在加入社群後認識很多圈內的朋友並與之討論後才體悟到 Lint 的重要性，首先在跟人家解釋程式時從<code>變數</code>、<code>函式</code>名稱時就能讓對方更快速知道用途，不用解釋 a1 a2 個別代表什麼，大大的降低溝通成本。</p>\n<h2 id=\"優點\"><a href=\"#優點\" class=\"headerlink\" title=\"優點\"></a>優點</h2>","more":"<ul>\n<li>開發風格統一</li>\n<li>不會有 tab、space 的問題</li>\n<li>後續接手的人心力可以放更多在商業邏輯上</li>\n<li>培養命名習慣，更謹慎地處理</li>\n</ul>\n<h2 id=\"缺點\"><a href=\"#缺點\" class=\"headerlink\" title=\"缺點\"></a>缺點</h2><ul>\n<li>容易打擊剛加入開發領域的朋友<ul>\n<li>Ａ：明明邏輯是對的但怎麼紅字一堆？</li>\n</ul>\n</li>\n<li>設定太嚴謹時會為了修問題延誤邏輯開發時間<ul>\n<li>時程很趕但 CI 一直擋住</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以下會介紹三個我使用過的 Lint，並分享使用經驗。</p>\n<h2 id=\"SonarQube\"><a href=\"#SonarQube\" class=\"headerlink\" title=\"SonarQube\"></a>SonarQube</h2><p>SonarQube 是我在之前的公司時所使用的 Lint，裡面的功能真的很完整，除了一些基本檢查以外，最有印象的就是它會找出<code>淺在風險</code>、<code>Code 品質</code>、<code>花多久時間可以看懂</code>…很多很特別的部分，也許這些功能可能只是參考，但看著數字很淒慘時工程魂就會上身，想要把它數值降低點別出現這麼可怕的數字 😅。</p>\n<p><img src=\"https://i.imgur.com/PDyOvLF.png\" alt></p>\n<blockquote>\n<p>Azure + Sonar 參考<a href=\"https://www.facebook.com/DotNetWalker/posts/3277105698995647?__xts__[0]=68.ARBkAILNJPiUfPxM6Prkqnc5a38h0vuBEmxvcb8WQRW1xbbJnMhddEwi7Lj2OudXHSJ2hrZ4jGtMMKEYzbF7GcdcZ0CoglZWSiexYSjlseEXBnReh6OoE5ZGIhlGTh75wVn5mHQ2B-bkTfatl-vIP-k83-G6yeoXm0ZcboLrq_e0gZqQLLTY0FPsbB_ROKWvYuYBbxY5-Vj2kpvVBU528mFDTCKDGTk5ih16hbuzlrxY0boNZUVuIcaT4zdnHBaAUFTminhF03jkys7pSpDeiBVz_A6z3jjPJChlAI9pZzZTrlmupgRR6yDzzQrjZ2CR6R2kWOZi5Liz7RfO9GkxZz4G6g&__tn__=-R\" target=\"_blank\" rel=\"noopener\">董老師的影片</a></p>\n</blockquote>\n<p>免費版具有容量限制，若是團隊人多的話我認為值得花錢買的 Lint，讓大家 Commit 的程式碼可以被檢查，而 SonarQube 應該是我目前遇到數一數二真的是在鞭打我 code 的一個凶狠 Lint 工具…</p>\n<h2 id=\"ESLint\"><a href=\"#ESLint\" class=\"headerlink\" title=\"ESLint\"></a>ESLint</h2><p>起初我初學 Vue 時，在初始化專案時覺得是工程師就是要 Lint，就直接選 ESLint，且當時對於 config 設定檔一竅不通，因此除了執行時滿滿的錯字以外，也讓我對於寫 code quality 的成就感大大折損，對於 coding 年紀還年輕的朋友可以先養成對於 coding 有興趣後再來使用 Lint 我認為對於整個發展會比較健全(但還是看人)。</p>\n<p>接著過了一陣子後，我開始修改一個 side project - <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a>，這時期因參加社群一陣子也得知 Bottender 這個使用 Javascript 開發 Chatbot 框架，就依照 <a href=\"https://bottender.js.org/docs/en/getting-started\" target=\"_blank\" rel=\"noopener\">Bottender 的初始化</a>方式加上 ESLint，並且搭配 TypeScript 動態檢查所有 code。</p>\n<blockquote>\n<p>可以看<a href=\"https://github.com/louis70109/Twitch-Bot/pull/16/files\" target=\"_blank\" rel=\"noopener\">當時的 PR 連結</a>，讓其他人改 code 時也是透過一樣的方式來貢獻，就不會有太多檔案被修改的問題了。</p>\n</blockquote>\n<p>在一開始因為還不熟悉 Javascript 相關開發風格，而我使用很多 pythonic 的方式撰寫 Bot，導致整個專案被狠狠教訓了一遍，不過藉由 Lint 校正的好處是讓我再隔一段時間回來時修改 issue 時不會因為 coding style 不統一而引發的問題，再開發的過程中也會透過小蚯蚓告訴你命名或是哪邊有排版問題，只要遵守 Lint 的規則整份 code 沒有被標記起來就覺得神清氣爽 😆。</p>\n<p>以下節錄我的 VSCode ESLint 相關設定：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 儲存時 format</span></span><br><span class=\"line\">  <span class=\"string\">\"editor.formatOnSave\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 單引號設定</span></span><br><span class=\"line\">  <span class=\"string\">\"javascript.preferences.quoteStyle\"</span>: <span class=\"string\">\"single\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"typescript.preferences.quoteStyle\"</span>: <span class=\"string\">\"single\"</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// ESLint 設定</span></span><br><span class=\"line\">  <span class=\"string\">\"eslint.autoFixOnSave\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"eslint.enable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"eslint.validate\"</span>: [<span class=\"string\">\"javascript\"</span>, <span class=\"string\">\"typescript\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"eslint.format.enable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"editor.codeActionsOnSave\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"source.fixAll.eslint\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://gist.github.com/louis70109/8ea88b9b26570d521c81922572f8309d\" target=\"_blank\" rel=\"noopener\">參考我的 Gist</a></p>\n</blockquote>\n<h3 id=\"Bonus-VSCode-settings\"><a href=\"#Bonus-VSCode-settings\" class=\"headerlink\" title=\"Bonus - VSCode settings\"></a>Bonus - VSCode settings</h3><p>開啟編輯器後的左上角按下<code>喜好設定</code>，英文則是 <code>Performance</code><br><img src=\"https://i.imgur.com/01XOZHL.png\" alt></p>\n<p>接著右上角有個<code>轉換檔案的圖案</code>按下去就可以看到 setting.json 囉！<br><img src=\"https://i.imgur.com/ut4sH60.png\" alt></p>\n<h2 id=\"Flake8\"><a href=\"#Flake8\" class=\"headerlink\" title=\"Flake8\"></a>Flake8</h2><p>當初會知道怎麼使用 Flake8 的原因是我去貢獻 <a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">LINE SDK</a>，它們是使用 tox 來跑多版本的檢查(py2.7、3.4~3.7)，</p>\n<p>以我前一陣子的寫的 <a href=\"https://github.com/louis70109/lotify#contributing\" target=\"_blank\" rel=\"noopener\">Lotify</a> 來說，在每次的上版前都一定要跑 flake8 檢查：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m pytest --flake8 tests/</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>上述範例是跑測試時要搭配 flake8 的格式。</p>\n</blockquote>\n<p>透過 flak8 的檢查讓我在 CI 環境時就可以檢查出錯誤，規範貢獻者們的開發風格(包含自己)，如此一來過陣子再回來修改 Lotify 時就可以駕輕就熟 😆，且其他的貢獻者也可以遵守這個規範下去開發。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>Lint 是集結各方工程師們的血汗結晶所產生的規則，在這開源的時代跟著大家的規則走能減少許多溝通成本，讓心思可以在(商業、工程)邏輯上。另一部分我則認為是對自我的要求，透過固定的格式再經過 <code>N 週/月</code> 後會來看 code 時不會因為一直因為不統一的 coding style 而導致連自己都看不懂的程式碼窘境，因此適當地遵循也是會對以後開發更有幫助喔！</p>\n<p>每個工具沒有絕對的好壞，我認為適當的遵循是好的，但別一昧的堅持才能開發出好的程式碼。</p>"},{"title":"【AWS】使用 API Gateway Authorizer 做使用者驗證 feat. Serverless","abbrlink":3960684583,"date":"2020-04-18T18:38:29.000Z","_content":"\n![API Gateway Lambda authorization workflow](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n在 AWS 的 API gateway 上就有一個項目(`Authorizer`)是支援 Cognito 以及客制認證的方法，好處就是在進我們寫的 API 之前有個可以做**身份確認**的 Lambda Function 幫我們好前處理，而本篇則會介紹如何在 Serverless framework 上設定 API gateway 的 Authorizer 以及成功讓 API 回應，串接 Cognito 做使用部分就留給之後吧！\n\n#### 👉 本篇的範例全都在 [GitHub](https://github.com/louis70109/aws-serverless-authorizer)\n\n<!-- more -->\n\n# API Gateway - Authorizer\n\n- [官方文件](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html)\n\n擁有 Authorizer 的一個 Serverless 服務會長這樣:\n\n> User Request - [Authorizer] - API - Response user\n\n好處除了前言所提到的前處理外，還有如果設定是 `Edge` 模式 (不是透過 `region` 從網路層傳) 的話其實在認證完後傳到 API 時速度是很快的。\n\n以下就開始好好的介紹它 😆\n\n## 實際的位置\n\n如果在這邊設定覺得不知道在哪邊的話可以參考 - [純手動用法官方教學](https://docs.aws.amazon.com/apigateway/latest/developerguide/)\n\n中文的話左邊名為`授權方`，英文則是`Authorizer`\n![API Gateway Authorizer](https://i.imgur.com/v2vflgw.png)\n\n## Serverless 實作\n\n### Yaml settings\n\n原始如果串接 python WSGI 的話設定檔應該會長得如下:\n\n```yaml\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\n```\n\n設定 Authorizer Lambda function，先在跟 `api` 同層加上 `Authorizer` Lambda，指定 handler 為 `handler 資料夾`下的 `authorizer.py` 的 `auth_handler` function，並且設定 `cors` 為 true，避免呼叫 api 時被 AWS 擋下來無法使用。\n\n接著在把 `events` 裡的兩個事件加上 `authorizer` 的 Function，名為 `ResourceAuthorizer`，改編過後入下:\n\n```yaml\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http:\n          path: /\n          method: ANY\n          authorizer: ResourceAuthorizer\n      - http:\n          path: /{proxy+}\n          method: ANY\n          authorizer: ResourceAuthorizer\n  ResourceAuthorizer:\n    handler: handler/authorizer.auth_handler\n    cors: true\n```\n\n- 這部分參考來自 [Serverless docs](https://serverless.com/framework/docs/providers/aws/events/apigateway/#http-endpoints-with-custom-authorizers)\n\n> 只要透過簡單的設定 function 就可以互相溝通是不是很像 docker compose 呀 😏\n\n## 處理 Lambda function handler\n\n[參考並複製官方的範例程式](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L15)會看到我的開頭要從 `event` 取得 token:\n\n```python\nevent_token = event.get('authorizationToken')\n```\n\n> 🐛🐛 這裡雖然是取 `authorizationToken`，不過呼叫 api 時 header 是要帶 `Authorization`，如此一來 Api gateway 才會收到對的值，這邊是需要注意 AWS 比較不一樣的地方！\n> [參考支援在這啦 QQ](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L17)\n\n取得 token 後一般就會做身份驗證的部分，以我的例子來說我就是解 JWT 下來做驗證，這邊為了 Demo 就先不處理它。\n\n## 產生 Auth Policy\n\n官方提供的範例版本是 Node.js[[參考資料](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html#api-gateway-lambda-authorizer-request-lambda-function-create)]，但畢竟我們是用 python 看著 javascript 我怎麼用啊！！\n\n因此查了一番找到了範例: [aws-apigateway-lambda-authorizer-blueprints](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints)，只是說沒有任何文件使用起來只能靠本能了 😭，這邊他很佛心的提供 `dotnet`、`golang`、`python`、`java`、`node.js`以及 `rust` 的範例，基本上常在 Serverless 上跑的語言都有了，就只好放過它一馬了 😇\n\n基本上從官方的範例終止需要改寫成像[我專案這樣](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py)只要注意 `auth_handler` 裡面的內容需要填什麼即可。\n\n其他需要注意的就如[第 25 行的 policy](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L25)以及 [28 行的 build policy](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L28)所產出的東西需要確認清楚才行:\n\n```python\npolicy.allowAllMethods()\n\n# Finally, build the policy\nauthResponse = policy.build()\n```\n\n而下面的 class code 就可以先忽略不管，因為那些官方是為了產生出 Authorizer 回應狀態 pattern 所使用的 code，即便我們去改也出不了什麼作用:\n\n```python\nclass HttpVerb:\n    GET = \"GET\"\n    ...\n\nclass AuthPolicy(object):\n    awsAccountId = \"\"\n    ...\n```\n\n## Lambda 回應狀態\n\nAuthorizer 認證成功之後 Lambda 會回傳給 API Gateway 的 pattern：\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"execute-api:Invoke\",\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"\n    }\n  ]\n}\n```\n\n認證失敗回傳的樣子:\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"execute-api:Invoke\",\n      \"Effect\": \"Deny\",\n      \"Resource\": \"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"\n    }\n  ]\n}\n```\n\n> 這些都會是透過 AuthPolicy 來產生的，直接對 Function return value 是部會作用的。\n\n# 使用心得 (踩坑)\n\n- Header 收的名稱是 `Authorization`，但程式是收`authorizationToken`，[參考]()。\n- 只能 raise Exception('Unauthorized')，多一字少一字都不行，真的很奇怪，[參考](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L29)。\n- 好不容易找到的範例預設是會先 `deny` 掉使用者，但這在測行為會很困擾，[官方範例 code](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L52)。\n\n# 結論\n\n以往都要使用框架(Flask, Django...)裡提供的功能實作 middleware 來做處理，但若使用像 AWS、Google、Azure 他們 Serverless 服務的話不妨使用 Authorizer 來做驗證，除了認證使用者以外還可以藉由這些 Function Service 來降低 API 的負載，讓它們可以更專心地處理後端邏輯的問題。\n\n> 如果真的很想知道 Authorizer 的行為機制的話可以看看這篇官方文件 - [使用 postman 去測試 authorizer](https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html)\n\n# 參考\n\n- [純手動用法官方教學](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-from-example.html)\n- [AWS Authorizer Official Document](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html)\n- [使用 postman 去測試 authorizer](https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html)\n\n- [範例 aws-apigateway-lambda-authorizer-blueprints](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints)\n\n- [Serverless Docs settings](https://serverless.com/framework/docs/providers/aws/events/apigateway#http-endpoints-with-custom-authorizers)\n","source":"_posts/【AWS】使用-API-Gateway-Authorizer-做使用者驗證-feat-Serverless.md","raw":"---\ntitle: 【AWS】使用 API Gateway Authorizer 做使用者驗證 feat. Serverless\ntags:\n  - AWS\n  - Serverless\n  - API Gateway\n  - Authorizer\n  - Python\n  - Amazon Web Service\n  - JWT\ncategories: Serverless\nabbrlink: 3960684583\ndate: 2020-04-19 02:38:29\n---\n\n![API Gateway Lambda authorization workflow](https://i.imgur.com/0QAGPDc.png)\n\n# 前言\n\n在 AWS 的 API gateway 上就有一個項目(`Authorizer`)是支援 Cognito 以及客制認證的方法，好處就是在進我們寫的 API 之前有個可以做**身份確認**的 Lambda Function 幫我們好前處理，而本篇則會介紹如何在 Serverless framework 上設定 API gateway 的 Authorizer 以及成功讓 API 回應，串接 Cognito 做使用部分就留給之後吧！\n\n#### 👉 本篇的範例全都在 [GitHub](https://github.com/louis70109/aws-serverless-authorizer)\n\n<!-- more -->\n\n# API Gateway - Authorizer\n\n- [官方文件](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html)\n\n擁有 Authorizer 的一個 Serverless 服務會長這樣:\n\n> User Request - [Authorizer] - API - Response user\n\n好處除了前言所提到的前處理外，還有如果設定是 `Edge` 模式 (不是透過 `region` 從網路層傳) 的話其實在認證完後傳到 API 時速度是很快的。\n\n以下就開始好好的介紹它 😆\n\n## 實際的位置\n\n如果在這邊設定覺得不知道在哪邊的話可以參考 - [純手動用法官方教學](https://docs.aws.amazon.com/apigateway/latest/developerguide/)\n\n中文的話左邊名為`授權方`，英文則是`Authorizer`\n![API Gateway Authorizer](https://i.imgur.com/v2vflgw.png)\n\n## Serverless 實作\n\n### Yaml settings\n\n原始如果串接 python WSGI 的話設定檔應該會長得如下:\n\n```yaml\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\n```\n\n設定 Authorizer Lambda function，先在跟 `api` 同層加上 `Authorizer` Lambda，指定 handler 為 `handler 資料夾`下的 `authorizer.py` 的 `auth_handler` function，並且設定 `cors` 為 true，避免呼叫 api 時被 AWS 擋下來無法使用。\n\n接著在把 `events` 裡的兩個事件加上 `authorizer` 的 Function，名為 `ResourceAuthorizer`，改編過後入下:\n\n```yaml\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http:\n          path: /\n          method: ANY\n          authorizer: ResourceAuthorizer\n      - http:\n          path: /{proxy+}\n          method: ANY\n          authorizer: ResourceAuthorizer\n  ResourceAuthorizer:\n    handler: handler/authorizer.auth_handler\n    cors: true\n```\n\n- 這部分參考來自 [Serverless docs](https://serverless.com/framework/docs/providers/aws/events/apigateway/#http-endpoints-with-custom-authorizers)\n\n> 只要透過簡單的設定 function 就可以互相溝通是不是很像 docker compose 呀 😏\n\n## 處理 Lambda function handler\n\n[參考並複製官方的範例程式](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L15)會看到我的開頭要從 `event` 取得 token:\n\n```python\nevent_token = event.get('authorizationToken')\n```\n\n> 🐛🐛 這裡雖然是取 `authorizationToken`，不過呼叫 api 時 header 是要帶 `Authorization`，如此一來 Api gateway 才會收到對的值，這邊是需要注意 AWS 比較不一樣的地方！\n> [參考支援在這啦 QQ](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L17)\n\n取得 token 後一般就會做身份驗證的部分，以我的例子來說我就是解 JWT 下來做驗證，這邊為了 Demo 就先不處理它。\n\n## 產生 Auth Policy\n\n官方提供的範例版本是 Node.js[[參考資料](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html#api-gateway-lambda-authorizer-request-lambda-function-create)]，但畢竟我們是用 python 看著 javascript 我怎麼用啊！！\n\n因此查了一番找到了範例: [aws-apigateway-lambda-authorizer-blueprints](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints)，只是說沒有任何文件使用起來只能靠本能了 😭，這邊他很佛心的提供 `dotnet`、`golang`、`python`、`java`、`node.js`以及 `rust` 的範例，基本上常在 Serverless 上跑的語言都有了，就只好放過它一馬了 😇\n\n基本上從官方的範例終止需要改寫成像[我專案這樣](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py)只要注意 `auth_handler` 裡面的內容需要填什麼即可。\n\n其他需要注意的就如[第 25 行的 policy](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L25)以及 [28 行的 build policy](https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L28)所產出的東西需要確認清楚才行:\n\n```python\npolicy.allowAllMethods()\n\n# Finally, build the policy\nauthResponse = policy.build()\n```\n\n而下面的 class code 就可以先忽略不管，因為那些官方是為了產生出 Authorizer 回應狀態 pattern 所使用的 code，即便我們去改也出不了什麼作用:\n\n```python\nclass HttpVerb:\n    GET = \"GET\"\n    ...\n\nclass AuthPolicy(object):\n    awsAccountId = \"\"\n    ...\n```\n\n## Lambda 回應狀態\n\nAuthorizer 認證成功之後 Lambda 會回傳給 API Gateway 的 pattern：\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"execute-api:Invoke\",\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"\n    }\n  ]\n}\n```\n\n認證失敗回傳的樣子:\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"execute-api:Invoke\",\n      \"Effect\": \"Deny\",\n      \"Resource\": \"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"\n    }\n  ]\n}\n```\n\n> 這些都會是透過 AuthPolicy 來產生的，直接對 Function return value 是部會作用的。\n\n# 使用心得 (踩坑)\n\n- Header 收的名稱是 `Authorization`，但程式是收`authorizationToken`，[參考]()。\n- 只能 raise Exception('Unauthorized')，多一字少一字都不行，真的很奇怪，[參考](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L29)。\n- 好不容易找到的範例預設是會先 `deny` 掉使用者，但這在測行為會很困擾，[官方範例 code](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L52)。\n\n# 結論\n\n以往都要使用框架(Flask, Django...)裡提供的功能實作 middleware 來做處理，但若使用像 AWS、Google、Azure 他們 Serverless 服務的話不妨使用 Authorizer 來做驗證，除了認證使用者以外還可以藉由這些 Function Service 來降低 API 的負載，讓它們可以更專心地處理後端邏輯的問題。\n\n> 如果真的很想知道 Authorizer 的行為機制的話可以看看這篇官方文件 - [使用 postman 去測試 authorizer](https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html)\n\n# 參考\n\n- [純手動用法官方教學](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-from-example.html)\n- [AWS Authorizer Official Document](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html)\n- [使用 postman 去測試 authorizer](https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html)\n\n- [範例 aws-apigateway-lambda-authorizer-blueprints](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints)\n\n- [Serverless Docs settings](https://serverless.com/framework/docs/providers/aws/events/apigateway#http-endpoints-with-custom-authorizers)\n","slug":"【AWS】使用-API-Gateway-Authorizer-做使用者驗證-feat-Serverless","published":1,"updated":"2020-06-19T14:03:58.870Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31le005a7crib7dco3av","content":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt=\"API Gateway Lambda authorization workflow\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在 AWS 的 API gateway 上就有一個項目(<code>Authorizer</code>)是支援 Cognito 以及客制認證的方法，好處就是在進我們寫的 API 之前有個可以做<strong>身份確認</strong>的 Lambda Function 幫我們好前處理，而本篇則會介紹如何在 Serverless framework 上設定 API gateway 的 Authorizer 以及成功讓 API 回應，串接 Cognito 做使用部分就留給之後吧！</p>\n<h4 id=\"👉-本篇的範例全都在-GitHub\"><a href=\"#👉-本篇的範例全都在-GitHub\" class=\"headerlink\" title=\"👉 本篇的範例全都在 GitHub\"></a>👉 本篇的範例全都在 <a href=\"https://github.com/louis70109/aws-serverless-authorizer\" target=\"_blank\" rel=\"noopener\">GitHub</a></h4><a id=\"more\"></a>\n\n<h1 id=\"API-Gateway-Authorizer\"><a href=\"#API-Gateway-Authorizer\" class=\"headerlink\" title=\"API Gateway - Authorizer\"></a>API Gateway - Authorizer</h1><ul>\n<li><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html\" target=\"_blank\" rel=\"noopener\">官方文件</a></li>\n</ul>\n<p>擁有 Authorizer 的一個 Serverless 服務會長這樣:</p>\n<blockquote>\n<p>User Request - [Authorizer] - API - Response user</p>\n</blockquote>\n<p>好處除了前言所提到的前處理外，還有如果設定是 <code>Edge</code> 模式 (不是透過 <code>region</code> 從網路層傳) 的話其實在認證完後傳到 API 時速度是很快的。</p>\n<p>以下就開始好好的介紹它 😆</p>\n<h2 id=\"實際的位置\"><a href=\"#實際的位置\" class=\"headerlink\" title=\"實際的位置\"></a>實際的位置</h2><p>如果在這邊設定覺得不知道在哪邊的話可以參考 - <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/\" target=\"_blank\" rel=\"noopener\">純手動用法官方教學</a></p>\n<p>中文的話左邊名為<code>授權方</code>，英文則是<code>Authorizer</code><br><img src=\"https://i.imgur.com/v2vflgw.png\" alt=\"API Gateway Authorizer\"></p>\n<h2 id=\"Serverless-實作\"><a href=\"#Serverless-實作\" class=\"headerlink\" title=\"Serverless 實作\"></a>Serverless 實作</h2><h3 id=\"Yaml-settings\"><a href=\"#Yaml-settings\" class=\"headerlink\" title=\"Yaml settings\"></a>Yaml settings</h3><p>原始如果串接 python WSGI 的話設定檔應該會長得如下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>設定 Authorizer Lambda function，先在跟 <code>api</code> 同層加上 <code>Authorizer</code> Lambda，指定 handler 為 <code>handler 資料夾</code>下的 <code>authorizer.py</code> 的 <code>auth_handler</code> function，並且設定 <code>cors</code> 為 true，避免呼叫 api 時被 AWS 擋下來無法使用。</p>\n<p>接著在把 <code>events</code> 裡的兩個事件加上 <code>authorizer</code> 的 Function，名為 <code>ResourceAuthorizer</code>，改編過後入下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">          method:</span> <span class=\"string\">ANY</span></span><br><span class=\"line\"><span class=\"attr\">          authorizer:</span> <span class=\"string\">ResourceAuthorizer</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">          method:</span> <span class=\"string\">ANY</span></span><br><span class=\"line\"><span class=\"attr\">          authorizer:</span> <span class=\"string\">ResourceAuthorizer</span></span><br><span class=\"line\"><span class=\"attr\">  ResourceAuthorizer:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">handler/authorizer.auth_handler</span></span><br><span class=\"line\"><span class=\"attr\">    cors:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>這部分參考來自 <a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway/#http-endpoints-with-custom-authorizers\" target=\"_blank\" rel=\"noopener\">Serverless docs</a></li>\n</ul>\n<blockquote>\n<p>只要透過簡單的設定 function 就可以互相溝通是不是很像 docker compose 呀 😏</p>\n</blockquote>\n<h2 id=\"處理-Lambda-function-handler\"><a href=\"#處理-Lambda-function-handler\" class=\"headerlink\" title=\"處理 Lambda function handler\"></a>處理 Lambda function handler</h2><p><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L15\" target=\"_blank\" rel=\"noopener\">參考並複製官方的範例程式</a>會看到我的開頭要從 <code>event</code> 取得 token:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">event_token = event.get(<span class=\"string\">'authorizationToken'</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🐛🐛 這裡雖然是取 <code>authorizationToken</code>，不過呼叫 api 時 header 是要帶 <code>Authorization</code>，如此一來 Api gateway 才會收到對的值，這邊是需要注意 AWS 比較不一樣的地方！<br><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L17\" target=\"_blank\" rel=\"noopener\">參考支援在這啦 QQ</a></p>\n</blockquote>\n<p>取得 token 後一般就會做身份驗證的部分，以我的例子來說我就是解 JWT 下來做驗證，這邊為了 Demo 就先不處理它。</p>\n<h2 id=\"產生-Auth-Policy\"><a href=\"#產生-Auth-Policy\" class=\"headerlink\" title=\"產生 Auth Policy\"></a>產生 Auth Policy</h2><p>官方提供的範例版本是 Node.js[<a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html#api-gateway-lambda-authorizer-request-lambda-function-create\" target=\"_blank\" rel=\"noopener\">參考資料</a>]，但畢竟我們是用 python 看著 javascript 我怎麼用啊！！</p>\n<p>因此查了一番找到了範例: <a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints\" target=\"_blank\" rel=\"noopener\">aws-apigateway-lambda-authorizer-blueprints</a>，只是說沒有任何文件使用起來只能靠本能了 😭，這邊他很佛心的提供 <code>dotnet</code>、<code>golang</code>、<code>python</code>、<code>java</code>、<code>node.js</code>以及 <code>rust</code> 的範例，基本上常在 Serverless 上跑的語言都有了，就只好放過它一馬了 😇</p>\n<p>基本上從官方的範例終止需要改寫成像<a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py\" target=\"_blank\" rel=\"noopener\">我專案這樣</a>只要注意 <code>auth_handler</code> 裡面的內容需要填什麼即可。</p>\n<p>其他需要注意的就如<a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L25\" target=\"_blank\" rel=\"noopener\">第 25 行的 policy</a>以及 <a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L28\" target=\"_blank\" rel=\"noopener\">28 行的 build policy</a>所產出的東西需要確認清楚才行:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">policy.allowAllMethods()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Finally, build the policy</span></span><br><span class=\"line\">authResponse = policy.build()</span><br></pre></td></tr></table></figure>\n\n<p>而下面的 class code 就可以先忽略不管，因為那些官方是為了產生出 Authorizer 回應狀態 pattern 所使用的 code，即便我們去改也出不了什麼作用:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HttpVerb</span>:</span></span><br><span class=\"line\">    GET = <span class=\"string\">\"GET\"</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AuthPolicy</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    awsAccountId = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    ...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Lambda-回應狀態\"><a href=\"#Lambda-回應狀態\" class=\"headerlink\" title=\"Lambda 回應狀態\"></a>Lambda 回應狀態</h2><p>Authorizer 認證成功之後 Lambda 會回傳給 API Gateway 的 pattern：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Version\"</span>: <span class=\"string\">\"2012-10-17\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"Statement\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Action\"</span>: <span class=\"string\">\"execute-api:Invoke\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Effect\"</span>: <span class=\"string\">\"Allow\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Resource\"</span>: <span class=\"string\">\"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>認證失敗回傳的樣子:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Version\"</span>: <span class=\"string\">\"2012-10-17\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"Statement\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Action\"</span>: <span class=\"string\">\"execute-api:Invoke\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Effect\"</span>: <span class=\"string\">\"Deny\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Resource\"</span>: <span class=\"string\">\"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>這些都會是透過 AuthPolicy 來產生的，直接對 Function return value 是部會作用的。</p>\n</blockquote>\n<h1 id=\"使用心得-踩坑\"><a href=\"#使用心得-踩坑\" class=\"headerlink\" title=\"使用心得 (踩坑)\"></a>使用心得 (踩坑)</h1><ul>\n<li>Header 收的名稱是 <code>Authorization</code>，但程式是收<code>authorizationToken</code>，<a href>參考</a>。</li>\n<li>只能 raise Exception(‘Unauthorized’)，多一字少一字都不行，真的很奇怪，<a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L29\" target=\"_blank\" rel=\"noopener\">參考</a>。</li>\n<li>好不容易找到的範例預設是會先 <code>deny</code> 掉使用者，但這在測行為會很困擾，<a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L52\" target=\"_blank\" rel=\"noopener\">官方範例 code</a>。</li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>以往都要使用框架(Flask, Django…)裡提供的功能實作 middleware 來做處理，但若使用像 AWS、Google、Azure 他們 Serverless 服務的話不妨使用 Authorizer 來做驗證，除了認證使用者以外還可以藉由這些 Function Service 來降低 API 的負載，讓它們可以更專心地處理後端邏輯的問題。</p>\n<blockquote>\n<p>如果真的很想知道 Authorizer 的行為機制的話可以看看這篇官方文件 - <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html\" target=\"_blank\" rel=\"noopener\">使用 postman 去測試 authorizer</a></p>\n</blockquote>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-from-example.html\" target=\"_blank\" rel=\"noopener\">純手動用法官方教學</a></p>\n</li>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html\" target=\"_blank\" rel=\"noopener\">AWS Authorizer Official Document</a></p>\n</li>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html\" target=\"_blank\" rel=\"noopener\">使用 postman 去測試 authorizer</a></p>\n</li>\n<li><p><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints\" target=\"_blank\" rel=\"noopener\">範例 aws-apigateway-lambda-authorizer-blueprints</a></p>\n</li>\n<li><p><a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway#http-endpoints-with-custom-authorizers\" target=\"_blank\" rel=\"noopener\">Serverless Docs settings</a></p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/0QAGPDc.png\" alt=\"API Gateway Lambda authorization workflow\"></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在 AWS 的 API gateway 上就有一個項目(<code>Authorizer</code>)是支援 Cognito 以及客制認證的方法，好處就是在進我們寫的 API 之前有個可以做<strong>身份確認</strong>的 Lambda Function 幫我們好前處理，而本篇則會介紹如何在 Serverless framework 上設定 API gateway 的 Authorizer 以及成功讓 API 回應，串接 Cognito 做使用部分就留給之後吧！</p>\n<h4 id=\"👉-本篇的範例全都在-GitHub\"><a href=\"#👉-本篇的範例全都在-GitHub\" class=\"headerlink\" title=\"👉 本篇的範例全都在 GitHub\"></a>👉 本篇的範例全都在 <a href=\"https://github.com/louis70109/aws-serverless-authorizer\" target=\"_blank\" rel=\"noopener\">GitHub</a></h4>","more":"<h1 id=\"API-Gateway-Authorizer\"><a href=\"#API-Gateway-Authorizer\" class=\"headerlink\" title=\"API Gateway - Authorizer\"></a>API Gateway - Authorizer</h1><ul>\n<li><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html\" target=\"_blank\" rel=\"noopener\">官方文件</a></li>\n</ul>\n<p>擁有 Authorizer 的一個 Serverless 服務會長這樣:</p>\n<blockquote>\n<p>User Request - [Authorizer] - API - Response user</p>\n</blockquote>\n<p>好處除了前言所提到的前處理外，還有如果設定是 <code>Edge</code> 模式 (不是透過 <code>region</code> 從網路層傳) 的話其實在認證完後傳到 API 時速度是很快的。</p>\n<p>以下就開始好好的介紹它 😆</p>\n<h2 id=\"實際的位置\"><a href=\"#實際的位置\" class=\"headerlink\" title=\"實際的位置\"></a>實際的位置</h2><p>如果在這邊設定覺得不知道在哪邊的話可以參考 - <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/\" target=\"_blank\" rel=\"noopener\">純手動用法官方教學</a></p>\n<p>中文的話左邊名為<code>授權方</code>，英文則是<code>Authorizer</code><br><img src=\"https://i.imgur.com/v2vflgw.png\" alt=\"API Gateway Authorizer\"></p>\n<h2 id=\"Serverless-實作\"><a href=\"#Serverless-實作\" class=\"headerlink\" title=\"Serverless 實作\"></a>Serverless 實作</h2><h3 id=\"Yaml-settings\"><a href=\"#Yaml-settings\" class=\"headerlink\" title=\"Yaml settings\"></a>Yaml settings</h3><p>原始如果串接 python WSGI 的話設定檔應該會長得如下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>設定 Authorizer Lambda function，先在跟 <code>api</code> 同層加上 <code>Authorizer</code> Lambda，指定 handler 為 <code>handler 資料夾</code>下的 <code>authorizer.py</code> 的 <code>auth_handler</code> function，並且設定 <code>cors</code> 為 true，避免呼叫 api 時被 AWS 擋下來無法使用。</p>\n<p>接著在把 <code>events</code> 裡的兩個事件加上 <code>authorizer</code> 的 Function，名為 <code>ResourceAuthorizer</code>，改編過後入下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">          method:</span> <span class=\"string\">ANY</span></span><br><span class=\"line\"><span class=\"attr\">          authorizer:</span> <span class=\"string\">ResourceAuthorizer</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span></span><br><span class=\"line\"><span class=\"attr\">          path:</span> <span class=\"string\">/&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">          method:</span> <span class=\"string\">ANY</span></span><br><span class=\"line\"><span class=\"attr\">          authorizer:</span> <span class=\"string\">ResourceAuthorizer</span></span><br><span class=\"line\"><span class=\"attr\">  ResourceAuthorizer:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">handler/authorizer.auth_handler</span></span><br><span class=\"line\"><span class=\"attr\">    cors:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>這部分參考來自 <a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway/#http-endpoints-with-custom-authorizers\" target=\"_blank\" rel=\"noopener\">Serverless docs</a></li>\n</ul>\n<blockquote>\n<p>只要透過簡單的設定 function 就可以互相溝通是不是很像 docker compose 呀 😏</p>\n</blockquote>\n<h2 id=\"處理-Lambda-function-handler\"><a href=\"#處理-Lambda-function-handler\" class=\"headerlink\" title=\"處理 Lambda function handler\"></a>處理 Lambda function handler</h2><p><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L15\" target=\"_blank\" rel=\"noopener\">參考並複製官方的範例程式</a>會看到我的開頭要從 <code>event</code> 取得 token:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">event_token = event.get(<span class=\"string\">'authorizationToken'</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🐛🐛 這裡雖然是取 <code>authorizationToken</code>，不過呼叫 api 時 header 是要帶 <code>Authorization</code>，如此一來 Api gateway 才會收到對的值，這邊是需要注意 AWS 比較不一樣的地方！<br><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L17\" target=\"_blank\" rel=\"noopener\">參考支援在這啦 QQ</a></p>\n</blockquote>\n<p>取得 token 後一般就會做身份驗證的部分，以我的例子來說我就是解 JWT 下來做驗證，這邊為了 Demo 就先不處理它。</p>\n<h2 id=\"產生-Auth-Policy\"><a href=\"#產生-Auth-Policy\" class=\"headerlink\" title=\"產生 Auth Policy\"></a>產生 Auth Policy</h2><p>官方提供的範例版本是 Node.js[<a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html#api-gateway-lambda-authorizer-request-lambda-function-create\" target=\"_blank\" rel=\"noopener\">參考資料</a>]，但畢竟我們是用 python 看著 javascript 我怎麼用啊！！</p>\n<p>因此查了一番找到了範例: <a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints\" target=\"_blank\" rel=\"noopener\">aws-apigateway-lambda-authorizer-blueprints</a>，只是說沒有任何文件使用起來只能靠本能了 😭，這邊他很佛心的提供 <code>dotnet</code>、<code>golang</code>、<code>python</code>、<code>java</code>、<code>node.js</code>以及 <code>rust</code> 的範例，基本上常在 Serverless 上跑的語言都有了，就只好放過它一馬了 😇</p>\n<p>基本上從官方的範例終止需要改寫成像<a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py\" target=\"_blank\" rel=\"noopener\">我專案這樣</a>只要注意 <code>auth_handler</code> 裡面的內容需要填什麼即可。</p>\n<p>其他需要注意的就如<a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L25\" target=\"_blank\" rel=\"noopener\">第 25 行的 policy</a>以及 <a href=\"https://github.com/louis70109/aws-serverless-authorizer/blob/master/handler/authorizer.py#L28\" target=\"_blank\" rel=\"noopener\">28 行的 build policy</a>所產出的東西需要確認清楚才行:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">policy.allowAllMethods()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Finally, build the policy</span></span><br><span class=\"line\">authResponse = policy.build()</span><br></pre></td></tr></table></figure>\n\n<p>而下面的 class code 就可以先忽略不管，因為那些官方是為了產生出 Authorizer 回應狀態 pattern 所使用的 code，即便我們去改也出不了什麼作用:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HttpVerb</span>:</span></span><br><span class=\"line\">    GET = <span class=\"string\">\"GET\"</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AuthPolicy</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    awsAccountId = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    ...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Lambda-回應狀態\"><a href=\"#Lambda-回應狀態\" class=\"headerlink\" title=\"Lambda 回應狀態\"></a>Lambda 回應狀態</h2><p>Authorizer 認證成功之後 Lambda 會回傳給 API Gateway 的 pattern：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Version\"</span>: <span class=\"string\">\"2012-10-17\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"Statement\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Action\"</span>: <span class=\"string\">\"execute-api:Invoke\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Effect\"</span>: <span class=\"string\">\"Allow\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Resource\"</span>: <span class=\"string\">\"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>認證失敗回傳的樣子:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Version\"</span>: <span class=\"string\">\"2012-10-17\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"Statement\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Action\"</span>: <span class=\"string\">\"execute-api:Invoke\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Effect\"</span>: <span class=\"string\">\"Deny\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"Resource\"</span>: <span class=\"string\">\"arn:aws:execute-api:us-east-1:123456789012:ivdtdhp7b5/ESTestInvoke-stage/GET/\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>這些都會是透過 AuthPolicy 來產生的，直接對 Function return value 是部會作用的。</p>\n</blockquote>\n<h1 id=\"使用心得-踩坑\"><a href=\"#使用心得-踩坑\" class=\"headerlink\" title=\"使用心得 (踩坑)\"></a>使用心得 (踩坑)</h1><ul>\n<li>Header 收的名稱是 <code>Authorization</code>，但程式是收<code>authorizationToken</code>，<a href>參考</a>。</li>\n<li>只能 raise Exception(‘Unauthorized’)，多一字少一字都不行，真的很奇怪，<a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L29\" target=\"_blank\" rel=\"noopener\">參考</a>。</li>\n<li>好不容易找到的範例預設是會先 <code>deny</code> 掉使用者，但這在測行為會很困擾，<a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/blob/master/blueprints/python/api-gateway-authorizer-python.py#L52\" target=\"_blank\" rel=\"noopener\">官方範例 code</a>。</li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>以往都要使用框架(Flask, Django…)裡提供的功能實作 middleware 來做處理，但若使用像 AWS、Google、Azure 他們 Serverless 服務的話不妨使用 Authorizer 來做驗證，除了認證使用者以外還可以藉由這些 Function Service 來降低 API 的負載，讓它們可以更專心地處理後端邏輯的問題。</p>\n<blockquote>\n<p>如果真的很想知道 Authorizer 的行為機制的話可以看看這篇官方文件 - <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html\" target=\"_blank\" rel=\"noopener\">使用 postman 去測試 authorizer</a></p>\n</blockquote>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-from-example.html\" target=\"_blank\" rel=\"noopener\">純手動用法官方教學</a></p>\n</li>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html\" target=\"_blank\" rel=\"noopener\">AWS Authorizer Official Document</a></p>\n</li>\n<li><p><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/call-api-with-api-gateway-lambda-authorization.html\" target=\"_blank\" rel=\"noopener\">使用 postman 去測試 authorizer</a></p>\n</li>\n<li><p><a href=\"https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints\" target=\"_blank\" rel=\"noopener\">範例 aws-apigateway-lambda-authorizer-blueprints</a></p>\n</li>\n<li><p><a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway#http-endpoints-with-custom-authorizers\" target=\"_blank\" rel=\"noopener\">Serverless Docs settings</a></p>\n</li>\n</ul>"},{"title":"【SQL】如何在 pgAdmin 上使用 DDL 快速初始化資料表","abbrlink":2631350634,"date":"2020-06-06T03:51:57.000Z","_content":"\n\n# 前言\n\n當接觸到 PostgreSQL 後 pgAdmin 應該是最常被找到的一個免費 GUI 工具，雖然因為是網站的緣故，很多體驗與桌面版稍嫌落差(跟 postwomen 之餘 postman 一樣)，但今天會告訴大家一個滿好用的功能 - `DDL`，而 DDL 在其他工具上(如 Navicat)上就讓我找不到地方使用，接著就帶大家認識一下 `DDL` 並透過 `pgAdmin` 講解使用的過程 🙂\n\n<!-- more -->\n\n# 流程\n\n接下來文章會按照下圖的步驟去說明：\n\n```puml\n@startuml\nleft to right direction\nskinparam packageStyle rectangle\nactor user\nrectangle Container {\n  user -- (pgAdmin)\n  (pgAdmin) .> (PostgreSQL)\n}\n(pgAdmin) --> (Create table): [1]\n(pgAdmin) --> (Find & save DDL): [2]\n(pgAdmin) --> (Drop table): [3]\n(pgAdmin) --> (Use DDL to create Table): [4]\n@enduml\n```\n\n# What is DDL?\n\n簡單來說 `資料定義語言`（Data Definition Language，DDL）是屬於 DBMS 語言的一種，用於定義 DB schema，且 DBMS 內基本上都有 DDL 編譯器 (complier) 能夠處理 DDL，而它是由 CREATE、ALTER 與 DROP 三個語法所組成。\n\n> 參考來自 [wiki](https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%AE%9A%E7%BE%A9%E8%AA%9E%E8%A8%80)\n\n# 操作環境\n\n以下是我操作的環境，使用 docker-compose 幫我架起 `postgreSQL` & `pgAdmin`。\n\n- MacOS\n- Docker\n  - pgAdmin\n  - PostgreSQL\n  - [參考範例](https://github.com/louis70109/postgresql-pgAdmin)\n\n# 步驟介紹\n\n## 1. 建立範例 Table\n\n首先先到 pgAdmin 中，建立一個新的 Table\n![](https://i.imgur.com/5lq8eip.png)\n\n建立一個範例的 Item table\n![](https://i.imgur.com/NvDIicH.png)\n\n再來是 Book table\n![](https://i.imgur.com/qdmIQCE.png)\n\n簡單加個 Item 的外鍵 (Foreign Key)\n![](https://i.imgur.com/XoQai7x.png)\n\n## 2. 找出 DDL\n\n接著就要開始找 DDL 啦！透過 `CREATE SCRIPT` 來找我們要的 DDL 腳本\n![](https://i.imgur.com/kYoWCTgl.png)\n\n儲存 `Item` & `Book` 的內容 (存成`.sql` 或是任一文字檔案)\n![](https://i.imgur.com/5Br3HkM.png)\n\n### 注意事項\n\n在前面的範例中 id 使用 流水號(`serial`)，它存在於 `Sequences` 的地方，所以千萬要記得將它一併帶出後儲存起來：\n![](https://i.imgur.com/d9jRfBil.png)\n\n否則會遇到以下問題:\n\n```\nERROR:  relation \"Book_id_seq\" does not exist\nSQL state: 42P01\n```\n\n---\n\n## 3. 將範例 Item & Book 刪除\n\n接著就把它刪除來做測試吧！\n![](https://i.imgur.com/phQ8AYvl.png)\n![](https://i.imgur.com/F6kVuYwl.png)\n\n## 4. 使用 DDL 將 Table 放回去\n\n在 `Public` 這個下拉式選單中`右鍵`就會看到 `CREATE SCRIPT` 的選項\n![](https://i.imgur.com/BS6wNXxl.png)\n\n把剛剛的 DDL 複製過來，記得要先讓 Sequence 先進去接著才是 Table\n\n抑或是可以將兩個組裝在一起，先把 Sequence 放在前面，其中一個範例如下:\n\n```\n-- SEQUENCE: public.Item_id_seq\n\nCREATE SEQUENCE public.\"Item_id_seq\"\n    INCREMENT 1\n    START 1\n    MINVALUE 1\n    MAXVALUE 2147483647\n    CACHE 1;\n\nALTER SEQUENCE public.\"Item_id_seq\"\n    OWNER TO postgres;\n\n\n-- Table: public.Item\n\nCREATE TABLE public.\"Item\"\n(\n    id integer NOT NULL DEFAULT nextval('\"Item_id_seq1\"'::regclass),\n    title character varying(100) COLLATE pg_catalog.\"default\",\n    description text COLLATE pg_catalog.\"default\",\n    CONSTRAINT \"Item_pkey\" PRIMARY KEY (id)\n)\nWITH (\n    OIDS = FALSE\n)\nTABLESPACE pg_default;\n\nALTER TABLE public.\"Item\"\n    OWNER to postgres;\n```\n\n將 `Sequence` 以及 `Table` 的 DDL 組在一起建立就能省掉一個步驟，之後的 Table 使用情境也會雷同，若照著步驟做有出現錯誤時，請記得檢查使用否`順序`有問題。\n\n# 結論\n\n在建置初期也許只有一個 staging，但隨著專案規模變大之後就會分 production、develop、beta、QA 等等的環境，而在建置環境時使用 DDL 這樣的功能也能避免部署人員失誤出錯，例如將欄位長度輸入錯(長度 100 -> 199)，當然如果連複製都能錯那就...😅，總之在專案中放入一個 schema 的資料夾放入這些 DDL 在部署到其他環境時能夠更快速處理這部分。\n","source":"_posts/【SQL】如何在-pgAdmin-上使用-DDL-快速初始化資料表.md","raw":"---\ntitle: 【SQL】如何在 pgAdmin 上使用 DDL 快速初始化資料表\ntags:\n  - PostgreSQL\n  - pgAdmin\n  - SQL\n  - DDL\ncategories: SQL\nabbrlink: 2631350634\ndate: 2020-06-06 11:51:57\n---\n\n\n# 前言\n\n當接觸到 PostgreSQL 後 pgAdmin 應該是最常被找到的一個免費 GUI 工具，雖然因為是網站的緣故，很多體驗與桌面版稍嫌落差(跟 postwomen 之餘 postman 一樣)，但今天會告訴大家一個滿好用的功能 - `DDL`，而 DDL 在其他工具上(如 Navicat)上就讓我找不到地方使用，接著就帶大家認識一下 `DDL` 並透過 `pgAdmin` 講解使用的過程 🙂\n\n<!-- more -->\n\n# 流程\n\n接下來文章會按照下圖的步驟去說明：\n\n```puml\n@startuml\nleft to right direction\nskinparam packageStyle rectangle\nactor user\nrectangle Container {\n  user -- (pgAdmin)\n  (pgAdmin) .> (PostgreSQL)\n}\n(pgAdmin) --> (Create table): [1]\n(pgAdmin) --> (Find & save DDL): [2]\n(pgAdmin) --> (Drop table): [3]\n(pgAdmin) --> (Use DDL to create Table): [4]\n@enduml\n```\n\n# What is DDL?\n\n簡單來說 `資料定義語言`（Data Definition Language，DDL）是屬於 DBMS 語言的一種，用於定義 DB schema，且 DBMS 內基本上都有 DDL 編譯器 (complier) 能夠處理 DDL，而它是由 CREATE、ALTER 與 DROP 三個語法所組成。\n\n> 參考來自 [wiki](https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%AE%9A%E7%BE%A9%E8%AA%9E%E8%A8%80)\n\n# 操作環境\n\n以下是我操作的環境，使用 docker-compose 幫我架起 `postgreSQL` & `pgAdmin`。\n\n- MacOS\n- Docker\n  - pgAdmin\n  - PostgreSQL\n  - [參考範例](https://github.com/louis70109/postgresql-pgAdmin)\n\n# 步驟介紹\n\n## 1. 建立範例 Table\n\n首先先到 pgAdmin 中，建立一個新的 Table\n![](https://i.imgur.com/5lq8eip.png)\n\n建立一個範例的 Item table\n![](https://i.imgur.com/NvDIicH.png)\n\n再來是 Book table\n![](https://i.imgur.com/qdmIQCE.png)\n\n簡單加個 Item 的外鍵 (Foreign Key)\n![](https://i.imgur.com/XoQai7x.png)\n\n## 2. 找出 DDL\n\n接著就要開始找 DDL 啦！透過 `CREATE SCRIPT` 來找我們要的 DDL 腳本\n![](https://i.imgur.com/kYoWCTgl.png)\n\n儲存 `Item` & `Book` 的內容 (存成`.sql` 或是任一文字檔案)\n![](https://i.imgur.com/5Br3HkM.png)\n\n### 注意事項\n\n在前面的範例中 id 使用 流水號(`serial`)，它存在於 `Sequences` 的地方，所以千萬要記得將它一併帶出後儲存起來：\n![](https://i.imgur.com/d9jRfBil.png)\n\n否則會遇到以下問題:\n\n```\nERROR:  relation \"Book_id_seq\" does not exist\nSQL state: 42P01\n```\n\n---\n\n## 3. 將範例 Item & Book 刪除\n\n接著就把它刪除來做測試吧！\n![](https://i.imgur.com/phQ8AYvl.png)\n![](https://i.imgur.com/F6kVuYwl.png)\n\n## 4. 使用 DDL 將 Table 放回去\n\n在 `Public` 這個下拉式選單中`右鍵`就會看到 `CREATE SCRIPT` 的選項\n![](https://i.imgur.com/BS6wNXxl.png)\n\n把剛剛的 DDL 複製過來，記得要先讓 Sequence 先進去接著才是 Table\n\n抑或是可以將兩個組裝在一起，先把 Sequence 放在前面，其中一個範例如下:\n\n```\n-- SEQUENCE: public.Item_id_seq\n\nCREATE SEQUENCE public.\"Item_id_seq\"\n    INCREMENT 1\n    START 1\n    MINVALUE 1\n    MAXVALUE 2147483647\n    CACHE 1;\n\nALTER SEQUENCE public.\"Item_id_seq\"\n    OWNER TO postgres;\n\n\n-- Table: public.Item\n\nCREATE TABLE public.\"Item\"\n(\n    id integer NOT NULL DEFAULT nextval('\"Item_id_seq1\"'::regclass),\n    title character varying(100) COLLATE pg_catalog.\"default\",\n    description text COLLATE pg_catalog.\"default\",\n    CONSTRAINT \"Item_pkey\" PRIMARY KEY (id)\n)\nWITH (\n    OIDS = FALSE\n)\nTABLESPACE pg_default;\n\nALTER TABLE public.\"Item\"\n    OWNER to postgres;\n```\n\n將 `Sequence` 以及 `Table` 的 DDL 組在一起建立就能省掉一個步驟，之後的 Table 使用情境也會雷同，若照著步驟做有出現錯誤時，請記得檢查使用否`順序`有問題。\n\n# 結論\n\n在建置初期也許只有一個 staging，但隨著專案規模變大之後就會分 production、develop、beta、QA 等等的環境，而在建置環境時使用 DDL 這樣的功能也能避免部署人員失誤出錯，例如將欄位長度輸入錯(長度 100 -> 199)，當然如果連複製都能錯那就...😅，總之在專案中放入一個 schema 的資料夾放入這些 DDL 在部署到其他環境時能夠更快速處理這部分。\n","slug":"【SQL】如何在-pgAdmin-上使用-DDL-快速初始化資料表","published":1,"updated":"2020-06-19T14:03:58.873Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lg005d7cripw8lc81s","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>當接觸到 PostgreSQL 後 pgAdmin 應該是最常被找到的一個免費 GUI 工具，雖然因為是網站的緣故，很多體驗與桌面版稍嫌落差(跟 postwomen 之餘 postman 一樣)，但今天會告訴大家一個滿好用的功能 - <code>DDL</code>，而 DDL 在其他工具上(如 Navicat)上就讓我找不到地方使用，接著就帶大家認識一下 <code>DDL</code> 並透過 <code>pgAdmin</code> 講解使用的過程 🙂</p>\n<a id=\"more\"></a>\n\n<h1 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h1><p>接下來文章會按照下圖的步驟去說明：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMjY2cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo1MTlweDtoZWlnaHQ6MjY2cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTkgMjY2IiB3aWR0aD0iNTE5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjF2Zm1nbGYzbmNvcTEiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PCEtLU1ENT1bOGUxY2EyMzRlNjdjMmQ4YmZjMGYyOTZjYTAwNzdmZDddCmNsdXN0ZXIgQ29udGFpbmVyLS0+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgaGVpZ2h0PSIxNDUiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1NSIgeD0iODMiIHk9IjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNzkiIHg9IjEyMSIgeT0iMjIuOTk1MSI+Q29udGFpbmVyPC90ZXh0PjxlbGxpcHNlIGN4PSIxNjAuNDYxOSIgY3k9IjEyMi4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjF2Zm1nbGYzbmNvcTEpIiByeD0iNDguOTYxOSIgcnk9IjE0LjUyMzYiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY1IiB4PSIxMjcuOTYxOSIgeT0iMTI2LjY3MjEiPnBnQWRtaW48L3RleHQ+PGVsbGlwc2UgY3g9IjE2MC41MTQzIiBjeT0iNTguMjAyOSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjYxLjUxNDMiIHJ5PSIxNC43MDI5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMTE4LjUxNDMiIHk9IjYyLjg1MTMiPlBvc3RncmVTUUw8L3RleHQ+PCEtLU1ENT1bOGZjMzUyMmE0M2Y4YzcxOTlkZjVlMDllNWJiMDE4OGVdCmVudGl0eSB1c2VyLS0+PGVsbGlwc2UgY3g9IjIxIiBjeT0iOTEiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMXZmbWdsZjNuY29xMSkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHBhdGggZD0iTTIxLDk5IEwyMSwxMjYgTTgsMTA3IEwzNCwxMDcgTTIxLDEyNiBMOCwxNDEgTTIxLDEyNiBMMzQsMTQxICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzAiIHg9IjYiIHk9IjE1OS40OTUxIj51c2VyPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDMuMDc1MiIgY3k9IjIxLjIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjY0LjA3NTIiIHJ5PSIxNS4yMTUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjkxIiB4PSIzNTcuNTc1MiIgeT0iMjUuODYzNSI+Q3JlYXRlIHRhYmxlPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDIuOTcxMSIgY3k9Ijg4LjA5NDIiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMXZmbWdsZjNuY29xMSkiIHJ4PSI3My40NzExIiByeT0iMTcuMDk0MiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTE1IiB4PSIzNDUuNDcxMSIgeT0iOTIuNzQyNyI+RmluZCAmYW1wOyBzYXZlIERETDwvdGV4dD48ZWxsaXBzZSBjeD0iNDAzLjE1NDMiIGN5PSIxNTUuMDIzNiIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjU4LjE1NDMiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI3OCIgeD0iMzY0LjE1NDMiIHk9IjE1OS42NzIxIj5Ecm9wIHRhYmxlPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDMuMDY3MyIgY3k9IjIyNy4yMTM1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjF2Zm1nbGYzbmNvcTEpIiByeD0iOTkuMDY3MyIgcnk9IjIyLjIxMzUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE3NCIgeD0iMzE2LjA2NzMiIHk9IjIzMS44NjE5Ij5Vc2UgRERMIHRvIGNyZWF0ZSBUYWJsZTwvdGV4dD48IS0tTUQ1PVs2ZjUyYjEyZWE0MWM1NGJmZTUzZGViOGE5ZTkyMzVhOV0KbGluayB1c2VyIHRvIHBnQWRtaW4tLT48cGF0aCBkPSJNMzYuMTk3LDEyMiBDNTMuODMxMSwxMjIgODQuODI5MywxMjIgMTExLjMzMiwxMjIgIiBmaWxsPSJub25lIiBpZD0idXNlci1wZ0FkbWluIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVs5M2FiNWNkYzU3YWI5ZjVlZGU3OTYyZTEwOTA2YzYxNl0KbGluayBwZ0FkbWluIHRvIFBvc3RncmVTUUwtLT48cGF0aCBkPSJNMTYwLjUsMTA3LjUgQzE2MC41LDk3LjYyMSAxNjAuNSw4Ny43NDEgMTYwLjUsNzcuODYyICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O1Bvc3RncmVTUUwiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyBzdHJva2UtZGFzaGFycmF5OiA3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTYwLjUsNzIuNjk1LDE1Ni41LDgxLjY5NSwxNjAuNSw3Ny42OTUsMTY0LjUsODEuNjk1LDE2MC41LDcyLjY5NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PCEtLU1ENT1bMzA1OTUwYTY1NTcyMzI3MmRiYzhkZWUzZmI4OTg5YWZdCmxpbmsgcGdBZG1pbiB0byBDcmVhdGUgdGFibGUtLT48cGF0aCBkPSJNMTk3LjIwNiwxMTIuMjA2IEMyMTIuOTAzLDEwNi45ODMgMjMxLjExMiw5OS42MjEgMjQ2LDkwIEMyNTAuMjIzLDg3LjI3MSAyNDkuOTkxLDg1LjAzNSAyNTQsODIgQzI3NC4zMDcsNjYuNjI4IDI4MC43Miw2NC4zMzEgMzA0LDU0IEMzMjAuODA0LDQ2LjU0MyAzMzkuODQ2LDM5Ljc3MSAzNTYuNjQ3LDM0LjMzICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O0NyZWF0ZSB0YWJsZSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzNjEuNzg0LDMyLjY4NSwzNTEuOTkyNywzMS42MjIxLDM1Ny4wMjI1LDM0LjIxMDcsMzU0LjQzMzksMzkuMjQwNiwzNjEuNzg0LDMyLjY4NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iNjQuMDY2OSI+WzFdPC90ZXh0PjwhLS1NRDU9W2Q1MDhiZjIxNzIwOTY2MGExNWE2OWNiOGExYzUwMjBmXQpsaW5rIHBnQWRtaW4gdG8gRmluZCAmIHNhdmUgRERMLS0+PHBhdGggZD0iTTIwNS4wNTMsMTE1Ljg0MyBDMjQxLjIxNCwxMTAuNzMxIDI5My4yNTUsMTAzLjM3MyAzMzQuNzYyLDk3LjUwNiAiIGZpbGw9Im5vbmUiIGlkPSJwZ0FkbWluLSZndDtGaW5kICZhbXA7IHNhdmUgRERMIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMzOS43Nyw5Ni43OTgsMzMwLjI5ODYsOTQuMDk3NiwzMzQuODE5Myw5Ny40OTgxLDMzMS40MTg3LDEwMi4wMTg4LDMzOS43Nyw5Ni43OTgiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE4IiB4PSIyNTUiIHk9IjEwMy4wNjY5Ij5bMl08L3RleHQ+PCEtLU1ENT1bNTFmNTE3OGZkMTJkZjg2M2MyODAwMjViNzk2YzY1OTJdCmxpbmsgcGdBZG1pbiB0byBEcm9wIHRhYmxlLS0+PHBhdGggZD0iTTE5My4yMDYsMTMyLjgzNyBDMjEwLjg4MSwxMzguMzg4IDIzMy40MTcsMTQ0LjY2NSAyNTQsMTQ4IEMyODEuODUyLDE1Mi41MTI5IDMxMy4wMDcsMTU0LjQ0MzYgMzM5LjUyMSwxNTUuMTc2NSAiIGZpbGw9Im5vbmUiIGlkPSJwZ0FkbWluLSZndDtEcm9wIHRhYmxlIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM0NC43NiwxNTUuMzA3NSwzMzUuODYyMiwxNTEuMDg1LDMzOS43NjE1LDE1NS4xODMyLDMzNS42NjM0LDE1OS4wODI1LDM0NC43NiwxNTUuMzA3NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iMTQ0LjA2NjkiPlszXTwvdGV4dD48IS0tTUQ1PVs4MTcxOWVlYWU4NDc2MjJlMGI4ZWZiNzYyMTZhYTk0N10KbGluayBwZ0FkbWluIHRvIFVzZSBEREwgdG8gY3JlYXRlIFRhYmxlLS0+PHBhdGggZD0iTTE4MS44NjcsMTM1LjExMyBDMjAwLjIzOSwxNDYuNTg4IDIyOC4yNDksMTYzLjIxODUgMjU0LDE3NSBDMjgxLjE2MSwxODcuNDI2OSAzMTIuMjEzLDE5OC43NSAzMzguODM4LDIwNy42MzQ0ICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O1VzZSBEREwgdG8gY3JlYXRlIFRhYmxlIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM0My43NTYsMjA5LjI2NDYsMzM2LjQ3MTMsMjAyLjYzNjQsMzM5LjAwOTgsMjA3LjY5MTcsMzMzLjk1NDYsMjEwLjIzMDMsMzQzLjc1NiwyMDkuMjY0NiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iMTcxLjA2NjkiPls0XTwvdGV4dD48IS0tTUQ1PVs2OTNkZTE5NDJmZWRjOWIxZDMzMTQxNmFhNGEwMTMxN10KQHN0YXJ0dW1sDQpsZWZ0IHRvIHJpZ2h0IGRpcmVjdGlvbg0Kc2tpbnBhcmFtIHBhY2thZ2VTdHlsZSByZWN0YW5nbGUNCmFjdG9yIHVzZXINCnJlY3RhbmdsZSBDb250YWluZXIgew0KICB1c2VyIC0gLSAocGdBZG1pbikNCiAgKHBnQWRtaW4pIC4+IChQb3N0Z3JlU1FMKQ0KfQ0KKHBnQWRtaW4pIC0gLT4gKENyZWF0ZSB0YWJsZSk6IFsxXQ0KKHBnQWRtaW4pIC0gLT4gKEZpbmQgJiBzYXZlIERETCk6IFsyXQ0KKHBnQWRtaW4pIC0gLT4gKERyb3AgdGFibGUpOiBbM10NCihwZ0FkbWluKSAtIC0+IChVc2UgRERMIHRvIGNyZWF0ZSBUYWJsZSk6IFs0XQ0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIwLjE1YmV0YTEoVW5rbm93biBjb21waWxlIHRpbWUpCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+\">\n\n<h1 id=\"What-is-DDL\"><a href=\"#What-is-DDL\" class=\"headerlink\" title=\"What is DDL?\"></a>What is DDL?</h1><p>簡單來說 <code>資料定義語言</code>（Data Definition Language，DDL）是屬於 DBMS 語言的一種，用於定義 DB schema，且 DBMS 內基本上都有 DDL 編譯器 (complier) 能夠處理 DDL，而它是由 CREATE、ALTER 與 DROP 三個語法所組成。</p>\n<blockquote>\n<p>參考來自 <a href=\"https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%AE%9A%E7%BE%A9%E8%AA%9E%E8%A8%80\" target=\"_blank\" rel=\"noopener\">wiki</a></p>\n</blockquote>\n<h1 id=\"操作環境\"><a href=\"#操作環境\" class=\"headerlink\" title=\"操作環境\"></a>操作環境</h1><p>以下是我操作的環境，使用 docker-compose 幫我架起 <code>postgreSQL</code> &amp; <code>pgAdmin</code>。</p>\n<ul>\n<li>MacOS</li>\n<li>Docker<ul>\n<li>pgAdmin</li>\n<li>PostgreSQL</li>\n<li><a href=\"https://github.com/louis70109/postgresql-pgAdmin\" target=\"_blank\" rel=\"noopener\">參考範例</a></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"步驟介紹\"><a href=\"#步驟介紹\" class=\"headerlink\" title=\"步驟介紹\"></a>步驟介紹</h1><h2 id=\"1-建立範例-Table\"><a href=\"#1-建立範例-Table\" class=\"headerlink\" title=\"1. 建立範例 Table\"></a>1. 建立範例 Table</h2><p>首先先到 pgAdmin 中，建立一個新的 Table<br><img src=\"https://i.imgur.com/5lq8eip.png\" alt></p>\n<p>建立一個範例的 Item table<br><img src=\"https://i.imgur.com/NvDIicH.png\" alt></p>\n<p>再來是 Book table<br><img src=\"https://i.imgur.com/qdmIQCE.png\" alt></p>\n<p>簡單加個 Item 的外鍵 (Foreign Key)<br><img src=\"https://i.imgur.com/XoQai7x.png\" alt></p>\n<h2 id=\"2-找出-DDL\"><a href=\"#2-找出-DDL\" class=\"headerlink\" title=\"2. 找出 DDL\"></a>2. 找出 DDL</h2><p>接著就要開始找 DDL 啦！透過 <code>CREATE SCRIPT</code> 來找我們要的 DDL 腳本<br><img src=\"https://i.imgur.com/kYoWCTgl.png\" alt></p>\n<p>儲存 <code>Item</code> &amp; <code>Book</code> 的內容 (存成<code>.sql</code> 或是任一文字檔案)<br><img src=\"https://i.imgur.com/5Br3HkM.png\" alt></p>\n<h3 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h3><p>在前面的範例中 id 使用 流水號(<code>serial</code>)，它存在於 <code>Sequences</code> 的地方，所以千萬要記得將它一併帶出後儲存起來：<br><img src=\"https://i.imgur.com/d9jRfBil.png\" alt></p>\n<p>否則會遇到以下問題:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR:  relation &quot;Book_id_seq&quot; does not exist</span><br><span class=\"line\">SQL state: 42P01</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"3-將範例-Item-amp-Book-刪除\"><a href=\"#3-將範例-Item-amp-Book-刪除\" class=\"headerlink\" title=\"3. 將範例 Item &amp; Book 刪除\"></a>3. 將範例 Item &amp; Book 刪除</h2><p>接著就把它刪除來做測試吧！<br><img src=\"https://i.imgur.com/phQ8AYvl.png\" alt><br><img src=\"https://i.imgur.com/F6kVuYwl.png\" alt></p>\n<h2 id=\"4-使用-DDL-將-Table-放回去\"><a href=\"#4-使用-DDL-將-Table-放回去\" class=\"headerlink\" title=\"4. 使用 DDL 將 Table 放回去\"></a>4. 使用 DDL 將 Table 放回去</h2><p>在 <code>Public</code> 這個下拉式選單中<code>右鍵</code>就會看到 <code>CREATE SCRIPT</code> 的選項<br><img src=\"https://i.imgur.com/BS6wNXxl.png\" alt></p>\n<p>把剛剛的 DDL 複製過來，記得要先讓 Sequence 先進去接著才是 Table</p>\n<p>抑或是可以將兩個組裝在一起，先把 Sequence 放在前面，其中一個範例如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-- SEQUENCE: public.Item_id_seq</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE SEQUENCE public.&quot;Item_id_seq&quot;</span><br><span class=\"line\">    INCREMENT 1</span><br><span class=\"line\">    START 1</span><br><span class=\"line\">    MINVALUE 1</span><br><span class=\"line\">    MAXVALUE 2147483647</span><br><span class=\"line\">    CACHE 1;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER SEQUENCE public.&quot;Item_id_seq&quot;</span><br><span class=\"line\">    OWNER TO postgres;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">-- Table: public.Item</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE TABLE public.&quot;Item&quot;</span><br><span class=\"line\">(</span><br><span class=\"line\">    id integer NOT NULL DEFAULT nextval(&apos;&quot;Item_id_seq1&quot;&apos;::regclass),</span><br><span class=\"line\">    title character varying(100) COLLATE pg_catalog.&quot;default&quot;,</span><br><span class=\"line\">    description text COLLATE pg_catalog.&quot;default&quot;,</span><br><span class=\"line\">    CONSTRAINT &quot;Item_pkey&quot; PRIMARY KEY (id)</span><br><span class=\"line\">)</span><br><span class=\"line\">WITH (</span><br><span class=\"line\">    OIDS = FALSE</span><br><span class=\"line\">)</span><br><span class=\"line\">TABLESPACE pg_default;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER TABLE public.&quot;Item&quot;</span><br><span class=\"line\">    OWNER to postgres;</span><br></pre></td></tr></table></figure>\n\n<p>將 <code>Sequence</code> 以及 <code>Table</code> 的 DDL 組在一起建立就能省掉一個步驟，之後的 Table 使用情境也會雷同，若照著步驟做有出現錯誤時，請記得檢查使用否<code>順序</code>有問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在建置初期也許只有一個 staging，但隨著專案規模變大之後就會分 production、develop、beta、QA 等等的環境，而在建置環境時使用 DDL 這樣的功能也能避免部署人員失誤出錯，例如將欄位長度輸入錯(長度 100 -&gt; 199)，當然如果連複製都能錯那就…😅，總之在專案中放入一個 schema 的資料夾放入這些 DDL 在部署到其他環境時能夠更快速處理這部分。</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>當接觸到 PostgreSQL 後 pgAdmin 應該是最常被找到的一個免費 GUI 工具，雖然因為是網站的緣故，很多體驗與桌面版稍嫌落差(跟 postwomen 之餘 postman 一樣)，但今天會告訴大家一個滿好用的功能 - <code>DDL</code>，而 DDL 在其他工具上(如 Navicat)上就讓我找不到地方使用，接著就帶大家認識一下 <code>DDL</code> 並透過 <code>pgAdmin</code> 講解使用的過程 🙂</p>","more":"<h1 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h1><p>接下來文章會按照下圖的步驟去說明：</p>\n<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMjY2cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo1MTlweDtoZWlnaHQ6MjY2cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTkgMjY2IiB3aWR0aD0iNTE5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZjF2Zm1nbGYzbmNvcTEiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PCEtLU1ENT1bOGUxY2EyMzRlNjdjMmQ4YmZjMGYyOTZjYTAwNzdmZDddCmNsdXN0ZXIgQ29udGFpbmVyLS0+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgaGVpZ2h0PSIxNDUiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1NSIgeD0iODMiIHk9IjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNzkiIHg9IjEyMSIgeT0iMjIuOTk1MSI+Q29udGFpbmVyPC90ZXh0PjxlbGxpcHNlIGN4PSIxNjAuNDYxOSIgY3k9IjEyMi4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjF2Zm1nbGYzbmNvcTEpIiByeD0iNDguOTYxOSIgcnk9IjE0LjUyMzYiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY1IiB4PSIxMjcuOTYxOSIgeT0iMTI2LjY3MjEiPnBnQWRtaW48L3RleHQ+PGVsbGlwc2UgY3g9IjE2MC41MTQzIiBjeT0iNTguMjAyOSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjYxLjUxNDMiIHJ5PSIxNC43MDI5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMTE4LjUxNDMiIHk9IjYyLjg1MTMiPlBvc3RncmVTUUw8L3RleHQ+PCEtLU1ENT1bOGZjMzUyMmE0M2Y4YzcxOTlkZjVlMDllNWJiMDE4OGVdCmVudGl0eSB1c2VyLS0+PGVsbGlwc2UgY3g9IjIxIiBjeT0iOTEiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMXZmbWdsZjNuY29xMSkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHBhdGggZD0iTTIxLDk5IEwyMSwxMjYgTTgsMTA3IEwzNCwxMDcgTTIxLDEyNiBMOCwxNDEgTTIxLDEyNiBMMzQsMTQxICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzAiIHg9IjYiIHk9IjE1OS40OTUxIj51c2VyPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDMuMDc1MiIgY3k9IjIxLjIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjY0LjA3NTIiIHJ5PSIxNS4yMTUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjkxIiB4PSIzNTcuNTc1MiIgeT0iMjUuODYzNSI+Q3JlYXRlIHRhYmxlPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDIuOTcxMSIgY3k9Ijg4LjA5NDIiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMXZmbWdsZjNuY29xMSkiIHJ4PSI3My40NzExIiByeT0iMTcuMDk0MiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTE1IiB4PSIzNDUuNDcxMSIgeT0iOTIuNzQyNyI+RmluZCAmYW1wOyBzYXZlIERETDwvdGV4dD48ZWxsaXBzZSBjeD0iNDAzLjE1NDMiIGN5PSIxNTUuMDIzNiIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxdmZtZ2xmM25jb3ExKSIgcng9IjU4LjE1NDMiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI3OCIgeD0iMzY0LjE1NDMiIHk9IjE1OS42NzIxIj5Ecm9wIHRhYmxlPC90ZXh0PjxlbGxpcHNlIGN4PSI0MDMuMDY3MyIgY3k9IjIyNy4yMTM1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjF2Zm1nbGYzbmNvcTEpIiByeD0iOTkuMDY3MyIgcnk9IjIyLjIxMzUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE3NCIgeD0iMzE2LjA2NzMiIHk9IjIzMS44NjE5Ij5Vc2UgRERMIHRvIGNyZWF0ZSBUYWJsZTwvdGV4dD48IS0tTUQ1PVs2ZjUyYjEyZWE0MWM1NGJmZTUzZGViOGE5ZTkyMzVhOV0KbGluayB1c2VyIHRvIHBnQWRtaW4tLT48cGF0aCBkPSJNMzYuMTk3LDEyMiBDNTMuODMxMSwxMjIgODQuODI5MywxMjIgMTExLjMzMiwxMjIgIiBmaWxsPSJub25lIiBpZD0idXNlci1wZ0FkbWluIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVs5M2FiNWNkYzU3YWI5ZjVlZGU3OTYyZTEwOTA2YzYxNl0KbGluayBwZ0FkbWluIHRvIFBvc3RncmVTUUwtLT48cGF0aCBkPSJNMTYwLjUsMTA3LjUgQzE2MC41LDk3LjYyMSAxNjAuNSw4Ny43NDEgMTYwLjUsNzcuODYyICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O1Bvc3RncmVTUUwiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyBzdHJva2UtZGFzaGFycmF5OiA3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTYwLjUsNzIuNjk1LDE1Ni41LDgxLjY5NSwxNjAuNSw3Ny42OTUsMTY0LjUsODEuNjk1LDE2MC41LDcyLjY5NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PCEtLU1ENT1bMzA1OTUwYTY1NTcyMzI3MmRiYzhkZWUzZmI4OTg5YWZdCmxpbmsgcGdBZG1pbiB0byBDcmVhdGUgdGFibGUtLT48cGF0aCBkPSJNMTk3LjIwNiwxMTIuMjA2IEMyMTIuOTAzLDEwNi45ODMgMjMxLjExMiw5OS42MjEgMjQ2LDkwIEMyNTAuMjIzLDg3LjI3MSAyNDkuOTkxLDg1LjAzNSAyNTQsODIgQzI3NC4zMDcsNjYuNjI4IDI4MC43Miw2NC4zMzEgMzA0LDU0IEMzMjAuODA0LDQ2LjU0MyAzMzkuODQ2LDM5Ljc3MSAzNTYuNjQ3LDM0LjMzICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O0NyZWF0ZSB0YWJsZSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzNjEuNzg0LDMyLjY4NSwzNTEuOTkyNywzMS42MjIxLDM1Ny4wMjI1LDM0LjIxMDcsMzU0LjQzMzksMzkuMjQwNiwzNjEuNzg0LDMyLjY4NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iNjQuMDY2OSI+WzFdPC90ZXh0PjwhLS1NRDU9W2Q1MDhiZjIxNzIwOTY2MGExNWE2OWNiOGExYzUwMjBmXQpsaW5rIHBnQWRtaW4gdG8gRmluZCAmIHNhdmUgRERMLS0+PHBhdGggZD0iTTIwNS4wNTMsMTE1Ljg0MyBDMjQxLjIxNCwxMTAuNzMxIDI5My4yNTUsMTAzLjM3MyAzMzQuNzYyLDk3LjUwNiAiIGZpbGw9Im5vbmUiIGlkPSJwZ0FkbWluLSZndDtGaW5kICZhbXA7IHNhdmUgRERMIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMzOS43Nyw5Ni43OTgsMzMwLjI5ODYsOTQuMDk3NiwzMzQuODE5Myw5Ny40OTgxLDMzMS40MTg3LDEwMi4wMTg4LDMzOS43Nyw5Ni43OTgiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE4IiB4PSIyNTUiIHk9IjEwMy4wNjY5Ij5bMl08L3RleHQ+PCEtLU1ENT1bNTFmNTE3OGZkMTJkZjg2M2MyODAwMjViNzk2YzY1OTJdCmxpbmsgcGdBZG1pbiB0byBEcm9wIHRhYmxlLS0+PHBhdGggZD0iTTE5My4yMDYsMTMyLjgzNyBDMjEwLjg4MSwxMzguMzg4IDIzMy40MTcsMTQ0LjY2NSAyNTQsMTQ4IEMyODEuODUyLDE1Mi41MTI5IDMxMy4wMDcsMTU0LjQ0MzYgMzM5LjUyMSwxNTUuMTc2NSAiIGZpbGw9Im5vbmUiIGlkPSJwZ0FkbWluLSZndDtEcm9wIHRhYmxlIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM0NC43NiwxNTUuMzA3NSwzMzUuODYyMiwxNTEuMDg1LDMzOS43NjE1LDE1NS4xODMyLDMzNS42NjM0LDE1OS4wODI1LDM0NC43NiwxNTUuMzA3NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iMTQ0LjA2NjkiPlszXTwvdGV4dD48IS0tTUQ1PVs4MTcxOWVlYWU4NDc2MjJlMGI4ZWZiNzYyMTZhYTk0N10KbGluayBwZ0FkbWluIHRvIFVzZSBEREwgdG8gY3JlYXRlIFRhYmxlLS0+PHBhdGggZD0iTTE4MS44NjcsMTM1LjExMyBDMjAwLjIzOSwxNDYuNTg4IDIyOC4yNDksMTYzLjIxODUgMjU0LDE3NSBDMjgxLjE2MSwxODcuNDI2OSAzMTIuMjEzLDE5OC43NSAzMzguODM4LDIwNy42MzQ0ICIgZmlsbD0ibm9uZSIgaWQ9InBnQWRtaW4tJmd0O1VzZSBEREwgdG8gY3JlYXRlIFRhYmxlIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM0My43NTYsMjA5LjI2NDYsMzM2LjQ3MTMsMjAyLjYzNjQsMzM5LjAwOTgsMjA3LjY5MTcsMzMzLjk1NDYsMjEwLjIzMDMsMzQzLjc1NiwyMDkuMjY0NiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTgiIHg9IjI1NSIgeT0iMTcxLjA2NjkiPls0XTwvdGV4dD48IS0tTUQ1PVs2OTNkZTE5NDJmZWRjOWIxZDMzMTQxNmFhNGEwMTMxN10KQHN0YXJ0dW1sDQpsZWZ0IHRvIHJpZ2h0IGRpcmVjdGlvbg0Kc2tpbnBhcmFtIHBhY2thZ2VTdHlsZSByZWN0YW5nbGUNCmFjdG9yIHVzZXINCnJlY3RhbmdsZSBDb250YWluZXIgew0KICB1c2VyIC0gLSAocGdBZG1pbikNCiAgKHBnQWRtaW4pIC4+IChQb3N0Z3JlU1FMKQ0KfQ0KKHBnQWRtaW4pIC0gLT4gKENyZWF0ZSB0YWJsZSk6IFsxXQ0KKHBnQWRtaW4pIC0gLT4gKEZpbmQgJiBzYXZlIERETCk6IFsyXQ0KKHBnQWRtaW4pIC0gLT4gKERyb3AgdGFibGUpOiBbM10NCihwZ0FkbWluKSAtIC0+IChVc2UgRERMIHRvIGNyZWF0ZSBUYWJsZSk6IFs0XQ0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIwLjE1YmV0YTEoVW5rbm93biBjb21waWxlIHRpbWUpCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+\">\n\n<h1 id=\"What-is-DDL\"><a href=\"#What-is-DDL\" class=\"headerlink\" title=\"What is DDL?\"></a>What is DDL?</h1><p>簡單來說 <code>資料定義語言</code>（Data Definition Language，DDL）是屬於 DBMS 語言的一種，用於定義 DB schema，且 DBMS 內基本上都有 DDL 編譯器 (complier) 能夠處理 DDL，而它是由 CREATE、ALTER 與 DROP 三個語法所組成。</p>\n<blockquote>\n<p>參考來自 <a href=\"https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%AE%9A%E7%BE%A9%E8%AA%9E%E8%A8%80\" target=\"_blank\" rel=\"noopener\">wiki</a></p>\n</blockquote>\n<h1 id=\"操作環境\"><a href=\"#操作環境\" class=\"headerlink\" title=\"操作環境\"></a>操作環境</h1><p>以下是我操作的環境，使用 docker-compose 幫我架起 <code>postgreSQL</code> &amp; <code>pgAdmin</code>。</p>\n<ul>\n<li>MacOS</li>\n<li>Docker<ul>\n<li>pgAdmin</li>\n<li>PostgreSQL</li>\n<li><a href=\"https://github.com/louis70109/postgresql-pgAdmin\" target=\"_blank\" rel=\"noopener\">參考範例</a></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"步驟介紹\"><a href=\"#步驟介紹\" class=\"headerlink\" title=\"步驟介紹\"></a>步驟介紹</h1><h2 id=\"1-建立範例-Table\"><a href=\"#1-建立範例-Table\" class=\"headerlink\" title=\"1. 建立範例 Table\"></a>1. 建立範例 Table</h2><p>首先先到 pgAdmin 中，建立一個新的 Table<br><img src=\"https://i.imgur.com/5lq8eip.png\" alt></p>\n<p>建立一個範例的 Item table<br><img src=\"https://i.imgur.com/NvDIicH.png\" alt></p>\n<p>再來是 Book table<br><img src=\"https://i.imgur.com/qdmIQCE.png\" alt></p>\n<p>簡單加個 Item 的外鍵 (Foreign Key)<br><img src=\"https://i.imgur.com/XoQai7x.png\" alt></p>\n<h2 id=\"2-找出-DDL\"><a href=\"#2-找出-DDL\" class=\"headerlink\" title=\"2. 找出 DDL\"></a>2. 找出 DDL</h2><p>接著就要開始找 DDL 啦！透過 <code>CREATE SCRIPT</code> 來找我們要的 DDL 腳本<br><img src=\"https://i.imgur.com/kYoWCTgl.png\" alt></p>\n<p>儲存 <code>Item</code> &amp; <code>Book</code> 的內容 (存成<code>.sql</code> 或是任一文字檔案)<br><img src=\"https://i.imgur.com/5Br3HkM.png\" alt></p>\n<h3 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h3><p>在前面的範例中 id 使用 流水號(<code>serial</code>)，它存在於 <code>Sequences</code> 的地方，所以千萬要記得將它一併帶出後儲存起來：<br><img src=\"https://i.imgur.com/d9jRfBil.png\" alt></p>\n<p>否則會遇到以下問題:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR:  relation &quot;Book_id_seq&quot; does not exist</span><br><span class=\"line\">SQL state: 42P01</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"3-將範例-Item-amp-Book-刪除\"><a href=\"#3-將範例-Item-amp-Book-刪除\" class=\"headerlink\" title=\"3. 將範例 Item &amp; Book 刪除\"></a>3. 將範例 Item &amp; Book 刪除</h2><p>接著就把它刪除來做測試吧！<br><img src=\"https://i.imgur.com/phQ8AYvl.png\" alt><br><img src=\"https://i.imgur.com/F6kVuYwl.png\" alt></p>\n<h2 id=\"4-使用-DDL-將-Table-放回去\"><a href=\"#4-使用-DDL-將-Table-放回去\" class=\"headerlink\" title=\"4. 使用 DDL 將 Table 放回去\"></a>4. 使用 DDL 將 Table 放回去</h2><p>在 <code>Public</code> 這個下拉式選單中<code>右鍵</code>就會看到 <code>CREATE SCRIPT</code> 的選項<br><img src=\"https://i.imgur.com/BS6wNXxl.png\" alt></p>\n<p>把剛剛的 DDL 複製過來，記得要先讓 Sequence 先進去接著才是 Table</p>\n<p>抑或是可以將兩個組裝在一起，先把 Sequence 放在前面，其中一個範例如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-- SEQUENCE: public.Item_id_seq</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE SEQUENCE public.&quot;Item_id_seq&quot;</span><br><span class=\"line\">    INCREMENT 1</span><br><span class=\"line\">    START 1</span><br><span class=\"line\">    MINVALUE 1</span><br><span class=\"line\">    MAXVALUE 2147483647</span><br><span class=\"line\">    CACHE 1;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER SEQUENCE public.&quot;Item_id_seq&quot;</span><br><span class=\"line\">    OWNER TO postgres;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">-- Table: public.Item</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE TABLE public.&quot;Item&quot;</span><br><span class=\"line\">(</span><br><span class=\"line\">    id integer NOT NULL DEFAULT nextval(&apos;&quot;Item_id_seq1&quot;&apos;::regclass),</span><br><span class=\"line\">    title character varying(100) COLLATE pg_catalog.&quot;default&quot;,</span><br><span class=\"line\">    description text COLLATE pg_catalog.&quot;default&quot;,</span><br><span class=\"line\">    CONSTRAINT &quot;Item_pkey&quot; PRIMARY KEY (id)</span><br><span class=\"line\">)</span><br><span class=\"line\">WITH (</span><br><span class=\"line\">    OIDS = FALSE</span><br><span class=\"line\">)</span><br><span class=\"line\">TABLESPACE pg_default;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER TABLE public.&quot;Item&quot;</span><br><span class=\"line\">    OWNER to postgres;</span><br></pre></td></tr></table></figure>\n\n<p>將 <code>Sequence</code> 以及 <code>Table</code> 的 DDL 組在一起建立就能省掉一個步驟，之後的 Table 使用情境也會雷同，若照著步驟做有出現錯誤時，請記得檢查使用否<code>順序</code>有問題。</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在建置初期也許只有一個 staging，但隨著專案規模變大之後就會分 production、develop、beta、QA 等等的環境，而在建置環境時使用 DDL 這樣的功能也能避免部署人員失誤出錯，例如將欄位長度輸入錯(長度 100 -&gt; 199)，當然如果連複製都能錯那就…😅，總之在專案中放入一個 schema 的資料夾放入這些 DDL 在部署到其他環境時能夠更快速處理這部分。</p>"},{"title":"【觀察系列-01】我認知的社群生態","abbrlink":738122234,"date":"2020-06-11T17:06:04.000Z","_content":"\n\n# 前言\n\n自從參與舉辦社群活動也一年多了，過往大多都是參加看大神表演為主，而自從開始處理社群後也認識很多負責人，在最近的待業中其實也思考了很多這類型的事，以下我就稍微整理我對於他們的看法以及推坑的文字。 ~~(誤)~~\n\n<!-- more -->\n\n# 介紹\n\n以我自身而立，常關注的就是 **核心型社群** 與 **應用型社群** 這兩種，基本上已經涵括大部分的社群，以下就稍微提一下我的看法。\n\n## 核心型社群\n\n我認為語言(Python、Ruby、Golang...)、Cloud Native、AI 演算法相關，至於為甚麼是這三個呢，稍微說明一下：\n\n### 語言(Python、Ruby、Golang...)\n\n基本上在研討會上最容易出現也最容易變成 Conference，原因在於通常都在討論**語言特性**、**底層實作**、**適用環境**...，當然還是會有許多相關應用實作的討論在裡面，但我認為前者佔比較大。\n\n像是以前在寫 Ruby 時，其實就很想去參加 **默默會**，給我的印象是前輩們很願意犧牲業餘的時間帶後輩們，讓整個學習環境變很棒，只可惜我身在台中一直沒機會參加，也許之後北上可以去當地與大家交流交流，學習不一樣的社群管理方式。\n\n以 Golang 來說，隨著越來越多產業加入這個語言，風潮感覺有點像之前的 Ruby on Rails，只是這語言的好處就是他是靜態語言，且因為檔案會編譯成靜態檔，所以應用程式是可跨平台。雖然我還沒機會去參加社群就換語言了，但從在學 Golang 時其實就一直有在參考社群前輩們的文章，在這之後其實很多人持續分享相關應用、語言特性的文章，自己是認為社群風格是很開放的，只要你願意分享，這邊都會提供舞台給你。\n\n## Cloud Native\n\n我覺得 Cloud Native 就橫跨兩個這兩種類型，若是提到 kernel 相關實作(Linux、Kubernetes、Docker...)、防火牆如何實現等等那就屬於核心系列，而若是架構、Load balance、打造環境等等就會屬於應用類型。\n\n話說以前碩班時其實也都在研究相關技能，只是當時對於整個生態根本不熟，且台中也沒社群，想學或找人問時其實都沒相關資源，後來找工作就只好往 coding 這塊去了，也因為做 Backend 系列的工作接觸到 Cloud 才有一種回家的感覺 😆，只是有好多東西都需要再複習，甚至可以說是重學了 😭，期待去台北工作後可以參加社群～\n\n## AI 相關\n\n老實說我只去過一場，因為以前有聽人家說過 NLP 相關，因此就選擇台中的社群參加，我自己認為提到 AI 相關就一定要看論文了解自己關注的項目背後演算法是如何操作，並且透過數學定理去優化它們，曾經也想過想要去研究，但這裡水太深了，還是留給高手們來好了 😆。\n\n## 核心型小結\n\n若今天想對相關技能要更深入研究時，勢必一定會碰到類似上述例子中的環境，我認為這部分時常沒有特定解答，大多都是當下的最佳解(概念很像解演算法)，當在這個環境裡面時勢必是很孤獨的(高手總是孤獨)，參加社群與大家交流也許你的問題別人已經解過，透過交流可以讓你趕快釐清~~這淌混水(誤)~~你當前遇到的問題！\n\n# 應用型社群\n\n我覺得這系列大致上的宗旨就是：「你用了這個技術去解決的什麼事情。」，以下就介紹兩個我關注的社群。\n\n## Chatbot\n\nLINE 在台灣崛起之後陸續有很多開發者開發相關的 chatbot (如 卡米狗)，隨著時間的演進我也加入社群中。\n\n我認為像是 Chatbot 的入門門檻其實相較於核心型並不算高，你只要用過特定平台(FaceBook、LINE、Telegram)你應該就會用過人家自動回覆的服務，像在此社群中就會有多輪對話、抽獎、看直播、查天氣...超多的應用，在這裡其實大家就是激發想法並分享點子，也許會在某些時刻創造出商機，透過不同點子的分享也就會讓我們社群越來越活絡。\n\n若是游走在前端、後端不定的朋友，其實不妨可以來 Chatbot Developer Taiwan 走走，因為 Chatbot 並不是一個單純的後端服務...\n\n## GDG (Google Developer Group)\n\n> ~~其實大多時都去噌吃的~~\n\n第一次參加時(2018)其實是為了看保哥秀 Angular 的技能(簡單說看神表演)，在當時大會中就聽到各種不一樣雲端的應用與情境，實在是琳琅滿目！\n\n我覺得雲端對於剛踏入程式領域一兩年的人來說應該會有點錯愕，為什麼這個有、那個他們也有，我應該用什麼服務才對？ 之類的問題，若是接觸像是 AWS、Google、Azure 這類的雲服務時，應該先可以手動打造一個完整的線上服務(如 購物車)，當打造完時參加社群問其他人應該怎麼改進，也許會收到類似的答案：\n\n- 使用者登入你可以用 Firebase 去記錄步驟，分析使用者有沒有完成註冊。\n- 購物車內的內容放在 NoSQL 中，放在資料庫太浪費空間了。\n- 網址有用 CDN 嗎？不然載入會變很慢喔！\n\n當收到以上的問題時，開始 google 後其實就會找到相對應的資源，收集問題後一步一步找對應的服務，串接上你的購物車，當 issue 解決掉時不僅你的購物車完整度超高，且你也學到雲端相關的技能，此時再去 GDG 分享你的成果，同時也可以滿足你的成就感呢！\n\n## 應用型小結\n\n畢竟人在世就是來解決問題，也許當下工作你並不會用到這個技能，但若哪天你上司希望用這服務建出**商業邏輯**時，又這麼剛好你都會，這豈不就發達的時候了？在現在資訊爆炸時代當然我們都需要廣學，在學習路程中若有個社群幫忙，其實會讓你在這坑坑的路上走得更順。\n\n> 一個人走走得快，一群人走走得遠。\n\n# 結論\n\n不管哪個社群，其實就是大家用了特定技術來解決某些大家都在意的問題，進而形成這個社群，也許你的工作上有點失意，沒關係來社群大家一起取暖(誤)，很多朋友都會覺得是要大神才可以去，錯了！其實透過分享技術學最多的就是分享本人，別以為你這個技能沒什麼而不分享，也許就剛好你對面的朋友他也遇到這個問題，那分享出來不就一起解決對方的問題了嗎？或許你現在還不知道參加什麼社群好，那就來參加 2020 的 COSCUP 吧，上面有很多精彩的議程讓你聽爆！🎉\n","source":"_posts/【觀察系列-01】我認知的社群生態.md","raw":"---\ntitle: 【觀察系列-01】我認知的社群生態\ntags:\n  - 核心型\n  - 應用型\n  - 社群\n  - 學習\ncategories: 觀察系列\nabbrlink: 738122234\ndate: 2020-06-12 01:06:04\n---\n\n\n# 前言\n\n自從參與舉辦社群活動也一年多了，過往大多都是參加看大神表演為主，而自從開始處理社群後也認識很多負責人，在最近的待業中其實也思考了很多這類型的事，以下我就稍微整理我對於他們的看法以及推坑的文字。 ~~(誤)~~\n\n<!-- more -->\n\n# 介紹\n\n以我自身而立，常關注的就是 **核心型社群** 與 **應用型社群** 這兩種，基本上已經涵括大部分的社群，以下就稍微提一下我的看法。\n\n## 核心型社群\n\n我認為語言(Python、Ruby、Golang...)、Cloud Native、AI 演算法相關，至於為甚麼是這三個呢，稍微說明一下：\n\n### 語言(Python、Ruby、Golang...)\n\n基本上在研討會上最容易出現也最容易變成 Conference，原因在於通常都在討論**語言特性**、**底層實作**、**適用環境**...，當然還是會有許多相關應用實作的討論在裡面，但我認為前者佔比較大。\n\n像是以前在寫 Ruby 時，其實就很想去參加 **默默會**，給我的印象是前輩們很願意犧牲業餘的時間帶後輩們，讓整個學習環境變很棒，只可惜我身在台中一直沒機會參加，也許之後北上可以去當地與大家交流交流，學習不一樣的社群管理方式。\n\n以 Golang 來說，隨著越來越多產業加入這個語言，風潮感覺有點像之前的 Ruby on Rails，只是這語言的好處就是他是靜態語言，且因為檔案會編譯成靜態檔，所以應用程式是可跨平台。雖然我還沒機會去參加社群就換語言了，但從在學 Golang 時其實就一直有在參考社群前輩們的文章，在這之後其實很多人持續分享相關應用、語言特性的文章，自己是認為社群風格是很開放的，只要你願意分享，這邊都會提供舞台給你。\n\n## Cloud Native\n\n我覺得 Cloud Native 就橫跨兩個這兩種類型，若是提到 kernel 相關實作(Linux、Kubernetes、Docker...)、防火牆如何實現等等那就屬於核心系列，而若是架構、Load balance、打造環境等等就會屬於應用類型。\n\n話說以前碩班時其實也都在研究相關技能，只是當時對於整個生態根本不熟，且台中也沒社群，想學或找人問時其實都沒相關資源，後來找工作就只好往 coding 這塊去了，也因為做 Backend 系列的工作接觸到 Cloud 才有一種回家的感覺 😆，只是有好多東西都需要再複習，甚至可以說是重學了 😭，期待去台北工作後可以參加社群～\n\n## AI 相關\n\n老實說我只去過一場，因為以前有聽人家說過 NLP 相關，因此就選擇台中的社群參加，我自己認為提到 AI 相關就一定要看論文了解自己關注的項目背後演算法是如何操作，並且透過數學定理去優化它們，曾經也想過想要去研究，但這裡水太深了，還是留給高手們來好了 😆。\n\n## 核心型小結\n\n若今天想對相關技能要更深入研究時，勢必一定會碰到類似上述例子中的環境，我認為這部分時常沒有特定解答，大多都是當下的最佳解(概念很像解演算法)，當在這個環境裡面時勢必是很孤獨的(高手總是孤獨)，參加社群與大家交流也許你的問題別人已經解過，透過交流可以讓你趕快釐清~~這淌混水(誤)~~你當前遇到的問題！\n\n# 應用型社群\n\n我覺得這系列大致上的宗旨就是：「你用了這個技術去解決的什麼事情。」，以下就介紹兩個我關注的社群。\n\n## Chatbot\n\nLINE 在台灣崛起之後陸續有很多開發者開發相關的 chatbot (如 卡米狗)，隨著時間的演進我也加入社群中。\n\n我認為像是 Chatbot 的入門門檻其實相較於核心型並不算高，你只要用過特定平台(FaceBook、LINE、Telegram)你應該就會用過人家自動回覆的服務，像在此社群中就會有多輪對話、抽獎、看直播、查天氣...超多的應用，在這裡其實大家就是激發想法並分享點子，也許會在某些時刻創造出商機，透過不同點子的分享也就會讓我們社群越來越活絡。\n\n若是游走在前端、後端不定的朋友，其實不妨可以來 Chatbot Developer Taiwan 走走，因為 Chatbot 並不是一個單純的後端服務...\n\n## GDG (Google Developer Group)\n\n> ~~其實大多時都去噌吃的~~\n\n第一次參加時(2018)其實是為了看保哥秀 Angular 的技能(簡單說看神表演)，在當時大會中就聽到各種不一樣雲端的應用與情境，實在是琳琅滿目！\n\n我覺得雲端對於剛踏入程式領域一兩年的人來說應該會有點錯愕，為什麼這個有、那個他們也有，我應該用什麼服務才對？ 之類的問題，若是接觸像是 AWS、Google、Azure 這類的雲服務時，應該先可以手動打造一個完整的線上服務(如 購物車)，當打造完時參加社群問其他人應該怎麼改進，也許會收到類似的答案：\n\n- 使用者登入你可以用 Firebase 去記錄步驟，分析使用者有沒有完成註冊。\n- 購物車內的內容放在 NoSQL 中，放在資料庫太浪費空間了。\n- 網址有用 CDN 嗎？不然載入會變很慢喔！\n\n當收到以上的問題時，開始 google 後其實就會找到相對應的資源，收集問題後一步一步找對應的服務，串接上你的購物車，當 issue 解決掉時不僅你的購物車完整度超高，且你也學到雲端相關的技能，此時再去 GDG 分享你的成果，同時也可以滿足你的成就感呢！\n\n## 應用型小結\n\n畢竟人在世就是來解決問題，也許當下工作你並不會用到這個技能，但若哪天你上司希望用這服務建出**商業邏輯**時，又這麼剛好你都會，這豈不就發達的時候了？在現在資訊爆炸時代當然我們都需要廣學，在學習路程中若有個社群幫忙，其實會讓你在這坑坑的路上走得更順。\n\n> 一個人走走得快，一群人走走得遠。\n\n# 結論\n\n不管哪個社群，其實就是大家用了特定技術來解決某些大家都在意的問題，進而形成這個社群，也許你的工作上有點失意，沒關係來社群大家一起取暖(誤)，很多朋友都會覺得是要大神才可以去，錯了！其實透過分享技術學最多的就是分享本人，別以為你這個技能沒什麼而不分享，也許就剛好你對面的朋友他也遇到這個問題，那分享出來不就一起解決對方的問題了嗎？或許你現在還不知道參加什麼社群好，那就來參加 2020 的 COSCUP 吧，上面有很多精彩的議程讓你聽爆！🎉\n","slug":"【觀察系列-01】我認知的社群生態","published":1,"updated":"2020-06-19T14:03:58.875Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31li005i7criqc75bneh","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>自從參與舉辦社群活動也一年多了，過往大多都是參加看大神表演為主，而自從開始處理社群後也認識很多負責人，在最近的待業中其實也思考了很多這類型的事，以下我就稍微整理我對於他們的看法以及推坑的文字。 <del>(誤)</del></p>\n<a id=\"more\"></a>\n\n<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以我自身而立，常關注的就是 <strong>核心型社群</strong> 與 <strong>應用型社群</strong> 這兩種，基本上已經涵括大部分的社群，以下就稍微提一下我的看法。</p>\n<h2 id=\"核心型社群\"><a href=\"#核心型社群\" class=\"headerlink\" title=\"核心型社群\"></a>核心型社群</h2><p>我認為語言(Python、Ruby、Golang…)、Cloud Native、AI 演算法相關，至於為甚麼是這三個呢，稍微說明一下：</p>\n<h3 id=\"語言-Python、Ruby、Golang…\"><a href=\"#語言-Python、Ruby、Golang…\" class=\"headerlink\" title=\"語言(Python、Ruby、Golang…)\"></a>語言(Python、Ruby、Golang…)</h3><p>基本上在研討會上最容易出現也最容易變成 Conference，原因在於通常都在討論<strong>語言特性</strong>、<strong>底層實作</strong>、<strong>適用環境</strong>…，當然還是會有許多相關應用實作的討論在裡面，但我認為前者佔比較大。</p>\n<p>像是以前在寫 Ruby 時，其實就很想去參加 <strong>默默會</strong>，給我的印象是前輩們很願意犧牲業餘的時間帶後輩們，讓整個學習環境變很棒，只可惜我身在台中一直沒機會參加，也許之後北上可以去當地與大家交流交流，學習不一樣的社群管理方式。</p>\n<p>以 Golang 來說，隨著越來越多產業加入這個語言，風潮感覺有點像之前的 Ruby on Rails，只是這語言的好處就是他是靜態語言，且因為檔案會編譯成靜態檔，所以應用程式是可跨平台。雖然我還沒機會去參加社群就換語言了，但從在學 Golang 時其實就一直有在參考社群前輩們的文章，在這之後其實很多人持續分享相關應用、語言特性的文章，自己是認為社群風格是很開放的，只要你願意分享，這邊都會提供舞台給你。</p>\n<h2 id=\"Cloud-Native\"><a href=\"#Cloud-Native\" class=\"headerlink\" title=\"Cloud Native\"></a>Cloud Native</h2><p>我覺得 Cloud Native 就橫跨兩個這兩種類型，若是提到 kernel 相關實作(Linux、Kubernetes、Docker…)、防火牆如何實現等等那就屬於核心系列，而若是架構、Load balance、打造環境等等就會屬於應用類型。</p>\n<p>話說以前碩班時其實也都在研究相關技能，只是當時對於整個生態根本不熟，且台中也沒社群，想學或找人問時其實都沒相關資源，後來找工作就只好往 coding 這塊去了，也因為做 Backend 系列的工作接觸到 Cloud 才有一種回家的感覺 😆，只是有好多東西都需要再複習，甚至可以說是重學了 😭，期待去台北工作後可以參加社群～</p>\n<h2 id=\"AI-相關\"><a href=\"#AI-相關\" class=\"headerlink\" title=\"AI 相關\"></a>AI 相關</h2><p>老實說我只去過一場，因為以前有聽人家說過 NLP 相關，因此就選擇台中的社群參加，我自己認為提到 AI 相關就一定要看論文了解自己關注的項目背後演算法是如何操作，並且透過數學定理去優化它們，曾經也想過想要去研究，但這裡水太深了，還是留給高手們來好了 😆。</p>\n<h2 id=\"核心型小結\"><a href=\"#核心型小結\" class=\"headerlink\" title=\"核心型小結\"></a>核心型小結</h2><p>若今天想對相關技能要更深入研究時，勢必一定會碰到類似上述例子中的環境，我認為這部分時常沒有特定解答，大多都是當下的最佳解(概念很像解演算法)，當在這個環境裡面時勢必是很孤獨的(高手總是孤獨)，參加社群與大家交流也許你的問題別人已經解過，透過交流可以讓你趕快釐清<del>這淌混水(誤)</del>你當前遇到的問題！</p>\n<h1 id=\"應用型社群\"><a href=\"#應用型社群\" class=\"headerlink\" title=\"應用型社群\"></a>應用型社群</h1><p>我覺得這系列大致上的宗旨就是：「你用了這個技術去解決的什麼事情。」，以下就介紹兩個我關注的社群。</p>\n<h2 id=\"Chatbot\"><a href=\"#Chatbot\" class=\"headerlink\" title=\"Chatbot\"></a>Chatbot</h2><p>LINE 在台灣崛起之後陸續有很多開發者開發相關的 chatbot (如 卡米狗)，隨著時間的演進我也加入社群中。</p>\n<p>我認為像是 Chatbot 的入門門檻其實相較於核心型並不算高，你只要用過特定平台(FaceBook、LINE、Telegram)你應該就會用過人家自動回覆的服務，像在此社群中就會有多輪對話、抽獎、看直播、查天氣…超多的應用，在這裡其實大家就是激發想法並分享點子，也許會在某些時刻創造出商機，透過不同點子的分享也就會讓我們社群越來越活絡。</p>\n<p>若是游走在前端、後端不定的朋友，其實不妨可以來 Chatbot Developer Taiwan 走走，因為 Chatbot 並不是一個單純的後端服務…</p>\n<h2 id=\"GDG-Google-Developer-Group\"><a href=\"#GDG-Google-Developer-Group\" class=\"headerlink\" title=\"GDG (Google Developer Group)\"></a>GDG (Google Developer Group)</h2><blockquote>\n<p><del>其實大多時都去噌吃的</del></p>\n</blockquote>\n<p>第一次參加時(2018)其實是為了看保哥秀 Angular 的技能(簡單說看神表演)，在當時大會中就聽到各種不一樣雲端的應用與情境，實在是琳琅滿目！</p>\n<p>我覺得雲端對於剛踏入程式領域一兩年的人來說應該會有點錯愕，為什麼這個有、那個他們也有，我應該用什麼服務才對？ 之類的問題，若是接觸像是 AWS、Google、Azure 這類的雲服務時，應該先可以手動打造一個完整的線上服務(如 購物車)，當打造完時參加社群問其他人應該怎麼改進，也許會收到類似的答案：</p>\n<ul>\n<li>使用者登入你可以用 Firebase 去記錄步驟，分析使用者有沒有完成註冊。</li>\n<li>購物車內的內容放在 NoSQL 中，放在資料庫太浪費空間了。</li>\n<li>網址有用 CDN 嗎？不然載入會變很慢喔！</li>\n</ul>\n<p>當收到以上的問題時，開始 google 後其實就會找到相對應的資源，收集問題後一步一步找對應的服務，串接上你的購物車，當 issue 解決掉時不僅你的購物車完整度超高，且你也學到雲端相關的技能，此時再去 GDG 分享你的成果，同時也可以滿足你的成就感呢！</p>\n<h2 id=\"應用型小結\"><a href=\"#應用型小結\" class=\"headerlink\" title=\"應用型小結\"></a>應用型小結</h2><p>畢竟人在世就是來解決問題，也許當下工作你並不會用到這個技能，但若哪天你上司希望用這服務建出<strong>商業邏輯</strong>時，又這麼剛好你都會，這豈不就發達的時候了？在現在資訊爆炸時代當然我們都需要廣學，在學習路程中若有個社群幫忙，其實會讓你在這坑坑的路上走得更順。</p>\n<blockquote>\n<p>一個人走走得快，一群人走走得遠。</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>不管哪個社群，其實就是大家用了特定技術來解決某些大家都在意的問題，進而形成這個社群，也許你的工作上有點失意，沒關係來社群大家一起取暖(誤)，很多朋友都會覺得是要大神才可以去，錯了！其實透過分享技術學最多的就是分享本人，別以為你這個技能沒什麼而不分享，也許就剛好你對面的朋友他也遇到這個問題，那分享出來不就一起解決對方的問題了嗎？或許你現在還不知道參加什麼社群好，那就來參加 2020 的 COSCUP 吧，上面有很多精彩的議程讓你聽爆！🎉</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>自從參與舉辦社群活動也一年多了，過往大多都是參加看大神表演為主，而自從開始處理社群後也認識很多負責人，在最近的待業中其實也思考了很多這類型的事，以下我就稍微整理我對於他們的看法以及推坑的文字。 <del>(誤)</del></p>","more":"<h1 id=\"介紹\"><a href=\"#介紹\" class=\"headerlink\" title=\"介紹\"></a>介紹</h1><p>以我自身而立，常關注的就是 <strong>核心型社群</strong> 與 <strong>應用型社群</strong> 這兩種，基本上已經涵括大部分的社群，以下就稍微提一下我的看法。</p>\n<h2 id=\"核心型社群\"><a href=\"#核心型社群\" class=\"headerlink\" title=\"核心型社群\"></a>核心型社群</h2><p>我認為語言(Python、Ruby、Golang…)、Cloud Native、AI 演算法相關，至於為甚麼是這三個呢，稍微說明一下：</p>\n<h3 id=\"語言-Python、Ruby、Golang…\"><a href=\"#語言-Python、Ruby、Golang…\" class=\"headerlink\" title=\"語言(Python、Ruby、Golang…)\"></a>語言(Python、Ruby、Golang…)</h3><p>基本上在研討會上最容易出現也最容易變成 Conference，原因在於通常都在討論<strong>語言特性</strong>、<strong>底層實作</strong>、<strong>適用環境</strong>…，當然還是會有許多相關應用實作的討論在裡面，但我認為前者佔比較大。</p>\n<p>像是以前在寫 Ruby 時，其實就很想去參加 <strong>默默會</strong>，給我的印象是前輩們很願意犧牲業餘的時間帶後輩們，讓整個學習環境變很棒，只可惜我身在台中一直沒機會參加，也許之後北上可以去當地與大家交流交流，學習不一樣的社群管理方式。</p>\n<p>以 Golang 來說，隨著越來越多產業加入這個語言，風潮感覺有點像之前的 Ruby on Rails，只是這語言的好處就是他是靜態語言，且因為檔案會編譯成靜態檔，所以應用程式是可跨平台。雖然我還沒機會去參加社群就換語言了，但從在學 Golang 時其實就一直有在參考社群前輩們的文章，在這之後其實很多人持續分享相關應用、語言特性的文章，自己是認為社群風格是很開放的，只要你願意分享，這邊都會提供舞台給你。</p>\n<h2 id=\"Cloud-Native\"><a href=\"#Cloud-Native\" class=\"headerlink\" title=\"Cloud Native\"></a>Cloud Native</h2><p>我覺得 Cloud Native 就橫跨兩個這兩種類型，若是提到 kernel 相關實作(Linux、Kubernetes、Docker…)、防火牆如何實現等等那就屬於核心系列，而若是架構、Load balance、打造環境等等就會屬於應用類型。</p>\n<p>話說以前碩班時其實也都在研究相關技能，只是當時對於整個生態根本不熟，且台中也沒社群，想學或找人問時其實都沒相關資源，後來找工作就只好往 coding 這塊去了，也因為做 Backend 系列的工作接觸到 Cloud 才有一種回家的感覺 😆，只是有好多東西都需要再複習，甚至可以說是重學了 😭，期待去台北工作後可以參加社群～</p>\n<h2 id=\"AI-相關\"><a href=\"#AI-相關\" class=\"headerlink\" title=\"AI 相關\"></a>AI 相關</h2><p>老實說我只去過一場，因為以前有聽人家說過 NLP 相關，因此就選擇台中的社群參加，我自己認為提到 AI 相關就一定要看論文了解自己關注的項目背後演算法是如何操作，並且透過數學定理去優化它們，曾經也想過想要去研究，但這裡水太深了，還是留給高手們來好了 😆。</p>\n<h2 id=\"核心型小結\"><a href=\"#核心型小結\" class=\"headerlink\" title=\"核心型小結\"></a>核心型小結</h2><p>若今天想對相關技能要更深入研究時，勢必一定會碰到類似上述例子中的環境，我認為這部分時常沒有特定解答，大多都是當下的最佳解(概念很像解演算法)，當在這個環境裡面時勢必是很孤獨的(高手總是孤獨)，參加社群與大家交流也許你的問題別人已經解過，透過交流可以讓你趕快釐清<del>這淌混水(誤)</del>你當前遇到的問題！</p>\n<h1 id=\"應用型社群\"><a href=\"#應用型社群\" class=\"headerlink\" title=\"應用型社群\"></a>應用型社群</h1><p>我覺得這系列大致上的宗旨就是：「你用了這個技術去解決的什麼事情。」，以下就介紹兩個我關注的社群。</p>\n<h2 id=\"Chatbot\"><a href=\"#Chatbot\" class=\"headerlink\" title=\"Chatbot\"></a>Chatbot</h2><p>LINE 在台灣崛起之後陸續有很多開發者開發相關的 chatbot (如 卡米狗)，隨著時間的演進我也加入社群中。</p>\n<p>我認為像是 Chatbot 的入門門檻其實相較於核心型並不算高，你只要用過特定平台(FaceBook、LINE、Telegram)你應該就會用過人家自動回覆的服務，像在此社群中就會有多輪對話、抽獎、看直播、查天氣…超多的應用，在這裡其實大家就是激發想法並分享點子，也許會在某些時刻創造出商機，透過不同點子的分享也就會讓我們社群越來越活絡。</p>\n<p>若是游走在前端、後端不定的朋友，其實不妨可以來 Chatbot Developer Taiwan 走走，因為 Chatbot 並不是一個單純的後端服務…</p>\n<h2 id=\"GDG-Google-Developer-Group\"><a href=\"#GDG-Google-Developer-Group\" class=\"headerlink\" title=\"GDG (Google Developer Group)\"></a>GDG (Google Developer Group)</h2><blockquote>\n<p><del>其實大多時都去噌吃的</del></p>\n</blockquote>\n<p>第一次參加時(2018)其實是為了看保哥秀 Angular 的技能(簡單說看神表演)，在當時大會中就聽到各種不一樣雲端的應用與情境，實在是琳琅滿目！</p>\n<p>我覺得雲端對於剛踏入程式領域一兩年的人來說應該會有點錯愕，為什麼這個有、那個他們也有，我應該用什麼服務才對？ 之類的問題，若是接觸像是 AWS、Google、Azure 這類的雲服務時，應該先可以手動打造一個完整的線上服務(如 購物車)，當打造完時參加社群問其他人應該怎麼改進，也許會收到類似的答案：</p>\n<ul>\n<li>使用者登入你可以用 Firebase 去記錄步驟，分析使用者有沒有完成註冊。</li>\n<li>購物車內的內容放在 NoSQL 中，放在資料庫太浪費空間了。</li>\n<li>網址有用 CDN 嗎？不然載入會變很慢喔！</li>\n</ul>\n<p>當收到以上的問題時，開始 google 後其實就會找到相對應的資源，收集問題後一步一步找對應的服務，串接上你的購物車，當 issue 解決掉時不僅你的購物車完整度超高，且你也學到雲端相關的技能，此時再去 GDG 分享你的成果，同時也可以滿足你的成就感呢！</p>\n<h2 id=\"應用型小結\"><a href=\"#應用型小結\" class=\"headerlink\" title=\"應用型小結\"></a>應用型小結</h2><p>畢竟人在世就是來解決問題，也許當下工作你並不會用到這個技能，但若哪天你上司希望用這服務建出<strong>商業邏輯</strong>時，又這麼剛好你都會，這豈不就發達的時候了？在現在資訊爆炸時代當然我們都需要廣學，在學習路程中若有個社群幫忙，其實會讓你在這坑坑的路上走得更順。</p>\n<blockquote>\n<p>一個人走走得快，一群人走走得遠。</p>\n</blockquote>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>不管哪個社群，其實就是大家用了特定技術來解決某些大家都在意的問題，進而形成這個社群，也許你的工作上有點失意，沒關係來社群大家一起取暖(誤)，很多朋友都會覺得是要大神才可以去，錯了！其實透過分享技術學最多的就是分享本人，別以為你這個技能沒什麼而不分享，也許就剛好你對面的朋友他也遇到這個問題，那分享出來不就一起解決對方的問題了嗎？或許你現在還不知道參加什麼社群好，那就來參加 2020 的 COSCUP 吧，上面有很多精彩的議程讓你聽爆！🎉</p>"},{"title":"使用 Serverless/Flask/Swagger 在 AWS 上搭建打造 Open API","abbrlink":1373457857,"date":"2020-05-05T09:09:39.000Z","_content":"\n\n![](https://i.imgur.com/2UI8Ggs.png)\n\n# 前言\n\n約在一年前，當時公司的同事帶我玩過 Swagger，只是當時的我寫得不太習慣，直到寫這篇之前都還只是寫 markdown 來做 API 文件 😓，不過寫 API 到最後總是要開放給其他人需要測試以及用文件來描述功能，但只是寫 Readme.md 給其他人看感覺有點不負責任 (?)，所以這個時候 Swagger 就發揮它的作用啦～\n\n但是看著下面這張圖…\n![](https://i.imgur.com/zg1jEuy.png)\n左邊那是怎樣！怎麼設定了一大堆右邊才出現一點點東西，估且不論還要設定 Model、Payload 什麼的，我想光寫左邊這份文件加測試的時間我都可以寫一份 Markdown 給其他同仁用 Postman 測試了…🤣🤣🤣\n這時候套件就出動啦，這次要介紹的是 flask-restful-swagger-2.0，他是延續原版套件並加以更新的，不得不說再搭更新完後整體寫起來人性多了，像是文先寫法用 decorator 的寫法在路由之前、宣告 Schema 時只要用類別包起來之類的，讓寫文件可以用 python 的寫法去寫，除了特殊的設定需要比對 Swagger 官方文件外，在建一個 Swagger 格式的文件這樣已經超快了 💪\n既然如此那就介紹一下他的相關設定並把它記錄下來吧！\n\n<!-- more -->\n\n若對 Serverless + WSGI +flask 還不清楚的話可以參考我之前[寫的文章](https://medium.com/@nijia.lin/%E7%BA%8C%E7%AF%87-serverless-wsgi-flask-chatbot-%E7%9A%84%E9%96%8B%E7%99%BC%E6%8C%87%E5%8D%97-f11de7dee7aa)\n\n<!-- more -->\n\n> 這次的範例已經放在 Github 上面，建議可以 Clone 下來邊看會比較清楚，若想要比較 flask-restful 套件生成的版本差異的朋友可以[參考分支 — Original](https://github.com/louis70109/aws-swagger-wsgi-flask)\n\n# api.py 設定\n\n一般來說，如果有用 flask_restful 套件的話會有以下兩行：\n\n```\nfrom flask_restful import Api\napi = Api(app)\n```\n\n這次因為需要引入 swagger，將程式替代成以下：\n\n```\nfrom flask_restful_swagger_2 import Api\napi = Api(app,\n    host=\"localhost:5000\",\n    schemes=['http'],\n   # schemes=['https'],\n   # base_path='/dev',\n    security_definitions=security,\n    security=[{'appKey': []}],\n    api_version='0.01',\n    api_spec_url='/api/swagger')\n```\n\n- host: 在本地端起的預設 port 為 5000 (部署上 AWS 後需要替換掉)\n\n> host 在此處可以先註解，設定此項目是如果需要使用 swagger-codegen 來產生相對應的 library 時，所需對應的 host\n\n- schemes: host 的協定 (部署後需要改成 https)\n- base_path: 一般 API 都會有 /v1、/v2 的版本號可以用在此處，而 serverless 部署上後則會有 /dev\n- security_definitions: 若在 call API 之前需要 OAuth 或是一般的 key 的話則在此地方設定\n- security: 設定完之後要在此告訴 swagger 要啟動這個 key\n- api_version: 使用者定義的版本號\n- api_sepc_url: swagger.json 輸出的路由\n\n> 在 sls deploy 之後需要將 host、schemes 以及 bash_path 改成部署完的設定\n\n# 設定 Swagger Model\n\n接著看到 controller/todos_controller.py，裡頭宣告了三個 Swagger model：\n\n- BasicTodosModel\n- QueryTodos\n- CreateTodos\n\n![](https://i.imgur.com/fg9Slabm.png)\n\n---\n\n![](https://i.imgur.com/njcsd9Im.png)\n\n---\n\n![](https://i.imgur.com/Dsw6Djmm.png)\n\n1. 定義了 Todos 的基本格式，兩個欄位都為字串且是必填欄位；\n2. 取資料後回傳的 schema，由於回傳時我習慣加個 result 的 key，且因為是取所有的 Todo，所以需要定義為 array，並按照 swagger 格式若為 array 則需要加入 items 的 key，value 則是放入原本定義好的 model 即可；\n3. 在建立完後的 schema，但由於只需要回傳 dictionary，所以直接指定即可。\n\n![](https://i.imgur.com/as5blSM.png)\n\n# Swagger 文件本體\n\n<script src=\"https://gist.github.com/louis70109/2b6e2d571e1ff558196e23eb1f3c4fe5.js\"></script>\n\n接著就來講解這次的主角身上的哪些特殊技能需要注意的，首先先看到第四行的部分，security 是來定義這個 method 需要用到哪個 authorize key，如果有用到兩種以上可以像是以下定義：\n\n```\n'security': [{\"appKey\": []}, {\"otherKey\": []}]\n```\n\n如此一來這個路由右邊又會有鎖頭 🔒 的選項，當 Authorize 過後才會鎖上。\n\n![](https://i.imgur.com/fLOprLT.png)\n\n接著看到第 8 行，這是定義當回傳成功 (200) 之後所對應的 Model，在上述已經設定過 Class 了，這邊就引入並跟 example 對應是不是自己想要的輸出\n\n以 Todos 的 Get 路由為例，我希望回傳值是由 result 包 Todo’s llist，點選 Model 就可以看到設定的 Model 的格式是不是有用陣列框起來。\n![](https://i.imgur.com/ehH5P7E.png)\n\n此時可以輸入以下指令啟動：\n\n```\nsls wsgi serve\n```\n\n並在 https://petstore.swagger.io/ 這個網址裡的輸入欄填上 http://localhost:5000/api/swagger.json 並按下 Explore 看一下自己的 API 有沒有問題。\n\n# 部署上 AWS\n\n在本地端玩那麼久了，接下來就是要部署上去啦，需要注意的是因為部署上去會有 https 以及 base_path 的問題，在本地端測試時的設定：\n\n```\napi = Api(app,\n schemes=[‘http’],\n security_definitions=security,\n security=[{‘appKey’: []}],\n api_version=’0.01',\n api_spec_url=’/api/swagger’)\n```\n\n由於預設為 dev 模式，在部署上的時候需要置換成以下內容：\n\n```\napi = Api(app,\n schemes=[‘https’],\n base_path=’/dev’,\n security_definitions=security,\n security=[{‘appKey’: []}],\n api_version=’0.01',\n api_spec_url=’/api/swagger’)\n```\n\n接著就部署上 AWS 嚕‼️\n\n```\nsls deploy\n```\n\n![](https://i.imgur.com/B3rdIHi.png)\n\n接著複製 endpoint 下來並在 dev 後面加上 /api/swagger.json，同時貼到 https://petstore.swagger.io/ 最上方的輸入欄位上就可以看到部署在 AWS 上的 Open API 囉！\n\n# 建立函式庫\n\n若是 Mac 的電腦可以使用以下指令 (其他的可以參考 [GitHub](https://github.com/swagger-api/swagger-codegen))：\n\n```\nbrew install swagger-codegen\n```\n\n接著再使用下列指令產生函式庫 (若不知道有支援什麼語言可以[參考官方](https://swagger.io/tools/swagger-codegen/))：\n\n```\nswagger-codegen generate -i https://{AWS_DOMAIN}/dev/api/swagger.json -l {language}\n```\n\n如此一來就可以把函式庫給對應的開發者使用，好處是大家的 code style 都是遵守 swagger 產生出來的格式，真的有問題就去解決當初產生這包 lib 的那位開發者 (咦？)。\n\n# 注意事項\n\n1. security 必須是 List 的 dictionary ([Issue](https://github.com/swagger-api/swagger-codegen/issues/7847#issuecomment-374512375))\n2. Schema 的 Model 在宣告巢狀時 type 為 array、需巢狀 Model 之前的 Key 為 items\n3. schemes 佈署上之前需要改成 https\n4. base_path 依照部署上的模式去設定，預設為 /dev\n5. 首次佈署上時不知道 domain，部署完之後把 domain 複製到 host 上在佈署一次，如此一來使用 swagger-codegen 產生函式庫套件的 configuration 網址就沒問題了。\n\n# 結論\n\n這次因為我的 API 需要給其他同事用而玩到 Swagger，剛好找到 [flask-restful-swagger-2.0](https://github.com/soerface/flask-restful-swagger-2.0) 這個套件讓我可以快速上手，並用 Swagger-Codegen 產生相依的 Library + 文件 讓其他的同事可以快速上手我的 API，讓我可以把心思都放在開發 API 上。接下來就是把 repository 弄到 CI 上，同時 Trigger 另一個 repository 並將 Library 產生出最新版的，如此一來就玩成一條龍服務啦！🎉🎉🎉\n","source":"_posts/使用-Serverless-Flask-Swagger-在-AWS-上搭建打造-Open-API.md","raw":"---\ntitle: 使用 Serverless/Flask/Swagger 在 AWS 上搭建打造 Open API\ntags:\n  - Swagger\n  - Flask\n  - Serverless\n  - Open Api\n  - Python\ncategories: Document tools\nabbrlink: 1373457857\ndate: 2020-05-05 17:09:39\n---\n\n\n![](https://i.imgur.com/2UI8Ggs.png)\n\n# 前言\n\n約在一年前，當時公司的同事帶我玩過 Swagger，只是當時的我寫得不太習慣，直到寫這篇之前都還只是寫 markdown 來做 API 文件 😓，不過寫 API 到最後總是要開放給其他人需要測試以及用文件來描述功能，但只是寫 Readme.md 給其他人看感覺有點不負責任 (?)，所以這個時候 Swagger 就發揮它的作用啦～\n\n但是看著下面這張圖…\n![](https://i.imgur.com/zg1jEuy.png)\n左邊那是怎樣！怎麼設定了一大堆右邊才出現一點點東西，估且不論還要設定 Model、Payload 什麼的，我想光寫左邊這份文件加測試的時間我都可以寫一份 Markdown 給其他同仁用 Postman 測試了…🤣🤣🤣\n這時候套件就出動啦，這次要介紹的是 flask-restful-swagger-2.0，他是延續原版套件並加以更新的，不得不說再搭更新完後整體寫起來人性多了，像是文先寫法用 decorator 的寫法在路由之前、宣告 Schema 時只要用類別包起來之類的，讓寫文件可以用 python 的寫法去寫，除了特殊的設定需要比對 Swagger 官方文件外，在建一個 Swagger 格式的文件這樣已經超快了 💪\n既然如此那就介紹一下他的相關設定並把它記錄下來吧！\n\n<!-- more -->\n\n若對 Serverless + WSGI +flask 還不清楚的話可以參考我之前[寫的文章](https://medium.com/@nijia.lin/%E7%BA%8C%E7%AF%87-serverless-wsgi-flask-chatbot-%E7%9A%84%E9%96%8B%E7%99%BC%E6%8C%87%E5%8D%97-f11de7dee7aa)\n\n<!-- more -->\n\n> 這次的範例已經放在 Github 上面，建議可以 Clone 下來邊看會比較清楚，若想要比較 flask-restful 套件生成的版本差異的朋友可以[參考分支 — Original](https://github.com/louis70109/aws-swagger-wsgi-flask)\n\n# api.py 設定\n\n一般來說，如果有用 flask_restful 套件的話會有以下兩行：\n\n```\nfrom flask_restful import Api\napi = Api(app)\n```\n\n這次因為需要引入 swagger，將程式替代成以下：\n\n```\nfrom flask_restful_swagger_2 import Api\napi = Api(app,\n    host=\"localhost:5000\",\n    schemes=['http'],\n   # schemes=['https'],\n   # base_path='/dev',\n    security_definitions=security,\n    security=[{'appKey': []}],\n    api_version='0.01',\n    api_spec_url='/api/swagger')\n```\n\n- host: 在本地端起的預設 port 為 5000 (部署上 AWS 後需要替換掉)\n\n> host 在此處可以先註解，設定此項目是如果需要使用 swagger-codegen 來產生相對應的 library 時，所需對應的 host\n\n- schemes: host 的協定 (部署後需要改成 https)\n- base_path: 一般 API 都會有 /v1、/v2 的版本號可以用在此處，而 serverless 部署上後則會有 /dev\n- security_definitions: 若在 call API 之前需要 OAuth 或是一般的 key 的話則在此地方設定\n- security: 設定完之後要在此告訴 swagger 要啟動這個 key\n- api_version: 使用者定義的版本號\n- api_sepc_url: swagger.json 輸出的路由\n\n> 在 sls deploy 之後需要將 host、schemes 以及 bash_path 改成部署完的設定\n\n# 設定 Swagger Model\n\n接著看到 controller/todos_controller.py，裡頭宣告了三個 Swagger model：\n\n- BasicTodosModel\n- QueryTodos\n- CreateTodos\n\n![](https://i.imgur.com/fg9Slabm.png)\n\n---\n\n![](https://i.imgur.com/njcsd9Im.png)\n\n---\n\n![](https://i.imgur.com/Dsw6Djmm.png)\n\n1. 定義了 Todos 的基本格式，兩個欄位都為字串且是必填欄位；\n2. 取資料後回傳的 schema，由於回傳時我習慣加個 result 的 key，且因為是取所有的 Todo，所以需要定義為 array，並按照 swagger 格式若為 array 則需要加入 items 的 key，value 則是放入原本定義好的 model 即可；\n3. 在建立完後的 schema，但由於只需要回傳 dictionary，所以直接指定即可。\n\n![](https://i.imgur.com/as5blSM.png)\n\n# Swagger 文件本體\n\n<script src=\"https://gist.github.com/louis70109/2b6e2d571e1ff558196e23eb1f3c4fe5.js\"></script>\n\n接著就來講解這次的主角身上的哪些特殊技能需要注意的，首先先看到第四行的部分，security 是來定義這個 method 需要用到哪個 authorize key，如果有用到兩種以上可以像是以下定義：\n\n```\n'security': [{\"appKey\": []}, {\"otherKey\": []}]\n```\n\n如此一來這個路由右邊又會有鎖頭 🔒 的選項，當 Authorize 過後才會鎖上。\n\n![](https://i.imgur.com/fLOprLT.png)\n\n接著看到第 8 行，這是定義當回傳成功 (200) 之後所對應的 Model，在上述已經設定過 Class 了，這邊就引入並跟 example 對應是不是自己想要的輸出\n\n以 Todos 的 Get 路由為例，我希望回傳值是由 result 包 Todo’s llist，點選 Model 就可以看到設定的 Model 的格式是不是有用陣列框起來。\n![](https://i.imgur.com/ehH5P7E.png)\n\n此時可以輸入以下指令啟動：\n\n```\nsls wsgi serve\n```\n\n並在 https://petstore.swagger.io/ 這個網址裡的輸入欄填上 http://localhost:5000/api/swagger.json 並按下 Explore 看一下自己的 API 有沒有問題。\n\n# 部署上 AWS\n\n在本地端玩那麼久了，接下來就是要部署上去啦，需要注意的是因為部署上去會有 https 以及 base_path 的問題，在本地端測試時的設定：\n\n```\napi = Api(app,\n schemes=[‘http’],\n security_definitions=security,\n security=[{‘appKey’: []}],\n api_version=’0.01',\n api_spec_url=’/api/swagger’)\n```\n\n由於預設為 dev 模式，在部署上的時候需要置換成以下內容：\n\n```\napi = Api(app,\n schemes=[‘https’],\n base_path=’/dev’,\n security_definitions=security,\n security=[{‘appKey’: []}],\n api_version=’0.01',\n api_spec_url=’/api/swagger’)\n```\n\n接著就部署上 AWS 嚕‼️\n\n```\nsls deploy\n```\n\n![](https://i.imgur.com/B3rdIHi.png)\n\n接著複製 endpoint 下來並在 dev 後面加上 /api/swagger.json，同時貼到 https://petstore.swagger.io/ 最上方的輸入欄位上就可以看到部署在 AWS 上的 Open API 囉！\n\n# 建立函式庫\n\n若是 Mac 的電腦可以使用以下指令 (其他的可以參考 [GitHub](https://github.com/swagger-api/swagger-codegen))：\n\n```\nbrew install swagger-codegen\n```\n\n接著再使用下列指令產生函式庫 (若不知道有支援什麼語言可以[參考官方](https://swagger.io/tools/swagger-codegen/))：\n\n```\nswagger-codegen generate -i https://{AWS_DOMAIN}/dev/api/swagger.json -l {language}\n```\n\n如此一來就可以把函式庫給對應的開發者使用，好處是大家的 code style 都是遵守 swagger 產生出來的格式，真的有問題就去解決當初產生這包 lib 的那位開發者 (咦？)。\n\n# 注意事項\n\n1. security 必須是 List 的 dictionary ([Issue](https://github.com/swagger-api/swagger-codegen/issues/7847#issuecomment-374512375))\n2. Schema 的 Model 在宣告巢狀時 type 為 array、需巢狀 Model 之前的 Key 為 items\n3. schemes 佈署上之前需要改成 https\n4. base_path 依照部署上的模式去設定，預設為 /dev\n5. 首次佈署上時不知道 domain，部署完之後把 domain 複製到 host 上在佈署一次，如此一來使用 swagger-codegen 產生函式庫套件的 configuration 網址就沒問題了。\n\n# 結論\n\n這次因為我的 API 需要給其他同事用而玩到 Swagger，剛好找到 [flask-restful-swagger-2.0](https://github.com/soerface/flask-restful-swagger-2.0) 這個套件讓我可以快速上手，並用 Swagger-Codegen 產生相依的 Library + 文件 讓其他的同事可以快速上手我的 API，讓我可以把心思都放在開發 API 上。接下來就是把 repository 弄到 CI 上，同時 Trigger 另一個 repository 並將 Library 產生出最新版的，如此一來就玩成一條龍服務啦！🎉🎉🎉\n","slug":"使用-Serverless-Flask-Swagger-在-AWS-上搭建打造-Open-API","published":1,"updated":"2020-06-19T14:03:58.872Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lk005l7cri0h0lifaw","content":"<p><img src=\"https://i.imgur.com/2UI8Ggs.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>約在一年前，當時公司的同事帶我玩過 Swagger，只是當時的我寫得不太習慣，直到寫這篇之前都還只是寫 markdown 來做 API 文件 😓，不過寫 API 到最後總是要開放給其他人需要測試以及用文件來描述功能，但只是寫 Readme.md 給其他人看感覺有點不負責任 (?)，所以這個時候 Swagger 就發揮它的作用啦～</p>\n<p>但是看著下面這張圖…<br><img src=\"https://i.imgur.com/zg1jEuy.png\" alt><br>左邊那是怎樣！怎麼設定了一大堆右邊才出現一點點東西，估且不論還要設定 Model、Payload 什麼的，我想光寫左邊這份文件加測試的時間我都可以寫一份 Markdown 給其他同仁用 Postman 測試了…🤣🤣🤣<br>這時候套件就出動啦，這次要介紹的是 flask-restful-swagger-2.0，他是延續原版套件並加以更新的，不得不說再搭更新完後整體寫起來人性多了，像是文先寫法用 decorator 的寫法在路由之前、宣告 Schema 時只要用類別包起來之類的，讓寫文件可以用 python 的寫法去寫，除了特殊的設定需要比對 Swagger 官方文件外，在建一個 Swagger 格式的文件這樣已經超快了 💪<br>既然如此那就介紹一下他的相關設定並把它記錄下來吧！</p>\n<a id=\"more\"></a>\n\n<p>若對 Serverless + WSGI +flask 還不清楚的話可以參考我之前<a href=\"https://medium.com/@nijia.lin/%E7%BA%8C%E7%AF%87-serverless-wsgi-flask-chatbot-%E7%9A%84%E9%96%8B%E7%99%BC%E6%8C%87%E5%8D%97-f11de7dee7aa\" target=\"_blank\" rel=\"noopener\">寫的文章</a></p>\n<!-- more -->\n\n<blockquote>\n<p>這次的範例已經放在 Github 上面，建議可以 Clone 下來邊看會比較清楚，若想要比較 flask-restful 套件生成的版本差異的朋友可以<a href=\"https://github.com/louis70109/aws-swagger-wsgi-flask\" target=\"_blank\" rel=\"noopener\">參考分支 — Original</a></p>\n</blockquote>\n<h1 id=\"api-py-設定\"><a href=\"#api-py-設定\" class=\"headerlink\" title=\"api.py 設定\"></a>api.py 設定</h1><p>一般來說，如果有用 flask_restful 套件的話會有以下兩行：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from flask_restful import Api</span><br><span class=\"line\">api = Api(app)</span><br></pre></td></tr></table></figure>\n\n<p>這次因為需要引入 swagger，將程式替代成以下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from flask_restful_swagger_2 import Api</span><br><span class=\"line\">api = Api(app,</span><br><span class=\"line\">    host=&quot;localhost:5000&quot;,</span><br><span class=\"line\">    schemes=[&apos;http&apos;],</span><br><span class=\"line\">   # schemes=[&apos;https&apos;],</span><br><span class=\"line\">   # base_path=&apos;/dev&apos;,</span><br><span class=\"line\">    security_definitions=security,</span><br><span class=\"line\">    security=[&#123;&apos;appKey&apos;: []&#125;],</span><br><span class=\"line\">    api_version=&apos;0.01&apos;,</span><br><span class=\"line\">    api_spec_url=&apos;/api/swagger&apos;)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>host: 在本地端起的預設 port 為 5000 (部署上 AWS 後需要替換掉)</li>\n</ul>\n<blockquote>\n<p>host 在此處可以先註解，設定此項目是如果需要使用 swagger-codegen 來產生相對應的 library 時，所需對應的 host</p>\n</blockquote>\n<ul>\n<li>schemes: host 的協定 (部署後需要改成 https)</li>\n<li>base_path: 一般 API 都會有 /v1、/v2 的版本號可以用在此處，而 serverless 部署上後則會有 /dev</li>\n<li>security_definitions: 若在 call API 之前需要 OAuth 或是一般的 key 的話則在此地方設定</li>\n<li>security: 設定完之後要在此告訴 swagger 要啟動這個 key</li>\n<li>api_version: 使用者定義的版本號</li>\n<li>api_sepc_url: swagger.json 輸出的路由</li>\n</ul>\n<blockquote>\n<p>在 sls deploy 之後需要將 host、schemes 以及 bash_path 改成部署完的設定</p>\n</blockquote>\n<h1 id=\"設定-Swagger-Model\"><a href=\"#設定-Swagger-Model\" class=\"headerlink\" title=\"設定 Swagger Model\"></a>設定 Swagger Model</h1><p>接著看到 controller/todos_controller.py，裡頭宣告了三個 Swagger model：</p>\n<ul>\n<li>BasicTodosModel</li>\n<li>QueryTodos</li>\n<li>CreateTodos</li>\n</ul>\n<p><img src=\"https://i.imgur.com/fg9Slabm.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/njcsd9Im.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/Dsw6Djmm.png\" alt></p>\n<ol>\n<li>定義了 Todos 的基本格式，兩個欄位都為字串且是必填欄位；</li>\n<li>取資料後回傳的 schema，由於回傳時我習慣加個 result 的 key，且因為是取所有的 Todo，所以需要定義為 array，並按照 swagger 格式若為 array 則需要加入 items 的 key，value 則是放入原本定義好的 model 即可；</li>\n<li>在建立完後的 schema，但由於只需要回傳 dictionary，所以直接指定即可。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/as5blSM.png\" alt></p>\n<h1 id=\"Swagger-文件本體\"><a href=\"#Swagger-文件本體\" class=\"headerlink\" title=\"Swagger 文件本體\"></a>Swagger 文件本體</h1><script src=\"https://gist.github.com/louis70109/2b6e2d571e1ff558196e23eb1f3c4fe5.js\"></script>\n\n<p>接著就來講解這次的主角身上的哪些特殊技能需要注意的，首先先看到第四行的部分，security 是來定義這個 method 需要用到哪個 authorize key，如果有用到兩種以上可以像是以下定義：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&apos;security&apos;: [&#123;&quot;appKey&quot;: []&#125;, &#123;&quot;otherKey&quot;: []&#125;]</span><br></pre></td></tr></table></figure>\n\n<p>如此一來這個路由右邊又會有鎖頭 🔒 的選項，當 Authorize 過後才會鎖上。</p>\n<p><img src=\"https://i.imgur.com/fLOprLT.png\" alt></p>\n<p>接著看到第 8 行，這是定義當回傳成功 (200) 之後所對應的 Model，在上述已經設定過 Class 了，這邊就引入並跟 example 對應是不是自己想要的輸出</p>\n<p>以 Todos 的 Get 路由為例，我希望回傳值是由 result 包 Todo’s llist，點選 Model 就可以看到設定的 Model 的格式是不是有用陣列框起來。<br><img src=\"https://i.imgur.com/ehH5P7E.png\" alt></p>\n<p>此時可以輸入以下指令啟動：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>並在 <a href=\"https://petstore.swagger.io/\" target=\"_blank\" rel=\"noopener\">https://petstore.swagger.io/</a> 這個網址裡的輸入欄填上 <a href=\"http://localhost:5000/api/swagger.json\" target=\"_blank\" rel=\"noopener\">http://localhost:5000/api/swagger.json</a> 並按下 Explore 看一下自己的 API 有沒有問題。</p>\n<h1 id=\"部署上-AWS\"><a href=\"#部署上-AWS\" class=\"headerlink\" title=\"部署上 AWS\"></a>部署上 AWS</h1><p>在本地端玩那麼久了，接下來就是要部署上去啦，需要注意的是因為部署上去會有 https 以及 base_path 的問題，在本地端測試時的設定：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">api = Api(app,</span><br><span class=\"line\"> schemes=[‘http’],</span><br><span class=\"line\"> security_definitions=security,</span><br><span class=\"line\"> security=[&#123;‘appKey’: []&#125;],</span><br><span class=\"line\"> api_version=’0.01&apos;,</span><br><span class=\"line\"> api_spec_url=’/api/swagger’)</span><br></pre></td></tr></table></figure>\n\n<p>由於預設為 dev 模式，在部署上的時候需要置換成以下內容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">api = Api(app,</span><br><span class=\"line\"> schemes=[‘https’],</span><br><span class=\"line\"> base_path=’/dev’,</span><br><span class=\"line\"> security_definitions=security,</span><br><span class=\"line\"> security=[&#123;‘appKey’: []&#125;],</span><br><span class=\"line\"> api_version=’0.01&apos;,</span><br><span class=\"line\"> api_spec_url=’/api/swagger’)</span><br></pre></td></tr></table></figure>\n\n<p>接著就部署上 AWS 嚕‼️</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/B3rdIHi.png\" alt></p>\n<p>接著複製 endpoint 下來並在 dev 後面加上 /api/swagger.json，同時貼到 <a href=\"https://petstore.swagger.io/\" target=\"_blank\" rel=\"noopener\">https://petstore.swagger.io/</a> 最上方的輸入欄位上就可以看到部署在 AWS 上的 Open API 囉！</p>\n<h1 id=\"建立函式庫\"><a href=\"#建立函式庫\" class=\"headerlink\" title=\"建立函式庫\"></a>建立函式庫</h1><p>若是 Mac 的電腦可以使用以下指令 (其他的可以參考 <a href=\"https://github.com/swagger-api/swagger-codegen\" target=\"_blank\" rel=\"noopener\">GitHub</a>)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install swagger-codegen</span><br></pre></td></tr></table></figure>\n\n<p>接著再使用下列指令產生函式庫 (若不知道有支援什麼語言可以<a href=\"https://swagger.io/tools/swagger-codegen/\" target=\"_blank\" rel=\"noopener\">參考官方</a>)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">swagger-codegen generate -i https://&#123;AWS_DOMAIN&#125;/dev/api/swagger.json -l &#123;language&#125;</span><br></pre></td></tr></table></figure>\n\n<p>如此一來就可以把函式庫給對應的開發者使用，好處是大家的 code style 都是遵守 swagger 產生出來的格式，真的有問題就去解決當初產生這包 lib 的那位開發者 (咦？)。</p>\n<h1 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h1><ol>\n<li>security 必須是 List 的 dictionary (<a href=\"https://github.com/swagger-api/swagger-codegen/issues/7847#issuecomment-374512375\" target=\"_blank\" rel=\"noopener\">Issue</a>)</li>\n<li>Schema 的 Model 在宣告巢狀時 type 為 array、需巢狀 Model 之前的 Key 為 items</li>\n<li>schemes 佈署上之前需要改成 https</li>\n<li>base_path 依照部署上的模式去設定，預設為 /dev</li>\n<li>首次佈署上時不知道 domain，部署完之後把 domain 複製到 host 上在佈署一次，如此一來使用 swagger-codegen 產生函式庫套件的 configuration 網址就沒問題了。</li>\n</ol>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>這次因為我的 API 需要給其他同事用而玩到 Swagger，剛好找到 <a href=\"https://github.com/soerface/flask-restful-swagger-2.0\" target=\"_blank\" rel=\"noopener\">flask-restful-swagger-2.0</a> 這個套件讓我可以快速上手，並用 Swagger-Codegen 產生相依的 Library + 文件 讓其他的同事可以快速上手我的 API，讓我可以把心思都放在開發 API 上。接下來就是把 repository 弄到 CI 上，同時 Trigger 另一個 repository 並將 Library 產生出最新版的，如此一來就玩成一條龍服務啦！🎉🎉🎉</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/2UI8Ggs.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>約在一年前，當時公司的同事帶我玩過 Swagger，只是當時的我寫得不太習慣，直到寫這篇之前都還只是寫 markdown 來做 API 文件 😓，不過寫 API 到最後總是要開放給其他人需要測試以及用文件來描述功能，但只是寫 Readme.md 給其他人看感覺有點不負責任 (?)，所以這個時候 Swagger 就發揮它的作用啦～</p>\n<p>但是看著下面這張圖…<br><img src=\"https://i.imgur.com/zg1jEuy.png\" alt><br>左邊那是怎樣！怎麼設定了一大堆右邊才出現一點點東西，估且不論還要設定 Model、Payload 什麼的，我想光寫左邊這份文件加測試的時間我都可以寫一份 Markdown 給其他同仁用 Postman 測試了…🤣🤣🤣<br>這時候套件就出動啦，這次要介紹的是 flask-restful-swagger-2.0，他是延續原版套件並加以更新的，不得不說再搭更新完後整體寫起來人性多了，像是文先寫法用 decorator 的寫法在路由之前、宣告 Schema 時只要用類別包起來之類的，讓寫文件可以用 python 的寫法去寫，除了特殊的設定需要比對 Swagger 官方文件外，在建一個 Swagger 格式的文件這樣已經超快了 💪<br>既然如此那就介紹一下他的相關設定並把它記錄下來吧！</p>","more":"<p>若對 Serverless + WSGI +flask 還不清楚的話可以參考我之前<a href=\"https://medium.com/@nijia.lin/%E7%BA%8C%E7%AF%87-serverless-wsgi-flask-chatbot-%E7%9A%84%E9%96%8B%E7%99%BC%E6%8C%87%E5%8D%97-f11de7dee7aa\" target=\"_blank\" rel=\"noopener\">寫的文章</a></p>\n<!-- more -->\n\n<blockquote>\n<p>這次的範例已經放在 Github 上面，建議可以 Clone 下來邊看會比較清楚，若想要比較 flask-restful 套件生成的版本差異的朋友可以<a href=\"https://github.com/louis70109/aws-swagger-wsgi-flask\" target=\"_blank\" rel=\"noopener\">參考分支 — Original</a></p>\n</blockquote>\n<h1 id=\"api-py-設定\"><a href=\"#api-py-設定\" class=\"headerlink\" title=\"api.py 設定\"></a>api.py 設定</h1><p>一般來說，如果有用 flask_restful 套件的話會有以下兩行：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from flask_restful import Api</span><br><span class=\"line\">api = Api(app)</span><br></pre></td></tr></table></figure>\n\n<p>這次因為需要引入 swagger，將程式替代成以下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from flask_restful_swagger_2 import Api</span><br><span class=\"line\">api = Api(app,</span><br><span class=\"line\">    host=&quot;localhost:5000&quot;,</span><br><span class=\"line\">    schemes=[&apos;http&apos;],</span><br><span class=\"line\">   # schemes=[&apos;https&apos;],</span><br><span class=\"line\">   # base_path=&apos;/dev&apos;,</span><br><span class=\"line\">    security_definitions=security,</span><br><span class=\"line\">    security=[&#123;&apos;appKey&apos;: []&#125;],</span><br><span class=\"line\">    api_version=&apos;0.01&apos;,</span><br><span class=\"line\">    api_spec_url=&apos;/api/swagger&apos;)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>host: 在本地端起的預設 port 為 5000 (部署上 AWS 後需要替換掉)</li>\n</ul>\n<blockquote>\n<p>host 在此處可以先註解，設定此項目是如果需要使用 swagger-codegen 來產生相對應的 library 時，所需對應的 host</p>\n</blockquote>\n<ul>\n<li>schemes: host 的協定 (部署後需要改成 https)</li>\n<li>base_path: 一般 API 都會有 /v1、/v2 的版本號可以用在此處，而 serverless 部署上後則會有 /dev</li>\n<li>security_definitions: 若在 call API 之前需要 OAuth 或是一般的 key 的話則在此地方設定</li>\n<li>security: 設定完之後要在此告訴 swagger 要啟動這個 key</li>\n<li>api_version: 使用者定義的版本號</li>\n<li>api_sepc_url: swagger.json 輸出的路由</li>\n</ul>\n<blockquote>\n<p>在 sls deploy 之後需要將 host、schemes 以及 bash_path 改成部署完的設定</p>\n</blockquote>\n<h1 id=\"設定-Swagger-Model\"><a href=\"#設定-Swagger-Model\" class=\"headerlink\" title=\"設定 Swagger Model\"></a>設定 Swagger Model</h1><p>接著看到 controller/todos_controller.py，裡頭宣告了三個 Swagger model：</p>\n<ul>\n<li>BasicTodosModel</li>\n<li>QueryTodos</li>\n<li>CreateTodos</li>\n</ul>\n<p><img src=\"https://i.imgur.com/fg9Slabm.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/njcsd9Im.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/Dsw6Djmm.png\" alt></p>\n<ol>\n<li>定義了 Todos 的基本格式，兩個欄位都為字串且是必填欄位；</li>\n<li>取資料後回傳的 schema，由於回傳時我習慣加個 result 的 key，且因為是取所有的 Todo，所以需要定義為 array，並按照 swagger 格式若為 array 則需要加入 items 的 key，value 則是放入原本定義好的 model 即可；</li>\n<li>在建立完後的 schema，但由於只需要回傳 dictionary，所以直接指定即可。</li>\n</ol>\n<p><img src=\"https://i.imgur.com/as5blSM.png\" alt></p>\n<h1 id=\"Swagger-文件本體\"><a href=\"#Swagger-文件本體\" class=\"headerlink\" title=\"Swagger 文件本體\"></a>Swagger 文件本體</h1><script src=\"https://gist.github.com/louis70109/2b6e2d571e1ff558196e23eb1f3c4fe5.js\"></script>\n\n<p>接著就來講解這次的主角身上的哪些特殊技能需要注意的，首先先看到第四行的部分，security 是來定義這個 method 需要用到哪個 authorize key，如果有用到兩種以上可以像是以下定義：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&apos;security&apos;: [&#123;&quot;appKey&quot;: []&#125;, &#123;&quot;otherKey&quot;: []&#125;]</span><br></pre></td></tr></table></figure>\n\n<p>如此一來這個路由右邊又會有鎖頭 🔒 的選項，當 Authorize 過後才會鎖上。</p>\n<p><img src=\"https://i.imgur.com/fLOprLT.png\" alt></p>\n<p>接著看到第 8 行，這是定義當回傳成功 (200) 之後所對應的 Model，在上述已經設定過 Class 了，這邊就引入並跟 example 對應是不是自己想要的輸出</p>\n<p>以 Todos 的 Get 路由為例，我希望回傳值是由 result 包 Todo’s llist，點選 Model 就可以看到設定的 Model 的格式是不是有用陣列框起來。<br><img src=\"https://i.imgur.com/ehH5P7E.png\" alt></p>\n<p>此時可以輸入以下指令啟動：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p>並在 <a href=\"https://petstore.swagger.io/\" target=\"_blank\" rel=\"noopener\">https://petstore.swagger.io/</a> 這個網址裡的輸入欄填上 <a href=\"http://localhost:5000/api/swagger.json\" target=\"_blank\" rel=\"noopener\">http://localhost:5000/api/swagger.json</a> 並按下 Explore 看一下自己的 API 有沒有問題。</p>\n<h1 id=\"部署上-AWS\"><a href=\"#部署上-AWS\" class=\"headerlink\" title=\"部署上 AWS\"></a>部署上 AWS</h1><p>在本地端玩那麼久了，接下來就是要部署上去啦，需要注意的是因為部署上去會有 https 以及 base_path 的問題，在本地端測試時的設定：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">api = Api(app,</span><br><span class=\"line\"> schemes=[‘http’],</span><br><span class=\"line\"> security_definitions=security,</span><br><span class=\"line\"> security=[&#123;‘appKey’: []&#125;],</span><br><span class=\"line\"> api_version=’0.01&apos;,</span><br><span class=\"line\"> api_spec_url=’/api/swagger’)</span><br></pre></td></tr></table></figure>\n\n<p>由於預設為 dev 模式，在部署上的時候需要置換成以下內容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">api = Api(app,</span><br><span class=\"line\"> schemes=[‘https’],</span><br><span class=\"line\"> base_path=’/dev’,</span><br><span class=\"line\"> security_definitions=security,</span><br><span class=\"line\"> security=[&#123;‘appKey’: []&#125;],</span><br><span class=\"line\"> api_version=’0.01&apos;,</span><br><span class=\"line\"> api_spec_url=’/api/swagger’)</span><br></pre></td></tr></table></figure>\n\n<p>接著就部署上 AWS 嚕‼️</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/B3rdIHi.png\" alt></p>\n<p>接著複製 endpoint 下來並在 dev 後面加上 /api/swagger.json，同時貼到 <a href=\"https://petstore.swagger.io/\" target=\"_blank\" rel=\"noopener\">https://petstore.swagger.io/</a> 最上方的輸入欄位上就可以看到部署在 AWS 上的 Open API 囉！</p>\n<h1 id=\"建立函式庫\"><a href=\"#建立函式庫\" class=\"headerlink\" title=\"建立函式庫\"></a>建立函式庫</h1><p>若是 Mac 的電腦可以使用以下指令 (其他的可以參考 <a href=\"https://github.com/swagger-api/swagger-codegen\" target=\"_blank\" rel=\"noopener\">GitHub</a>)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install swagger-codegen</span><br></pre></td></tr></table></figure>\n\n<p>接著再使用下列指令產生函式庫 (若不知道有支援什麼語言可以<a href=\"https://swagger.io/tools/swagger-codegen/\" target=\"_blank\" rel=\"noopener\">參考官方</a>)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">swagger-codegen generate -i https://&#123;AWS_DOMAIN&#125;/dev/api/swagger.json -l &#123;language&#125;</span><br></pre></td></tr></table></figure>\n\n<p>如此一來就可以把函式庫給對應的開發者使用，好處是大家的 code style 都是遵守 swagger 產生出來的格式，真的有問題就去解決當初產生這包 lib 的那位開發者 (咦？)。</p>\n<h1 id=\"注意事項\"><a href=\"#注意事項\" class=\"headerlink\" title=\"注意事項\"></a>注意事項</h1><ol>\n<li>security 必須是 List 的 dictionary (<a href=\"https://github.com/swagger-api/swagger-codegen/issues/7847#issuecomment-374512375\" target=\"_blank\" rel=\"noopener\">Issue</a>)</li>\n<li>Schema 的 Model 在宣告巢狀時 type 為 array、需巢狀 Model 之前的 Key 為 items</li>\n<li>schemes 佈署上之前需要改成 https</li>\n<li>base_path 依照部署上的模式去設定，預設為 /dev</li>\n<li>首次佈署上時不知道 domain，部署完之後把 domain 複製到 host 上在佈署一次，如此一來使用 swagger-codegen 產生函式庫套件的 configuration 網址就沒問題了。</li>\n</ol>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>這次因為我的 API 需要給其他同事用而玩到 Swagger，剛好找到 <a href=\"https://github.com/soerface/flask-restful-swagger-2.0\" target=\"_blank\" rel=\"noopener\">flask-restful-swagger-2.0</a> 這個套件讓我可以快速上手，並用 Swagger-Codegen 產生相依的 Library + 文件 讓其他的同事可以快速上手我的 API，讓我可以把心思都放在開發 API 上。接下來就是把 repository 弄到 CI 上，同時 Trigger 另一個 repository 並將 Library 產生出最新版的，如此一來就玩成一條龍服務啦！🎉🎉🎉</p>"},{"title":"使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot","abbrlink":3648300953,"date":"2019-10-31T08:20:12.000Z","_content":"\n# 前言\n\nServerless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。\n那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)\n[2019/07/04 更新]\n若已經暸解的朋友可以參考我的 python 版本:\n[louis70109/aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot)\nRuby 的範例版本:\n[louis70109/aws-ruby-line-echo-bot](https://github.com/louis70109/aws-ruby-line-echo-bot)\n\n# 為什麼要 Serverless\n\n[2019/06/29 更新]\n以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login — Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～\n但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！\nCold start time 問題，依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 😆，所以這部分就別擔新大力地給他用下去～ (感謝 petertc 幫忙找這方面的問題 💪)\n\nAWS Lambda 免費方案\n接下來就讓我介紹如何使用 sls + LINE Message API 建立一個 Echo bot 吧！\n![](https://i.imgur.com/pNCDY4e.png)\n\n# 環境\n\nnpm 6.9.0\npython 3.7.3\nserverless 1.45.1\n\n# 建立 AWS 存取金鑰\n\n首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！\n![](https://i.imgur.com/XHuvbyX.png)\n如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！\n![AWS secret & ID key](https://i.imgur.com/FzRCna0.png)\n\n如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。\n接著就將這兩個參數加入環境變數中：\n\n```bash\nexport AWS_ACCESS_KEY_ID=<your-key-here>\nexport AWS_SECRET_ACCESS_KEY=<your-secret-key-here>\n```\n\n# Serverless 建立與部署\n\n首先先透過以下指令讓 npm 幫忙安裝 sls 的指令。\n\n```bash\nnpm install serverless -g\n```\n\n安裝完之後就透過 sls 指令來建立專案嚕！\n\n```bash\nserverless create — template aws-python — path aws-line-echo-bot\n```\n\n> severless 指令可以縮寫成 sls\n> template = 想用什麼平台以及語言就在此模板了 (參考)\n> path = 檔案名稱\n\n![](https://i.imgur.com/2KNweWB.png)\n![](https://i.imgur.com/HDonmjF.png)\n\n透過 severless 建立專案指令\n依照不同的 template 可能會建立 N 個檔案，但主要還是以下三個檔案\n\n```bash\n.gitignore\nhandler.py = 主程式的地方\nserverless.yml = 所有設定都在這裡，funtion 參數會對應到指定的路由\n```\n\n在部署前須至 serverless.yml 裡，把 runtime 的 python2.7 改至 3.7，否則會因版本問題導致錯誤。\n\n```bash\nserverless deploy # sls deploy\n```\n\n![Serverless 部署畫面](https://i.imgur.com/18Fnran.png)\n\n接著到 AWS Lambda 以及 S3 就可以看到第一次部署完的程式以及檔案囉！\n\n# 加入 LINE Message API\n\n既然是寫 python，那一定是要用 line-python-sdk\n照著官方用法應該是要執行以下指令安裝套件\n\n```bash\npip install line-bot-sdk\n```\n\n不過我們是要部署到 AWS 的 Lambda 上，且因為他是無伺服器運算的服務，所以他沒辦法跑 pip 去幫我安裝套件。\n此時就要出動 requirements.txt 來管理相依套件 ，但只有加入它 sls 根本不認識，因此我們需要安裝 pulgin 來讓 sls 認得(requirements.txt)。\n\n```bash\nsls plugin install -n serverless-python-requirements\n```\n\n![](https://i.imgur.com/0NFfVi6.png)\n\n---\n\n![](https://i.imgur.com/pS7s8ls.png)\n\n安裝指令 & package.json\n如圖，安裝過程中會自動建立 package.json，且會幫忙在 serverless.yml 裡面加入 pulgin，這樣 sls 在部署時就認得 requirements.txt 囉！\n接著將 LINE SDK 加入 requirements.txt， AWS 就會幫忙安裝套件了。\n\n```bash\necho \"line-bot-sdk==1.12.1\" > requirements.txt\n```\n\n然後新增一個 setup.cfg 並加入以下內容：\n\n```bash\n[install]\nprefix=\n```\n\n由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 pip install -t . -r requirements.txt 時會需要 setup.cfg。\n至於詳細原因嘛～還有請各位大大幫小弟解答 🙏\n最後就處理 handler.py 以及 serverless.yml 囉！\n將上述兩個 gist 分別貼到自己的 handler.py & serverless.yml，在 hanlder.py 裡的 CHANNEL KEY & TOKEN 記得換成自己的機器人 👾 哦！\n![佈屬完狀態](https://i.imgur.com/WVBHxL3.png)\n接著在執行一次 sls deploy，將程式部署上去，如上圖所示，在 endpoints 那行會有一個網址，將那網址放到 LINE Webhook URL 上並 Verify 看看有沒有成功，如下圖所示。\n![](https://i.imgur.com/CQMwc8V.png)\n最後對著自己的機器人發個話，看他有沒有回應你一模一樣的文字，若成功了就能往下一步應用層繼續開發囉！若失敗了就要檢查一下是不是有哪個步驟做錯了～\n\n# 結論\n\n因為公司的緣故讓我能夠接觸到這神奇的 Serverless，經過這次的分享加深我對於 FaaS 的架構更加了熟悉，由於我也是初碰，我認為使用上可以把它當作是一個 Docker 的容器或許概念上會比較好理解，後續還有很多的設定檔都還沒詳細研究，最近讓我先研究研究一下再上來分享。\n\n> 文章中有任何勘誤歡迎指正\n\n如果覺得這篇文章有幫助的話請給我個掌聲鼓勵我一下 👋\n下列是我的這次實作的專案，如果有幫助也來顆星星吧！\n[louis70109/aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot?source=post_page-----1e3e785a2a01----------------------)\n\n# 參考\n\n- [AWS Lambda 費率問題](https://aws.amazon.com/tw/lambda/pricing/)\n- [Serverless GitHub](https://github.com/serverless/serverless)\n- [Serverless Python Requirements](https://serverless.com/plugins/serverless-python-requirements/)\n- [LINE Python SDK](https://github.com/line/line-bot-sdk-python)\n- [FaaS 概念](https://aws.amazon.com/cn/blogs/china/iaas-faas-serverless/)\n- [AWS, GCP, Azure cold start time](https://mikhail.io/2018/08/serverless-cold-start-war/)\n","source":"_posts/使用-Serverless-Line-Message-API-在-AWS-上打造一個-Echo-bot.md","raw":"---\ntitle: 使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot\ntags:\n  - Serverless\n  - LINE\n  - AWS\ncategories: Serverless\nabbrlink: 3648300953\ndate: 2019-10-31 16:20:12\n---\n\n# 前言\n\nServerless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。\n那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)\n[2019/07/04 更新]\n若已經暸解的朋友可以參考我的 python 版本:\n[louis70109/aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot)\nRuby 的範例版本:\n[louis70109/aws-ruby-line-echo-bot](https://github.com/louis70109/aws-ruby-line-echo-bot)\n\n# 為什麼要 Serverless\n\n[2019/06/29 更新]\n以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login — Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～\n但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！\nCold start time 問題，依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 😆，所以這部分就別擔新大力地給他用下去～ (感謝 petertc 幫忙找這方面的問題 💪)\n\nAWS Lambda 免費方案\n接下來就讓我介紹如何使用 sls + LINE Message API 建立一個 Echo bot 吧！\n![](https://i.imgur.com/pNCDY4e.png)\n\n# 環境\n\nnpm 6.9.0\npython 3.7.3\nserverless 1.45.1\n\n# 建立 AWS 存取金鑰\n\n首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！\n![](https://i.imgur.com/XHuvbyX.png)\n如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！\n![AWS secret & ID key](https://i.imgur.com/FzRCna0.png)\n\n如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。\n接著就將這兩個參數加入環境變數中：\n\n```bash\nexport AWS_ACCESS_KEY_ID=<your-key-here>\nexport AWS_SECRET_ACCESS_KEY=<your-secret-key-here>\n```\n\n# Serverless 建立與部署\n\n首先先透過以下指令讓 npm 幫忙安裝 sls 的指令。\n\n```bash\nnpm install serverless -g\n```\n\n安裝完之後就透過 sls 指令來建立專案嚕！\n\n```bash\nserverless create — template aws-python — path aws-line-echo-bot\n```\n\n> severless 指令可以縮寫成 sls\n> template = 想用什麼平台以及語言就在此模板了 (參考)\n> path = 檔案名稱\n\n![](https://i.imgur.com/2KNweWB.png)\n![](https://i.imgur.com/HDonmjF.png)\n\n透過 severless 建立專案指令\n依照不同的 template 可能會建立 N 個檔案，但主要還是以下三個檔案\n\n```bash\n.gitignore\nhandler.py = 主程式的地方\nserverless.yml = 所有設定都在這裡，funtion 參數會對應到指定的路由\n```\n\n在部署前須至 serverless.yml 裡，把 runtime 的 python2.7 改至 3.7，否則會因版本問題導致錯誤。\n\n```bash\nserverless deploy # sls deploy\n```\n\n![Serverless 部署畫面](https://i.imgur.com/18Fnran.png)\n\n接著到 AWS Lambda 以及 S3 就可以看到第一次部署完的程式以及檔案囉！\n\n# 加入 LINE Message API\n\n既然是寫 python，那一定是要用 line-python-sdk\n照著官方用法應該是要執行以下指令安裝套件\n\n```bash\npip install line-bot-sdk\n```\n\n不過我們是要部署到 AWS 的 Lambda 上，且因為他是無伺服器運算的服務，所以他沒辦法跑 pip 去幫我安裝套件。\n此時就要出動 requirements.txt 來管理相依套件 ，但只有加入它 sls 根本不認識，因此我們需要安裝 pulgin 來讓 sls 認得(requirements.txt)。\n\n```bash\nsls plugin install -n serverless-python-requirements\n```\n\n![](https://i.imgur.com/0NFfVi6.png)\n\n---\n\n![](https://i.imgur.com/pS7s8ls.png)\n\n安裝指令 & package.json\n如圖，安裝過程中會自動建立 package.json，且會幫忙在 serverless.yml 裡面加入 pulgin，這樣 sls 在部署時就認得 requirements.txt 囉！\n接著將 LINE SDK 加入 requirements.txt， AWS 就會幫忙安裝套件了。\n\n```bash\necho \"line-bot-sdk==1.12.1\" > requirements.txt\n```\n\n然後新增一個 setup.cfg 並加入以下內容：\n\n```bash\n[install]\nprefix=\n```\n\n由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 pip install -t . -r requirements.txt 時會需要 setup.cfg。\n至於詳細原因嘛～還有請各位大大幫小弟解答 🙏\n最後就處理 handler.py 以及 serverless.yml 囉！\n將上述兩個 gist 分別貼到自己的 handler.py & serverless.yml，在 hanlder.py 裡的 CHANNEL KEY & TOKEN 記得換成自己的機器人 👾 哦！\n![佈屬完狀態](https://i.imgur.com/WVBHxL3.png)\n接著在執行一次 sls deploy，將程式部署上去，如上圖所示，在 endpoints 那行會有一個網址，將那網址放到 LINE Webhook URL 上並 Verify 看看有沒有成功，如下圖所示。\n![](https://i.imgur.com/CQMwc8V.png)\n最後對著自己的機器人發個話，看他有沒有回應你一模一樣的文字，若成功了就能往下一步應用層繼續開發囉！若失敗了就要檢查一下是不是有哪個步驟做錯了～\n\n# 結論\n\n因為公司的緣故讓我能夠接觸到這神奇的 Serverless，經過這次的分享加深我對於 FaaS 的架構更加了熟悉，由於我也是初碰，我認為使用上可以把它當作是一個 Docker 的容器或許概念上會比較好理解，後續還有很多的設定檔都還沒詳細研究，最近讓我先研究研究一下再上來分享。\n\n> 文章中有任何勘誤歡迎指正\n\n如果覺得這篇文章有幫助的話請給我個掌聲鼓勵我一下 👋\n下列是我的這次實作的專案，如果有幫助也來顆星星吧！\n[louis70109/aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot?source=post_page-----1e3e785a2a01----------------------)\n\n# 參考\n\n- [AWS Lambda 費率問題](https://aws.amazon.com/tw/lambda/pricing/)\n- [Serverless GitHub](https://github.com/serverless/serverless)\n- [Serverless Python Requirements](https://serverless.com/plugins/serverless-python-requirements/)\n- [LINE Python SDK](https://github.com/line/line-bot-sdk-python)\n- [FaaS 概念](https://aws.amazon.com/cn/blogs/china/iaas-faas-serverless/)\n- [AWS, GCP, Azure cold start time](https://mikhail.io/2018/08/serverless-cold-start-war/)\n","slug":"使用-Serverless-Line-Message-API-在-AWS-上打造一個-Echo-bot","published":1,"updated":"2020-06-19T14:22:24.339Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31ln005o7cri8uf9vr62","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>Serverless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。<br>那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)<br>[2019/07/04 更新]<br>若已經暸解的朋友可以參考我的 python 版本:<br><a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">louis70109/aws-line-echo-bot</a><br>Ruby 的範例版本:<br><a href=\"https://github.com/louis70109/aws-ruby-line-echo-bot\" target=\"_blank\" rel=\"noopener\">louis70109/aws-ruby-line-echo-bot</a></p>\n<h1 id=\"為什麼要-Serverless\"><a href=\"#為什麼要-Serverless\" class=\"headerlink\" title=\"為什麼要 Serverless\"></a>為什麼要 Serverless</h1><p>[2019/06/29 更新]<br>以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login — Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～<br>但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！<br>Cold start time 問題，依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 😆，所以這部分就別擔新大力地給他用下去～ (感謝 petertc 幫忙找這方面的問題 💪)</p>\n<p>AWS Lambda 免費方案<br>接下來就讓我介紹如何使用 sls + LINE Message API 建立一個 Echo bot 吧！<br><img src=\"https://i.imgur.com/pNCDY4e.png\" alt></p>\n<h1 id=\"環境\"><a href=\"#環境\" class=\"headerlink\" title=\"環境\"></a>環境</h1><p>npm 6.9.0<br>python 3.7.3<br>serverless 1.45.1</p>\n<h1 id=\"建立-AWS-存取金鑰\"><a href=\"#建立-AWS-存取金鑰\" class=\"headerlink\" title=\"建立 AWS 存取金鑰\"></a>建立 AWS 存取金鑰</h1><p>首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！<br><img src=\"https://i.imgur.com/XHuvbyX.png\" alt><br>如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！<br><img src=\"https://i.imgur.com/FzRCna0.png\" alt=\"AWS secret &amp; ID key\"></p>\n<p>如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。<br>接著就將這兩個參數加入環境變數中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> AWS_ACCESS_KEY_ID=&lt;your-key-here&gt;</span><br><span class=\"line\"><span class=\"built_in\">export</span> AWS_SECRET_ACCESS_KEY=&lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Serverless-建立與部署\"><a href=\"#Serverless-建立與部署\" class=\"headerlink\" title=\"Serverless 建立與部署\"></a>Serverless 建立與部署</h1><p>首先先透過以下指令讓 npm 幫忙安裝 sls 的指令。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless -g</span><br></pre></td></tr></table></figure>\n\n<p>安裝完之後就透過 sls 指令來建立專案嚕！</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless create — template aws-python — path aws-line-echo-bot</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>severless 指令可以縮寫成 sls<br>template = 想用什麼平台以及語言就在此模板了 (參考)<br>path = 檔案名稱</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/2KNweWB.png\" alt><br><img src=\"https://i.imgur.com/HDonmjF.png\" alt></p>\n<p>透過 severless 建立專案指令<br>依照不同的 template 可能會建立 N 個檔案，但主要還是以下三個檔案</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.gitignore</span><br><span class=\"line\">handler.py = 主程式的地方</span><br><span class=\"line\">serverless.yml = 所有設定都在這裡，funtion 參數會對應到指定的路由</span><br></pre></td></tr></table></figure>\n\n<p>在部署前須至 serverless.yml 裡，把 runtime 的 python2.7 改至 3.7，否則會因版本問題導致錯誤。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless deploy <span class=\"comment\"># sls deploy</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/18Fnran.png\" alt=\"Serverless 部署畫面\"></p>\n<p>接著到 AWS Lambda 以及 S3 就可以看到第一次部署完的程式以及檔案囉！</p>\n<h1 id=\"加入-LINE-Message-API\"><a href=\"#加入-LINE-Message-API\" class=\"headerlink\" title=\"加入 LINE Message API\"></a>加入 LINE Message API</h1><p>既然是寫 python，那一定是要用 line-python-sdk<br>照著官方用法應該是要執行以下指令安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install line-bot-sdk</span><br></pre></td></tr></table></figure>\n\n<p>不過我們是要部署到 AWS 的 Lambda 上，且因為他是無伺服器運算的服務，所以他沒辦法跑 pip 去幫我安裝套件。<br>此時就要出動 requirements.txt 來管理相依套件 ，但只有加入它 sls 根本不認識，因此我們需要安裝 pulgin 來讓 sls 認得(requirements.txt)。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls plugin install -n serverless-python-requirements</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/0NFfVi6.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/pS7s8ls.png\" alt></p>\n<p>安裝指令 &amp; package.json<br>如圖，安裝過程中會自動建立 package.json，且會幫忙在 serverless.yml 裡面加入 pulgin，這樣 sls 在部署時就認得 requirements.txt 囉！<br>接著將 LINE SDK 加入 requirements.txt， AWS 就會幫忙安裝套件了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"line-bot-sdk==1.12.1\"</span> &gt; requirements.txt</span><br></pre></td></tr></table></figure>\n\n<p>然後新增一個 setup.cfg 並加入以下內容：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[install]</span><br><span class=\"line\">prefix=</span><br></pre></td></tr></table></figure>\n\n<p>由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 pip install -t . -r requirements.txt 時會需要 setup.cfg。<br>至於詳細原因嘛～還有請各位大大幫小弟解答 🙏<br>最後就處理 handler.py 以及 serverless.yml 囉！<br>將上述兩個 gist 分別貼到自己的 handler.py &amp; serverless.yml，在 hanlder.py 裡的 CHANNEL KEY &amp; TOKEN 記得換成自己的機器人 👾 哦！<br><img src=\"https://i.imgur.com/WVBHxL3.png\" alt=\"佈屬完狀態\"><br>接著在執行一次 sls deploy，將程式部署上去，如上圖所示，在 endpoints 那行會有一個網址，將那網址放到 LINE Webhook URL 上並 Verify 看看有沒有成功，如下圖所示。<br><img src=\"https://i.imgur.com/CQMwc8V.png\" alt><br>最後對著自己的機器人發個話，看他有沒有回應你一模一樣的文字，若成功了就能往下一步應用層繼續開發囉！若失敗了就要檢查一下是不是有哪個步驟做錯了～</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>因為公司的緣故讓我能夠接觸到這神奇的 Serverless，經過這次的分享加深我對於 FaaS 的架構更加了熟悉，由於我也是初碰，我認為使用上可以把它當作是一個 Docker 的容器或許概念上會比較好理解，後續還有很多的設定檔都還沒詳細研究，最近讓我先研究研究一下再上來分享。</p>\n<blockquote>\n<p>文章中有任何勘誤歡迎指正</p>\n</blockquote>\n<p>如果覺得這篇文章有幫助的話請給我個掌聲鼓勵我一下 👋<br>下列是我的這次實作的專案，如果有幫助也來顆星星吧！<br><a href=\"https://github.com/louis70109/aws-line-echo-bot?source=post_page-----1e3e785a2a01----------------------\" target=\"_blank\" rel=\"noopener\">louis70109/aws-line-echo-bot</a></p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://aws.amazon.com/tw/lambda/pricing/\" target=\"_blank\" rel=\"noopener\">AWS Lambda 費率問題</a></li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless GitHub</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-python-requirements/\" target=\"_blank\" rel=\"noopener\">Serverless Python Requirements</a></li>\n<li><a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">LINE Python SDK</a></li>\n<li><a href=\"https://aws.amazon.com/cn/blogs/china/iaas-faas-serverless/\" target=\"_blank\" rel=\"noopener\">FaaS 概念</a></li>\n<li><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/\" target=\"_blank\" rel=\"noopener\">AWS, GCP, Azure cold start time</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>Serverless 架構是一個基於 FaaS(Function as a Service) 實作的一個服務，讓開發者可以更專注在開發功能，將 yml 檔設定好其餘維運的問題都交給 AWS、Google、Azure 這些服務商去處理，只要把信用卡準備好就好(?)，讓開發者在寫完程式之後不用煩惱部署得問題，減少的不少的麻煩事。<br>那因為現任公司的服務都是基於 AWS，如此這般我就接觸到 Serverless(以下簡稱 sls) 這個框架啦 (想更深入了解 FaaS 架構可以參考 AWS)<br>[2019/07/04 更新]<br>若已經暸解的朋友可以參考我的 python 版本:<br><a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">louis70109/aws-line-echo-bot</a><br>Ruby 的範例版本:<br><a href=\"https://github.com/louis70109/aws-ruby-line-echo-bot\" target=\"_blank\" rel=\"noopener\">louis70109/aws-ruby-line-echo-bot</a></p>\n<h1 id=\"為什麼要-Serverless\"><a href=\"#為什麼要-Serverless\" class=\"headerlink\" title=\"為什麼要 Serverless\"></a>為什麼要 Serverless</h1><p>[2019/06/29 更新]<br>以用一個 Ruby on Rails 寫的機器人為例，在寫完個 webhook function 後，設定路由然後部署，一般主機或是虛擬機就很麻煩，要安裝佈署環境以及一安裝堆相關套件，完了之後設定 Domain 什麼的有夠花時間。但若是使用 heroku 部署就很方便，Login — Create-Deploy 馬上就結束，機器人馬上就上線了，實在是俗又大碗呀～<br>但我覺得像是 LINE Message 這種 stateless 的服務，且只要一個 function + route 就能實作的程式最適合 Serverless 了，讓專案可以簡潔有力，只要寫一個 function+yml 設定並打個指令就部署了，而且 domain 還附贈 SSL，將服務交給 AWS 也不需要擔心，整個就是超級方便啊！<br>Cold start time 問題，依照我目前使用的結果下來，在 heroku 以及 AWS Lambda 同時睡著的情況下，AWS 起床的回應速度大概 1 秒左右，而 heroku 則大概落在 10~15 秒(參考)。如下圖所示的免費方案，基本上開發階段應該是不至於到 100 萬/月 個請求吧 😆，所以這部分就別擔新大力地給他用下去～ (感謝 petertc 幫忙找這方面的問題 💪)</p>\n<p>AWS Lambda 免費方案<br>接下來就讓我介紹如何使用 sls + LINE Message API 建立一個 Echo bot 吧！<br><img src=\"https://i.imgur.com/pNCDY4e.png\" alt></p>\n<h1 id=\"環境\"><a href=\"#環境\" class=\"headerlink\" title=\"環境\"></a>環境</h1><p>npm 6.9.0<br>python 3.7.3<br>serverless 1.45.1</p>\n<h1 id=\"建立-AWS-存取金鑰\"><a href=\"#建立-AWS-存取金鑰\" class=\"headerlink\" title=\"建立 AWS 存取金鑰\"></a>建立 AWS 存取金鑰</h1><p>首先要先有個 AWS 帳號(廢話) ，如果沒有綁定信用卡記得去綁定才能繼續，接下來就可以去就可以去建立鑰匙囉！<br><img src=\"https://i.imgur.com/XHuvbyX.png\" alt><br>如上圖，按下紅色框框的部分，接著按箭頭指的按鈕，就會建立一個我們要的金鑰囉！<br><img src=\"https://i.imgur.com/FzRCna0.png\" alt=\"AWS secret &amp; ID key\"></p>\n<p>如上圖所示，可以下載 key，AWS 不會幫忙保存 Secret key，若這視窗關掉的話 key 就不見了，所以使用者可以自行下載檔案保存，以免哪天要部署的時候找不到 key。<br>接著就將這兩個參數加入環境變數中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> AWS_ACCESS_KEY_ID=&lt;your-key-here&gt;</span><br><span class=\"line\"><span class=\"built_in\">export</span> AWS_SECRET_ACCESS_KEY=&lt;your-secret-key-here&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Serverless-建立與部署\"><a href=\"#Serverless-建立與部署\" class=\"headerlink\" title=\"Serverless 建立與部署\"></a>Serverless 建立與部署</h1><p>首先先透過以下指令讓 npm 幫忙安裝 sls 的指令。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install serverless -g</span><br></pre></td></tr></table></figure>\n\n<p>安裝完之後就透過 sls 指令來建立專案嚕！</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless create — template aws-python — path aws-line-echo-bot</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>severless 指令可以縮寫成 sls<br>template = 想用什麼平台以及語言就在此模板了 (參考)<br>path = 檔案名稱</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/2KNweWB.png\" alt><br><img src=\"https://i.imgur.com/HDonmjF.png\" alt></p>\n<p>透過 severless 建立專案指令<br>依照不同的 template 可能會建立 N 個檔案，但主要還是以下三個檔案</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.gitignore</span><br><span class=\"line\">handler.py = 主程式的地方</span><br><span class=\"line\">serverless.yml = 所有設定都在這裡，funtion 參數會對應到指定的路由</span><br></pre></td></tr></table></figure>\n\n<p>在部署前須至 serverless.yml 裡，把 runtime 的 python2.7 改至 3.7，否則會因版本問題導致錯誤。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serverless deploy <span class=\"comment\"># sls deploy</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/18Fnran.png\" alt=\"Serverless 部署畫面\"></p>\n<p>接著到 AWS Lambda 以及 S3 就可以看到第一次部署完的程式以及檔案囉！</p>\n<h1 id=\"加入-LINE-Message-API\"><a href=\"#加入-LINE-Message-API\" class=\"headerlink\" title=\"加入 LINE Message API\"></a>加入 LINE Message API</h1><p>既然是寫 python，那一定是要用 line-python-sdk<br>照著官方用法應該是要執行以下指令安裝套件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install line-bot-sdk</span><br></pre></td></tr></table></figure>\n\n<p>不過我們是要部署到 AWS 的 Lambda 上，且因為他是無伺服器運算的服務，所以他沒辦法跑 pip 去幫我安裝套件。<br>此時就要出動 requirements.txt 來管理相依套件 ，但只有加入它 sls 根本不認識，因此我們需要安裝 pulgin 來讓 sls 認得(requirements.txt)。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls plugin install -n serverless-python-requirements</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/0NFfVi6.png\" alt></p>\n<hr>\n<p><img src=\"https://i.imgur.com/pS7s8ls.png\" alt></p>\n<p>安裝指令 &amp; package.json<br>如圖，安裝過程中會自動建立 package.json，且會幫忙在 serverless.yml 裡面加入 pulgin，這樣 sls 在部署時就認得 requirements.txt 囉！<br>接著將 LINE SDK 加入 requirements.txt， AWS 就會幫忙安裝套件了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"line-bot-sdk==1.12.1\"</span> &gt; requirements.txt</span><br></pre></td></tr></table></figure>\n\n<p>然後新增一個 setup.cfg 並加入以下內容：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[install]</span><br><span class=\"line\">prefix=</span><br></pre></td></tr></table></figure>\n\n<p>由於 AWS Lambda 上都會將套件安裝在本地端(Lambda 上)，因此在執行 pip install -t . -r requirements.txt 時會需要 setup.cfg。<br>至於詳細原因嘛～還有請各位大大幫小弟解答 🙏<br>最後就處理 handler.py 以及 serverless.yml 囉！<br>將上述兩個 gist 分別貼到自己的 handler.py &amp; serverless.yml，在 hanlder.py 裡的 CHANNEL KEY &amp; TOKEN 記得換成自己的機器人 👾 哦！<br><img src=\"https://i.imgur.com/WVBHxL3.png\" alt=\"佈屬完狀態\"><br>接著在執行一次 sls deploy，將程式部署上去，如上圖所示，在 endpoints 那行會有一個網址，將那網址放到 LINE Webhook URL 上並 Verify 看看有沒有成功，如下圖所示。<br><img src=\"https://i.imgur.com/CQMwc8V.png\" alt><br>最後對著自己的機器人發個話，看他有沒有回應你一模一樣的文字，若成功了就能往下一步應用層繼續開發囉！若失敗了就要檢查一下是不是有哪個步驟做錯了～</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>因為公司的緣故讓我能夠接觸到這神奇的 Serverless，經過這次的分享加深我對於 FaaS 的架構更加了熟悉，由於我也是初碰，我認為使用上可以把它當作是一個 Docker 的容器或許概念上會比較好理解，後續還有很多的設定檔都還沒詳細研究，最近讓我先研究研究一下再上來分享。</p>\n<blockquote>\n<p>文章中有任何勘誤歡迎指正</p>\n</blockquote>\n<p>如果覺得這篇文章有幫助的話請給我個掌聲鼓勵我一下 👋<br>下列是我的這次實作的專案，如果有幫助也來顆星星吧！<br><a href=\"https://github.com/louis70109/aws-line-echo-bot?source=post_page-----1e3e785a2a01----------------------\" target=\"_blank\" rel=\"noopener\">louis70109/aws-line-echo-bot</a></p>\n<h1 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h1><ul>\n<li><a href=\"https://aws.amazon.com/tw/lambda/pricing/\" target=\"_blank\" rel=\"noopener\">AWS Lambda 費率問題</a></li>\n<li><a href=\"https://github.com/serverless/serverless\" target=\"_blank\" rel=\"noopener\">Serverless GitHub</a></li>\n<li><a href=\"https://serverless.com/plugins/serverless-python-requirements/\" target=\"_blank\" rel=\"noopener\">Serverless Python Requirements</a></li>\n<li><a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">LINE Python SDK</a></li>\n<li><a href=\"https://aws.amazon.com/cn/blogs/china/iaas-faas-serverless/\" target=\"_blank\" rel=\"noopener\">FaaS 概念</a></li>\n<li><a href=\"https://mikhail.io/2018/08/serverless-cold-start-war/\" target=\"_blank\" rel=\"noopener\">AWS, GCP, Azure cold start time</a></li>\n</ul>\n"},{"title":"如何建立一個跨平台的 Twitch 機器人","abbrlink":4054342848,"date":"2020-01-11T16:53:22.000Z","_content":"\n# 前言\n\n在去年大約五月的時候寫了一隻 Twitch 的 LINE bot，不過後來似乎 Twitch API 有改版讓機器人壞掉了，最近又有需要一隻機器人幫我查詢，就開始去翻一下 Twitch 官方文件，碰巧逛到這個 [Community Resources page](https://dev.twitch.tv/code/)，看到了好多資料在裡面，就索性來重寫囉！\n\n> 因為 Twitch package 都是 Typescript，因此本篇的範例都會是 Typescript 哦！\n\n⭐️ 本專案: [Twitch-Bot](https://github.com/louis70109/Twitch-Bot)\n\n# 加好友\n\n- LINE\n  <img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/kRcEhBN.png\">\n\n- Messenger\n  <img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/93yxeiy.png\">\n\n# 準備\n\n- 套件\n  - [bottender](https://github.com/Yoctol/bottender) 為這次實作跨平台所使用的框架\n  - [Twitch js](https://github.com/d-fischer/twitch) 中找到了 [npm 的套件](https://d-fischer.github.io/twitch/docs/basic-usage/getting-started.html)\n\n```javascript\nyarn add twitch\n// or...\nnpm install --save twitch\n```\n\n- 金鑰\n  - ~~申請 [Client ID](https://dev.twitch.tv/docs/v5#getting-a-client-id)~~\n  - 建立 [Access Token](https://twitchapps.com/tmi/)\n\n[2020/06/08 修正] 申請完後將 `oauth:` 後的 key 透過官方文件的 [Validating requests](https://dev.twitch.tv/docs/authentication/#validating-requests) 指令放入 access token 中取得 Client_id，如下:\n\n```\ncurl -H \"Authorization: OAuth <access token>\" https://id.twitch.tv/oauth2/validate\n```\n\n本專案的 `TWITCH_CLIENT_ID` 的環境變數就是這個回傳值中的 `client_id`。\n\n> 這部分可能會需要去 twitch `設定 -> 連結` 去綁定 Oauth 的樣子，再麻煩各位注意一下。\n\n- 平台\n\n  - 需要有個 Facebook 粉絲頁\n  - LINE bot\n\n- 資料庫\n  - MongoDB: Heroku 上為 `mLab`\n\n# 實作\n\nClone 專案下來看 ➡️ https://github.com/louis70109/Twitch-Bot.git\n首先把`.env.sample`改成 `.env`，並將對應的`Messenger`、`LINE`以及`Twtich` key 放置對應的位置\n\n- Messenger 申請我是參考 C.T. Lin 的[鐵人文章](https://ithelp.ithome.com.tw/articles/10218682)\n- LINE bot 申請參考[我的文章](https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/)\n\n## 跨平台\n\n跨平台含本地總共會有三個:\n\n- Console (本地端)\n- Messenger (線上)\n- LINE (線上)\n\nConsole 是 bottender 的特色之一，可以在終端機上直接測試 Bot 的行為，會先用此模式先測試路由的回覆是否正常。\n\n接著要讓同樣的 Action 可以導到 Messenger 以及 LINE，bottender 提供了可以設計針對特定平台處理 Action，如下:\n\n```javascript\nimport { platform } from \"bottender/router\";\nexport default async function App(): Promise<void> {\n  return await router([\n    platform(\"line\", LineAction),\n    platform(\"messenger\", MessengerAction),\n  ]);\n}\n```\n\n透過`platform`來把特定平台的訊息到打對應的 Action (如 `LineAction`、`MessengerAction`)，在傳遞 Action 過程中會有一個 `context` 的變數，裡頭會有底層幫忙整理好的參數:\n\n```bash\nConsoleContext {\n  ...\n  _session: {\n    _id: 5e08a45c719a1335aeae39bc,\n    id: 'console:1',\n    _state: {},\n    lastActivity: 1578743328620,\n    platform: 'console',\n    user: { id: '1', name: 'you', _updatedAt: '2019-12-29T13:04:25.633Z' }\n  },\n  ...\n}\n```\n\n`_session` 裡有個 `platform` 的參數，只要判斷這參數就能知道訊息是來自哪個平台，而`user`則是被正規化完後的使用者資訊 (這兩個參數為目前為止我最常用的參數)\n\n## 遇到的問題\n\n由於長期使用 LINE flex message 的 button template ([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/view/line/games.ts#L56))，這按鈕事件可以設定按鈕上的文字並設定按下去回覆的字串。\n\n而 Messenger 的按鈕就跟人家不一樣了([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/view/messenger/games.ts#L22))！他沒有 LINE 的這個事件，差不多的事件只有 `postback`，在路由上就得特別處理這個事件，為了讓跨平台所使用的內容要統一，在訊息進 router 時就要處理掉:\n\n```javascript\nimport { messenger } from 'bottender/router';\nimport { withProps } from 'bottender';\n\nasync function LineAction(context): Promise<void> {\n  return await router([\n    ...\n    text(/^[f|F]ind\\s*(?<topic>.*)$/, searchGame)\n    ...\n  ]);\n}\n\nasync function MessengerAction(context): Promise<void> {\n  const payload = context.event?.postback?.payload;\n  return await router([\n    ...\n    messenger.postback(\n      withProps(searchGame, { match: { groups: { topic: payload } } })\n    )\n    ...\n  ]);\n}\n```\n\n這邊找到 [bottender 官方文件](https://bottender.js.org/docs/channel-messenger-routing)中函式專門在處理 Messenger 的 postback 事件，並搭配`withProps`來幫忙把參數 postback 收到的參數傳進對應 Action。\n\n為什麼會要把傳入的參數設定成巢狀 object -> `{ match: { groups: { topic: payload }}}`，因為在設計初期本是希望進來的內容都是從`text`傳進來，意指都是透過使用者打字進來，那 bottender 都會透過傳 match 參數進來([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/twitches/searchGame.ts#L7))，而解析完 Messenger 的 postback 時也得需要符合這樣的格式，因此就這樣設計，當然如果有更好的設計歡迎送 PR 🎉。\n\n# Chatbot MVC\n\n## [Model](https://github.com/louis70109/Twitch-Bot/blob/master/src/model)\n\n- `Twitch`: 這裡我設定 \u001cuserId 為 unique，針對每個平台有自己的 id，每個平台都可以綁定 twitch 帳號，進而去做相關操作。\n- `Game`: 因為 Twitch 套件這部分是`read only`，因此我就在建立一個一樣的 model 來處理。\n\n> Twich id 是全開放的，只要知道其他使用者的 id 就可以查詢某些功能([參考](https://dev.twitch.tv/docs/v5))，這邊我就使用查詢`追隨`的功能。\n\n## [View](https://github.com/louis70109/Twitch-Bot/tree/master/src/view)\n\n這裡設計上只要屬於送出訊息相關的樣板(`Flex`、`Genetic`、`Text`)接放在此。\n\n- common: `作者資訊(author)` 以及 `幫助我(help)` 的相關\n- LINE: Flex message 相關樣板\n- messenger: Genetic template 相關樣板\n\n## [Controller](https://github.com/louis70109/Twitch-Bot/tree/master/src/controller)\n\n在呼叫 twitch api 出來的資料有時候會大於 LINE 以及 Messenger 的樣板限制，因此所有計算服務都會放在這邊，剛好就搭上 Controller 的對應功能。\n\n- common: 負責將 controller 處理完的內容送至 `View`\n- twitch: 處理`最多人看得遊戲`以及`搜尋指定遊戲`\n- user: 處理`綁定`以及`查詢追隨`\n\n# 結論\n\n基本上做到這如果之後要擴增`Telegram`或是`Slack`都可以很快速擴充，只要把相對只要把相對的 Action 加在 `App.ts` 就行了。\n\n藉由這次也學到跨平台的機器人真的不好做，每家廠牌的行為都不一樣，所幸 bottender 已經處理大部分平台間的問題，接著我們只需要將欲輸出的內容處理好對應框架所提供的功能去回傳給使用者，讓整體的開發可以更專注在開發功能上並更有彈性。\n\n歡迎各位幫我按個星星 ⭐️➡️ https://github.com/louis70109/Twitch-Bot\n也一起支持開源專案 `bottender`⭐️➡️ https://github.com/Yoctol/bottender\n","source":"_posts/如何建立一個跨平台的Twitch機器人.md","raw":"---\ntitle: 如何建立一個跨平台的 Twitch 機器人\ntags:\n  - Chatbot\n  - bottender\ncategories: Chatbot\nabbrlink: 4054342848\ndate: 2020-01-12 00:53:22\n---\n\n# 前言\n\n在去年大約五月的時候寫了一隻 Twitch 的 LINE bot，不過後來似乎 Twitch API 有改版讓機器人壞掉了，最近又有需要一隻機器人幫我查詢，就開始去翻一下 Twitch 官方文件，碰巧逛到這個 [Community Resources page](https://dev.twitch.tv/code/)，看到了好多資料在裡面，就索性來重寫囉！\n\n> 因為 Twitch package 都是 Typescript，因此本篇的範例都會是 Typescript 哦！\n\n⭐️ 本專案: [Twitch-Bot](https://github.com/louis70109/Twitch-Bot)\n\n# 加好友\n\n- LINE\n  <img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/kRcEhBN.png\">\n\n- Messenger\n  <img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/93yxeiy.png\">\n\n# 準備\n\n- 套件\n  - [bottender](https://github.com/Yoctol/bottender) 為這次實作跨平台所使用的框架\n  - [Twitch js](https://github.com/d-fischer/twitch) 中找到了 [npm 的套件](https://d-fischer.github.io/twitch/docs/basic-usage/getting-started.html)\n\n```javascript\nyarn add twitch\n// or...\nnpm install --save twitch\n```\n\n- 金鑰\n  - ~~申請 [Client ID](https://dev.twitch.tv/docs/v5#getting-a-client-id)~~\n  - 建立 [Access Token](https://twitchapps.com/tmi/)\n\n[2020/06/08 修正] 申請完後將 `oauth:` 後的 key 透過官方文件的 [Validating requests](https://dev.twitch.tv/docs/authentication/#validating-requests) 指令放入 access token 中取得 Client_id，如下:\n\n```\ncurl -H \"Authorization: OAuth <access token>\" https://id.twitch.tv/oauth2/validate\n```\n\n本專案的 `TWITCH_CLIENT_ID` 的環境變數就是這個回傳值中的 `client_id`。\n\n> 這部分可能會需要去 twitch `設定 -> 連結` 去綁定 Oauth 的樣子，再麻煩各位注意一下。\n\n- 平台\n\n  - 需要有個 Facebook 粉絲頁\n  - LINE bot\n\n- 資料庫\n  - MongoDB: Heroku 上為 `mLab`\n\n# 實作\n\nClone 專案下來看 ➡️ https://github.com/louis70109/Twitch-Bot.git\n首先把`.env.sample`改成 `.env`，並將對應的`Messenger`、`LINE`以及`Twtich` key 放置對應的位置\n\n- Messenger 申請我是參考 C.T. Lin 的[鐵人文章](https://ithelp.ithome.com.tw/articles/10218682)\n- LINE bot 申請參考[我的文章](https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/)\n\n## 跨平台\n\n跨平台含本地總共會有三個:\n\n- Console (本地端)\n- Messenger (線上)\n- LINE (線上)\n\nConsole 是 bottender 的特色之一，可以在終端機上直接測試 Bot 的行為，會先用此模式先測試路由的回覆是否正常。\n\n接著要讓同樣的 Action 可以導到 Messenger 以及 LINE，bottender 提供了可以設計針對特定平台處理 Action，如下:\n\n```javascript\nimport { platform } from \"bottender/router\";\nexport default async function App(): Promise<void> {\n  return await router([\n    platform(\"line\", LineAction),\n    platform(\"messenger\", MessengerAction),\n  ]);\n}\n```\n\n透過`platform`來把特定平台的訊息到打對應的 Action (如 `LineAction`、`MessengerAction`)，在傳遞 Action 過程中會有一個 `context` 的變數，裡頭會有底層幫忙整理好的參數:\n\n```bash\nConsoleContext {\n  ...\n  _session: {\n    _id: 5e08a45c719a1335aeae39bc,\n    id: 'console:1',\n    _state: {},\n    lastActivity: 1578743328620,\n    platform: 'console',\n    user: { id: '1', name: 'you', _updatedAt: '2019-12-29T13:04:25.633Z' }\n  },\n  ...\n}\n```\n\n`_session` 裡有個 `platform` 的參數，只要判斷這參數就能知道訊息是來自哪個平台，而`user`則是被正規化完後的使用者資訊 (這兩個參數為目前為止我最常用的參數)\n\n## 遇到的問題\n\n由於長期使用 LINE flex message 的 button template ([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/view/line/games.ts#L56))，這按鈕事件可以設定按鈕上的文字並設定按下去回覆的字串。\n\n而 Messenger 的按鈕就跟人家不一樣了([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/view/messenger/games.ts#L22))！他沒有 LINE 的這個事件，差不多的事件只有 `postback`，在路由上就得特別處理這個事件，為了讓跨平台所使用的內容要統一，在訊息進 router 時就要處理掉:\n\n```javascript\nimport { messenger } from 'bottender/router';\nimport { withProps } from 'bottender';\n\nasync function LineAction(context): Promise<void> {\n  return await router([\n    ...\n    text(/^[f|F]ind\\s*(?<topic>.*)$/, searchGame)\n    ...\n  ]);\n}\n\nasync function MessengerAction(context): Promise<void> {\n  const payload = context.event?.postback?.payload;\n  return await router([\n    ...\n    messenger.postback(\n      withProps(searchGame, { match: { groups: { topic: payload } } })\n    )\n    ...\n  ]);\n}\n```\n\n這邊找到 [bottender 官方文件](https://bottender.js.org/docs/channel-messenger-routing)中函式專門在處理 Messenger 的 postback 事件，並搭配`withProps`來幫忙把參數 postback 收到的參數傳進對應 Action。\n\n為什麼會要把傳入的參數設定成巢狀 object -> `{ match: { groups: { topic: payload }}}`，因為在設計初期本是希望進來的內容都是從`text`傳進來，意指都是透過使用者打字進來，那 bottender 都會透過傳 match 參數進來([參考](https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/twitches/searchGame.ts#L7))，而解析完 Messenger 的 postback 時也得需要符合這樣的格式，因此就這樣設計，當然如果有更好的設計歡迎送 PR 🎉。\n\n# Chatbot MVC\n\n## [Model](https://github.com/louis70109/Twitch-Bot/blob/master/src/model)\n\n- `Twitch`: 這裡我設定 \u001cuserId 為 unique，針對每個平台有自己的 id，每個平台都可以綁定 twitch 帳號，進而去做相關操作。\n- `Game`: 因為 Twitch 套件這部分是`read only`，因此我就在建立一個一樣的 model 來處理。\n\n> Twich id 是全開放的，只要知道其他使用者的 id 就可以查詢某些功能([參考](https://dev.twitch.tv/docs/v5))，這邊我就使用查詢`追隨`的功能。\n\n## [View](https://github.com/louis70109/Twitch-Bot/tree/master/src/view)\n\n這裡設計上只要屬於送出訊息相關的樣板(`Flex`、`Genetic`、`Text`)接放在此。\n\n- common: `作者資訊(author)` 以及 `幫助我(help)` 的相關\n- LINE: Flex message 相關樣板\n- messenger: Genetic template 相關樣板\n\n## [Controller](https://github.com/louis70109/Twitch-Bot/tree/master/src/controller)\n\n在呼叫 twitch api 出來的資料有時候會大於 LINE 以及 Messenger 的樣板限制，因此所有計算服務都會放在這邊，剛好就搭上 Controller 的對應功能。\n\n- common: 負責將 controller 處理完的內容送至 `View`\n- twitch: 處理`最多人看得遊戲`以及`搜尋指定遊戲`\n- user: 處理`綁定`以及`查詢追隨`\n\n# 結論\n\n基本上做到這如果之後要擴增`Telegram`或是`Slack`都可以很快速擴充，只要把相對只要把相對的 Action 加在 `App.ts` 就行了。\n\n藉由這次也學到跨平台的機器人真的不好做，每家廠牌的行為都不一樣，所幸 bottender 已經處理大部分平台間的問題，接著我們只需要將欲輸出的內容處理好對應框架所提供的功能去回傳給使用者，讓整體的開發可以更專注在開發功能上並更有彈性。\n\n歡迎各位幫我按個星星 ⭐️➡️ https://github.com/louis70109/Twitch-Bot\n也一起支持開源專案 `bottender`⭐️➡️ https://github.com/Yoctol/bottender\n","slug":"如何建立一個跨平台的Twitch機器人","published":1,"updated":"2020-06-19T14:20:23.117Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lq005s7critfsq9ygj","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在去年大約五月的時候寫了一隻 Twitch 的 LINE bot，不過後來似乎 Twitch API 有改版讓機器人壞掉了，最近又有需要一隻機器人幫我查詢，就開始去翻一下 Twitch 官方文件，碰巧逛到這個 <a href=\"https://dev.twitch.tv/code/\" target=\"_blank\" rel=\"noopener\">Community Resources page</a>，看到了好多資料在裡面，就索性來重寫囉！</p>\n<blockquote>\n<p>因為 Twitch package 都是 Typescript，因此本篇的範例都會是 Typescript 哦！</p>\n</blockquote>\n<p>⭐️ 本專案: <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a></p>\n<h1 id=\"加好友\"><a href=\"#加好友\" class=\"headerlink\" title=\"加好友\"></a>加好友</h1><ul>\n<li><p>LINE</p>\n<img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/kRcEhBN.png\">\n</li>\n<li><p>Messenger</p>\n<img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/93yxeiy.png\">\n\n</li>\n</ul>\n<h1 id=\"準備\"><a href=\"#準備\" class=\"headerlink\" title=\"準備\"></a>準備</h1><ul>\n<li>套件<ul>\n<li><a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">bottender</a> 為這次實作跨平台所使用的框架</li>\n<li><a href=\"https://github.com/d-fischer/twitch\" target=\"_blank\" rel=\"noopener\">Twitch js</a> 中找到了 <a href=\"https://d-fischer.github.io/twitch/docs/basic-usage/getting-started.html\" target=\"_blank\" rel=\"noopener\">npm 的套件</a></li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add twitch</span><br><span class=\"line\"><span class=\"comment\">// or...</span></span><br><span class=\"line\">npm install --save twitch</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>金鑰<ul>\n<li><del>申請 <a href=\"https://dev.twitch.tv/docs/v5#getting-a-client-id\" target=\"_blank\" rel=\"noopener\">Client ID</a></del></li>\n<li>建立 <a href=\"https://twitchapps.com/tmi/\" target=\"_blank\" rel=\"noopener\">Access Token</a></li>\n</ul>\n</li>\n</ul>\n<p>[2020/06/08 修正] 申請完後將 <code>oauth:</code> 後的 key 透過官方文件的 <a href=\"https://dev.twitch.tv/docs/authentication/#validating-requests\" target=\"_blank\" rel=\"noopener\">Validating requests</a> 指令放入 access token 中取得 Client_id，如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -H &quot;Authorization: OAuth &lt;access token&gt;&quot; https://id.twitch.tv/oauth2/validate</span><br></pre></td></tr></table></figure>\n\n<p>本專案的 <code>TWITCH_CLIENT_ID</code> 的環境變數就是這個回傳值中的 <code>client_id</code>。</p>\n<blockquote>\n<p>這部分可能會需要去 twitch <code>設定 -&gt; 連結</code> 去綁定 Oauth 的樣子，再麻煩各位注意一下。</p>\n</blockquote>\n<ul>\n<li><p>平台</p>\n<ul>\n<li>需要有個 Facebook 粉絲頁</li>\n<li>LINE bot</li>\n</ul>\n</li>\n<li><p>資料庫</p>\n<ul>\n<li>MongoDB: Heroku 上為 <code>mLab</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>Clone 專案下來看 ➡️ <a href=\"https://github.com/louis70109/Twitch-Bot.git\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/Twitch-Bot.git</a><br>首先把<code>.env.sample</code>改成 <code>.env</code>，並將對應的<code>Messenger</code>、<code>LINE</code>以及<code>Twtich</code> key 放置對應的位置</p>\n<ul>\n<li>Messenger 申請我是參考 C.T. Lin 的<a href=\"https://ithelp.ithome.com.tw/articles/10218682\" target=\"_blank\" rel=\"noopener\">鐵人文章</a></li>\n<li>LINE bot 申請參考<a href=\"https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/\">我的文章</a></li>\n</ul>\n<h2 id=\"跨平台\"><a href=\"#跨平台\" class=\"headerlink\" title=\"跨平台\"></a>跨平台</h2><p>跨平台含本地總共會有三個:</p>\n<ul>\n<li>Console (本地端)</li>\n<li>Messenger (線上)</li>\n<li>LINE (線上)</li>\n</ul>\n<p>Console 是 bottender 的特色之一，可以在終端機上直接測試 Bot 的行為，會先用此模式先測試路由的回覆是否正常。</p>\n<p>接著要讓同樣的 Action 可以導到 Messenger 以及 LINE，bottender 提供了可以設計針對特定平台處理 Action，如下:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; platform &#125; <span class=\"keyword\">from</span> <span class=\"string\">\"bottender/router\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">App</span>(<span class=\"params\"></span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    platform(<span class=\"string\">\"line\"</span>, LineAction),</span><br><span class=\"line\">    platform(<span class=\"string\">\"messenger\"</span>, MessengerAction),</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>透過<code>platform</code>來把特定平台的訊息到打對應的 Action (如 <code>LineAction</code>、<code>MessengerAction</code>)，在傳遞 Action 過程中會有一個 <code>context</code> 的變數，裡頭會有底層幫忙整理好的參數:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ConsoleContext &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  _session: &#123;</span><br><span class=\"line\">    _id: 5e08a45c719a1335aeae39bc,</span><br><span class=\"line\">    id: <span class=\"string\">'console:1'</span>,</span><br><span class=\"line\">    _state: &#123;&#125;,</span><br><span class=\"line\">    lastActivity: 1578743328620,</span><br><span class=\"line\">    platform: <span class=\"string\">'console'</span>,</span><br><span class=\"line\">    user: &#123; id: <span class=\"string\">'1'</span>, name: <span class=\"string\">'you'</span>, _updatedAt: <span class=\"string\">'2019-12-29T13:04:25.633Z'</span> &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>_session</code> 裡有個 <code>platform</code> 的參數，只要判斷這參數就能知道訊息是來自哪個平台，而<code>user</code>則是被正規化完後的使用者資訊 (這兩個參數為目前為止我最常用的參數)</p>\n<h2 id=\"遇到的問題\"><a href=\"#遇到的問題\" class=\"headerlink\" title=\"遇到的問題\"></a>遇到的問題</h2><p>由於長期使用 LINE flex message 的 button template (<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/view/line/games.ts#L56\" target=\"_blank\" rel=\"noopener\">參考</a>)，這按鈕事件可以設定按鈕上的文字並設定按下去回覆的字串。</p>\n<p>而 Messenger 的按鈕就跟人家不一樣了(<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/view/messenger/games.ts#L22\" target=\"_blank\" rel=\"noopener\">參考</a>)！他沒有 LINE 的這個事件，差不多的事件只有 <code>postback</code>，在路由上就得特別處理這個事件，為了讓跨平台所使用的內容要統一，在訊息進 router 時就要處理掉:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; messenger &#125; <span class=\"keyword\">from</span> <span class=\"string\">'bottender/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; withProps &#125; <span class=\"keyword\">from</span> <span class=\"string\">'bottender'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">LineAction</span>(<span class=\"params\">context</span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    text(<span class=\"regexp\">/^[f|F]ind\\s*(?&lt;topic&gt;.*)$/</span>, searchGame)</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">MessengerAction</span>(<span class=\"params\">context</span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> payload = context.event?.postback?.payload;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    messenger.postback(</span><br><span class=\"line\">      withProps(searchGame, &#123; <span class=\"attr\">match</span>: &#123; <span class=\"attr\">groups</span>: &#123; <span class=\"attr\">topic</span>: payload &#125; &#125; &#125;)</span><br><span class=\"line\">    )</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這邊找到 <a href=\"https://bottender.js.org/docs/channel-messenger-routing\" target=\"_blank\" rel=\"noopener\">bottender 官方文件</a>中函式專門在處理 Messenger 的 postback 事件，並搭配<code>withProps</code>來幫忙把參數 postback 收到的參數傳進對應 Action。</p>\n<p>為什麼會要把傳入的參數設定成巢狀 object -&gt; <code>{ match: { groups: { topic: payload }}}</code>，因為在設計初期本是希望進來的內容都是從<code>text</code>傳進來，意指都是透過使用者打字進來，那 bottender 都會透過傳 match 參數進來(<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/twitches/searchGame.ts#L7\" target=\"_blank\" rel=\"noopener\">參考</a>)，而解析完 Messenger 的 postback 時也得需要符合這樣的格式，因此就這樣設計，當然如果有更好的設計歡迎送 PR 🎉。</p>\n<h1 id=\"Chatbot-MVC\"><a href=\"#Chatbot-MVC\" class=\"headerlink\" title=\"Chatbot MVC\"></a>Chatbot MVC</h1><h2 id=\"Model\"><a href=\"#Model\" class=\"headerlink\" title=\"Model\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/model\" target=\"_blank\" rel=\"noopener\">Model</a></h2><ul>\n<li><code>Twitch</code>: 這裡我設定 \u001cuserId 為 unique，針對每個平台有自己的 id，每個平台都可以綁定 twitch 帳號，進而去做相關操作。</li>\n<li><code>Game</code>: 因為 Twitch 套件這部分是<code>read only</code>，因此我就在建立一個一樣的 model 來處理。</li>\n</ul>\n<blockquote>\n<p>Twich id 是全開放的，只要知道其他使用者的 id 就可以查詢某些功能(<a href=\"https://dev.twitch.tv/docs/v5\" target=\"_blank\" rel=\"noopener\">參考</a>)，這邊我就使用查詢<code>追隨</code>的功能。</p>\n</blockquote>\n<h2 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/tree/master/src/view\" target=\"_blank\" rel=\"noopener\">View</a></h2><p>這裡設計上只要屬於送出訊息相關的樣板(<code>Flex</code>、<code>Genetic</code>、<code>Text</code>)接放在此。</p>\n<ul>\n<li>common: <code>作者資訊(author)</code> 以及 <code>幫助我(help)</code> 的相關</li>\n<li>LINE: Flex message 相關樣板</li>\n<li>messenger: Genetic template 相關樣板</li>\n</ul>\n<h2 id=\"Controller\"><a href=\"#Controller\" class=\"headerlink\" title=\"Controller\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/tree/master/src/controller\" target=\"_blank\" rel=\"noopener\">Controller</a></h2><p>在呼叫 twitch api 出來的資料有時候會大於 LINE 以及 Messenger 的樣板限制，因此所有計算服務都會放在這邊，剛好就搭上 Controller 的對應功能。</p>\n<ul>\n<li>common: 負責將 controller 處理完的內容送至 <code>View</code></li>\n<li>twitch: 處理<code>最多人看得遊戲</code>以及<code>搜尋指定遊戲</code></li>\n<li>user: 處理<code>綁定</code>以及<code>查詢追隨</code></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>基本上做到這如果之後要擴增<code>Telegram</code>或是<code>Slack</code>都可以很快速擴充，只要把相對只要把相對的 Action 加在 <code>App.ts</code> 就行了。</p>\n<p>藉由這次也學到跨平台的機器人真的不好做，每家廠牌的行為都不一樣，所幸 bottender 已經處理大部分平台間的問題，接著我們只需要將欲輸出的內容處理好對應框架所提供的功能去回傳給使用者，讓整體的開發可以更專注在開發功能上並更有彈性。</p>\n<p>歡迎各位幫我按個星星 ⭐️➡️ <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/Twitch-Bot</a><br>也一起支持開源專案 <code>bottender</code>⭐️➡️ <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">https://github.com/Yoctol/bottender</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>在去年大約五月的時候寫了一隻 Twitch 的 LINE bot，不過後來似乎 Twitch API 有改版讓機器人壞掉了，最近又有需要一隻機器人幫我查詢，就開始去翻一下 Twitch 官方文件，碰巧逛到這個 <a href=\"https://dev.twitch.tv/code/\" target=\"_blank\" rel=\"noopener\">Community Resources page</a>，看到了好多資料在裡面，就索性來重寫囉！</p>\n<blockquote>\n<p>因為 Twitch package 都是 Typescript，因此本篇的範例都會是 Typescript 哦！</p>\n</blockquote>\n<p>⭐️ 本專案: <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">Twitch-Bot</a></p>\n<h1 id=\"加好友\"><a href=\"#加好友\" class=\"headerlink\" title=\"加好友\"></a>加好友</h1><ul>\n<li><p>LINE</p>\n<img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/kRcEhBN.png\">\n</li>\n<li><p>Messenger</p>\n<img height=\"200\" border=\"0\" alt=\"QRcode\" src=\"https://i.imgur.com/93yxeiy.png\">\n\n</li>\n</ul>\n<h1 id=\"準備\"><a href=\"#準備\" class=\"headerlink\" title=\"準備\"></a>準備</h1><ul>\n<li>套件<ul>\n<li><a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">bottender</a> 為這次實作跨平台所使用的框架</li>\n<li><a href=\"https://github.com/d-fischer/twitch\" target=\"_blank\" rel=\"noopener\">Twitch js</a> 中找到了 <a href=\"https://d-fischer.github.io/twitch/docs/basic-usage/getting-started.html\" target=\"_blank\" rel=\"noopener\">npm 的套件</a></li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add twitch</span><br><span class=\"line\"><span class=\"comment\">// or...</span></span><br><span class=\"line\">npm install --save twitch</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>金鑰<ul>\n<li><del>申請 <a href=\"https://dev.twitch.tv/docs/v5#getting-a-client-id\" target=\"_blank\" rel=\"noopener\">Client ID</a></del></li>\n<li>建立 <a href=\"https://twitchapps.com/tmi/\" target=\"_blank\" rel=\"noopener\">Access Token</a></li>\n</ul>\n</li>\n</ul>\n<p>[2020/06/08 修正] 申請完後將 <code>oauth:</code> 後的 key 透過官方文件的 <a href=\"https://dev.twitch.tv/docs/authentication/#validating-requests\" target=\"_blank\" rel=\"noopener\">Validating requests</a> 指令放入 access token 中取得 Client_id，如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -H &quot;Authorization: OAuth &lt;access token&gt;&quot; https://id.twitch.tv/oauth2/validate</span><br></pre></td></tr></table></figure>\n\n<p>本專案的 <code>TWITCH_CLIENT_ID</code> 的環境變數就是這個回傳值中的 <code>client_id</code>。</p>\n<blockquote>\n<p>這部分可能會需要去 twitch <code>設定 -&gt; 連結</code> 去綁定 Oauth 的樣子，再麻煩各位注意一下。</p>\n</blockquote>\n<ul>\n<li><p>平台</p>\n<ul>\n<li>需要有個 Facebook 粉絲頁</li>\n<li>LINE bot</li>\n</ul>\n</li>\n<li><p>資料庫</p>\n<ul>\n<li>MongoDB: Heroku 上為 <code>mLab</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>Clone 專案下來看 ➡️ <a href=\"https://github.com/louis70109/Twitch-Bot.git\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/Twitch-Bot.git</a><br>首先把<code>.env.sample</code>改成 <code>.env</code>，並將對應的<code>Messenger</code>、<code>LINE</code>以及<code>Twtich</code> key 放置對應的位置</p>\n<ul>\n<li>Messenger 申請我是參考 C.T. Lin 的<a href=\"https://ithelp.ithome.com.tw/articles/10218682\" target=\"_blank\" rel=\"noopener\">鐵人文章</a></li>\n<li>LINE bot 申請參考<a href=\"https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/\">我的文章</a></li>\n</ul>\n<h2 id=\"跨平台\"><a href=\"#跨平台\" class=\"headerlink\" title=\"跨平台\"></a>跨平台</h2><p>跨平台含本地總共會有三個:</p>\n<ul>\n<li>Console (本地端)</li>\n<li>Messenger (線上)</li>\n<li>LINE (線上)</li>\n</ul>\n<p>Console 是 bottender 的特色之一，可以在終端機上直接測試 Bot 的行為，會先用此模式先測試路由的回覆是否正常。</p>\n<p>接著要讓同樣的 Action 可以導到 Messenger 以及 LINE，bottender 提供了可以設計針對特定平台處理 Action，如下:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; platform &#125; <span class=\"keyword\">from</span> <span class=\"string\">\"bottender/router\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">App</span>(<span class=\"params\"></span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    platform(<span class=\"string\">\"line\"</span>, LineAction),</span><br><span class=\"line\">    platform(<span class=\"string\">\"messenger\"</span>, MessengerAction),</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>透過<code>platform</code>來把特定平台的訊息到打對應的 Action (如 <code>LineAction</code>、<code>MessengerAction</code>)，在傳遞 Action 過程中會有一個 <code>context</code> 的變數，裡頭會有底層幫忙整理好的參數:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ConsoleContext &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  _session: &#123;</span><br><span class=\"line\">    _id: 5e08a45c719a1335aeae39bc,</span><br><span class=\"line\">    id: <span class=\"string\">'console:1'</span>,</span><br><span class=\"line\">    _state: &#123;&#125;,</span><br><span class=\"line\">    lastActivity: 1578743328620,</span><br><span class=\"line\">    platform: <span class=\"string\">'console'</span>,</span><br><span class=\"line\">    user: &#123; id: <span class=\"string\">'1'</span>, name: <span class=\"string\">'you'</span>, _updatedAt: <span class=\"string\">'2019-12-29T13:04:25.633Z'</span> &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>_session</code> 裡有個 <code>platform</code> 的參數，只要判斷這參數就能知道訊息是來自哪個平台，而<code>user</code>則是被正規化完後的使用者資訊 (這兩個參數為目前為止我最常用的參數)</p>\n<h2 id=\"遇到的問題\"><a href=\"#遇到的問題\" class=\"headerlink\" title=\"遇到的問題\"></a>遇到的問題</h2><p>由於長期使用 LINE flex message 的 button template (<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/view/line/games.ts#L56\" target=\"_blank\" rel=\"noopener\">參考</a>)，這按鈕事件可以設定按鈕上的文字並設定按下去回覆的字串。</p>\n<p>而 Messenger 的按鈕就跟人家不一樣了(<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/view/messenger/games.ts#L22\" target=\"_blank\" rel=\"noopener\">參考</a>)！他沒有 LINE 的這個事件，差不多的事件只有 <code>postback</code>，在路由上就得特別處理這個事件，為了讓跨平台所使用的內容要統一，在訊息進 router 時就要處理掉:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; messenger &#125; <span class=\"keyword\">from</span> <span class=\"string\">'bottender/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; withProps &#125; <span class=\"keyword\">from</span> <span class=\"string\">'bottender'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">LineAction</span>(<span class=\"params\">context</span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    text(<span class=\"regexp\">/^[f|F]ind\\s*(?&lt;topic&gt;.*)$/</span>, searchGame)</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">MessengerAction</span>(<span class=\"params\">context</span>): <span class=\"title\">Promise</span>&lt;<span class=\"title\">void</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> payload = context.event?.postback?.payload;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> router([</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    messenger.postback(</span><br><span class=\"line\">      withProps(searchGame, &#123; <span class=\"attr\">match</span>: &#123; <span class=\"attr\">groups</span>: &#123; <span class=\"attr\">topic</span>: payload &#125; &#125; &#125;)</span><br><span class=\"line\">    )</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  ]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>這邊找到 <a href=\"https://bottender.js.org/docs/channel-messenger-routing\" target=\"_blank\" rel=\"noopener\">bottender 官方文件</a>中函式專門在處理 Messenger 的 postback 事件，並搭配<code>withProps</code>來幫忙把參數 postback 收到的參數傳進對應 Action。</p>\n<p>為什麼會要把傳入的參數設定成巢狀 object -&gt; <code>{ match: { groups: { topic: payload }}}</code>，因為在設計初期本是希望進來的內容都是從<code>text</code>傳進來，意指都是透過使用者打字進來，那 bottender 都會透過傳 match 參數進來(<a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/controller/twitches/searchGame.ts#L7\" target=\"_blank\" rel=\"noopener\">參考</a>)，而解析完 Messenger 的 postback 時也得需要符合這樣的格式，因此就這樣設計，當然如果有更好的設計歡迎送 PR 🎉。</p>\n<h1 id=\"Chatbot-MVC\"><a href=\"#Chatbot-MVC\" class=\"headerlink\" title=\"Chatbot MVC\"></a>Chatbot MVC</h1><h2 id=\"Model\"><a href=\"#Model\" class=\"headerlink\" title=\"Model\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/blob/master/src/model\" target=\"_blank\" rel=\"noopener\">Model</a></h2><ul>\n<li><code>Twitch</code>: 這裡我設定 \u001cuserId 為 unique，針對每個平台有自己的 id，每個平台都可以綁定 twitch 帳號，進而去做相關操作。</li>\n<li><code>Game</code>: 因為 Twitch 套件這部分是<code>read only</code>，因此我就在建立一個一樣的 model 來處理。</li>\n</ul>\n<blockquote>\n<p>Twich id 是全開放的，只要知道其他使用者的 id 就可以查詢某些功能(<a href=\"https://dev.twitch.tv/docs/v5\" target=\"_blank\" rel=\"noopener\">參考</a>)，這邊我就使用查詢<code>追隨</code>的功能。</p>\n</blockquote>\n<h2 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/tree/master/src/view\" target=\"_blank\" rel=\"noopener\">View</a></h2><p>這裡設計上只要屬於送出訊息相關的樣板(<code>Flex</code>、<code>Genetic</code>、<code>Text</code>)接放在此。</p>\n<ul>\n<li>common: <code>作者資訊(author)</code> 以及 <code>幫助我(help)</code> 的相關</li>\n<li>LINE: Flex message 相關樣板</li>\n<li>messenger: Genetic template 相關樣板</li>\n</ul>\n<h2 id=\"Controller\"><a href=\"#Controller\" class=\"headerlink\" title=\"Controller\"></a><a href=\"https://github.com/louis70109/Twitch-Bot/tree/master/src/controller\" target=\"_blank\" rel=\"noopener\">Controller</a></h2><p>在呼叫 twitch api 出來的資料有時候會大於 LINE 以及 Messenger 的樣板限制，因此所有計算服務都會放在這邊，剛好就搭上 Controller 的對應功能。</p>\n<ul>\n<li>common: 負責將 controller 處理完的內容送至 <code>View</code></li>\n<li>twitch: 處理<code>最多人看得遊戲</code>以及<code>搜尋指定遊戲</code></li>\n<li>user: 處理<code>綁定</code>以及<code>查詢追隨</code></li>\n</ul>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>基本上做到這如果之後要擴增<code>Telegram</code>或是<code>Slack</code>都可以很快速擴充，只要把相對只要把相對的 Action 加在 <code>App.ts</code> 就行了。</p>\n<p>藉由這次也學到跨平台的機器人真的不好做，每家廠牌的行為都不一樣，所幸 bottender 已經處理大部分平台間的問題，接著我們只需要將欲輸出的內容處理好對應框架所提供的功能去回傳給使用者，讓整體的開發可以更專注在開發功能上並更有彈性。</p>\n<p>歡迎各位幫我按個星星 ⭐️➡️ <a href=\"https://github.com/louis70109/Twitch-Bot\" target=\"_blank\" rel=\"noopener\">https://github.com/louis70109/Twitch-Bot</a><br>也一起支持開源專案 <code>bottender</code>⭐️➡️ <a href=\"https://github.com/Yoctol/bottender\" target=\"_blank\" rel=\"noopener\">https://github.com/Yoctol/bottender</a></p>\n"},{"title":"第一次寫 Python SDK 實戰全記錄","abbrlink":1700005553,"date":"2020-05-03T11:46:49.000Z","_content":"\n![](https://i.imgur.com/Rms5ZNG.png)\n\n# 前言\n\n對於 LINE Notify 其實早早就一直有在使用，不管是 server 健康檢查、空汙通知、直播主開台通知...等，都一直使用著，也是因為一直在用時有個困擾，就是每次都要找 [API 文件](https://notify-bot.line.me/doc/en/)並且看對應的參數...這在開發流程上浪費了不少時間，也因為到 Pypi 套件庫裡找 LINE Notify 相關套件時大多都只有推送功能，幾乎沒有對於認證流程的操作的 function ，文件也不齊全，在此同時也看到卡米哥的 GitHub 在此時上傳了一個 [Notify SDK](https://github.com/etrex/lotify)，畢竟我對 Ruby 還不算陌生，就直接參考卡米哥的架構並加上單元測試來完成本篇要介紹的 - [Lotify](https://github.com/louis70109/lotify)\n\n<!-- more -->\n\n# [Lotify](https://github.com/louis70109/line-notify) 介紹\n\n先簡單列幾點以下會提到的部分：\n\n1. tests/ 是 mock 住 server 而不是 mock 請求函式\n2. requirements 分層用意\n3. SDK function init 設計用途\n4. README markdown to rst\n\n### 使用 flask 框架的範例程式碼 - [flask-line-notify](https://github.com/louis70109/flask-line-notify)\n\n這是 Lotify 的展開圖:\n![目錄架構](https://i.imgur.com/uXo7jA8.png)\n\n架構上參考許多 [line-bot-sdk-python](https://github.com/line/line-bot-sdk-python) 的使用方式，包括 `tests` 的寫法、`Travis`、`requirements`的環境分層、`tox`支援多版本的寫法...\n\n因為 python 有多版本支援的問題，雖然最後我沒支援到 2.7，不過寫法上其實已經可以支援，只差設定檔搞不清楚是哪邊的問題，這邊的優先權就排後面點～\n\n# 使用 - [responses](https://pypi.org/project/responses/) mock 對於 LINE server 請求與回應\n\n```\npip install responses\n```\n\n只要簡單使用 python 常用的 decorator 就可以讓這個函式快速的 mock 所有 requests，並且透過 `add()` 的方式可以把所有的 `Method`、`Url`、`status_code`、`json` 都模擬出來，使用方法可以參考以下的 code:\n\n```python\nimport responses\n\n@responses.activate\ndef test_get_access_token(self):\n    responses.add(\n        responses.POST,\n        '{url}/oauth/token'.format(url=self.bot_origin),\n        json={ 'access_token': self.token },\n        status=200\n    )\n\n    result = self.tested.get_access_token('foo')\n    request = responses.calls[0]\n    response = json.loads(request.response.content.decode())\n    self.assertEqual('POST', request.request.method)\n    self.assertEqual(result, response.get('access_token'))\n```\n\n會這麼用是因為若只用 patch 來 mock requests 的話對於測試真實度就會失真(黑箱)，讓請求正常執行而只擋下第三方 server，，雖然兩者行為差不多，但這樣的做法還是比較正確。\n\n# Requirements.txt 分層設計\n\n一般來說 python 的大家習慣使用`requirements.txt`這個檔案，但在寫 SDK 時需要跑測試，因此需要使用`pytest`以及`flake8`(Lint)相關套件，但使用者 clone 檔案時不一定需要跑測試，因此我就分為`requirements.txt`以及`requirements.dev.txt`，將兩個環境有需要的都放在`requirements.txt`中，跑測試需要的則都是放在另一個檔案。\n\n`requirements.dev.txt`只要在開頭放上`-r requirements.txt`就可以把另一個文字檔的套檢引進來囉！\n\n```\n-r requirements.txt\nresponses\npytest\n```\n\n# Client 設計原則\n\n<script src=\"https://gist.github.com/louis70109/e39302e76c66a450991fb2aea5838a35.js\"></script>\n\n## 傳至 Dummy server\n\n這邊 api_origin & bot_origin 會這樣設計是某次看到 bottender 文件上有使用這樣的設計，目的為了讓開發者可以把請求打回自己建立的 server 上，不管壓力測試或是負載平衡，如此一來彈性就大增了 🙂，因此參考之下就加入 SDK 的設計了。\n\n> Dummy 是很多地方都會用到的東西，像 AWS X-Ray 若需要阻擋下來的話也是用這個關鍵字去搜尋喔‼️\n\n## 預設環境變數 - `LINE_CLIENT_ID`、`LINE_CLIENT_SECRET`、`LINE_REDIRECT_URI`\n\n設定三個目的是可以讓使用者只要在`環境變數`中引入這三個參數，SDK 預設就會去載入至 Instance 中，當然使用者也可以手動輸入指定自己定義的變數名稱。\n😆\n放在 class level 用意是若開發者在起 server 時已經放在環境變數中，則不需要每次在 instance level 時才去環境變數中取值，稍微增加點效率(~~根本無感~~)。\n\n> 若對這部分不了解可以[參考這篇](https://www.digitalocean.com/community/tutorials/understanding-class-and-instance-variables-in-python-3)\n\n# Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件\n\n畢竟第一次寫，對於實際操作還不清楚，\b 在寫完第一版之後需要上傳，官方文件寫說 `long_description_content_type` 這個參數能設定 markdown 格式，但每每要上傳時都寫說不是 rst 格式不能上傳。\n\n找了許久後找到 [m2r 這個套件](https://github.com/miyakogi/m2r)，好處是可以在程式裡面就直接幫忙轉格式，因為若額外寫一個檔案對我來說在管理上實在太不方便，因此用套件幫忙轉，藉由這樣的方式每次更新完後就不用擔心 README 的問題囉！下面的 code 則是使用的片段:\n\n```python\ntry:\n    from m2r import parse_from_file\n\n    readme = parse_from_file(readme_file)\nexcept ImportError:\n    # m2r may not be installed in user environment\n    with open(readme_file) as f:\n        readme = f.read()\n\nsetup(\n    ...\n    long_description=readme,\n    long_description_content_type=\"text/x-rst\",\n    ...\n)\n```\n\n# 結論\n\n雖然只是單純包裝 LINE Notify 並加上`測試`確保狀態，但在這過程中遇到`設計問題`、`文件格式`、`Mock`、`依賴套件分層`的各種問題，運用在前公司學到的以及參考 open source \b\b 中很多的設計理念，不知道之後還有沒有機會開發新的 python SDK，學個經驗未來有個參考的文章 😁\n","source":"_posts/第一次寫-python-套件的實戰全記錄.md","raw":"---\ntitle: 第一次寫 Python SDK 實戰全記錄\ntags:\n  - Python\n  - LINE\n  - Lotify\ncategories: 學習紀錄\nabbrlink: 1700005553\ndate: 2020-05-03 19:46:49\n---\n\n![](https://i.imgur.com/Rms5ZNG.png)\n\n# 前言\n\n對於 LINE Notify 其實早早就一直有在使用，不管是 server 健康檢查、空汙通知、直播主開台通知...等，都一直使用著，也是因為一直在用時有個困擾，就是每次都要找 [API 文件](https://notify-bot.line.me/doc/en/)並且看對應的參數...這在開發流程上浪費了不少時間，也因為到 Pypi 套件庫裡找 LINE Notify 相關套件時大多都只有推送功能，幾乎沒有對於認證流程的操作的 function ，文件也不齊全，在此同時也看到卡米哥的 GitHub 在此時上傳了一個 [Notify SDK](https://github.com/etrex/lotify)，畢竟我對 Ruby 還不算陌生，就直接參考卡米哥的架構並加上單元測試來完成本篇要介紹的 - [Lotify](https://github.com/louis70109/lotify)\n\n<!-- more -->\n\n# [Lotify](https://github.com/louis70109/line-notify) 介紹\n\n先簡單列幾點以下會提到的部分：\n\n1. tests/ 是 mock 住 server 而不是 mock 請求函式\n2. requirements 分層用意\n3. SDK function init 設計用途\n4. README markdown to rst\n\n### 使用 flask 框架的範例程式碼 - [flask-line-notify](https://github.com/louis70109/flask-line-notify)\n\n這是 Lotify 的展開圖:\n![目錄架構](https://i.imgur.com/uXo7jA8.png)\n\n架構上參考許多 [line-bot-sdk-python](https://github.com/line/line-bot-sdk-python) 的使用方式，包括 `tests` 的寫法、`Travis`、`requirements`的環境分層、`tox`支援多版本的寫法...\n\n因為 python 有多版本支援的問題，雖然最後我沒支援到 2.7，不過寫法上其實已經可以支援，只差設定檔搞不清楚是哪邊的問題，這邊的優先權就排後面點～\n\n# 使用 - [responses](https://pypi.org/project/responses/) mock 對於 LINE server 請求與回應\n\n```\npip install responses\n```\n\n只要簡單使用 python 常用的 decorator 就可以讓這個函式快速的 mock 所有 requests，並且透過 `add()` 的方式可以把所有的 `Method`、`Url`、`status_code`、`json` 都模擬出來，使用方法可以參考以下的 code:\n\n```python\nimport responses\n\n@responses.activate\ndef test_get_access_token(self):\n    responses.add(\n        responses.POST,\n        '{url}/oauth/token'.format(url=self.bot_origin),\n        json={ 'access_token': self.token },\n        status=200\n    )\n\n    result = self.tested.get_access_token('foo')\n    request = responses.calls[0]\n    response = json.loads(request.response.content.decode())\n    self.assertEqual('POST', request.request.method)\n    self.assertEqual(result, response.get('access_token'))\n```\n\n會這麼用是因為若只用 patch 來 mock requests 的話對於測試真實度就會失真(黑箱)，讓請求正常執行而只擋下第三方 server，，雖然兩者行為差不多，但這樣的做法還是比較正確。\n\n# Requirements.txt 分層設計\n\n一般來說 python 的大家習慣使用`requirements.txt`這個檔案，但在寫 SDK 時需要跑測試，因此需要使用`pytest`以及`flake8`(Lint)相關套件，但使用者 clone 檔案時不一定需要跑測試，因此我就分為`requirements.txt`以及`requirements.dev.txt`，將兩個環境有需要的都放在`requirements.txt`中，跑測試需要的則都是放在另一個檔案。\n\n`requirements.dev.txt`只要在開頭放上`-r requirements.txt`就可以把另一個文字檔的套檢引進來囉！\n\n```\n-r requirements.txt\nresponses\npytest\n```\n\n# Client 設計原則\n\n<script src=\"https://gist.github.com/louis70109/e39302e76c66a450991fb2aea5838a35.js\"></script>\n\n## 傳至 Dummy server\n\n這邊 api_origin & bot_origin 會這樣設計是某次看到 bottender 文件上有使用這樣的設計，目的為了讓開發者可以把請求打回自己建立的 server 上，不管壓力測試或是負載平衡，如此一來彈性就大增了 🙂，因此參考之下就加入 SDK 的設計了。\n\n> Dummy 是很多地方都會用到的東西，像 AWS X-Ray 若需要阻擋下來的話也是用這個關鍵字去搜尋喔‼️\n\n## 預設環境變數 - `LINE_CLIENT_ID`、`LINE_CLIENT_SECRET`、`LINE_REDIRECT_URI`\n\n設定三個目的是可以讓使用者只要在`環境變數`中引入這三個參數，SDK 預設就會去載入至 Instance 中，當然使用者也可以手動輸入指定自己定義的變數名稱。\n😆\n放在 class level 用意是若開發者在起 server 時已經放在環境變數中，則不需要每次在 instance level 時才去環境變數中取值，稍微增加點效率(~~根本無感~~)。\n\n> 若對這部分不了解可以[參考這篇](https://www.digitalocean.com/community/tutorials/understanding-class-and-instance-variables-in-python-3)\n\n# Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件\n\n畢竟第一次寫，對於實際操作還不清楚，\b 在寫完第一版之後需要上傳，官方文件寫說 `long_description_content_type` 這個參數能設定 markdown 格式，但每每要上傳時都寫說不是 rst 格式不能上傳。\n\n找了許久後找到 [m2r 這個套件](https://github.com/miyakogi/m2r)，好處是可以在程式裡面就直接幫忙轉格式，因為若額外寫一個檔案對我來說在管理上實在太不方便，因此用套件幫忙轉，藉由這樣的方式每次更新完後就不用擔心 README 的問題囉！下面的 code 則是使用的片段:\n\n```python\ntry:\n    from m2r import parse_from_file\n\n    readme = parse_from_file(readme_file)\nexcept ImportError:\n    # m2r may not be installed in user environment\n    with open(readme_file) as f:\n        readme = f.read()\n\nsetup(\n    ...\n    long_description=readme,\n    long_description_content_type=\"text/x-rst\",\n    ...\n)\n```\n\n# 結論\n\n雖然只是單純包裝 LINE Notify 並加上`測試`確保狀態，但在這過程中遇到`設計問題`、`文件格式`、`Mock`、`依賴套件分層`的各種問題，運用在前公司學到的以及參考 open source \b\b 中很多的設計理念，不知道之後還有沒有機會開發新的 python SDK，學個經驗未來有個參考的文章 😁\n","slug":"第一次寫-python-套件的實戰全記錄","published":1,"updated":"2020-06-19T14:03:58.876Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lt005v7cri78xsr5zh","content":"<p><img src=\"https://i.imgur.com/Rms5ZNG.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>對於 LINE Notify 其實早早就一直有在使用，不管是 server 健康檢查、空汙通知、直播主開台通知…等，都一直使用著，也是因為一直在用時有個困擾，就是每次都要找 <a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">API 文件</a>並且看對應的參數…這在開發流程上浪費了不少時間，也因為到 Pypi 套件庫裡找 LINE Notify 相關套件時大多都只有推送功能，幾乎沒有對於認證流程的操作的 function ，文件也不齊全，在此同時也看到卡米哥的 GitHub 在此時上傳了一個 <a href=\"https://github.com/etrex/lotify\" target=\"_blank\" rel=\"noopener\">Notify SDK</a>，畢竟我對 Ruby 還不算陌生，就直接參考卡米哥的架構並加上單元測試來完成本篇要介紹的 - <a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">Lotify</a></p>\n<a id=\"more\"></a>\n\n<h1 id=\"Lotify-介紹\"><a href=\"#Lotify-介紹\" class=\"headerlink\" title=\"Lotify 介紹\"></a><a href=\"https://github.com/louis70109/line-notify\" target=\"_blank\" rel=\"noopener\">Lotify</a> 介紹</h1><p>先簡單列幾點以下會提到的部分：</p>\n<ol>\n<li>tests/ 是 mock 住 server 而不是 mock 請求函式</li>\n<li>requirements 分層用意</li>\n<li>SDK function init 設計用途</li>\n<li>README markdown to rst</li>\n</ol>\n<h3 id=\"使用-flask-框架的範例程式碼-flask-line-notify\"><a href=\"#使用-flask-框架的範例程式碼-flask-line-notify\" class=\"headerlink\" title=\"使用 flask 框架的範例程式碼 - flask-line-notify\"></a>使用 flask 框架的範例程式碼 - <a href=\"https://github.com/louis70109/flask-line-notify\" target=\"_blank\" rel=\"noopener\">flask-line-notify</a></h3><p>這是 Lotify 的展開圖:<br><img src=\"https://i.imgur.com/uXo7jA8.png\" alt=\"目錄架構\"></p>\n<p>架構上參考許多 <a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">line-bot-sdk-python</a> 的使用方式，包括 <code>tests</code> 的寫法、<code>Travis</code>、<code>requirements</code>的環境分層、<code>tox</code>支援多版本的寫法…</p>\n<p>因為 python 有多版本支援的問題，雖然最後我沒支援到 2.7，不過寫法上其實已經可以支援，只差設定檔搞不清楚是哪邊的問題，這邊的優先權就排後面點～</p>\n<h1 id=\"使用-responses-mock-對於-LINE-server-請求與回應\"><a href=\"#使用-responses-mock-對於-LINE-server-請求與回應\" class=\"headerlink\" title=\"使用 - responses mock 對於 LINE server 請求與回應\"></a>使用 - <a href=\"https://pypi.org/project/responses/\" target=\"_blank\" rel=\"noopener\">responses</a> mock 對於 LINE server 請求與回應</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install responses</span><br></pre></td></tr></table></figure>\n\n<p>只要簡單使用 python 常用的 decorator 就可以讓這個函式快速的 mock 所有 requests，並且透過 <code>add()</code> 的方式可以把所有的 <code>Method</code>、<code>Url</code>、<code>status_code</code>、<code>json</code> 都模擬出來，使用方法可以參考以下的 code:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> responses</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@responses.activate</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">test_get_access_token</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    responses.add(</span><br><span class=\"line\">        responses.POST,</span><br><span class=\"line\">        <span class=\"string\">'&#123;url&#125;/oauth/token'</span>.format(url=self.bot_origin),</span><br><span class=\"line\">        json=&#123; <span class=\"string\">'access_token'</span>: self.token &#125;,</span><br><span class=\"line\">        status=<span class=\"number\">200</span></span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">    result = self.tested.get_access_token(<span class=\"string\">'foo'</span>)</span><br><span class=\"line\">    request = responses.calls[<span class=\"number\">0</span>]</span><br><span class=\"line\">    response = json.loads(request.response.content.decode())</span><br><span class=\"line\">    self.assertEqual(<span class=\"string\">'POST'</span>, request.request.method)</span><br><span class=\"line\">    self.assertEqual(result, response.get(<span class=\"string\">'access_token'</span>))</span><br></pre></td></tr></table></figure>\n\n<p>會這麼用是因為若只用 patch 來 mock requests 的話對於測試真實度就會失真(黑箱)，讓請求正常執行而只擋下第三方 server，，雖然兩者行為差不多，但這樣的做法還是比較正確。</p>\n<h1 id=\"Requirements-txt-分層設計\"><a href=\"#Requirements-txt-分層設計\" class=\"headerlink\" title=\"Requirements.txt 分層設計\"></a>Requirements.txt 分層設計</h1><p>一般來說 python 的大家習慣使用<code>requirements.txt</code>這個檔案，但在寫 SDK 時需要跑測試，因此需要使用<code>pytest</code>以及<code>flake8</code>(Lint)相關套件，但使用者 clone 檔案時不一定需要跑測試，因此我就分為<code>requirements.txt</code>以及<code>requirements.dev.txt</code>，將兩個環境有需要的都放在<code>requirements.txt</code>中，跑測試需要的則都是放在另一個檔案。</p>\n<p><code>requirements.dev.txt</code>只要在開頭放上<code>-r requirements.txt</code>就可以把另一個文字檔的套檢引進來囉！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-r requirements.txt</span><br><span class=\"line\">responses</span><br><span class=\"line\">pytest</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Client-設計原則\"><a href=\"#Client-設計原則\" class=\"headerlink\" title=\"Client 設計原則\"></a>Client 設計原則</h1><script src=\"https://gist.github.com/louis70109/e39302e76c66a450991fb2aea5838a35.js\"></script>\n\n<h2 id=\"傳至-Dummy-server\"><a href=\"#傳至-Dummy-server\" class=\"headerlink\" title=\"傳至 Dummy server\"></a>傳至 Dummy server</h2><p>這邊 api_origin &amp; bot_origin 會這樣設計是某次看到 bottender 文件上有使用這樣的設計，目的為了讓開發者可以把請求打回自己建立的 server 上，不管壓力測試或是負載平衡，如此一來彈性就大增了 🙂，因此參考之下就加入 SDK 的設計了。</p>\n<blockquote>\n<p>Dummy 是很多地方都會用到的東西，像 AWS X-Ray 若需要阻擋下來的話也是用這個關鍵字去搜尋喔‼️</p>\n</blockquote>\n<h2 id=\"預設環境變數-LINE-CLIENT-ID、LINE-CLIENT-SECRET、LINE-REDIRECT-URI\"><a href=\"#預設環境變數-LINE-CLIENT-ID、LINE-CLIENT-SECRET、LINE-REDIRECT-URI\" class=\"headerlink\" title=\"預設環境變數 - LINE_CLIENT_ID、LINE_CLIENT_SECRET、LINE_REDIRECT_URI\"></a>預設環境變數 - <code>LINE_CLIENT_ID</code>、<code>LINE_CLIENT_SECRET</code>、<code>LINE_REDIRECT_URI</code></h2><p>設定三個目的是可以讓使用者只要在<code>環境變數</code>中引入這三個參數，SDK 預設就會去載入至 Instance 中，當然使用者也可以手動輸入指定自己定義的變數名稱。<br>😆<br>放在 class level 用意是若開發者在起 server 時已經放在環境變數中，則不需要每次在 instance level 時才去環境變數中取值，稍微增加點效率(<del>根本無感</del>)。</p>\n<blockquote>\n<p>若對這部分不了解可以<a href=\"https://www.digitalocean.com/community/tutorials/understanding-class-and-instance-variables-in-python-3\" target=\"_blank\" rel=\"noopener\">參考這篇</a></p>\n</blockquote>\n<h1 id=\"Markdown-轉-RestructuredText-的麻煩事-使用-m2r-套件\"><a href=\"#Markdown-轉-RestructuredText-的麻煩事-使用-m2r-套件\" class=\"headerlink\" title=\"Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件\"></a>Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件</h1><p>畢竟第一次寫，對於實際操作還不清楚，\b 在寫完第一版之後需要上傳，官方文件寫說 <code>long_description_content_type</code> 這個參數能設定 markdown 格式，但每每要上傳時都寫說不是 rst 格式不能上傳。</p>\n<p>找了許久後找到 <a href=\"https://github.com/miyakogi/m2r\" target=\"_blank\" rel=\"noopener\">m2r 這個套件</a>，好處是可以在程式裡面就直接幫忙轉格式，因為若額外寫一個檔案對我來說在管理上實在太不方便，因此用套件幫忙轉，藉由這樣的方式每次更新完後就不用擔心 README 的問題囉！下面的 code 則是使用的片段:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">from</span> m2r <span class=\"keyword\">import</span> parse_from_file</span><br><span class=\"line\"></span><br><span class=\"line\">    readme = parse_from_file(readme_file)</span><br><span class=\"line\"><span class=\"keyword\">except</span> ImportError:</span><br><span class=\"line\">    <span class=\"comment\"># m2r may not be installed in user environment</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> open(readme_file) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">        readme = f.read()</span><br><span class=\"line\"></span><br><span class=\"line\">setup(</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    long_description=readme,</span><br><span class=\"line\">    long_description_content_type=<span class=\"string\">\"text/x-rst\"</span>,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然只是單純包裝 LINE Notify 並加上<code>測試</code>確保狀態，但在這過程中遇到<code>設計問題</code>、<code>文件格式</code>、<code>Mock</code>、<code>依賴套件分層</code>的各種問題，運用在前公司學到的以及參考 open source \b\b 中很多的設計理念，不知道之後還有沒有機會開發新的 python SDK，學個經驗未來有個參考的文章 😁</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/Rms5ZNG.png\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>對於 LINE Notify 其實早早就一直有在使用，不管是 server 健康檢查、空汙通知、直播主開台通知…等，都一直使用著，也是因為一直在用時有個困擾，就是每次都要找 <a href=\"https://notify-bot.line.me/doc/en/\" target=\"_blank\" rel=\"noopener\">API 文件</a>並且看對應的參數…這在開發流程上浪費了不少時間，也因為到 Pypi 套件庫裡找 LINE Notify 相關套件時大多都只有推送功能，幾乎沒有對於認證流程的操作的 function ，文件也不齊全，在此同時也看到卡米哥的 GitHub 在此時上傳了一個 <a href=\"https://github.com/etrex/lotify\" target=\"_blank\" rel=\"noopener\">Notify SDK</a>，畢竟我對 Ruby 還不算陌生，就直接參考卡米哥的架構並加上單元測試來完成本篇要介紹的 - <a href=\"https://github.com/louis70109/lotify\" target=\"_blank\" rel=\"noopener\">Lotify</a></p>","more":"<h1 id=\"Lotify-介紹\"><a href=\"#Lotify-介紹\" class=\"headerlink\" title=\"Lotify 介紹\"></a><a href=\"https://github.com/louis70109/line-notify\" target=\"_blank\" rel=\"noopener\">Lotify</a> 介紹</h1><p>先簡單列幾點以下會提到的部分：</p>\n<ol>\n<li>tests/ 是 mock 住 server 而不是 mock 請求函式</li>\n<li>requirements 分層用意</li>\n<li>SDK function init 設計用途</li>\n<li>README markdown to rst</li>\n</ol>\n<h3 id=\"使用-flask-框架的範例程式碼-flask-line-notify\"><a href=\"#使用-flask-框架的範例程式碼-flask-line-notify\" class=\"headerlink\" title=\"使用 flask 框架的範例程式碼 - flask-line-notify\"></a>使用 flask 框架的範例程式碼 - <a href=\"https://github.com/louis70109/flask-line-notify\" target=\"_blank\" rel=\"noopener\">flask-line-notify</a></h3><p>這是 Lotify 的展開圖:<br><img src=\"https://i.imgur.com/uXo7jA8.png\" alt=\"目錄架構\"></p>\n<p>架構上參考許多 <a href=\"https://github.com/line/line-bot-sdk-python\" target=\"_blank\" rel=\"noopener\">line-bot-sdk-python</a> 的使用方式，包括 <code>tests</code> 的寫法、<code>Travis</code>、<code>requirements</code>的環境分層、<code>tox</code>支援多版本的寫法…</p>\n<p>因為 python 有多版本支援的問題，雖然最後我沒支援到 2.7，不過寫法上其實已經可以支援，只差設定檔搞不清楚是哪邊的問題，這邊的優先權就排後面點～</p>\n<h1 id=\"使用-responses-mock-對於-LINE-server-請求與回應\"><a href=\"#使用-responses-mock-對於-LINE-server-請求與回應\" class=\"headerlink\" title=\"使用 - responses mock 對於 LINE server 請求與回應\"></a>使用 - <a href=\"https://pypi.org/project/responses/\" target=\"_blank\" rel=\"noopener\">responses</a> mock 對於 LINE server 請求與回應</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install responses</span><br></pre></td></tr></table></figure>\n\n<p>只要簡單使用 python 常用的 decorator 就可以讓這個函式快速的 mock 所有 requests，並且透過 <code>add()</code> 的方式可以把所有的 <code>Method</code>、<code>Url</code>、<code>status_code</code>、<code>json</code> 都模擬出來，使用方法可以參考以下的 code:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> responses</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@responses.activate</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">test_get_access_token</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    responses.add(</span><br><span class=\"line\">        responses.POST,</span><br><span class=\"line\">        <span class=\"string\">'&#123;url&#125;/oauth/token'</span>.format(url=self.bot_origin),</span><br><span class=\"line\">        json=&#123; <span class=\"string\">'access_token'</span>: self.token &#125;,</span><br><span class=\"line\">        status=<span class=\"number\">200</span></span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">    result = self.tested.get_access_token(<span class=\"string\">'foo'</span>)</span><br><span class=\"line\">    request = responses.calls[<span class=\"number\">0</span>]</span><br><span class=\"line\">    response = json.loads(request.response.content.decode())</span><br><span class=\"line\">    self.assertEqual(<span class=\"string\">'POST'</span>, request.request.method)</span><br><span class=\"line\">    self.assertEqual(result, response.get(<span class=\"string\">'access_token'</span>))</span><br></pre></td></tr></table></figure>\n\n<p>會這麼用是因為若只用 patch 來 mock requests 的話對於測試真實度就會失真(黑箱)，讓請求正常執行而只擋下第三方 server，，雖然兩者行為差不多，但這樣的做法還是比較正確。</p>\n<h1 id=\"Requirements-txt-分層設計\"><a href=\"#Requirements-txt-分層設計\" class=\"headerlink\" title=\"Requirements.txt 分層設計\"></a>Requirements.txt 分層設計</h1><p>一般來說 python 的大家習慣使用<code>requirements.txt</code>這個檔案，但在寫 SDK 時需要跑測試，因此需要使用<code>pytest</code>以及<code>flake8</code>(Lint)相關套件，但使用者 clone 檔案時不一定需要跑測試，因此我就分為<code>requirements.txt</code>以及<code>requirements.dev.txt</code>，將兩個環境有需要的都放在<code>requirements.txt</code>中，跑測試需要的則都是放在另一個檔案。</p>\n<p><code>requirements.dev.txt</code>只要在開頭放上<code>-r requirements.txt</code>就可以把另一個文字檔的套檢引進來囉！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-r requirements.txt</span><br><span class=\"line\">responses</span><br><span class=\"line\">pytest</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Client-設計原則\"><a href=\"#Client-設計原則\" class=\"headerlink\" title=\"Client 設計原則\"></a>Client 設計原則</h1><script src=\"https://gist.github.com/louis70109/e39302e76c66a450991fb2aea5838a35.js\"></script>\n\n<h2 id=\"傳至-Dummy-server\"><a href=\"#傳至-Dummy-server\" class=\"headerlink\" title=\"傳至 Dummy server\"></a>傳至 Dummy server</h2><p>這邊 api_origin &amp; bot_origin 會這樣設計是某次看到 bottender 文件上有使用這樣的設計，目的為了讓開發者可以把請求打回自己建立的 server 上，不管壓力測試或是負載平衡，如此一來彈性就大增了 🙂，因此參考之下就加入 SDK 的設計了。</p>\n<blockquote>\n<p>Dummy 是很多地方都會用到的東西，像 AWS X-Ray 若需要阻擋下來的話也是用這個關鍵字去搜尋喔‼️</p>\n</blockquote>\n<h2 id=\"預設環境變數-LINE-CLIENT-ID、LINE-CLIENT-SECRET、LINE-REDIRECT-URI\"><a href=\"#預設環境變數-LINE-CLIENT-ID、LINE-CLIENT-SECRET、LINE-REDIRECT-URI\" class=\"headerlink\" title=\"預設環境變數 - LINE_CLIENT_ID、LINE_CLIENT_SECRET、LINE_REDIRECT_URI\"></a>預設環境變數 - <code>LINE_CLIENT_ID</code>、<code>LINE_CLIENT_SECRET</code>、<code>LINE_REDIRECT_URI</code></h2><p>設定三個目的是可以讓使用者只要在<code>環境變數</code>中引入這三個參數，SDK 預設就會去載入至 Instance 中，當然使用者也可以手動輸入指定自己定義的變數名稱。<br>😆<br>放在 class level 用意是若開發者在起 server 時已經放在環境變數中，則不需要每次在 instance level 時才去環境變數中取值，稍微增加點效率(<del>根本無感</del>)。</p>\n<blockquote>\n<p>若對這部分不了解可以<a href=\"https://www.digitalocean.com/community/tutorials/understanding-class-and-instance-variables-in-python-3\" target=\"_blank\" rel=\"noopener\">參考這篇</a></p>\n</blockquote>\n<h1 id=\"Markdown-轉-RestructuredText-的麻煩事-使用-m2r-套件\"><a href=\"#Markdown-轉-RestructuredText-的麻煩事-使用-m2r-套件\" class=\"headerlink\" title=\"Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件\"></a>Markdown 轉 RestructuredText 的麻煩事 - 使用 m2r 套件</h1><p>畢竟第一次寫，對於實際操作還不清楚，\b 在寫完第一版之後需要上傳，官方文件寫說 <code>long_description_content_type</code> 這個參數能設定 markdown 格式，但每每要上傳時都寫說不是 rst 格式不能上傳。</p>\n<p>找了許久後找到 <a href=\"https://github.com/miyakogi/m2r\" target=\"_blank\" rel=\"noopener\">m2r 這個套件</a>，好處是可以在程式裡面就直接幫忙轉格式，因為若額外寫一個檔案對我來說在管理上實在太不方便，因此用套件幫忙轉，藉由這樣的方式每次更新完後就不用擔心 README 的問題囉！下面的 code 則是使用的片段:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">from</span> m2r <span class=\"keyword\">import</span> parse_from_file</span><br><span class=\"line\"></span><br><span class=\"line\">    readme = parse_from_file(readme_file)</span><br><span class=\"line\"><span class=\"keyword\">except</span> ImportError:</span><br><span class=\"line\">    <span class=\"comment\"># m2r may not be installed in user environment</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> open(readme_file) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">        readme = f.read()</span><br><span class=\"line\"></span><br><span class=\"line\">setup(</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    long_description=readme,</span><br><span class=\"line\">    long_description_content_type=<span class=\"string\">\"text/x-rst\"</span>,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>雖然只是單純包裝 LINE Notify 並加上<code>測試</code>確保狀態，但在這過程中遇到<code>設計問題</code>、<code>文件格式</code>、<code>Mock</code>、<code>依賴套件分層</code>的各種問題，運用在前公司學到的以及參考 open source \b\b 中很多的設計理念，不知道之後還有沒有機會開發新的 python SDK，學個經驗未來有個參考的文章 😁</p>"},{"title":"從 Http 請求到認識 OAuth 以及 OpenID","abbrlink":4259746686,"date":"2020-05-31T18:26:55.000Z","_content":"\n![](https://cdn.pixabay.com/photo/2015/03/10/18/46/taiwan-667565_960_720.jpg)\n\n# 前言\n\n最近因為在找新工作，同時也需要把一些知識打穩，既然常在寫 side project，那麼一定要對於 http 請求後發生什麼事、SSL、OAuth、OpenID 都需要理解清楚，否則串了這麼多服務也寫了應用，但在關鍵時沒講出來的話作品就發揮不出它的功用了 😞，那麼以下就會用我的觀點以及紀錄方法來敘述這些功能。\n\n> 註：若有發現有什麼問題或內容有誤的話麻煩再留言讓我知道，或是`寄信`給我也是可以喔！\n\n# 從輸入`https://www.google.com`之後發生了什麼事?\n\n首先須了解`https://www.google.com`這樣的網址是如何組成:\n\n<!-- more -->\n\n1. https: 通訊協定，其他常見如: tcp、udp、websocket、mqtt...\n2. www: 常聽到的 sub domain 就指這個部分，也會聽到 host 的名稱，意指在一個 Domain 下若有多個主機時則用這個部分來指定名稱為特定主機，一般預設進入點為 `www`。\n3. .google: 這部分學名為 `Second Level Domain`(SLD)，在 Top level domain 搜尋完後接著搜尋的層級，通常為個人品牌、公司行號為名稱。\n4. .com: 這層名為 `Top Level Domain`(TLD)，常見為 com、org、gov、edu、io，較好理解的方式我認為就是把當前進入點判斷為何種`組織`，再以此分類下去找 SLD，有點二元搜尋的概念 😁。\n5. root: 一開始我看到這部分也覺得霧煞煞，簡單來說每個域名(Domain)的結尾都會有 `.` 這個小數點，它是指域名(Domain)的進入點，所有上的 Domain 都會從這個地方開始判斷。\n\n> 上述是照著網址由左而右寫，實際上則是從右往左判斷\n\n上面步驟已經說明清楚每個部分了，接下來就說明從瀏覽器輸入網址後的步驟吧！\n\n## 向 DNS 要 IP\n\n```puml\n@startuml\nUser -> (Browser): 1. https://www.google.com\n(Browser) -down-> (DNS): 2. 請給我 IP\n(DNS) <--> (Name Server): 3. 將 Domain 轉成 IP\n(DNS) --> (Browser): 4. IP 為 123.223.45.6\n(Browser) -right-> (123.223.45.6): 5.取得 IP 後訪問主機\\n並下載資源\n(123.223.45.6) --> (Web Server): 6. 索取資源\n(Web Server) -right-> (123.223.45.6): 7. 回傳\\n靜態檔案\\nJSON 或 XML\n(123.223.45.6) -> (Browser): 8. 回傳靜態資料\n(Browser) -right-> User: 9. 渲染畫面\nnote left of (Name Server)\n  處理四個部分:\n  root\n  .com\n  www\n  .google\nend note\n@enduml\n```\n\nDNS 全名為 Domain Name Server，主要職責是幫忙把 網域名稱(Domain Name) 轉成 IP，因為網域名稱是人才看得懂而機器只認得 IP，因此需要 DNS 來幫忙轉譯。\n\n### Name Server\n\n藉由上圖最終 DNS 會收到每個單獨的 Name Server 回傳後的值並組成 IP 回傳給瀏覽器。\n\n## 跟 IP 請求資源\n\n待瀏覽器收到 IP 後去請求資源，而 IP (資源方)那一般來說都會有個 Web Server 擋在前面(Nginx、Apache)，若是有前端頁面則是讓瀏覽器下載靜態檔案(static)，而若只是單純導向至 API 的話就直接回傳定義的資料格式(JSON、XML...)。\n\n## 快取\n\n此時瀏覽器下載完後則會存到快取(Cache)裡，加速下次載入。\n\n## 渲染\n\n![https://i.imgur.com/ddrEQxs.png](https://i.imgur.com/ddrEQxs.png)\n\n> 參考[六角學院](https://w3c.hexschool.com/blog/8d691e4f)\n\n這邊就簡單敘述一下前端渲染發生的經過，HTML 會產生出一個 `DOM Tree`，CSS 會有一個 `CSSOM Tree`，在各別產生完後會合併成一個 `render Tree`，最後經由 `layout` 的步驟讓瀏覽器將 Tree 渲染至畫面上，完成畫面顯示的步驟。\n\n- 上述的 DOM 就是寫 jQuery 時呼叫的那個 DOM 元素\n\n以上就是當你輸入一個網址後會遇到的事情經過～\n\n# 輸入網址後，你怎能不知道怎麼連線呢？\n\n## 準備連線 - 三方交握 (Three-Way Handshake)\n\n```puml\n@startuml\nClient -> Server: 我需要連線(SYN)，回答請用 M\nServer -> Client: 收到了，是 M+1 嗎(ACK)？\\n 回答請用 N (SYN)\nClient -> Server: 收到了，N+1 是我收到的訊號(ACK)\nClient <--> Server: Server 確認完後開始連線\n@enduml\n```\n\n這邊我用最簡單的表示，`SYN`在三方交握會是一個帶有序列號(n)的請求，而`ACK`則是代表回應對方我們這邊收到的訊號，會帶有 n+1 的數字回傳。\n\n在三方交握中，會先由 Client 告訴 Server 現在它要連線並給一個數字，回傳時會送 n+1 的原因是避免在請求的過程中因各種因素導致回來的值錯誤時的一個防範機制，用 `+1` 這個做法來確保對方給的回傳值是我剛剛送出去的值 +1，避免連線過程中混亂。\n\n簡單的記法就是從 Client 先送一個數字 N 給 Server，而回傳時一定是給 N+1 並且帶著一個 M，Client 收到後確認完則在回傳 M+1 讓 Server 也確定 CLient 收到了，完成三次連線。\n\n### Bonus - 為什麼不兩次或四次交握呢？\n\n經過上述的流程，一定是一個發(SYN)，一個收完後告訴對方它收到(ACK)，那如果是只有`兩次`， Client 會不知道 Server 收到沒，導致這次連線失敗。\n\n然後四次、五次、六次其實都是可以做到的，但只是工程師在實作東西時都會盡可能的精簡它，所以為了不浪費系統資源，因此最低次數就是`三次`！🎉\n\n## 斷開連線 - 四次揮手(Four-Way Wavehand)\n\n> 四次揮手是用 FIN 以及 ACK 當作 請求 以及 回應\n\n![https://i.imgur.com/wZk7hoS.png](https://i.imgur.com/wZk7hoS.png)\n\n> 圖片[參考](<(https://kknews.cc/code/yr9ng6j.html)>)\n\n> Client = 1, Server = 2 的話，順序就是 1 - 2 - 2 - 1\n\n我了解這部分的方法是\n\n#### 每個關閉連線時都需要等待\n\n所以向 Client 送請求(`FIN`)到 Server 會先告訴 Client 已經收到(`ACK`)，處理完後再送一個請求給 Client，Client 最後就在回應 Server 告訴他能關閉來斷開連線。\n\n因為是在第三步驟最後回應時需要等待 Server 的主動發送，因此交握的最低數量就變成`4`了。\n\n基本上跟三方交握流程是一樣的，差別在於到 Server 時不會馬上告訴 Client 等等要回應的值(N)是多少，而是等 ACK 完後過一陣子才回傳 publish FIN flag。\n\n詳細可以參考[這篇](https://kknews.cc/code/yr9ng6j.html)\n\n# SSL\n\n經過了上面無情摧殘後，接下來就是要認識 SSL 這個安全機制了。\n\n![](https://i.imgur.com/5tk4osI.png)\n\n除非你的網站內容是全靜態輸出，完全沒串任何 API，否則沒有 SSL 安全性實在是嚴重不足啊！因為沒有 SSL 的網站會享有[中間人攻擊](https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB)的優惠，那既然那麼重要接著就來介紹吧！\n\n> 這裡會簡單敘述一下流程以及功能，但詳細的還是要參考其他部落格詳細的文章喔！\n\n## SSL 有的裝備\n\nSSL 申請時一般都會給三種東西，公鑰(Public key)、私鑰(Private key)、CA(Certificate authority)\n\n1. 公鑰是 Server 發給信任裝置使用的鑰匙\n2. 私鑰則是解開來自信任裝置加密封包的鑰匙\n3. CA 是 Server 的證書，用來確認 Server 的合法性，若只拿私鑰來解也會含有中間人攻擊的問題\n\n## 流程\n\n![https://i.imgur.com/oeLkNoP.png](https://i.imgur.com/oeLkNoP.png)\n\n> 圖片參考[阮一峰的部落格](http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html)\n\nVisitor 就等於前面文章提到的 Client，而 CloudFlare 則等於 Server 端。\n\n1. Client 把一個`隨機數`並發送給 Server\n2. Server 在產生一組`隨機數+公鑰`給 Client\n3. Client 利用收到的`隨機數+公鑰`加密資料回傳給 Server\n4. Server 用`私鑰`來解開資料\n5. 拿著上圖灰色虛線的東西來產生 Session Key 確認對方\n\n> 隨機數用意為讓密鑰每次產生都不一樣\n\n## SSL 小結\n\n這邊沒有提太多實作跟詳細內容，但看著上述的流程來說有沒有覺得其實跟`三方交握`很像，差別在於 Server 端回傳時有多給 Client 一個公鑰(Public Key)，所以再記這部分時，利用三方交握來理解這件事情，基本上就如魚得水了！😊\n\n# OAuth\n\n接著就一起陪我釐清 OAuth 吧！\n\n## 說明\n\n讓客戶端能以 OAuth 開放標準在第三方應用程式上透過授權(Authorization)的方式取得在服務提供商(LINE、Facebook、Google...)的資料(檔案、照片、影片...)。\n\n## 擁有四種角色\n\n- Resource Owner(簡稱 RO)：可以授權於`終端用戶`存取受保護之資料。\n- Resource Server(簡稱 RS)：存取受保護資料的地方，根據 Access Token 之權限處理請求。\n- Client：代表使用者去存取受保護資料的應用程式。Client 指任何在 Server 端、桌面或設備上執行的應用程式。\n- Authorization Server(簡稱 AS)：職責為認證過使用者的身份，且經由使用者許可後，就會簽發 Access Token 的地方。\n\n## 流程\n\n以下為一個 OAuth 的流程:\n\n```\n+--------+                               +---------------+\n|        |--(1)- Authorization Request ->|   Resource    |\n|        |                               |     Owner     |\n|        |<-(2)-- Authorization Grant ---|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(3)-- Authorization Grant -->| Authorization |\n| Client |                               |     Server    |\n|        |<-(4)----- Access Token -------|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(5)----- Access Token ------>|    Resource   |\n|        |                               |     Server    |\n|        |<-(6)--- Protected Resource ---|               |\n+--------+                               +---------------+\n```\n\n## 小故事\n\n以下會分別用四個角色代替他們：\nClient = A 員工、RO = 大樓警衛、AS = 公司櫃檯、RS = 倉庫\n\n並用小故事說明，情境是員工假日需返回公司倉庫拿取零件，但是卻沒帶公司的證件，而公司是在商業辦公室中，大樓警衛認不得這麼多間公司的人，因此需要按照基本流程才能進公司拿取資料，A 員工抵達商辦大樓後：\n\n1. A 員工拿證件出來並填寫基本資料的單子給警衛 (發送請求)\n2. 警衛確認完後拿了一個暫時性的鑰匙(`code`)給 A 員工\n3. A 員工拿著暫時性鑰匙(`code`)跟公司櫃檯\n4. 櫃檯將臨時鑰匙(`code`)換成公司的門禁卡(Access Token)\n5. A 員工去倉庫使用門禁卡(Access Token)開倉庫門\n6. 倉庫門打開後 A 員工從裡面拿取自己需要的零件(Protected Resource)\n\n> 透過這樣的解釋應該比較好懂吧 ❓\n\n## 小結\n\n看著流程圖，有沒有覺得它還是很像三方交握嗎？只是 Server 端功能切開變成微服務的樣子，並透過三個步驟來獲取 Server 的資源，如此一來會不會覺得這樣親切點呢？\n\n希望能藉由文章的敘述讓你能更快速點了解這些玩意兒。\n\n# OpenID Connect\n\n大家寫了這麼多 side project，對 OAuth 的見聞與使用一定不在其數，但實際上在做像是 LINE Login、Facebook、Google 這類型的 Single Sign On(SSO) 的服務時很常誤以為 `SSO == OAuth`，答案是錯的，SSO 這件事情本身是由 OpenID 來實現，對於實際的原由呢，這邊有[很詳細的介紹](https://medium.com/@petertc/openid-connect-a27e0a3cc2ae)，這邊就不贅述。\n\n主要的核心我覺得要記得這件事：\n\n```\nOpenID Connect 是認證（Authentication），OAuth 2.0 則是授權（Authorization）\n```\n\n一般來說只要搞懂這兩個字的意思，並透過實作經驗加上記得文件內容，就會對於 OpenID 以及 OAuth 個別的職責是什麼很清楚。\n\n![](https://i.imgur.com/WghYZJM.png)\n\n> 這邊一樣參考 petertc 的[文章](https://medium.com/@petertc/openid-connect-a27e0a3cc2ae)\n\n上圖流程可能太複雜，這裡簡單敘述一下，就是他流程基本上與 OAuth 差不多，因為 OpenID 就是在 OAuth 上加一層`使用者認證層(User Identify Layer)`，若記得上述 OAuth 的話，OpenID 會在取得 Access Token 的同時取得一個 ID Token，以下說明一下 ID Token：\n\nID Token 一般比較常見是 Json Web Token(JWT) 的格式，使用者的資訊一般都會放在這邊，只要拿到了這個就可以跟資料庫去 mapping 就能做使用者管理囉 ❗️\n\n## 小結\n\nOpenID 其中一部分解決了 OAuth scope 這參數定義的問題，在 OpenID 還沒出來之前這個時基本上是服務提供商說的算，眾說紛紜的話那就損失了公信力，因此 OpenID 的 scope 除了要必須輸入 `openid` 以外呢，他還有規定可以輸入`email`、`phone`、`profile`，因此在有規範後在串接第三方服務後就不會各說各的啦！\n\n此外這邊需要再重複一次，OpenID 是`驗證`與各戶端的交握過程後並給初使用者資料，而 OAuth 則是`授權`於應用程式可以取用服務中的某個資料(從倉庫拿貨)，如此一來就能較有效的記得 OpenID 與 OAuth 的差異囉！\n\n# 結論\n\n在這些熱門面試題中往往是準備不完的 😅，但如何有效的記得這些東西的步驟卻是很重要，畢竟不可能只把 HTTP、SSL、OpenID、OAuth 讀完面試就過了吧？還有演算法、資料庫 這些哩哩摳摳的需要釐清，當然這邊是整理出我自己的紀錄方法，希望能透過我的方法讓你能夠更快速的釐清這些功能，但看完了各個文章後還是記得要看官方文件，把真正的東西學進去才是對自己有益的喔！\n\n那本篇就先記錄到這，希望大家能有收穫 😁\n","source":"_posts/從-Http-請求到認識-OAuth-以及-OpenID.md","raw":"---\ntitle: 從 Http 請求到認識 OAuth 以及 OpenID\ntags:\n  - Http\n  - SSL\n  - OAuth\n  - OpenID\ncategories: 學習紀錄\nabbrlink: 4259746686\ndate: 2020-06-01 02:26:55\n---\n\n![](https://cdn.pixabay.com/photo/2015/03/10/18/46/taiwan-667565_960_720.jpg)\n\n# 前言\n\n最近因為在找新工作，同時也需要把一些知識打穩，既然常在寫 side project，那麼一定要對於 http 請求後發生什麼事、SSL、OAuth、OpenID 都需要理解清楚，否則串了這麼多服務也寫了應用，但在關鍵時沒講出來的話作品就發揮不出它的功用了 😞，那麼以下就會用我的觀點以及紀錄方法來敘述這些功能。\n\n> 註：若有發現有什麼問題或內容有誤的話麻煩再留言讓我知道，或是`寄信`給我也是可以喔！\n\n# 從輸入`https://www.google.com`之後發生了什麼事?\n\n首先須了解`https://www.google.com`這樣的網址是如何組成:\n\n<!-- more -->\n\n1. https: 通訊協定，其他常見如: tcp、udp、websocket、mqtt...\n2. www: 常聽到的 sub domain 就指這個部分，也會聽到 host 的名稱，意指在一個 Domain 下若有多個主機時則用這個部分來指定名稱為特定主機，一般預設進入點為 `www`。\n3. .google: 這部分學名為 `Second Level Domain`(SLD)，在 Top level domain 搜尋完後接著搜尋的層級，通常為個人品牌、公司行號為名稱。\n4. .com: 這層名為 `Top Level Domain`(TLD)，常見為 com、org、gov、edu、io，較好理解的方式我認為就是把當前進入點判斷為何種`組織`，再以此分類下去找 SLD，有點二元搜尋的概念 😁。\n5. root: 一開始我看到這部分也覺得霧煞煞，簡單來說每個域名(Domain)的結尾都會有 `.` 這個小數點，它是指域名(Domain)的進入點，所有上的 Domain 都會從這個地方開始判斷。\n\n> 上述是照著網址由左而右寫，實際上則是從右往左判斷\n\n上面步驟已經說明清楚每個部分了，接下來就說明從瀏覽器輸入網址後的步驟吧！\n\n## 向 DNS 要 IP\n\n```puml\n@startuml\nUser -> (Browser): 1. https://www.google.com\n(Browser) -down-> (DNS): 2. 請給我 IP\n(DNS) <--> (Name Server): 3. 將 Domain 轉成 IP\n(DNS) --> (Browser): 4. IP 為 123.223.45.6\n(Browser) -right-> (123.223.45.6): 5.取得 IP 後訪問主機\\n並下載資源\n(123.223.45.6) --> (Web Server): 6. 索取資源\n(Web Server) -right-> (123.223.45.6): 7. 回傳\\n靜態檔案\\nJSON 或 XML\n(123.223.45.6) -> (Browser): 8. 回傳靜態資料\n(Browser) -right-> User: 9. 渲染畫面\nnote left of (Name Server)\n  處理四個部分:\n  root\n  .com\n  www\n  .google\nend note\n@enduml\n```\n\nDNS 全名為 Domain Name Server，主要職責是幫忙把 網域名稱(Domain Name) 轉成 IP，因為網域名稱是人才看得懂而機器只認得 IP，因此需要 DNS 來幫忙轉譯。\n\n### Name Server\n\n藉由上圖最終 DNS 會收到每個單獨的 Name Server 回傳後的值並組成 IP 回傳給瀏覽器。\n\n## 跟 IP 請求資源\n\n待瀏覽器收到 IP 後去請求資源，而 IP (資源方)那一般來說都會有個 Web Server 擋在前面(Nginx、Apache)，若是有前端頁面則是讓瀏覽器下載靜態檔案(static)，而若只是單純導向至 API 的話就直接回傳定義的資料格式(JSON、XML...)。\n\n## 快取\n\n此時瀏覽器下載完後則會存到快取(Cache)裡，加速下次載入。\n\n## 渲染\n\n![https://i.imgur.com/ddrEQxs.png](https://i.imgur.com/ddrEQxs.png)\n\n> 參考[六角學院](https://w3c.hexschool.com/blog/8d691e4f)\n\n這邊就簡單敘述一下前端渲染發生的經過，HTML 會產生出一個 `DOM Tree`，CSS 會有一個 `CSSOM Tree`，在各別產生完後會合併成一個 `render Tree`，最後經由 `layout` 的步驟讓瀏覽器將 Tree 渲染至畫面上，完成畫面顯示的步驟。\n\n- 上述的 DOM 就是寫 jQuery 時呼叫的那個 DOM 元素\n\n以上就是當你輸入一個網址後會遇到的事情經過～\n\n# 輸入網址後，你怎能不知道怎麼連線呢？\n\n## 準備連線 - 三方交握 (Three-Way Handshake)\n\n```puml\n@startuml\nClient -> Server: 我需要連線(SYN)，回答請用 M\nServer -> Client: 收到了，是 M+1 嗎(ACK)？\\n 回答請用 N (SYN)\nClient -> Server: 收到了，N+1 是我收到的訊號(ACK)\nClient <--> Server: Server 確認完後開始連線\n@enduml\n```\n\n這邊我用最簡單的表示，`SYN`在三方交握會是一個帶有序列號(n)的請求，而`ACK`則是代表回應對方我們這邊收到的訊號，會帶有 n+1 的數字回傳。\n\n在三方交握中，會先由 Client 告訴 Server 現在它要連線並給一個數字，回傳時會送 n+1 的原因是避免在請求的過程中因各種因素導致回來的值錯誤時的一個防範機制，用 `+1` 這個做法來確保對方給的回傳值是我剛剛送出去的值 +1，避免連線過程中混亂。\n\n簡單的記法就是從 Client 先送一個數字 N 給 Server，而回傳時一定是給 N+1 並且帶著一個 M，Client 收到後確認完則在回傳 M+1 讓 Server 也確定 CLient 收到了，完成三次連線。\n\n### Bonus - 為什麼不兩次或四次交握呢？\n\n經過上述的流程，一定是一個發(SYN)，一個收完後告訴對方它收到(ACK)，那如果是只有`兩次`， Client 會不知道 Server 收到沒，導致這次連線失敗。\n\n然後四次、五次、六次其實都是可以做到的，但只是工程師在實作東西時都會盡可能的精簡它，所以為了不浪費系統資源，因此最低次數就是`三次`！🎉\n\n## 斷開連線 - 四次揮手(Four-Way Wavehand)\n\n> 四次揮手是用 FIN 以及 ACK 當作 請求 以及 回應\n\n![https://i.imgur.com/wZk7hoS.png](https://i.imgur.com/wZk7hoS.png)\n\n> 圖片[參考](<(https://kknews.cc/code/yr9ng6j.html)>)\n\n> Client = 1, Server = 2 的話，順序就是 1 - 2 - 2 - 1\n\n我了解這部分的方法是\n\n#### 每個關閉連線時都需要等待\n\n所以向 Client 送請求(`FIN`)到 Server 會先告訴 Client 已經收到(`ACK`)，處理完後再送一個請求給 Client，Client 最後就在回應 Server 告訴他能關閉來斷開連線。\n\n因為是在第三步驟最後回應時需要等待 Server 的主動發送，因此交握的最低數量就變成`4`了。\n\n基本上跟三方交握流程是一樣的，差別在於到 Server 時不會馬上告訴 Client 等等要回應的值(N)是多少，而是等 ACK 完後過一陣子才回傳 publish FIN flag。\n\n詳細可以參考[這篇](https://kknews.cc/code/yr9ng6j.html)\n\n# SSL\n\n經過了上面無情摧殘後，接下來就是要認識 SSL 這個安全機制了。\n\n![](https://i.imgur.com/5tk4osI.png)\n\n除非你的網站內容是全靜態輸出，完全沒串任何 API，否則沒有 SSL 安全性實在是嚴重不足啊！因為沒有 SSL 的網站會享有[中間人攻擊](https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB)的優惠，那既然那麼重要接著就來介紹吧！\n\n> 這裡會簡單敘述一下流程以及功能，但詳細的還是要參考其他部落格詳細的文章喔！\n\n## SSL 有的裝備\n\nSSL 申請時一般都會給三種東西，公鑰(Public key)、私鑰(Private key)、CA(Certificate authority)\n\n1. 公鑰是 Server 發給信任裝置使用的鑰匙\n2. 私鑰則是解開來自信任裝置加密封包的鑰匙\n3. CA 是 Server 的證書，用來確認 Server 的合法性，若只拿私鑰來解也會含有中間人攻擊的問題\n\n## 流程\n\n![https://i.imgur.com/oeLkNoP.png](https://i.imgur.com/oeLkNoP.png)\n\n> 圖片參考[阮一峰的部落格](http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html)\n\nVisitor 就等於前面文章提到的 Client，而 CloudFlare 則等於 Server 端。\n\n1. Client 把一個`隨機數`並發送給 Server\n2. Server 在產生一組`隨機數+公鑰`給 Client\n3. Client 利用收到的`隨機數+公鑰`加密資料回傳給 Server\n4. Server 用`私鑰`來解開資料\n5. 拿著上圖灰色虛線的東西來產生 Session Key 確認對方\n\n> 隨機數用意為讓密鑰每次產生都不一樣\n\n## SSL 小結\n\n這邊沒有提太多實作跟詳細內容，但看著上述的流程來說有沒有覺得其實跟`三方交握`很像，差別在於 Server 端回傳時有多給 Client 一個公鑰(Public Key)，所以再記這部分時，利用三方交握來理解這件事情，基本上就如魚得水了！😊\n\n# OAuth\n\n接著就一起陪我釐清 OAuth 吧！\n\n## 說明\n\n讓客戶端能以 OAuth 開放標準在第三方應用程式上透過授權(Authorization)的方式取得在服務提供商(LINE、Facebook、Google...)的資料(檔案、照片、影片...)。\n\n## 擁有四種角色\n\n- Resource Owner(簡稱 RO)：可以授權於`終端用戶`存取受保護之資料。\n- Resource Server(簡稱 RS)：存取受保護資料的地方，根據 Access Token 之權限處理請求。\n- Client：代表使用者去存取受保護資料的應用程式。Client 指任何在 Server 端、桌面或設備上執行的應用程式。\n- Authorization Server(簡稱 AS)：職責為認證過使用者的身份，且經由使用者許可後，就會簽發 Access Token 的地方。\n\n## 流程\n\n以下為一個 OAuth 的流程:\n\n```\n+--------+                               +---------------+\n|        |--(1)- Authorization Request ->|   Resource    |\n|        |                               |     Owner     |\n|        |<-(2)-- Authorization Grant ---|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(3)-- Authorization Grant -->| Authorization |\n| Client |                               |     Server    |\n|        |<-(4)----- Access Token -------|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(5)----- Access Token ------>|    Resource   |\n|        |                               |     Server    |\n|        |<-(6)--- Protected Resource ---|               |\n+--------+                               +---------------+\n```\n\n## 小故事\n\n以下會分別用四個角色代替他們：\nClient = A 員工、RO = 大樓警衛、AS = 公司櫃檯、RS = 倉庫\n\n並用小故事說明，情境是員工假日需返回公司倉庫拿取零件，但是卻沒帶公司的證件，而公司是在商業辦公室中，大樓警衛認不得這麼多間公司的人，因此需要按照基本流程才能進公司拿取資料，A 員工抵達商辦大樓後：\n\n1. A 員工拿證件出來並填寫基本資料的單子給警衛 (發送請求)\n2. 警衛確認完後拿了一個暫時性的鑰匙(`code`)給 A 員工\n3. A 員工拿著暫時性鑰匙(`code`)跟公司櫃檯\n4. 櫃檯將臨時鑰匙(`code`)換成公司的門禁卡(Access Token)\n5. A 員工去倉庫使用門禁卡(Access Token)開倉庫門\n6. 倉庫門打開後 A 員工從裡面拿取自己需要的零件(Protected Resource)\n\n> 透過這樣的解釋應該比較好懂吧 ❓\n\n## 小結\n\n看著流程圖，有沒有覺得它還是很像三方交握嗎？只是 Server 端功能切開變成微服務的樣子，並透過三個步驟來獲取 Server 的資源，如此一來會不會覺得這樣親切點呢？\n\n希望能藉由文章的敘述讓你能更快速點了解這些玩意兒。\n\n# OpenID Connect\n\n大家寫了這麼多 side project，對 OAuth 的見聞與使用一定不在其數，但實際上在做像是 LINE Login、Facebook、Google 這類型的 Single Sign On(SSO) 的服務時很常誤以為 `SSO == OAuth`，答案是錯的，SSO 這件事情本身是由 OpenID 來實現，對於實際的原由呢，這邊有[很詳細的介紹](https://medium.com/@petertc/openid-connect-a27e0a3cc2ae)，這邊就不贅述。\n\n主要的核心我覺得要記得這件事：\n\n```\nOpenID Connect 是認證（Authentication），OAuth 2.0 則是授權（Authorization）\n```\n\n一般來說只要搞懂這兩個字的意思，並透過實作經驗加上記得文件內容，就會對於 OpenID 以及 OAuth 個別的職責是什麼很清楚。\n\n![](https://i.imgur.com/WghYZJM.png)\n\n> 這邊一樣參考 petertc 的[文章](https://medium.com/@petertc/openid-connect-a27e0a3cc2ae)\n\n上圖流程可能太複雜，這裡簡單敘述一下，就是他流程基本上與 OAuth 差不多，因為 OpenID 就是在 OAuth 上加一層`使用者認證層(User Identify Layer)`，若記得上述 OAuth 的話，OpenID 會在取得 Access Token 的同時取得一個 ID Token，以下說明一下 ID Token：\n\nID Token 一般比較常見是 Json Web Token(JWT) 的格式，使用者的資訊一般都會放在這邊，只要拿到了這個就可以跟資料庫去 mapping 就能做使用者管理囉 ❗️\n\n## 小結\n\nOpenID 其中一部分解決了 OAuth scope 這參數定義的問題，在 OpenID 還沒出來之前這個時基本上是服務提供商說的算，眾說紛紜的話那就損失了公信力，因此 OpenID 的 scope 除了要必須輸入 `openid` 以外呢，他還有規定可以輸入`email`、`phone`、`profile`，因此在有規範後在串接第三方服務後就不會各說各的啦！\n\n此外這邊需要再重複一次，OpenID 是`驗證`與各戶端的交握過程後並給初使用者資料，而 OAuth 則是`授權`於應用程式可以取用服務中的某個資料(從倉庫拿貨)，如此一來就能較有效的記得 OpenID 與 OAuth 的差異囉！\n\n# 結論\n\n在這些熱門面試題中往往是準備不完的 😅，但如何有效的記得這些東西的步驟卻是很重要，畢竟不可能只把 HTTP、SSL、OpenID、OAuth 讀完面試就過了吧？還有演算法、資料庫 這些哩哩摳摳的需要釐清，當然這邊是整理出我自己的紀錄方法，希望能透過我的方法讓你能夠更快速的釐清這些功能，但看完了各個文章後還是記得要看官方文件，把真正的東西學進去才是對自己有益的喔！\n\n那本篇就先記錄到這，希望大家能有收穫 😁\n","slug":"從-Http-請求到認識-OAuth-以及-OpenID","published":1,"updated":"2020-06-19T14:03:58.880Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lw00607criqbkd7vzs","content":"<p><img src=\"https://cdn.pixabay.com/photo/2015/03/10/18/46/taiwan-667565_960_720.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近因為在找新工作，同時也需要把一些知識打穩，既然常在寫 side project，那麼一定要對於 http 請求後發生什麼事、SSL、OAuth、OpenID 都需要理解清楚，否則串了這麼多服務也寫了應用，但在關鍵時沒講出來的話作品就發揮不出它的功用了 😞，那麼以下就會用我的觀點以及紀錄方法來敘述這些功能。</p>\n<blockquote>\n<p>註：若有發現有什麼問題或內容有誤的話麻煩再留言讓我知道，或是<code>寄信</code>給我也是可以喔！</p>\n</blockquote>\n<h1 id=\"從輸入https-www-google-com之後發生了什麼事\"><a href=\"#從輸入https-www-google-com之後發生了什麼事\" class=\"headerlink\" title=\"從輸入https://www.google.com之後發生了什麼事?\"></a>從輸入<code>https://www.google.com</code>之後發生了什麼事?</h1><p>首先須了解<code>https://www.google.com</code>這樣的網址是如何組成:</p>\n<a id=\"more\"></a>\n\n<ol>\n<li>https: 通訊協定，其他常見如: tcp、udp、websocket、mqtt…</li>\n<li>www: 常聽到的 sub domain 就指這個部分，也會聽到 host 的名稱，意指在一個 Domain 下若有多個主機時則用這個部分來指定名稱為特定主機，一般預設進入點為 <code>www</code>。</li>\n<li>.google: 這部分學名為 <code>Second Level Domain</code>(SLD)，在 Top level domain 搜尋完後接著搜尋的層級，通常為個人品牌、公司行號為名稱。</li>\n<li>.com: 這層名為 <code>Top Level Domain</code>(TLD)，常見為 com、org、gov、edu、io，較好理解的方式我認為就是把當前進入點判斷為何種<code>組織</code>，再以此分類下去找 SLD，有點二元搜尋的概念 😁。</li>\n<li>root: 一開始我看到這部分也覺得霧煞煞，簡單來說每個域名(Domain)的結尾都會有 <code>.</code> 這個小數點，它是指域名(Domain)的進入點，所有上的 Domain 都會從這個地方開始判斷。</li>\n</ol>\n<blockquote>\n<p>上述是照著網址由左而右寫，實際上則是從右往左判斷</p>\n</blockquote>\n<p>上面步驟已經說明清楚每個部分了，接下來就說明從瀏覽器輸入網址後的步驟吧！</p>\n<h2 id=\"向-DNS-要-IP\"><a href=\"#向-DNS-要-IP\" class=\"headerlink\" title=\"向 DNS 要 IP\"></a>向 DNS 要 IP</h2><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMzk2cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo2OTlweDtoZWlnaHQ6Mzk2cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA2OTkgMzk2IiB3aWR0aD0iNjk5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZnUzaGE1NDZwdjJneiIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48IS0tTUQ1PVtmZWU2NjJhMjkyYTAzNTNhNjliZDE2MjgyMGJhZTkzYl0KZW50aXR5IFVzZXItLT48ZWxsaXBzZSBjeD0iMjEuNSIgY3k9IjE0IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHBhdGggZD0iTTIxLjUsMjIgTDIxLjUsNDkgTTguNSwzMCBMMzQuNSwzMCBNMjEuNSw0OSBMOC41LDY0IE0yMS41LDQ5IEwzNC41LDY0ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2Z1M2hhNTQ2cHYyZ3opIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMSIgeD0iNiIgeT0iODIuNDk1MSI+VXNlcjwvdGV4dD48ZWxsaXBzZSBjeD0iMjkxLjUxMjIiIGN5PSI0NS4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI0NC4wMTIyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNTgiIHg9IjI2Mi41MTIyIiB5PSI0OS42NzIxIj5Ccm93c2VyPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTguNzEzMiIgY3k9IjIwNy4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSIyNC4yMTMyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzAiIHg9IjI0My43MTMyIiB5PSIyMTEuNjcyMSI+RE5TPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTguNDQ4NiIgY3k9IjM0MS4yODk3IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI2NC40NDg2IiByeT0iMTUuMjg5NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iOTIiIHg9IjIxMi40NDg2IiB5PSIzNDUuOTM4MiI+TmFtZSBTZXJ2ZXI8L3RleHQ+PGVsbGlwc2UgY3g9IjU1OC40NDg2IiBjeT0iNDQuNzg5NyIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2Z1M2hhNTQ2cHYyZ3opIiByeD0iNjQuNDQ4NiIgcnk9IjE1LjI4OTciIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjkyIiB4PSI1MTIuNDQ4NiIgeT0iNDkuNDM4MiI+MTIzLjIyMy40NS42PC90ZXh0PjxlbGxpcHNlIGN4PSI1ODkuNTE0MyIgY3k9IjIwNy4yMDI5IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI2MS41MTQzIiByeT0iMTQuNzAyOSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iODQiIHg9IjU0Ny41MTQzIiB5PSIyMTEuODUxMyI+V2ViIFNlcnZlcjwvdGV4dD48cGF0aCBkPSJNNTQuNSwyOTguNSBMNTQuNSwzODQuMTY0MSBBMCwwIDAgMCAwIDU0LjUsMzg0LjE2NDEgTDE1OC41LDM4NC4xNjQxIEEwLDAgMCAwIDAgMTU4LjUsMzg0LjE2NDEgTDE1OC41LDM0NS41IEwxOTMuODE4LDM0MS41IEwxNTguNSwzMzcuNSBMMTU4LjUsMzA4LjUgTDE0OC41LDI5OC41IEw1NC41LDI5OC41IEEwLDAgMCAwIDAgNTQuNSwyOTguNSAiIGZpbGw9IiNGQkZCNzciIGZpbHRlcj0idXJsKCNmdTNoYTU0NnB2Mmd6KSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBhdGggZD0iTTE0OC41LDI5OC41IEwxNDguNSwzMDguNSBMMTU4LjUsMzA4LjUgTDE0OC41LDI5OC41ICIgZmlsbD0iI0ZCRkI3NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iODMiIHg9IjYwLjUiIHk9IjMxNS41NjY5Ij7omZXnkIblm5vlgIvpg6jliIY6PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjI2IiB4PSI2MC41IiB5PSIzMzAuNjk5NyI+cm9vdDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMiIgeD0iNjAuNSIgeT0iMzQ1LjgzMjUiPi5jb208L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzMiIHg9IjYwLjUiIHk9IjM2MC45NjUzIj53d3c8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNDciIHg9IjYwLjUiIHk9IjM3Ni4wOTgxIj4uZ29vZ2xlPC90ZXh0PjwhLS1NRDU9W2VjNGM5M2U0NTk2M2ExNTRjOTdlMzk0N2QxOWE5NjYzXQpsaW5rIFVzZXIgdG8gQnJvd3Nlci0tPjxwYXRoIGQ9Ik0zNy4xODM0LDQ1IEM3Ni4zNzM4LDQ1IDE3OS44ODgsNDUgMjQyLjEwNiw0NSAiIGZpbGw9Im5vbmUiIGlkPSJVc2VyLSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI0Ny4yNTMsNDUsMjM4LjI1Myw0MSwyNDIuMjUzLDQ1LDIzOC4yNTMsNDksMjQ3LjI1Myw0NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTc0IiB4PSI1NS4yNSIgeT0iMzguMDY2OSI+MS4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbTwvdGV4dD48IS0tTUQ1PVs0YWNmYzk1NTBiZmFhNTliZmZjNmM2MWI4MjMzYTNhOV0KbGluayBCcm93c2VyIHRvIFVzZXItLT48cGF0aCBkPSJNMjU1LjgxOSw1My41OTIgQzIxOC42OTEsNjEuNDI2IDE1OC44NzMsNzAuOTQgMTA3LjI1LDY1IEM4NC42NzkxLDYyLjQwMyA1OS40MTMzLDU2LjA4IDQyLjE4OTUsNTEuMjMzICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0O1VzZXIiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMzcuMTE0Miw0OS43ODIsNDQuNjY3Nyw1Ni4xMDIyLDQxLjkyMTUsNTEuMTU2Niw0Ni44NjcxLDQ4LjQxMDUsMzcuMTE0Miw0OS43ODIiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY4IiB4PSIxMDguMjUiIHk9IjYxLjA2NjkiPjkuIOa4suafk+eVq+mdojwvdGV4dD48IS0tTUQ1PVtiY2FlZjkxOTFlZGY3ZGNlNGRiOTVjZDU3MGY0MjY5YV0KbGluayBCcm93c2VyIHRvIEROUy0tPjxwYXRoIGQ9Ik0yNjYuMjk2LDU2Ljk0OCBDMjQ0LjEzNyw2OC4xMDUgMjEzLjMyOCw4Ny43MjQgMTk5LjUsMTE1LjUgQzE5MC4xOTEsMTM0LjIgMTkwLjA4MiwxNDMuODU1IDE5OS41LDE2Mi41IEMyMDYuOTEsMTc3LjE2OSAyMjEuODU4LDE4OC4xMDggMjM0Ljg1MywxOTUuMzQ4ICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0O0ROUyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyMzkuNTM1LDE5Ny44NDcsMjMzLjQ3ODMsMTkwLjA4MDcsMjM1LjEyMzksMTk1LjQ5MjksMjI5LjcxMTcsMTk3LjEzODUsMjM5LjUzNSwxOTcuODQ3IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI3MCIgeD0iMjAwLjUiIHk9IjE0My41NjY5Ij4yLiDoq4vntabmiJEgSVA8L3RleHQ+PCEtLU1ENT1bYzdkMmE3YTBhNWMyNzExZGMzNzZmNzM3NTJkZjIwZDRdCmxpbmsgRE5TIHRvIEJyb3dzZXItLT48cGF0aCBkPSJNMjY0LjUzOSwxOTIuOTQyIEMyNjguMjM1LDE4NC40NDEgMjcyLjc2NCwxNzMuMDE1IDI3NS41LDE2Mi41IEMyODQuMjU2LDEyOC44NDQgMjg4LjQ0NCw4OC4zOTYgMjkwLjI2Niw2NS4wOTYgIiBmaWxsPSJub25lIiBpZD0iRE5TLSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI5MC42NTksNTkuODM1LDI4NS45OTg5LDY4LjUxMTYsMjkwLjI4NjEsNjQuODIxMSwyOTMuOTc2Nyw2OS4xMDgyLDI5MC42NTksNTkuODM1IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMzIiIHg9IjI4NS41IiB5PSIxNDMuNTY2OSI+NC4gSVAg54K6IDEyMy4yMjMuNDUuNjwvdGV4dD48IS0tTUQ1PVsyYTFkMDJjYjI3MGMzNDA1NTMzMDkxYzhmNDg5ZDdkMV0KbGluayBETlMgdG8gTmFtZSBTZXJ2ZXItLT48cGF0aCBkPSJNMjU4LjUsMjI2LjcwOCBDMjU4LjUsMjUxLjU4OSAyNTguNSwyOTUuMzc1IDI1OC41LDMyMC43NjQ0ICIgZmlsbD0ibm9uZSIgaWQ9IkROUy1OYW1lIFNlcnZlciIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTguNSwzMjUuODg5NSwyNjIuNSwzMTYuODg5NSwyNTguNSwzMjAuODg5NSwyNTQuNSwzMTYuODg5NSwyNTguNSwzMjUuODg5NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTguNSwyMjEuNjgxLDI1NC41LDIzMC42ODEsMjU4LjUsMjI2LjY4MSwyNjIuNSwyMzAuNjgxLDI1OC41LDIyMS42ODEiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyOCIgeD0iMjU5LjUiIHk9IjI2NC41NjY5Ij4zLiDlsIcgRG9tYWluIOi9ieaIkCBJUDwvdGV4dD48IS0tTUQ1PVs2OTMxZTJmNGZjYTU2MGMyYzY4M2NhNGZlZjUxYWZjZF0KbGluayBCcm93c2VyIHRvIDEyMy4yMjMuNDUuNi0tPjxwYXRoIGQ9Ik0zMzUuNTksNDUgQzM3Ny4xNzYsNDUgNDQwLjE4Niw0NSA0ODguNjE3LDQ1ICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0OzEyMy4yMjMuNDUuNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OTMuODUxLDQ1LDQ4NC44NTEsNDEsNDg4Ljg1MSw0NSw0ODQuODUxLDQ5LDQ5My44NTEsNDUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyMiIgeD0iMzUzLjc1IiB5PSIyMy4wNjY5Ij41LuWPluW+lyBJUCDlvozoqKrllY/kuLvmqZ88L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNjUiIHg9IjM4Mi4yNSIgeT0iMzguMTk5NyI+5Lim5LiL6LyJ6LOH5rqQPC90ZXh0PjwhLS1NRDU9Wzg5NWE5NThmYzM4YWFiY2M1OWI1MTI1YjYwYjVjY2JkXQpsaW5rIDEyMy4yMjMuNDUuNiB0byBCcm93c2VyLS0+PHBhdGggZD0iTTUxMy45ODUsNTYuMjg1IEM0OTcuOTQ4LDU5LjgyMSA0NzkuNjQyLDYzLjI1NSA0NjIuNzUsNjUgQzQyMC4zMDksNjkuMzg1IDQwOS4wNTcsNzAuNTI2IDM2Ni43NSw2NSBDMzUzLjk2Niw2My4zMyAzNDAuMjYzLDYwLjEyOCAzMjguMSw1Ni43NjggIiBmaWxsPSJub25lIiBpZD0iMTIzLjIyMy40NS42LSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMyMi45ODksNTUuMzIyLDMzMC41NjEyLDYxLjYxOTgsMzI3LjgwMDQsNTYuNjgyNCwzMzIuNzM3OCw1My45MjE2LDMyMi45ODksNTUuMzIyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI5NCIgeD0iMzY3Ljc1IiB5PSI2MS4wNjY5Ij44LiDlm57lgrPpnZzmhYvos4fmlpk8L3RleHQ+PCEtLU1ENT1bMzY1ZDc2OWE4ZGU2ODJkNGQ2YzgwZmVlNDliZTEwNDRdCmxpbmsgMTIzLjIyMy40NS42IHRvIFdlYiBTZXJ2ZXItLT48cGF0aCBkPSJNNTQ4LjMwNyw2MC4zNTQgQzUzMy41MjEsODMuMDk3IDUwOS43MzQsMTI4LjMzMyA1MjcuNSwxNjIuNSBDNTMzLjg3MywxNzQuNzU2IDU0NS40NTYsMTg0LjI3OCA1NTYuOSwxOTEuMjQ3ICIgZmlsbD0ibm9uZSIgaWQ9IjEyMy4yMjMuNDUuNi0mZ3Q7V2ViIFNlcnZlciIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NjEuNDM4LDE5My44ODgsNTU1LjY3MjQsMTg1LjkwMzEsNTU3LjExNjksMTkxLjM3MjUsNTUxLjY0NzYsMTkyLjgxNjksNTYxLjQzOCwxOTMuODg4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI2OCIgeD0iNTI4LjUiIHk9IjE0My41NjY5Ij42LiDntKLlj5bos4fmupA8L3RleHQ+PCEtLU1ENT1bNDUxNjU4MWZlMzg1YTNmNzI2OTNjNDBiMTBhOTI5ZTNdCmxpbmsgV2ViIFNlcnZlciB0byAxMjMuMjIzLjQ1LjYtLT48cGF0aCBkPSJNNTk1Ljk4LDE5Mi4yNDQgQzU5OS41NjksMTgzLjg1NSA2MDMuNjY2LDE3Mi43OTkgNjA1LjUsMTYyLjUgQzYwOS4xNjIsMTQxLjkzNSA2MTEuNjE5LDEzNS40NzIgNjA1LjUsMTE1LjUgQzU5OS41ODMsOTYuMTg5IDU4Ni4yODgsNzcuNDA5IDU3NS4zNDMsNjQuMjQ5ICIgZmlsbD0ibm9uZSIgaWQ9IldlYiBTZXJ2ZXItJmd0OzEyMy4yMjMuNDUuNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NzIuMDMyLDYwLjM1MSw1NzQuODA3Myw2OS44MDA3LDU3NS4yNjc5LDY0LjE2MjcsNTgwLjkwNiw2NC42MjMzLDU3Mi4wMzIsNjAuMzUxIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iNjI3LjUiIHk9IjEyOC41NjY5Ij43LiDlm57lgrM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNTIiIHg9IjYyMi41IiB5PSIxNDMuNjk5NyI+6Z2c5oWL5qqU5qGIPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9Ijc4IiB4PSI2MDkuNSIgeT0iMTU4LjgzMjUiPkpTT04g5oiWIFhNTDwvdGV4dD48IS0tTUQ1PVs0ZDc4NDIyOWQ1YzFjOWZiNzg4Yzk3MzI3NWQxMmQ5MF0KQHN0YXJ0dW1sDQpVc2VyIC0+IChCcm93c2VyKTogMS4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbQ0KKEJyb3dzZXIpIC1kb3duLT4gKEROUyk6IDIuIOiri+e1puaIkSBJUA0KKEROUykgPC0gLT4gKE5hbWUgU2VydmVyKTogMy4g5bCHIERvbWFpbiDovYnmiJAgSVANCihETlMpIC0gLT4gKEJyb3dzZXIpOiA0LiBJUCDngrogMTIzLjIyMy40NS42DQooQnJvd3NlcikgLXJpZ2h0LT4gKDEyMy4yMjMuNDUuNik6IDUu5Y+W5b6XIElQIOW+jOioquWVj+S4u+apn1xu5Lim5LiL6LyJ6LOH5rqQDQooMTIzLjIyMy40NS42KSAtIC0+IChXZWIgU2VydmVyKTogNi4g57Si5Y+W6LOH5rqQDQooV2ViIFNlcnZlcikgLXJpZ2h0LT4gKDEyMy4yMjMuNDUuNik6IDcuIOWbnuWCs1xu6Z2c5oWL5qqU5qGIXG5KU09OIOaIliBYTUwNCigxMjMuMjIzLjQ1LjYpIC0+IChCcm93c2VyKTogOC4g5Zue5YKz6Z2c5oWL6LOH5paZDQooQnJvd3NlcikgLXJpZ2h0LT4gVXNlcjogOS4g5riy5p+T55Wr6Z2iDQpub3RlIGxlZnQgb2YgKE5hbWUgU2VydmVyKQ0KICDomZXnkIblm5vlgIvpg6jliIY6DQogIHJvb3QNCiAgLmNvbQ0KICB3d3cNCiAgLmdvb2dsZQ0KZW5kIG5vdGUNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4xNWJldGExKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg==\">\n\n<p>DNS 全名為 Domain Name Server，主要職責是幫忙把 網域名稱(Domain Name) 轉成 IP，因為網域名稱是人才看得懂而機器只認得 IP，因此需要 DNS 來幫忙轉譯。</p>\n<h3 id=\"Name-Server\"><a href=\"#Name-Server\" class=\"headerlink\" title=\"Name Server\"></a>Name Server</h3><p>藉由上圖最終 DNS 會收到每個單獨的 Name Server 回傳後的值並組成 IP 回傳給瀏覽器。</p>\n<h2 id=\"跟-IP-請求資源\"><a href=\"#跟-IP-請求資源\" class=\"headerlink\" title=\"跟 IP 請求資源\"></a>跟 IP 請求資源</h2><p>待瀏覽器收到 IP 後去請求資源，而 IP (資源方)那一般來說都會有個 Web Server 擋在前面(Nginx、Apache)，若是有前端頁面則是讓瀏覽器下載靜態檔案(static)，而若只是單純導向至 API 的話就直接回傳定義的資料格式(JSON、XML…)。</p>\n<h2 id=\"快取\"><a href=\"#快取\" class=\"headerlink\" title=\"快取\"></a>快取</h2><p>此時瀏覽器下載完後則會存到快取(Cache)裡，加速下次載入。</p>\n<h2 id=\"渲染\"><a href=\"#渲染\" class=\"headerlink\" title=\"渲染\"></a>渲染</h2><p><img src=\"https://i.imgur.com/ddrEQxs.png\" alt=\"https://i.imgur.com/ddrEQxs.png\"></p>\n<blockquote>\n<p>參考<a href=\"https://w3c.hexschool.com/blog/8d691e4f\" target=\"_blank\" rel=\"noopener\">六角學院</a></p>\n</blockquote>\n<p>這邊就簡單敘述一下前端渲染發生的經過，HTML 會產生出一個 <code>DOM Tree</code>，CSS 會有一個 <code>CSSOM Tree</code>，在各別產生完後會合併成一個 <code>render Tree</code>，最後經由 <code>layout</code> 的步驟讓瀏覽器將 Tree 渲染至畫面上，完成畫面顯示的步驟。</p>\n<ul>\n<li>上述的 DOM 就是寫 jQuery 時呼叫的那個 DOM 元素</li>\n</ul>\n<p>以上就是當你輸入一個網址後會遇到的事情經過～</p>\n<h1 id=\"輸入網址後，你怎能不知道怎麼連線呢？\"><a href=\"#輸入網址後，你怎能不知道怎麼連線呢？\" class=\"headerlink\" title=\"輸入網址後，你怎能不知道怎麼連線呢？\"></a>輸入網址後，你怎能不知道怎麼連線呢？</h1><h2 id=\"準備連線-三方交握-Three-Way-Handshake\"><a href=\"#準備連線-三方交握-Three-Way-Handshake\" class=\"headerlink\" title=\"準備連線 - 三方交握 (Three-Way Handshake)\"></a>準備連線 - 三方交握 (Three-Way Handshake)</h2><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMjM4cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDozMjBweDtoZWlnaHQ6MjM4cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAzMjAgMjM4IiB3aWR0aD0iMzIwcHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmRkd2c5MTM2bXhxdyIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogNS4wLDUuMDsiIHgxPSIzOCIgeDI9IjM4IiB5MT0iMzguMjk2OSIgeTI9IjE4OS45NjA5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IHN0cm9rZS1kYXNoYXJyYXk6IDUuMCw1LjA7IiB4MT0iMjcyIiB4Mj0iMjcyIiB5MT0iMzguMjk2OSIgeTI9IjE4OS45NjA5Ii8+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZkZHdnOTEzNm14cXcpIiBoZWlnaHQ9IjMwLjI5NjkiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjU3IiB4PSI4IiB5PSIzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNDMiIHg9IjE1IiB5PSIyMi45OTUxIj5DbGllbnQ8L3RleHQ+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZkZHdnOTEzNm14cXcpIiBoZWlnaHQ9IjMwLjI5NjkiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjU3IiB4PSI4IiB5PSIxODguOTYwOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjQzIiB4PSIxNSIgeT0iMjA4Ljk1NjEiPkNsaWVudDwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRkd2c5MTM2bXhxdykiIGhlaWdodD0iMzAuMjk2OSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNjEiIHg9IjI0MCIgeT0iMyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjQ3IiB4PSIyNDciIHk9IjIyLjk5NTEiPlNlcnZlcjwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRkd2c5MTM2bXhxdykiIGhlaWdodD0iMzAuMjk2OSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNjEiIHg9IjI0MCIgeT0iMTg4Ljk2MDkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI0NyIgeD0iMjQ3IiB5PSIyMDguOTU2MSI+U2VydmVyPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjYwLjUsNjUuNDI5NywyNzAuNSw2OS40Mjk3LDI2MC41LDczLjQyOTcsMjY0LjUsNjkuNDI5NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IiB4MT0iMzguNSIgeDI9IjI2Ni41IiB5MT0iNjkuNDI5NyIgeTI9IjY5LjQyOTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzkiIHg9IjQ1LjUiIHk9IjY0LjM2MzgiPuaIkemcgOimgemAo+e3mihTWU4p77yM5Zue562U6KuL55SoIE08L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OS41LDEwOS42OTUzLDM5LjUsMTEzLjY5NTMsNDkuNSwxMTcuNjk1Myw0NS41LDExMy42OTUzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiIHgxPSI0My41IiB4Mj0iMjcxLjUiIHkxPSIxMTMuNjk1MyIgeTI9IjExMy42OTUzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTYzIiB4PSI1NS41IiB5PSI5My40OTY2Ij7mlLbliLDkuobvvIzmmK8gTSsxIOWXjihBQ0sp77yfPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEwNCIgeD0iNTkuNSIgeT0iMTA4LjYyOTQiPuWbnuetlOiri+eUqCBOIChTWU4pPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjYwLjUsMTM4LjgyODEsMjcwLjUsMTQyLjgyODEsMjYwLjUsMTQ2LjgyODEsMjY0LjUsMTQyLjgyODEiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIgeDE9IjM4LjUiIHgyPSIyNjYuNSIgeTE9IjE0Mi44MjgxIiB5Mj0iMTQyLjgyODEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyMTAiIHg9IjQ1LjUiIHk9IjEzNy43NjIyIj7mlLbliLDkuobvvIxOKzEg5piv5oiR5pS25Yiw55qE6KiK6JmfKEFDSyk8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OS41LDE2Ny45NjA5LDM5LjUsMTcxLjk2MDksNDkuNSwxNzUuOTYwOSw0NS41LDE3MS45NjA5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI2MC41LDE2Ny45NjA5LDI3MC41LDE3MS45NjA5LDI2MC41LDE3NS45NjA5LDI2NC41LDE3MS45NjA5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogMi4wLDIuMDsiIHgxPSI0My41IiB4Mj0iMjY2LjUiIHkxPSIxNzEuOTYwOSIgeTI9IjE3MS45NjA5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTUwIiB4PSI1NS41IiB5PSIxNjYuODk1Ij5TZXJ2ZXIg56K66KqN5a6M5b6M6ZaL5aeL6YCj57eaPC90ZXh0PjwhLS1NRDU9WzA2MGYxODZlMDgxMmE5YTI4OGNkM2ZkYzg5ZjYwOGU0XQpAc3RhcnR1bWwNCkNsaWVudCAtPiBTZXJ2ZXI6IOaIkemcgOimgemAo+e3mihTWU4p77yM5Zue562U6KuL55SoIE0NClNlcnZlciAtPiBDbGllbnQ6IOaUtuWIsOS6hu+8jOaYryBNKzEg5ZeOKEFDSynvvJ9cbiDlm57nrZToq4vnlKggTiAoU1lOKQ0KQ2xpZW50IC0+IFNlcnZlcjog5pS25Yiw5LqG77yMTisxIOaYr+aIkeaUtuWIsOeahOioiuiZnyhBQ0spDQpDbGllbnQgPC0gLT4gU2VydmVyOiBTZXJ2ZXIg56K66KqN5a6M5b6M6ZaL5aeL6YCj57eaDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>這邊我用最簡單的表示，<code>SYN</code>在三方交握會是一個帶有序列號(n)的請求，而<code>ACK</code>則是代表回應對方我們這邊收到的訊號，會帶有 n+1 的數字回傳。</p>\n<p>在三方交握中，會先由 Client 告訴 Server 現在它要連線並給一個數字，回傳時會送 n+1 的原因是避免在請求的過程中因各種因素導致回來的值錯誤時的一個防範機制，用 <code>+1</code> 這個做法來確保對方給的回傳值是我剛剛送出去的值 +1，避免連線過程中混亂。</p>\n<p>簡單的記法就是從 Client 先送一個數字 N 給 Server，而回傳時一定是給 N+1 並且帶著一個 M，Client 收到後確認完則在回傳 M+1 讓 Server 也確定 CLient 收到了，完成三次連線。</p>\n<h3 id=\"Bonus-為什麼不兩次或四次交握呢？\"><a href=\"#Bonus-為什麼不兩次或四次交握呢？\" class=\"headerlink\" title=\"Bonus - 為什麼不兩次或四次交握呢？\"></a>Bonus - 為什麼不兩次或四次交握呢？</h3><p>經過上述的流程，一定是一個發(SYN)，一個收完後告訴對方它收到(ACK)，那如果是只有<code>兩次</code>， Client 會不知道 Server 收到沒，導致這次連線失敗。</p>\n<p>然後四次、五次、六次其實都是可以做到的，但只是工程師在實作東西時都會盡可能的精簡它，所以為了不浪費系統資源，因此最低次數就是<code>三次</code>！🎉</p>\n<h2 id=\"斷開連線-四次揮手-Four-Way-Wavehand\"><a href=\"#斷開連線-四次揮手-Four-Way-Wavehand\" class=\"headerlink\" title=\"斷開連線 - 四次揮手(Four-Way Wavehand)\"></a>斷開連線 - 四次揮手(Four-Way Wavehand)</h2><blockquote>\n<p>四次揮手是用 FIN 以及 ACK 當作 請求 以及 回應</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/wZk7hoS.png\" alt=\"https://i.imgur.com/wZk7hoS.png\"></p>\n<blockquote>\n<p>圖片<a href=\"(https://kknews.cc/code/yr9ng6j.html)\">參考</a></p>\n</blockquote>\n<blockquote>\n<p>Client = 1, Server = 2 的話，順序就是 1 - 2 - 2 - 1</p>\n</blockquote>\n<p>我了解這部分的方法是</p>\n<h4 id=\"每個關閉連線時都需要等待\"><a href=\"#每個關閉連線時都需要等待\" class=\"headerlink\" title=\"每個關閉連線時都需要等待\"></a>每個關閉連線時都需要等待</h4><p>所以向 Client 送請求(<code>FIN</code>)到 Server 會先告訴 Client 已經收到(<code>ACK</code>)，處理完後再送一個請求給 Client，Client 最後就在回應 Server 告訴他能關閉來斷開連線。</p>\n<p>因為是在第三步驟最後回應時需要等待 Server 的主動發送，因此交握的最低數量就變成<code>4</code>了。</p>\n<p>基本上跟三方交握流程是一樣的，差別在於到 Server 時不會馬上告訴 Client 等等要回應的值(N)是多少，而是等 ACK 完後過一陣子才回傳 publish FIN flag。</p>\n<p>詳細可以參考<a href=\"https://kknews.cc/code/yr9ng6j.html\" target=\"_blank\" rel=\"noopener\">這篇</a></p>\n<h1 id=\"SSL\"><a href=\"#SSL\" class=\"headerlink\" title=\"SSL\"></a>SSL</h1><p>經過了上面無情摧殘後，接下來就是要認識 SSL 這個安全機制了。</p>\n<p><img src=\"https://i.imgur.com/5tk4osI.png\" alt></p>\n<p>除非你的網站內容是全靜態輸出，完全沒串任何 API，否則沒有 SSL 安全性實在是嚴重不足啊！因為沒有 SSL 的網站會享有<a href=\"https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB\" target=\"_blank\" rel=\"noopener\">中間人攻擊</a>的優惠，那既然那麼重要接著就來介紹吧！</p>\n<blockquote>\n<p>這裡會簡單敘述一下流程以及功能，但詳細的還是要參考其他部落格詳細的文章喔！</p>\n</blockquote>\n<h2 id=\"SSL-有的裝備\"><a href=\"#SSL-有的裝備\" class=\"headerlink\" title=\"SSL 有的裝備\"></a>SSL 有的裝備</h2><p>SSL 申請時一般都會給三種東西，公鑰(Public key)、私鑰(Private key)、CA(Certificate authority)</p>\n<ol>\n<li>公鑰是 Server 發給信任裝置使用的鑰匙</li>\n<li>私鑰則是解開來自信任裝置加密封包的鑰匙</li>\n<li>CA 是 Server 的證書，用來確認 Server 的合法性，若只拿私鑰來解也會含有中間人攻擊的問題</li>\n</ol>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p><img src=\"https://i.imgur.com/oeLkNoP.png\" alt=\"https://i.imgur.com/oeLkNoP.png\"></p>\n<blockquote>\n<p>圖片參考<a href=\"http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html\" target=\"_blank\" rel=\"noopener\">阮一峰的部落格</a></p>\n</blockquote>\n<p>Visitor 就等於前面文章提到的 Client，而 CloudFlare 則等於 Server 端。</p>\n<ol>\n<li>Client 把一個<code>隨機數</code>並發送給 Server</li>\n<li>Server 在產生一組<code>隨機數+公鑰</code>給 Client</li>\n<li>Client 利用收到的<code>隨機數+公鑰</code>加密資料回傳給 Server</li>\n<li>Server 用<code>私鑰</code>來解開資料</li>\n<li>拿著上圖灰色虛線的東西來產生 Session Key 確認對方</li>\n</ol>\n<blockquote>\n<p>隨機數用意為讓密鑰每次產生都不一樣</p>\n</blockquote>\n<h2 id=\"SSL-小結\"><a href=\"#SSL-小結\" class=\"headerlink\" title=\"SSL 小結\"></a>SSL 小結</h2><p>這邊沒有提太多實作跟詳細內容，但看著上述的流程來說有沒有覺得其實跟<code>三方交握</code>很像，差別在於 Server 端回傳時有多給 Client 一個公鑰(Public Key)，所以再記這部分時，利用三方交握來理解這件事情，基本上就如魚得水了！😊</p>\n<h1 id=\"OAuth\"><a href=\"#OAuth\" class=\"headerlink\" title=\"OAuth\"></a>OAuth</h1><p>接著就一起陪我釐清 OAuth 吧！</p>\n<h2 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h2><p>讓客戶端能以 OAuth 開放標準在第三方應用程式上透過授權(Authorization)的方式取得在服務提供商(LINE、Facebook、Google…)的資料(檔案、照片、影片…)。</p>\n<h2 id=\"擁有四種角色\"><a href=\"#擁有四種角色\" class=\"headerlink\" title=\"擁有四種角色\"></a>擁有四種角色</h2><ul>\n<li>Resource Owner(簡稱 RO)：可以授權於<code>終端用戶</code>存取受保護之資料。</li>\n<li>Resource Server(簡稱 RS)：存取受保護資料的地方，根據 Access Token 之權限處理請求。</li>\n<li>Client：代表使用者去存取受保護資料的應用程式。Client 指任何在 Server 端、桌面或設備上執行的應用程式。</li>\n<li>Authorization Server(簡稱 AS)：職責為認證過使用者的身份，且經由使用者許可後，就會簽發 Access Token 的地方。</li>\n</ul>\n<h2 id=\"流程-1\"><a href=\"#流程-1\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p>以下為一個 OAuth 的流程:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+--------+                               +---------------+</span><br><span class=\"line\">|        |--(1)- Authorization Request -&gt;|   Resource    |</span><br><span class=\"line\">|        |                               |     Owner     |</span><br><span class=\"line\">|        |&lt;-(2)-- Authorization Grant ---|               |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |--(3)-- Authorization Grant --&gt;| Authorization |</span><br><span class=\"line\">| Client |                               |     Server    |</span><br><span class=\"line\">|        |&lt;-(4)----- Access Token -------|               |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |--(5)----- Access Token ------&gt;|    Resource   |</span><br><span class=\"line\">|        |                               |     Server    |</span><br><span class=\"line\">|        |&lt;-(6)--- Protected Resource ---|               |</span><br><span class=\"line\">+--------+                               +---------------+</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"小故事\"><a href=\"#小故事\" class=\"headerlink\" title=\"小故事\"></a>小故事</h2><p>以下會分別用四個角色代替他們：<br>Client = A 員工、RO = 大樓警衛、AS = 公司櫃檯、RS = 倉庫</p>\n<p>並用小故事說明，情境是員工假日需返回公司倉庫拿取零件，但是卻沒帶公司的證件，而公司是在商業辦公室中，大樓警衛認不得這麼多間公司的人，因此需要按照基本流程才能進公司拿取資料，A 員工抵達商辦大樓後：</p>\n<ol>\n<li>A 員工拿證件出來並填寫基本資料的單子給警衛 (發送請求)</li>\n<li>警衛確認完後拿了一個暫時性的鑰匙(<code>code</code>)給 A 員工</li>\n<li>A 員工拿著暫時性鑰匙(<code>code</code>)跟公司櫃檯</li>\n<li>櫃檯將臨時鑰匙(<code>code</code>)換成公司的門禁卡(Access Token)</li>\n<li>A 員工去倉庫使用門禁卡(Access Token)開倉庫門</li>\n<li>倉庫門打開後 A 員工從裡面拿取自己需要的零件(Protected Resource)</li>\n</ol>\n<blockquote>\n<p>透過這樣的解釋應該比較好懂吧 ❓</p>\n</blockquote>\n<h2 id=\"小結\"><a href=\"#小結\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>看著流程圖，有沒有覺得它還是很像三方交握嗎？只是 Server 端功能切開變成微服務的樣子，並透過三個步驟來獲取 Server 的資源，如此一來會不會覺得這樣親切點呢？</p>\n<p>希望能藉由文章的敘述讓你能更快速點了解這些玩意兒。</p>\n<h1 id=\"OpenID-Connect\"><a href=\"#OpenID-Connect\" class=\"headerlink\" title=\"OpenID Connect\"></a>OpenID Connect</h1><p>大家寫了這麼多 side project，對 OAuth 的見聞與使用一定不在其數，但實際上在做像是 LINE Login、Facebook、Google 這類型的 Single Sign On(SSO) 的服務時很常誤以為 <code>SSO == OAuth</code>，答案是錯的，SSO 這件事情本身是由 OpenID 來實現，對於實際的原由呢，這邊有<a href=\"https://medium.com/@petertc/openid-connect-a27e0a3cc2ae\" target=\"_blank\" rel=\"noopener\">很詳細的介紹</a>，這邊就不贅述。</p>\n<p>主要的核心我覺得要記得這件事：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">OpenID Connect 是認證（Authentication），OAuth 2.0 則是授權（Authorization）</span><br></pre></td></tr></table></figure>\n\n<p>一般來說只要搞懂這兩個字的意思，並透過實作經驗加上記得文件內容，就會對於 OpenID 以及 OAuth 個別的職責是什麼很清楚。</p>\n<p><img src=\"https://i.imgur.com/WghYZJM.png\" alt></p>\n<blockquote>\n<p>這邊一樣參考 petertc 的<a href=\"https://medium.com/@petertc/openid-connect-a27e0a3cc2ae\" target=\"_blank\" rel=\"noopener\">文章</a></p>\n</blockquote>\n<p>上圖流程可能太複雜，這裡簡單敘述一下，就是他流程基本上與 OAuth 差不多，因為 OpenID 就是在 OAuth 上加一層<code>使用者認證層(User Identify Layer)</code>，若記得上述 OAuth 的話，OpenID 會在取得 Access Token 的同時取得一個 ID Token，以下說明一下 ID Token：</p>\n<p>ID Token 一般比較常見是 Json Web Token(JWT) 的格式，使用者的資訊一般都會放在這邊，只要拿到了這個就可以跟資料庫去 mapping 就能做使用者管理囉 ❗️</p>\n<h2 id=\"小結-1\"><a href=\"#小結-1\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>OpenID 其中一部分解決了 OAuth scope 這參數定義的問題，在 OpenID 還沒出來之前這個時基本上是服務提供商說的算，眾說紛紜的話那就損失了公信力，因此 OpenID 的 scope 除了要必須輸入 <code>openid</code> 以外呢，他還有規定可以輸入<code>email</code>、<code>phone</code>、<code>profile</code>，因此在有規範後在串接第三方服務後就不會各說各的啦！</p>\n<p>此外這邊需要再重複一次，OpenID 是<code>驗證</code>與各戶端的交握過程後並給初使用者資料，而 OAuth 則是<code>授權</code>於應用程式可以取用服務中的某個資料(從倉庫拿貨)，如此一來就能較有效的記得 OpenID 與 OAuth 的差異囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在這些熱門面試題中往往是準備不完的 😅，但如何有效的記得這些東西的步驟卻是很重要，畢竟不可能只把 HTTP、SSL、OpenID、OAuth 讀完面試就過了吧？還有演算法、資料庫 這些哩哩摳摳的需要釐清，當然這邊是整理出我自己的紀錄方法，希望能透過我的方法讓你能夠更快速的釐清這些功能，但看完了各個文章後還是記得要看官方文件，把真正的東西學進去才是對自己有益的喔！</p>\n<p>那本篇就先記錄到這，希望大家能有收穫 😁</p>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://cdn.pixabay.com/photo/2015/03/10/18/46/taiwan-667565_960_720.jpg\" alt></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>最近因為在找新工作，同時也需要把一些知識打穩，既然常在寫 side project，那麼一定要對於 http 請求後發生什麼事、SSL、OAuth、OpenID 都需要理解清楚，否則串了這麼多服務也寫了應用，但在關鍵時沒講出來的話作品就發揮不出它的功用了 😞，那麼以下就會用我的觀點以及紀錄方法來敘述這些功能。</p>\n<blockquote>\n<p>註：若有發現有什麼問題或內容有誤的話麻煩再留言讓我知道，或是<code>寄信</code>給我也是可以喔！</p>\n</blockquote>\n<h1 id=\"從輸入https-www-google-com之後發生了什麼事\"><a href=\"#從輸入https-www-google-com之後發生了什麼事\" class=\"headerlink\" title=\"從輸入https://www.google.com之後發生了什麼事?\"></a>從輸入<code>https://www.google.com</code>之後發生了什麼事?</h1><p>首先須了解<code>https://www.google.com</code>這樣的網址是如何組成:</p>","more":"<ol>\n<li>https: 通訊協定，其他常見如: tcp、udp、websocket、mqtt…</li>\n<li>www: 常聽到的 sub domain 就指這個部分，也會聽到 host 的名稱，意指在一個 Domain 下若有多個主機時則用這個部分來指定名稱為特定主機，一般預設進入點為 <code>www</code>。</li>\n<li>.google: 這部分學名為 <code>Second Level Domain</code>(SLD)，在 Top level domain 搜尋完後接著搜尋的層級，通常為個人品牌、公司行號為名稱。</li>\n<li>.com: 這層名為 <code>Top Level Domain</code>(TLD)，常見為 com、org、gov、edu、io，較好理解的方式我認為就是把當前進入點判斷為何種<code>組織</code>，再以此分類下去找 SLD，有點二元搜尋的概念 😁。</li>\n<li>root: 一開始我看到這部分也覺得霧煞煞，簡單來說每個域名(Domain)的結尾都會有 <code>.</code> 這個小數點，它是指域名(Domain)的進入點，所有上的 Domain 都會從這個地方開始判斷。</li>\n</ol>\n<blockquote>\n<p>上述是照著網址由左而右寫，實際上則是從右往左判斷</p>\n</blockquote>\n<p>上面步驟已經說明清楚每個部分了，接下來就說明從瀏覽器輸入網址後的步驟吧！</p>\n<h2 id=\"向-DNS-要-IP\"><a href=\"#向-DNS-要-IP\" class=\"headerlink\" title=\"向 DNS 要 IP\"></a>向 DNS 要 IP</h2><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMzk2cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo2OTlweDtoZWlnaHQ6Mzk2cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA2OTkgMzk2IiB3aWR0aD0iNjk5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZnUzaGE1NDZwdjJneiIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48IS0tTUQ1PVtmZWU2NjJhMjkyYTAzNTNhNjliZDE2MjgyMGJhZTkzYl0KZW50aXR5IFVzZXItLT48ZWxsaXBzZSBjeD0iMjEuNSIgY3k9IjE0IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHBhdGggZD0iTTIxLjUsMjIgTDIxLjUsNDkgTTguNSwzMCBMMzQuNSwzMCBNMjEuNSw0OSBMOC41LDY0IE0yMS41LDQ5IEwzNC41LDY0ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2Z1M2hhNTQ2cHYyZ3opIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMSIgeD0iNiIgeT0iODIuNDk1MSI+VXNlcjwvdGV4dD48ZWxsaXBzZSBjeD0iMjkxLjUxMjIiIGN5PSI0NS4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI0NC4wMTIyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNTgiIHg9IjI2Mi41MTIyIiB5PSI0OS42NzIxIj5Ccm93c2VyPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTguNzEzMiIgY3k9IjIwNy4wMjM2IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSIyNC4yMTMyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzAiIHg9IjI0My43MTMyIiB5PSIyMTEuNjcyMSI+RE5TPC90ZXh0PjxlbGxpcHNlIGN4PSIyNTguNDQ4NiIgY3k9IjM0MS4yODk3IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI2NC40NDg2IiByeT0iMTUuMjg5NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iOTIiIHg9IjIxMi40NDg2IiB5PSIzNDUuOTM4MiI+TmFtZSBTZXJ2ZXI8L3RleHQ+PGVsbGlwc2UgY3g9IjU1OC40NDg2IiBjeT0iNDQuNzg5NyIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2Z1M2hhNTQ2cHYyZ3opIiByeD0iNjQuNDQ4NiIgcnk9IjE1LjI4OTciIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjkyIiB4PSI1MTIuNDQ4NiIgeT0iNDkuNDM4MiI+MTIzLjIyMy40NS42PC90ZXh0PjxlbGxpcHNlIGN4PSI1ODkuNTE0MyIgY3k9IjIwNy4yMDI5IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnUzaGE1NDZwdjJneikiIHJ4PSI2MS41MTQzIiByeT0iMTQuNzAyOSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iODQiIHg9IjU0Ny41MTQzIiB5PSIyMTEuODUxMyI+V2ViIFNlcnZlcjwvdGV4dD48cGF0aCBkPSJNNTQuNSwyOTguNSBMNTQuNSwzODQuMTY0MSBBMCwwIDAgMCAwIDU0LjUsMzg0LjE2NDEgTDE1OC41LDM4NC4xNjQxIEEwLDAgMCAwIDAgMTU4LjUsMzg0LjE2NDEgTDE1OC41LDM0NS41IEwxOTMuODE4LDM0MS41IEwxNTguNSwzMzcuNSBMMTU4LjUsMzA4LjUgTDE0OC41LDI5OC41IEw1NC41LDI5OC41IEEwLDAgMCAwIDAgNTQuNSwyOTguNSAiIGZpbGw9IiNGQkZCNzciIGZpbHRlcj0idXJsKCNmdTNoYTU0NnB2Mmd6KSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBhdGggZD0iTTE0OC41LDI5OC41IEwxNDguNSwzMDguNSBMMTU4LjUsMzA4LjUgTDE0OC41LDI5OC41ICIgZmlsbD0iI0ZCRkI3NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iODMiIHg9IjYwLjUiIHk9IjMxNS41NjY5Ij7omZXnkIblm5vlgIvpg6jliIY6PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjI2IiB4PSI2MC41IiB5PSIzMzAuNjk5NyI+cm9vdDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMiIgeD0iNjAuNSIgeT0iMzQ1LjgzMjUiPi5jb208L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzMiIHg9IjYwLjUiIHk9IjM2MC45NjUzIj53d3c8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNDciIHg9IjYwLjUiIHk9IjM3Ni4wOTgxIj4uZ29vZ2xlPC90ZXh0PjwhLS1NRDU9W2VjNGM5M2U0NTk2M2ExNTRjOTdlMzk0N2QxOWE5NjYzXQpsaW5rIFVzZXIgdG8gQnJvd3Nlci0tPjxwYXRoIGQ9Ik0zNy4xODM0LDQ1IEM3Ni4zNzM4LDQ1IDE3OS44ODgsNDUgMjQyLjEwNiw0NSAiIGZpbGw9Im5vbmUiIGlkPSJVc2VyLSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI0Ny4yNTMsNDUsMjM4LjI1Myw0MSwyNDIuMjUzLDQ1LDIzOC4yNTMsNDksMjQ3LjI1Myw0NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTc0IiB4PSI1NS4yNSIgeT0iMzguMDY2OSI+MS4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbTwvdGV4dD48IS0tTUQ1PVs0YWNmYzk1NTBiZmFhNTliZmZjNmM2MWI4MjMzYTNhOV0KbGluayBCcm93c2VyIHRvIFVzZXItLT48cGF0aCBkPSJNMjU1LjgxOSw1My41OTIgQzIxOC42OTEsNjEuNDI2IDE1OC44NzMsNzAuOTQgMTA3LjI1LDY1IEM4NC42NzkxLDYyLjQwMyA1OS40MTMzLDU2LjA4IDQyLjE4OTUsNTEuMjMzICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0O1VzZXIiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMzcuMTE0Miw0OS43ODIsNDQuNjY3Nyw1Ni4xMDIyLDQxLjkyMTUsNTEuMTU2Niw0Ni44NjcxLDQ4LjQxMDUsMzcuMTE0Miw0OS43ODIiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY4IiB4PSIxMDguMjUiIHk9IjYxLjA2NjkiPjkuIOa4suafk+eVq+mdojwvdGV4dD48IS0tTUQ1PVtiY2FlZjkxOTFlZGY3ZGNlNGRiOTVjZDU3MGY0MjY5YV0KbGluayBCcm93c2VyIHRvIEROUy0tPjxwYXRoIGQ9Ik0yNjYuMjk2LDU2Ljk0OCBDMjQ0LjEzNyw2OC4xMDUgMjEzLjMyOCw4Ny43MjQgMTk5LjUsMTE1LjUgQzE5MC4xOTEsMTM0LjIgMTkwLjA4MiwxNDMuODU1IDE5OS41LDE2Mi41IEMyMDYuOTEsMTc3LjE2OSAyMjEuODU4LDE4OC4xMDggMjM0Ljg1MywxOTUuMzQ4ICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0O0ROUyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyMzkuNTM1LDE5Ny44NDcsMjMzLjQ3ODMsMTkwLjA4MDcsMjM1LjEyMzksMTk1LjQ5MjksMjI5LjcxMTcsMTk3LjEzODUsMjM5LjUzNSwxOTcuODQ3IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI3MCIgeD0iMjAwLjUiIHk9IjE0My41NjY5Ij4yLiDoq4vntabmiJEgSVA8L3RleHQ+PCEtLU1ENT1bYzdkMmE3YTBhNWMyNzExZGMzNzZmNzM3NTJkZjIwZDRdCmxpbmsgRE5TIHRvIEJyb3dzZXItLT48cGF0aCBkPSJNMjY0LjUzOSwxOTIuOTQyIEMyNjguMjM1LDE4NC40NDEgMjcyLjc2NCwxNzMuMDE1IDI3NS41LDE2Mi41IEMyODQuMjU2LDEyOC44NDQgMjg4LjQ0NCw4OC4zOTYgMjkwLjI2Niw2NS4wOTYgIiBmaWxsPSJub25lIiBpZD0iRE5TLSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI5MC42NTksNTkuODM1LDI4NS45OTg5LDY4LjUxMTYsMjkwLjI4NjEsNjQuODIxMSwyOTMuOTc2Nyw2OS4xMDgyLDI5MC42NTksNTkuODM1IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMzIiIHg9IjI4NS41IiB5PSIxNDMuNTY2OSI+NC4gSVAg54K6IDEyMy4yMjMuNDUuNjwvdGV4dD48IS0tTUQ1PVsyYTFkMDJjYjI3MGMzNDA1NTMzMDkxYzhmNDg5ZDdkMV0KbGluayBETlMgdG8gTmFtZSBTZXJ2ZXItLT48cGF0aCBkPSJNMjU4LjUsMjI2LjcwOCBDMjU4LjUsMjUxLjU4OSAyNTguNSwyOTUuMzc1IDI1OC41LDMyMC43NjQ0ICIgZmlsbD0ibm9uZSIgaWQ9IkROUy1OYW1lIFNlcnZlciIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTguNSwzMjUuODg5NSwyNjIuNSwzMTYuODg5NSwyNTguNSwzMjAuODg5NSwyNTQuNSwzMTYuODg5NSwyNTguNSwzMjUuODg5NSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTguNSwyMjEuNjgxLDI1NC41LDIzMC42ODEsMjU4LjUsMjI2LjY4MSwyNjIuNSwyMzAuNjgxLDI1OC41LDIyMS42ODEiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyOCIgeD0iMjU5LjUiIHk9IjI2NC41NjY5Ij4zLiDlsIcgRG9tYWluIOi9ieaIkCBJUDwvdGV4dD48IS0tTUQ1PVs2OTMxZTJmNGZjYTU2MGMyYzY4M2NhNGZlZjUxYWZjZF0KbGluayBCcm93c2VyIHRvIDEyMy4yMjMuNDUuNi0tPjxwYXRoIGQ9Ik0zMzUuNTksNDUgQzM3Ny4xNzYsNDUgNDQwLjE4Niw0NSA0ODguNjE3LDQ1ICIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXItJmd0OzEyMy4yMjMuNDUuNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OTMuODUxLDQ1LDQ4NC44NTEsNDEsNDg4Ljg1MSw0NSw0ODQuODUxLDQ5LDQ5My44NTEsNDUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyMiIgeD0iMzUzLjc1IiB5PSIyMy4wNjY5Ij41LuWPluW+lyBJUCDlvozoqKrllY/kuLvmqZ88L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNjUiIHg9IjM4Mi4yNSIgeT0iMzguMTk5NyI+5Lim5LiL6LyJ6LOH5rqQPC90ZXh0PjwhLS1NRDU9Wzg5NWE5NThmYzM4YWFiY2M1OWI1MTI1YjYwYjVjY2JkXQpsaW5rIDEyMy4yMjMuNDUuNiB0byBCcm93c2VyLS0+PHBhdGggZD0iTTUxMy45ODUsNTYuMjg1IEM0OTcuOTQ4LDU5LjgyMSA0NzkuNjQyLDYzLjI1NSA0NjIuNzUsNjUgQzQyMC4zMDksNjkuMzg1IDQwOS4wNTcsNzAuNTI2IDM2Ni43NSw2NSBDMzUzLjk2Niw2My4zMyAzNDAuMjYzLDYwLjEyOCAzMjguMSw1Ni43NjggIiBmaWxsPSJub25lIiBpZD0iMTIzLjIyMy40NS42LSZndDtCcm93c2VyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMyMi45ODksNTUuMzIyLDMzMC41NjEyLDYxLjYxOTgsMzI3LjgwMDQsNTYuNjgyNCwzMzIuNzM3OCw1My45MjE2LDMyMi45ODksNTUuMzIyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI5NCIgeD0iMzY3Ljc1IiB5PSI2MS4wNjY5Ij44LiDlm57lgrPpnZzmhYvos4fmlpk8L3RleHQ+PCEtLU1ENT1bMzY1ZDc2OWE4ZGU2ODJkNGQ2YzgwZmVlNDliZTEwNDRdCmxpbmsgMTIzLjIyMy40NS42IHRvIFdlYiBTZXJ2ZXItLT48cGF0aCBkPSJNNTQ4LjMwNyw2MC4zNTQgQzUzMy41MjEsODMuMDk3IDUwOS43MzQsMTI4LjMzMyA1MjcuNSwxNjIuNSBDNTMzLjg3MywxNzQuNzU2IDU0NS40NTYsMTg0LjI3OCA1NTYuOSwxOTEuMjQ3ICIgZmlsbD0ibm9uZSIgaWQ9IjEyMy4yMjMuNDUuNi0mZ3Q7V2ViIFNlcnZlciIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NjEuNDM4LDE5My44ODgsNTU1LjY3MjQsMTg1LjkwMzEsNTU3LjExNjksMTkxLjM3MjUsNTUxLjY0NzYsMTkyLjgxNjksNTYxLjQzOCwxOTMuODg4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI2OCIgeD0iNTI4LjUiIHk9IjE0My41NjY5Ij42LiDntKLlj5bos4fmupA8L3RleHQ+PCEtLU1ENT1bNDUxNjU4MWZlMzg1YTNmNzI2OTNjNDBiMTBhOTI5ZTNdCmxpbmsgV2ViIFNlcnZlciB0byAxMjMuMjIzLjQ1LjYtLT48cGF0aCBkPSJNNTk1Ljk4LDE5Mi4yNDQgQzU5OS41NjksMTgzLjg1NSA2MDMuNjY2LDE3Mi43OTkgNjA1LjUsMTYyLjUgQzYwOS4xNjIsMTQxLjkzNSA2MTEuNjE5LDEzNS40NzIgNjA1LjUsMTE1LjUgQzU5OS41ODMsOTYuMTg5IDU4Ni4yODgsNzcuNDA5IDU3NS4zNDMsNjQuMjQ5ICIgZmlsbD0ibm9uZSIgaWQ9IldlYiBTZXJ2ZXItJmd0OzEyMy4yMjMuNDUuNiIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NzIuMDMyLDYwLjM1MSw1NzQuODA3Myw2OS44MDA3LDU3NS4yNjc5LDY0LjE2MjcsNTgwLjkwNiw2NC42MjMzLDU3Mi4wMzIsNjAuMzUxIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iNjI3LjUiIHk9IjEyOC41NjY5Ij43LiDlm57lgrM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNTIiIHg9IjYyMi41IiB5PSIxNDMuNjk5NyI+6Z2c5oWL5qqU5qGIPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9Ijc4IiB4PSI2MDkuNSIgeT0iMTU4LjgzMjUiPkpTT04g5oiWIFhNTDwvdGV4dD48IS0tTUQ1PVs0ZDc4NDIyOWQ1YzFjOWZiNzg4Yzk3MzI3NWQxMmQ5MF0KQHN0YXJ0dW1sDQpVc2VyIC0+IChCcm93c2VyKTogMS4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbQ0KKEJyb3dzZXIpIC1kb3duLT4gKEROUyk6IDIuIOiri+e1puaIkSBJUA0KKEROUykgPC0gLT4gKE5hbWUgU2VydmVyKTogMy4g5bCHIERvbWFpbiDovYnmiJAgSVANCihETlMpIC0gLT4gKEJyb3dzZXIpOiA0LiBJUCDngrogMTIzLjIyMy40NS42DQooQnJvd3NlcikgLXJpZ2h0LT4gKDEyMy4yMjMuNDUuNik6IDUu5Y+W5b6XIElQIOW+jOioquWVj+S4u+apn1xu5Lim5LiL6LyJ6LOH5rqQDQooMTIzLjIyMy40NS42KSAtIC0+IChXZWIgU2VydmVyKTogNi4g57Si5Y+W6LOH5rqQDQooV2ViIFNlcnZlcikgLXJpZ2h0LT4gKDEyMy4yMjMuNDUuNik6IDcuIOWbnuWCs1xu6Z2c5oWL5qqU5qGIXG5KU09OIOaIliBYTUwNCigxMjMuMjIzLjQ1LjYpIC0+IChCcm93c2VyKTogOC4g5Zue5YKz6Z2c5oWL6LOH5paZDQooQnJvd3NlcikgLXJpZ2h0LT4gVXNlcjogOS4g5riy5p+T55Wr6Z2iDQpub3RlIGxlZnQgb2YgKE5hbWUgU2VydmVyKQ0KICDomZXnkIblm5vlgIvpg6jliIY6DQogIHJvb3QNCiAgLmNvbQ0KICB3d3cNCiAgLmdvb2dsZQ0KZW5kIG5vdGUNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4xNWJldGExKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg==\">\n\n<p>DNS 全名為 Domain Name Server，主要職責是幫忙把 網域名稱(Domain Name) 轉成 IP，因為網域名稱是人才看得懂而機器只認得 IP，因此需要 DNS 來幫忙轉譯。</p>\n<h3 id=\"Name-Server\"><a href=\"#Name-Server\" class=\"headerlink\" title=\"Name Server\"></a>Name Server</h3><p>藉由上圖最終 DNS 會收到每個單獨的 Name Server 回傳後的值並組成 IP 回傳給瀏覽器。</p>\n<h2 id=\"跟-IP-請求資源\"><a href=\"#跟-IP-請求資源\" class=\"headerlink\" title=\"跟 IP 請求資源\"></a>跟 IP 請求資源</h2><p>待瀏覽器收到 IP 後去請求資源，而 IP (資源方)那一般來說都會有個 Web Server 擋在前面(Nginx、Apache)，若是有前端頁面則是讓瀏覽器下載靜態檔案(static)，而若只是單純導向至 API 的話就直接回傳定義的資料格式(JSON、XML…)。</p>\n<h2 id=\"快取\"><a href=\"#快取\" class=\"headerlink\" title=\"快取\"></a>快取</h2><p>此時瀏覽器下載完後則會存到快取(Cache)裡，加速下次載入。</p>\n<h2 id=\"渲染\"><a href=\"#渲染\" class=\"headerlink\" title=\"渲染\"></a>渲染</h2><p><img src=\"https://i.imgur.com/ddrEQxs.png\" alt=\"https://i.imgur.com/ddrEQxs.png\"></p>\n<blockquote>\n<p>參考<a href=\"https://w3c.hexschool.com/blog/8d691e4f\" target=\"_blank\" rel=\"noopener\">六角學院</a></p>\n</blockquote>\n<p>這邊就簡單敘述一下前端渲染發生的經過，HTML 會產生出一個 <code>DOM Tree</code>，CSS 會有一個 <code>CSSOM Tree</code>，在各別產生完後會合併成一個 <code>render Tree</code>，最後經由 <code>layout</code> 的步驟讓瀏覽器將 Tree 渲染至畫面上，完成畫面顯示的步驟。</p>\n<ul>\n<li>上述的 DOM 就是寫 jQuery 時呼叫的那個 DOM 元素</li>\n</ul>\n<p>以上就是當你輸入一個網址後會遇到的事情經過～</p>\n<h1 id=\"輸入網址後，你怎能不知道怎麼連線呢？\"><a href=\"#輸入網址後，你怎能不知道怎麼連線呢？\" class=\"headerlink\" title=\"輸入網址後，你怎能不知道怎麼連線呢？\"></a>輸入網址後，你怎能不知道怎麼連線呢？</h1><h2 id=\"準備連線-三方交握-Three-Way-Handshake\"><a href=\"#準備連線-三方交握-Three-Way-Handshake\" class=\"headerlink\" title=\"準備連線 - 三方交握 (Three-Way Handshake)\"></a>準備連線 - 三方交握 (Three-Way Handshake)</h2><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMjM4cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDozMjBweDtoZWlnaHQ6MjM4cHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAzMjAgMjM4IiB3aWR0aD0iMzIwcHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzPjxmaWx0ZXIgaGVpZ2h0PSIzMDAlIiBpZD0iZmRkd2c5MTM2bXhxdyIgd2lkdGg9IjMwMCUiIHg9Ii0xIiB5PSItMSI+PGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgc3RkRGV2aWF0aW9uPSIyLjAiLz48ZmVDb2xvck1hdHJpeCBpbj0iYmx1ck91dCIgcmVzdWx0PSJibHVyT3V0MiIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIC40IDAiLz48ZmVPZmZzZXQgZHg9IjQuMCIgZHk9IjQuMCIgaW49ImJsdXJPdXQyIiByZXN1bHQ9ImJsdXJPdXQzIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iYmx1ck91dDMiIG1vZGU9Im5vcm1hbCIvPjwvZmlsdGVyPjwvZGVmcz48Zz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogNS4wLDUuMDsiIHgxPSIzOCIgeDI9IjM4IiB5MT0iMzguMjk2OSIgeTI9IjE4OS45NjA5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IHN0cm9rZS1kYXNoYXJyYXk6IDUuMCw1LjA7IiB4MT0iMjcyIiB4Mj0iMjcyIiB5MT0iMzguMjk2OSIgeTI9IjE4OS45NjA5Ii8+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZkZHdnOTEzNm14cXcpIiBoZWlnaHQ9IjMwLjI5NjkiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjU3IiB4PSI4IiB5PSIzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iNDMiIHg9IjE1IiB5PSIyMi45OTUxIj5DbGllbnQ8L3RleHQ+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZkZHdnOTEzNm14cXcpIiBoZWlnaHQ9IjMwLjI5NjkiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjU3IiB4PSI4IiB5PSIxODguOTYwOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjQzIiB4PSIxNSIgeT0iMjA4Ljk1NjEiPkNsaWVudDwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRkd2c5MTM2bXhxdykiIGhlaWdodD0iMzAuMjk2OSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNjEiIHg9IjI0MCIgeT0iMyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjQ3IiB4PSIyNDciIHk9IjIyLjk5NTEiPlNlcnZlcjwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZmRkd2c5MTM2bXhxdykiIGhlaWdodD0iMzAuMjk2OSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNjEiIHg9IjI0MCIgeT0iMTg4Ljk2MDkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI0NyIgeD0iMjQ3IiB5PSIyMDguOTU2MSI+U2VydmVyPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjYwLjUsNjUuNDI5NywyNzAuNSw2OS40Mjk3LDI2MC41LDczLjQyOTcsMjY0LjUsNjkuNDI5NyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IiB4MT0iMzguNSIgeDI9IjI2Ni41IiB5MT0iNjkuNDI5NyIgeTI9IjY5LjQyOTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNzkiIHg9IjQ1LjUiIHk9IjY0LjM2MzgiPuaIkemcgOimgemAo+e3mihTWU4p77yM5Zue562U6KuL55SoIE08L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OS41LDEwOS42OTUzLDM5LjUsMTEzLjY5NTMsNDkuNSwxMTcuNjk1Myw0NS41LDExMy42OTUzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiIHgxPSI0My41IiB4Mj0iMjcxLjUiIHkxPSIxMTMuNjk1MyIgeTI9IjExMy42OTUzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTYzIiB4PSI1NS41IiB5PSI5My40OTY2Ij7mlLbliLDkuobvvIzmmK8gTSsxIOWXjihBQ0sp77yfPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEwNCIgeD0iNTkuNSIgeT0iMTA4LjYyOTQiPuWbnuetlOiri+eUqCBOIChTWU4pPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjYwLjUsMTM4LjgyODEsMjcwLjUsMTQyLjgyODEsMjYwLjUsMTQ2LjgyODEsMjY0LjUsMTQyLjgyODEiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIgeDE9IjM4LjUiIHgyPSIyNjYuNSIgeTE9IjE0Mi44MjgxIiB5Mj0iMTQyLjgyODEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyMTAiIHg9IjQ1LjUiIHk9IjEzNy43NjIyIj7mlLbliLDkuobvvIxOKzEg5piv5oiR5pS25Yiw55qE6KiK6JmfKEFDSyk8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OS41LDE2Ny45NjA5LDM5LjUsMTcxLjk2MDksNDkuNSwxNzUuOTYwOSw0NS41LDE3MS45NjA5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI2MC41LDE2Ny45NjA5LDI3MC41LDE3MS45NjA5LDI2MC41LDE3NS45NjA5LDI2NC41LDE3MS45NjA5IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogMi4wLDIuMDsiIHgxPSI0My41IiB4Mj0iMjY2LjUiIHkxPSIxNzEuOTYwOSIgeTI9IjE3MS45NjA5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTUwIiB4PSI1NS41IiB5PSIxNjYuODk1Ij5TZXJ2ZXIg56K66KqN5a6M5b6M6ZaL5aeL6YCj57eaPC90ZXh0PjwhLS1NRDU9WzA2MGYxODZlMDgxMmE5YTI4OGNkM2ZkYzg5ZjYwOGU0XQpAc3RhcnR1bWwNCkNsaWVudCAtPiBTZXJ2ZXI6IOaIkemcgOimgemAo+e3mihTWU4p77yM5Zue562U6KuL55SoIE0NClNlcnZlciAtPiBDbGllbnQ6IOaUtuWIsOS6hu+8jOaYryBNKzEg5ZeOKEFDSynvvJ9cbiDlm57nrZToq4vnlKggTiAoU1lOKQ0KQ2xpZW50IC0+IFNlcnZlcjog5pS25Yiw5LqG77yMTisxIOaYr+aIkeaUtuWIsOeahOioiuiZnyhBQ0spDQpDbGllbnQgPC0gLT4gU2VydmVyOiBTZXJ2ZXIg56K66KqN5a6M5b6M6ZaL5aeL6YCj57eaDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjAuMTMoU2F0IEp1biAxMyAxMjoyNjozOCBVVEMgMjAyMCkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=\">\n\n<p>這邊我用最簡單的表示，<code>SYN</code>在三方交握會是一個帶有序列號(n)的請求，而<code>ACK</code>則是代表回應對方我們這邊收到的訊號，會帶有 n+1 的數字回傳。</p>\n<p>在三方交握中，會先由 Client 告訴 Server 現在它要連線並給一個數字，回傳時會送 n+1 的原因是避免在請求的過程中因各種因素導致回來的值錯誤時的一個防範機制，用 <code>+1</code> 這個做法來確保對方給的回傳值是我剛剛送出去的值 +1，避免連線過程中混亂。</p>\n<p>簡單的記法就是從 Client 先送一個數字 N 給 Server，而回傳時一定是給 N+1 並且帶著一個 M，Client 收到後確認完則在回傳 M+1 讓 Server 也確定 CLient 收到了，完成三次連線。</p>\n<h3 id=\"Bonus-為什麼不兩次或四次交握呢？\"><a href=\"#Bonus-為什麼不兩次或四次交握呢？\" class=\"headerlink\" title=\"Bonus - 為什麼不兩次或四次交握呢？\"></a>Bonus - 為什麼不兩次或四次交握呢？</h3><p>經過上述的流程，一定是一個發(SYN)，一個收完後告訴對方它收到(ACK)，那如果是只有<code>兩次</code>， Client 會不知道 Server 收到沒，導致這次連線失敗。</p>\n<p>然後四次、五次、六次其實都是可以做到的，但只是工程師在實作東西時都會盡可能的精簡它，所以為了不浪費系統資源，因此最低次數就是<code>三次</code>！🎉</p>\n<h2 id=\"斷開連線-四次揮手-Four-Way-Wavehand\"><a href=\"#斷開連線-四次揮手-Four-Way-Wavehand\" class=\"headerlink\" title=\"斷開連線 - 四次揮手(Four-Way Wavehand)\"></a>斷開連線 - 四次揮手(Four-Way Wavehand)</h2><blockquote>\n<p>四次揮手是用 FIN 以及 ACK 當作 請求 以及 回應</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/wZk7hoS.png\" alt=\"https://i.imgur.com/wZk7hoS.png\"></p>\n<blockquote>\n<p>圖片<a href=\"(https://kknews.cc/code/yr9ng6j.html)\">參考</a></p>\n</blockquote>\n<blockquote>\n<p>Client = 1, Server = 2 的話，順序就是 1 - 2 - 2 - 1</p>\n</blockquote>\n<p>我了解這部分的方法是</p>\n<h4 id=\"每個關閉連線時都需要等待\"><a href=\"#每個關閉連線時都需要等待\" class=\"headerlink\" title=\"每個關閉連線時都需要等待\"></a>每個關閉連線時都需要等待</h4><p>所以向 Client 送請求(<code>FIN</code>)到 Server 會先告訴 Client 已經收到(<code>ACK</code>)，處理完後再送一個請求給 Client，Client 最後就在回應 Server 告訴他能關閉來斷開連線。</p>\n<p>因為是在第三步驟最後回應時需要等待 Server 的主動發送，因此交握的最低數量就變成<code>4</code>了。</p>\n<p>基本上跟三方交握流程是一樣的，差別在於到 Server 時不會馬上告訴 Client 等等要回應的值(N)是多少，而是等 ACK 完後過一陣子才回傳 publish FIN flag。</p>\n<p>詳細可以參考<a href=\"https://kknews.cc/code/yr9ng6j.html\" target=\"_blank\" rel=\"noopener\">這篇</a></p>\n<h1 id=\"SSL\"><a href=\"#SSL\" class=\"headerlink\" title=\"SSL\"></a>SSL</h1><p>經過了上面無情摧殘後，接下來就是要認識 SSL 這個安全機制了。</p>\n<p><img src=\"https://i.imgur.com/5tk4osI.png\" alt></p>\n<p>除非你的網站內容是全靜態輸出，完全沒串任何 API，否則沒有 SSL 安全性實在是嚴重不足啊！因為沒有 SSL 的網站會享有<a href=\"https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB\" target=\"_blank\" rel=\"noopener\">中間人攻擊</a>的優惠，那既然那麼重要接著就來介紹吧！</p>\n<blockquote>\n<p>這裡會簡單敘述一下流程以及功能，但詳細的還是要參考其他部落格詳細的文章喔！</p>\n</blockquote>\n<h2 id=\"SSL-有的裝備\"><a href=\"#SSL-有的裝備\" class=\"headerlink\" title=\"SSL 有的裝備\"></a>SSL 有的裝備</h2><p>SSL 申請時一般都會給三種東西，公鑰(Public key)、私鑰(Private key)、CA(Certificate authority)</p>\n<ol>\n<li>公鑰是 Server 發給信任裝置使用的鑰匙</li>\n<li>私鑰則是解開來自信任裝置加密封包的鑰匙</li>\n<li>CA 是 Server 的證書，用來確認 Server 的合法性，若只拿私鑰來解也會含有中間人攻擊的問題</li>\n</ol>\n<h2 id=\"流程\"><a href=\"#流程\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p><img src=\"https://i.imgur.com/oeLkNoP.png\" alt=\"https://i.imgur.com/oeLkNoP.png\"></p>\n<blockquote>\n<p>圖片參考<a href=\"http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html\" target=\"_blank\" rel=\"noopener\">阮一峰的部落格</a></p>\n</blockquote>\n<p>Visitor 就等於前面文章提到的 Client，而 CloudFlare 則等於 Server 端。</p>\n<ol>\n<li>Client 把一個<code>隨機數</code>並發送給 Server</li>\n<li>Server 在產生一組<code>隨機數+公鑰</code>給 Client</li>\n<li>Client 利用收到的<code>隨機數+公鑰</code>加密資料回傳給 Server</li>\n<li>Server 用<code>私鑰</code>來解開資料</li>\n<li>拿著上圖灰色虛線的東西來產生 Session Key 確認對方</li>\n</ol>\n<blockquote>\n<p>隨機數用意為讓密鑰每次產生都不一樣</p>\n</blockquote>\n<h2 id=\"SSL-小結\"><a href=\"#SSL-小結\" class=\"headerlink\" title=\"SSL 小結\"></a>SSL 小結</h2><p>這邊沒有提太多實作跟詳細內容，但看著上述的流程來說有沒有覺得其實跟<code>三方交握</code>很像，差別在於 Server 端回傳時有多給 Client 一個公鑰(Public Key)，所以再記這部分時，利用三方交握來理解這件事情，基本上就如魚得水了！😊</p>\n<h1 id=\"OAuth\"><a href=\"#OAuth\" class=\"headerlink\" title=\"OAuth\"></a>OAuth</h1><p>接著就一起陪我釐清 OAuth 吧！</p>\n<h2 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h2><p>讓客戶端能以 OAuth 開放標準在第三方應用程式上透過授權(Authorization)的方式取得在服務提供商(LINE、Facebook、Google…)的資料(檔案、照片、影片…)。</p>\n<h2 id=\"擁有四種角色\"><a href=\"#擁有四種角色\" class=\"headerlink\" title=\"擁有四種角色\"></a>擁有四種角色</h2><ul>\n<li>Resource Owner(簡稱 RO)：可以授權於<code>終端用戶</code>存取受保護之資料。</li>\n<li>Resource Server(簡稱 RS)：存取受保護資料的地方，根據 Access Token 之權限處理請求。</li>\n<li>Client：代表使用者去存取受保護資料的應用程式。Client 指任何在 Server 端、桌面或設備上執行的應用程式。</li>\n<li>Authorization Server(簡稱 AS)：職責為認證過使用者的身份，且經由使用者許可後，就會簽發 Access Token 的地方。</li>\n</ul>\n<h2 id=\"流程-1\"><a href=\"#流程-1\" class=\"headerlink\" title=\"流程\"></a>流程</h2><p>以下為一個 OAuth 的流程:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+--------+                               +---------------+</span><br><span class=\"line\">|        |--(1)- Authorization Request -&gt;|   Resource    |</span><br><span class=\"line\">|        |                               |     Owner     |</span><br><span class=\"line\">|        |&lt;-(2)-- Authorization Grant ---|               |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |--(3)-- Authorization Grant --&gt;| Authorization |</span><br><span class=\"line\">| Client |                               |     Server    |</span><br><span class=\"line\">|        |&lt;-(4)----- Access Token -------|               |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |</span><br><span class=\"line\">|        |                               +---------------+</span><br><span class=\"line\">|        |--(5)----- Access Token ------&gt;|    Resource   |</span><br><span class=\"line\">|        |                               |     Server    |</span><br><span class=\"line\">|        |&lt;-(6)--- Protected Resource ---|               |</span><br><span class=\"line\">+--------+                               +---------------+</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"小故事\"><a href=\"#小故事\" class=\"headerlink\" title=\"小故事\"></a>小故事</h2><p>以下會分別用四個角色代替他們：<br>Client = A 員工、RO = 大樓警衛、AS = 公司櫃檯、RS = 倉庫</p>\n<p>並用小故事說明，情境是員工假日需返回公司倉庫拿取零件，但是卻沒帶公司的證件，而公司是在商業辦公室中，大樓警衛認不得這麼多間公司的人，因此需要按照基本流程才能進公司拿取資料，A 員工抵達商辦大樓後：</p>\n<ol>\n<li>A 員工拿證件出來並填寫基本資料的單子給警衛 (發送請求)</li>\n<li>警衛確認完後拿了一個暫時性的鑰匙(<code>code</code>)給 A 員工</li>\n<li>A 員工拿著暫時性鑰匙(<code>code</code>)跟公司櫃檯</li>\n<li>櫃檯將臨時鑰匙(<code>code</code>)換成公司的門禁卡(Access Token)</li>\n<li>A 員工去倉庫使用門禁卡(Access Token)開倉庫門</li>\n<li>倉庫門打開後 A 員工從裡面拿取自己需要的零件(Protected Resource)</li>\n</ol>\n<blockquote>\n<p>透過這樣的解釋應該比較好懂吧 ❓</p>\n</blockquote>\n<h2 id=\"小結\"><a href=\"#小結\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>看著流程圖，有沒有覺得它還是很像三方交握嗎？只是 Server 端功能切開變成微服務的樣子，並透過三個步驟來獲取 Server 的資源，如此一來會不會覺得這樣親切點呢？</p>\n<p>希望能藉由文章的敘述讓你能更快速點了解這些玩意兒。</p>\n<h1 id=\"OpenID-Connect\"><a href=\"#OpenID-Connect\" class=\"headerlink\" title=\"OpenID Connect\"></a>OpenID Connect</h1><p>大家寫了這麼多 side project，對 OAuth 的見聞與使用一定不在其數，但實際上在做像是 LINE Login、Facebook、Google 這類型的 Single Sign On(SSO) 的服務時很常誤以為 <code>SSO == OAuth</code>，答案是錯的，SSO 這件事情本身是由 OpenID 來實現，對於實際的原由呢，這邊有<a href=\"https://medium.com/@petertc/openid-connect-a27e0a3cc2ae\" target=\"_blank\" rel=\"noopener\">很詳細的介紹</a>，這邊就不贅述。</p>\n<p>主要的核心我覺得要記得這件事：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">OpenID Connect 是認證（Authentication），OAuth 2.0 則是授權（Authorization）</span><br></pre></td></tr></table></figure>\n\n<p>一般來說只要搞懂這兩個字的意思，並透過實作經驗加上記得文件內容，就會對於 OpenID 以及 OAuth 個別的職責是什麼很清楚。</p>\n<p><img src=\"https://i.imgur.com/WghYZJM.png\" alt></p>\n<blockquote>\n<p>這邊一樣參考 petertc 的<a href=\"https://medium.com/@petertc/openid-connect-a27e0a3cc2ae\" target=\"_blank\" rel=\"noopener\">文章</a></p>\n</blockquote>\n<p>上圖流程可能太複雜，這裡簡單敘述一下，就是他流程基本上與 OAuth 差不多，因為 OpenID 就是在 OAuth 上加一層<code>使用者認證層(User Identify Layer)</code>，若記得上述 OAuth 的話，OpenID 會在取得 Access Token 的同時取得一個 ID Token，以下說明一下 ID Token：</p>\n<p>ID Token 一般比較常見是 Json Web Token(JWT) 的格式，使用者的資訊一般都會放在這邊，只要拿到了這個就可以跟資料庫去 mapping 就能做使用者管理囉 ❗️</p>\n<h2 id=\"小結-1\"><a href=\"#小結-1\" class=\"headerlink\" title=\"小結\"></a>小結</h2><p>OpenID 其中一部分解決了 OAuth scope 這參數定義的問題，在 OpenID 還沒出來之前這個時基本上是服務提供商說的算，眾說紛紜的話那就損失了公信力，因此 OpenID 的 scope 除了要必須輸入 <code>openid</code> 以外呢，他還有規定可以輸入<code>email</code>、<code>phone</code>、<code>profile</code>，因此在有規範後在串接第三方服務後就不會各說各的啦！</p>\n<p>此外這邊需要再重複一次，OpenID 是<code>驗證</code>與各戶端的交握過程後並給初使用者資料，而 OAuth 則是<code>授權</code>於應用程式可以取用服務中的某個資料(從倉庫拿貨)，如此一來就能較有效的記得 OpenID 與 OAuth 的差異囉！</p>\n<h1 id=\"結論\"><a href=\"#結論\" class=\"headerlink\" title=\"結論\"></a>結論</h1><p>在這些熱門面試題中往往是準備不完的 😅，但如何有效的記得這些東西的步驟卻是很重要，畢竟不可能只把 HTTP、SSL、OpenID、OAuth 讀完面試就過了吧？還有演算法、資料庫 這些哩哩摳摳的需要釐清，當然這邊是整理出我自己的紀錄方法，希望能透過我的方法讓你能夠更快速的釐清這些功能，但看完了各個文章後還是記得要看官方文件，把真正的東西學進去才是對自己有益的喔！</p>\n<p>那本篇就先記錄到這，希望大家能有收穫 😁</p>"},{"title":"續篇 — serverless + WSGI + flask + chatbot 的開發指南","abbrlink":895426056,"date":"2019-11-02T05:04:28.000Z","_content":"\n# 前言\n\n如果還不知道 Serverless (以下簡稱 sls )的朋友可以先看我[上篇文章](https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/)，裡頭有介紹 [Python](https://github.com/louis70109/aws-line-echo-bot) 以及 [Ruby](https://github.com/louis70109/aws-ruby-line-echo-bot) 的範例。\n還沒接觸 Serverless 之前，當開發完一包程式時就將它部署至 Heroku，實在是有夠方便又快速(還是免費的)。不過有個問題是當程式沒在運行時他會睡覺，身為一個免費仔做的小專案這樣是夠的，做為一個貪心的免費仔怎能容許睡覺睡這麼久 🤤！但若是照著我上篇分享的文章做，佈署程式沒問題，但就開發機器人我都要佈署才能測試，這未免也太不人性了 😒。<!-- more -->\n既然上次都用 Python 來寫了，為了解決這個問題，本篇會介紹如何在 Serverless 上導入 WSGI & Flask，讓我們再開發時不僅可以在本地端 auto-reload，也可以搭配 ngrok 讓 chatbot wehook 能夠打過來做測試。\n\n<div class=\"tenor-gif-embed\" data-postid=\"14472399\" data-share-method=\"host\" data-width=\"100%\" data-aspect-ratio=\"2.2232142857142856\"><a href=\"https://tenor.com/view/minions-amazing-cheer-yes-excited-gif-14472399\">Minions Amazing GIF</a> from <a href=\"https://tenor.com/search/minions-gifs\">Minions GIFs</a></div><script type=\"text/javascript\" async src=\"https://tenor.com/embed.js\"></script>\n\n> 順便慶祝一下 python 以及 ruby 的兩個範例都過 Serverless 的 PR 了 ✌️\n\n![](https://i.imgur.com/PVcuACel.png)\n![](https://i.imgur.com/RmqPM0bl.png)\n\n# 實作\n\n這次的主題是延續上次的文章，過程中若有像是 AWS key 之類的問題可以回顧一下～\n\n- [使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot](https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/)\n- [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot?source=post_page-----f11de7dee7aa----------------------)\n\n首先先透過 sls 至 Github 將 Python 範例抓下來並建專案。\n\n```bash\n$ serverless install --url https://github.com/louis70109/aws-line-echo-bot -n <YOUR_FILE_NAME>\n$ cd <YOUR_FILE_NAME>\n```\n\n接著參考 [官方文件](https://serverless.com/plugins/serverless-wsgi/) 上的實例，引入 WSGI & requirements Plugin。\n\n```bash\n$ sls plugin install -n serverless-wsgi\n$ sls plugin install -n serverless-python-requirements\n```\n\n接著加入 Flask 以及 line-bot-sdk 的相依套件版本(寫這篇時是使用 Flask 1.0.2 以及 line-bot-sdk 1.12.1)\n\n```bash\n$ echo “Flask==1.0.2\\nline-bot-sdk==1.12.1” > requirements.txt\n$ pip install -r requirements.txt -—user\n```\n\n置換以下內容至 serverless.yml，讓 WSGI 去處理路由。\n\n```yaml\nservice: <YOUR_FILE_NAME>\nprovider:\n  name: aws\n  runtime: python3.7\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\ncustom:\n  wsgi:\n    app: api.app\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n新增 api.py 並加入以下內容 (記得要換 chatbot token 哦！)\n\n```python\nfrom flask import Flask, request, abort\nimport json\nfrom linebot import (\n    LineBotApi, WebhookHandler\n)\nfrom linebot.exceptions import (\n    InvalidSignatureError\n)\nfrom linebot.models import (\n    MessageEvent, TextMessage, TextSendMessage,\n)\n\napp = Flask(__name__)\n\n@app.route(\"/webhook\", methods=['POST'])\ndef webhook():\n    line_bot_api = LineBotApi('YOUR_CHANNEL_TOKEN')\n    handler = WebhookHandler('YOUR_CNANNEL_SECRET_KEY')\n\n    # get X-Line-Signature header value\n    signature = request.headers['X-Line-Signature']\n\n    body = request.get_data(as_text=True)\n    event = json.loads(body)\n    print(event)\n    try:\n        handler.handle(body, signature)\n    except InvalidSignatureError:\n        print(\n            \"Invalid signature. Please check your channel access token/channel secret.\")\n        abort(400)\n\n    token = event['events'][0]['replyToken']\n    if token == \"00000000000000000000000000000000\":\n        pass\n    else:\n        line_bot_api.reply_message(token, TextSendMessage(\n            text=event['events'][0]['message']['text']))\n    return 'OK'\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n接著就透過 WSGI 起一個 local server(預設 port 為 5000)\n\n```bash\n$ sls wsgi serve\n```\n\n![](https://i.imgur.com/zVY6YYB.png)\n\n並加上 ngrok 並指定用 5000 port\n\n```bash\n$ ./ngrok http 5000\n```\n\n![](https://i.imgur.com/K40h9e8.png)\n\n將 ngrok 產生的網址貼進 webhook 欄位並加上 /wehbook 。\n(註: 透過 sls 起的 local server 並不會有 /dev 或是 /prod 開頭的網址哦！)\n![](https://i.imgur.com/0BzEsP1.png)\n\n若測試流程都順利的話，最後就是 Deploy 上 AWS 囉！\n\n```\nsls deploy\n```\n\n佈署完應該會看到類似以下內容：\n![](https://i.imgur.com/vAiRaZS.png)\n\n這裡大家可能會有個疑慮，為什麼上篇文章的 endpoints 會幫忙顯示路由，但這邊沒有呢？因為上篇文章的佈屬方法是屬於一個 function 對應一個 API，所以若寫了很多路由的話，在 AWS Dashboard 裡就會看到一大堆的 function，雖然佈署時都幫你顯示他的路由，但在後續管理上就會很麻煩。\n而這次的實作只建立出一個 Lambda，透過 WSGI 幫忙轉發到裡面的路由，使用時只要更改 {proxy} 改自己寫的路由，這邊就是改成 /webhook 就可以測試囉！\n\n> 若是玩完不想留著的話可以下以下指令來刪除這個專案有用到的 AWS 資源。\n\n```\nsls remove\n```\n\n# 後記\n\n這次只是將上次的寫的 [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot) 更新並加入 WSGI 以及 flask，在寫上篇文章當時在測試程式都要部署上去，或是用 serverless 的 invoke 來做本地端的模擬測試，但是要是接了像是 Line Message API 這類的第三方服務的話，根本沒辦法自己去模擬 replyToken 之類的參數，因此這次套用了 WSGI 以及 Flask 讓我可以在本地端搭配 ngrok 先測試完之後再將程式佈署上 AWS，如此以來既讓我的程式達到 Serverless，又不會為測試而影響到太多開發時間。\n不過都只有 API 相關的路由好像有點難應用，接下來要研究一下怎麼讓前端框架可以一起上 AWS 並擁有 SSL (上次玩只到 http 沒有 SSL)，並加上 RDS 讓整體服務可以串起來，雖然這樣不像 Heroku 這麼人性化一鍵通包，不過至少也是讓服務可以個別管理擴充呢！\n有興趣的朋友們可以參考我的 Github，若覺得不錯給個星星 ⭐️ 或是掌聲 👏 鼓勵我繼續研究下一個主題 😃！\n\n# 其他\n\n> 免費方案，AWS [常見問與答集](https://aws.amazon.com/tw/free/faqs/)\n\n![](https://i.imgur.com/OTxONmI.png)\n![](https://i.imgur.com/ymZyKyN.png)\n\n如果在做機器人時有用到類似 numpy, psycopg2 … 的套件的話，請參考 這篇文章，簡單來說因為 AWS 不會幫你編譯套件，所以需要透過 docker 來幫忙打包編譯並上傳。\n","source":"_posts/續篇-—-serverless-WSGI-flask-chatbot-的開發指南.md","raw":"---\ntitle: 續篇 — serverless + WSGI + flask + chatbot 的開發指南\ntags:\n  - Serverless\n  - LINE\n  - AWS\ncategories: Serverless\nabbrlink: 895426056\ndate: 2019-11-02 13:04:28\n---\n\n# 前言\n\n如果還不知道 Serverless (以下簡稱 sls )的朋友可以先看我[上篇文章](https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/)，裡頭有介紹 [Python](https://github.com/louis70109/aws-line-echo-bot) 以及 [Ruby](https://github.com/louis70109/aws-ruby-line-echo-bot) 的範例。\n還沒接觸 Serverless 之前，當開發完一包程式時就將它部署至 Heroku，實在是有夠方便又快速(還是免費的)。不過有個問題是當程式沒在運行時他會睡覺，身為一個免費仔做的小專案這樣是夠的，做為一個貪心的免費仔怎能容許睡覺睡這麼久 🤤！但若是照著我上篇分享的文章做，佈署程式沒問題，但就開發機器人我都要佈署才能測試，這未免也太不人性了 😒。<!-- more -->\n既然上次都用 Python 來寫了，為了解決這個問題，本篇會介紹如何在 Serverless 上導入 WSGI & Flask，讓我們再開發時不僅可以在本地端 auto-reload，也可以搭配 ngrok 讓 chatbot wehook 能夠打過來做測試。\n\n<div class=\"tenor-gif-embed\" data-postid=\"14472399\" data-share-method=\"host\" data-width=\"100%\" data-aspect-ratio=\"2.2232142857142856\"><a href=\"https://tenor.com/view/minions-amazing-cheer-yes-excited-gif-14472399\">Minions Amazing GIF</a> from <a href=\"https://tenor.com/search/minions-gifs\">Minions GIFs</a></div><script type=\"text/javascript\" async src=\"https://tenor.com/embed.js\"></script>\n\n> 順便慶祝一下 python 以及 ruby 的兩個範例都過 Serverless 的 PR 了 ✌️\n\n![](https://i.imgur.com/PVcuACel.png)\n![](https://i.imgur.com/RmqPM0bl.png)\n\n# 實作\n\n這次的主題是延續上次的文章，過程中若有像是 AWS key 之類的問題可以回顧一下～\n\n- [使用 Serverless & LINE Message API 在 AWS 上打造一個 Echo bot](https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/)\n- [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot?source=post_page-----f11de7dee7aa----------------------)\n\n首先先透過 sls 至 Github 將 Python 範例抓下來並建專案。\n\n```bash\n$ serverless install --url https://github.com/louis70109/aws-line-echo-bot -n <YOUR_FILE_NAME>\n$ cd <YOUR_FILE_NAME>\n```\n\n接著參考 [官方文件](https://serverless.com/plugins/serverless-wsgi/) 上的實例，引入 WSGI & requirements Plugin。\n\n```bash\n$ sls plugin install -n serverless-wsgi\n$ sls plugin install -n serverless-python-requirements\n```\n\n接著加入 Flask 以及 line-bot-sdk 的相依套件版本(寫這篇時是使用 Flask 1.0.2 以及 line-bot-sdk 1.12.1)\n\n```bash\n$ echo “Flask==1.0.2\\nline-bot-sdk==1.12.1” > requirements.txt\n$ pip install -r requirements.txt -—user\n```\n\n置換以下內容至 serverless.yml，讓 WSGI 去處理路由。\n\n```yaml\nservice: <YOUR_FILE_NAME>\nprovider:\n  name: aws\n  runtime: python3.7\nfunctions:\n  api:\n    handler: wsgi_handler.handler\n    events:\n      - http: ANY /\n      - http: ANY {proxy+}\ncustom:\n  wsgi:\n    app: api.app\nplugins:\n  - serverless-python-requirements\n  - serverless-wsgi\n```\n\n新增 api.py 並加入以下內容 (記得要換 chatbot token 哦！)\n\n```python\nfrom flask import Flask, request, abort\nimport json\nfrom linebot import (\n    LineBotApi, WebhookHandler\n)\nfrom linebot.exceptions import (\n    InvalidSignatureError\n)\nfrom linebot.models import (\n    MessageEvent, TextMessage, TextSendMessage,\n)\n\napp = Flask(__name__)\n\n@app.route(\"/webhook\", methods=['POST'])\ndef webhook():\n    line_bot_api = LineBotApi('YOUR_CHANNEL_TOKEN')\n    handler = WebhookHandler('YOUR_CNANNEL_SECRET_KEY')\n\n    # get X-Line-Signature header value\n    signature = request.headers['X-Line-Signature']\n\n    body = request.get_data(as_text=True)\n    event = json.loads(body)\n    print(event)\n    try:\n        handler.handle(body, signature)\n    except InvalidSignatureError:\n        print(\n            \"Invalid signature. Please check your channel access token/channel secret.\")\n        abort(400)\n\n    token = event['events'][0]['replyToken']\n    if token == \"00000000000000000000000000000000\":\n        pass\n    else:\n        line_bot_api.reply_message(token, TextSendMessage(\n            text=event['events'][0]['message']['text']))\n    return 'OK'\n\nif __name__ == '__main__':\n    app.run(debug=True)\n```\n\n接著就透過 WSGI 起一個 local server(預設 port 為 5000)\n\n```bash\n$ sls wsgi serve\n```\n\n![](https://i.imgur.com/zVY6YYB.png)\n\n並加上 ngrok 並指定用 5000 port\n\n```bash\n$ ./ngrok http 5000\n```\n\n![](https://i.imgur.com/K40h9e8.png)\n\n將 ngrok 產生的網址貼進 webhook 欄位並加上 /wehbook 。\n(註: 透過 sls 起的 local server 並不會有 /dev 或是 /prod 開頭的網址哦！)\n![](https://i.imgur.com/0BzEsP1.png)\n\n若測試流程都順利的話，最後就是 Deploy 上 AWS 囉！\n\n```\nsls deploy\n```\n\n佈署完應該會看到類似以下內容：\n![](https://i.imgur.com/vAiRaZS.png)\n\n這裡大家可能會有個疑慮，為什麼上篇文章的 endpoints 會幫忙顯示路由，但這邊沒有呢？因為上篇文章的佈屬方法是屬於一個 function 對應一個 API，所以若寫了很多路由的話，在 AWS Dashboard 裡就會看到一大堆的 function，雖然佈署時都幫你顯示他的路由，但在後續管理上就會很麻煩。\n而這次的實作只建立出一個 Lambda，透過 WSGI 幫忙轉發到裡面的路由，使用時只要更改 {proxy} 改自己寫的路由，這邊就是改成 /webhook 就可以測試囉！\n\n> 若是玩完不想留著的話可以下以下指令來刪除這個專案有用到的 AWS 資源。\n\n```\nsls remove\n```\n\n# 後記\n\n這次只是將上次的寫的 [aws-line-echo-bot](https://github.com/louis70109/aws-line-echo-bot) 更新並加入 WSGI 以及 flask，在寫上篇文章當時在測試程式都要部署上去，或是用 serverless 的 invoke 來做本地端的模擬測試，但是要是接了像是 Line Message API 這類的第三方服務的話，根本沒辦法自己去模擬 replyToken 之類的參數，因此這次套用了 WSGI 以及 Flask 讓我可以在本地端搭配 ngrok 先測試完之後再將程式佈署上 AWS，如此以來既讓我的程式達到 Serverless，又不會為測試而影響到太多開發時間。\n不過都只有 API 相關的路由好像有點難應用，接下來要研究一下怎麼讓前端框架可以一起上 AWS 並擁有 SSL (上次玩只到 http 沒有 SSL)，並加上 RDS 讓整體服務可以串起來，雖然這樣不像 Heroku 這麼人性化一鍵通包，不過至少也是讓服務可以個別管理擴充呢！\n有興趣的朋友們可以參考我的 Github，若覺得不錯給個星星 ⭐️ 或是掌聲 👏 鼓勵我繼續研究下一個主題 😃！\n\n# 其他\n\n> 免費方案，AWS [常見問與答集](https://aws.amazon.com/tw/free/faqs/)\n\n![](https://i.imgur.com/OTxONmI.png)\n![](https://i.imgur.com/ymZyKyN.png)\n\n如果在做機器人時有用到類似 numpy, psycopg2 … 的套件的話，請參考 這篇文章，簡單來說因為 AWS 不會幫你編譯套件，所以需要透過 docker 來幫忙打包編譯並上傳。\n","slug":"續篇-—-serverless-WSGI-flask-chatbot-的開發指南","published":1,"updated":"2020-06-19T14:21:53.213Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31lx00637crilt1tj34o","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>如果還不知道 Serverless (以下簡稱 sls )的朋友可以先看我<a href=\"https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/\">上篇文章</a>，裡頭有介紹 <a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">Python</a> 以及 <a href=\"https://github.com/louis70109/aws-ruby-line-echo-bot\" target=\"_blank\" rel=\"noopener\">Ruby</a> 的範例。<br>還沒接觸 Serverless 之前，當開發完一包程式時就將它部署至 Heroku，實在是有夠方便又快速(還是免費的)。不過有個問題是當程式沒在運行時他會睡覺，身為一個免費仔做的小專案這樣是夠的，做為一個貪心的免費仔怎能容許睡覺睡這麼久 🤤！但若是照著我上篇分享的文章做，佈署程式沒問題，但就開發機器人我都要佈署才能測試，這未免也太不人性了 😒。<a id=\"more\"></a><br>既然上次都用 Python 來寫了，為了解決這個問題，本篇會介紹如何在 Serverless 上導入 WSGI &amp; Flask，讓我們再開發時不僅可以在本地端 auto-reload，也可以搭配 ngrok 讓 chatbot wehook 能夠打過來做測試。</p>\n<div class=\"tenor-gif-embed\" data-postid=\"14472399\" data-share-method=\"host\" data-width=\"100%\" data-aspect-ratio=\"2.2232142857142856\"><a href=\"https://tenor.com/view/minions-amazing-cheer-yes-excited-gif-14472399\" target=\"_blank\" rel=\"noopener\">Minions Amazing GIF</a> from <a href=\"https://tenor.com/search/minions-gifs\" target=\"_blank\" rel=\"noopener\">Minions GIFs</a></div><script type=\"text/javascript\" async src=\"https://tenor.com/embed.js\"></script>\n\n<blockquote>\n<p>順便慶祝一下 python 以及 ruby 的兩個範例都過 Serverless 的 PR 了 ✌️</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/PVcuACel.png\" alt><br><img src=\"https://i.imgur.com/RmqPM0bl.png\" alt></p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>這次的主題是延續上次的文章，過程中若有像是 AWS key 之類的問題可以回顧一下～</p>\n<ul>\n<li><a href=\"https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/\">使用 Serverless &amp; LINE Message API 在 AWS 上打造一個 Echo bot</a></li>\n<li><a href=\"https://github.com/louis70109/aws-line-echo-bot?source=post_page-----f11de7dee7aa----------------------\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a></li>\n</ul>\n<p>首先先透過 sls 至 Github 將 Python 範例抓下來並建專案。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ serverless install --url https://github.com/louis70109/aws-line-echo-bot -n &lt;YOUR_FILE_NAME&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;YOUR_FILE_NAME&gt;</span><br></pre></td></tr></table></figure>\n\n<p>接著參考 <a href=\"https://serverless.com/plugins/serverless-wsgi/\" target=\"_blank\" rel=\"noopener\">官方文件</a> 上的實例，引入 WSGI &amp; requirements Plugin。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sls plugin install -n serverless-wsgi</span><br><span class=\"line\">$ sls plugin install -n serverless-python-requirements</span><br></pre></td></tr></table></figure>\n\n<p>接著加入 Flask 以及 line-bot-sdk 的相依套件版本(寫這篇時是使用 Flask 1.0.2 以及 line-bot-sdk 1.12.1)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> “Flask==1.0.2\\nline-bot-sdk==1.12.1” &gt; requirements.txt</span><br><span class=\"line\">$ pip install -r requirements.txt -—user</span><br></pre></td></tr></table></figure>\n\n<p>置換以下內容至 serverless.yml，讓 WSGI 去處理路由。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">service:</span> <span class=\"string\">&lt;YOUR_FILE_NAME&gt;</span></span><br><span class=\"line\"><span class=\"attr\">provider:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">aws</span></span><br><span class=\"line\"><span class=\"attr\">  runtime:</span> <span class=\"string\">python3.7</span></span><br><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  wsgi:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">api.app</span></span><br><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<p>新增 api.py 並加入以下內容 (記得要換 chatbot token 哦！)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, request, abort</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    LineBotApi, WebhookHandler</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.exceptions <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    InvalidSignatureError</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    MessageEvent, TextMessage, TextSendMessage,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/webhook\", methods=['POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">webhook</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    line_bot_api = LineBotApi(<span class=\"string\">'YOUR_CHANNEL_TOKEN'</span>)</span><br><span class=\"line\">    handler = WebhookHandler(<span class=\"string\">'YOUR_CNANNEL_SECRET_KEY'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># get X-Line-Signature header value</span></span><br><span class=\"line\">    signature = request.headers[<span class=\"string\">'X-Line-Signature'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    body = request.get_data(as_text=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    event = json.loads(body)</span><br><span class=\"line\">    print(event)</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        handler.handle(body, signature)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> InvalidSignatureError:</span><br><span class=\"line\">        print(</span><br><span class=\"line\">            <span class=\"string\">\"Invalid signature. Please check your channel access token/channel secret.\"</span>)</span><br><span class=\"line\">        abort(<span class=\"number\">400</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    token = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'replyToken'</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> token == <span class=\"string\">\"00000000000000000000000000000000\"</span>:</span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        line_bot_api.reply_message(token, TextSendMessage(</span><br><span class=\"line\">            text=event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'OK'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>接著就透過 WSGI 起一個 local server(預設 port 為 5000)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/zVY6YYB.png\" alt></p>\n<p>並加上 ngrok 並指定用 5000 port</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ./ngrok http 5000</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/K40h9e8.png\" alt></p>\n<p>將 ngrok 產生的網址貼進 webhook 欄位並加上 /wehbook 。<br>(註: 透過 sls 起的 local server 並不會有 /dev 或是 /prod 開頭的網址哦！)<br><img src=\"https://i.imgur.com/0BzEsP1.png\" alt></p>\n<p>若測試流程都順利的話，最後就是 Deploy 上 AWS 囉！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<p>佈署完應該會看到類似以下內容：<br><img src=\"https://i.imgur.com/vAiRaZS.png\" alt></p>\n<p>這裡大家可能會有個疑慮，為什麼上篇文章的 endpoints 會幫忙顯示路由，但這邊沒有呢？因為上篇文章的佈屬方法是屬於一個 function 對應一個 API，所以若寫了很多路由的話，在 AWS Dashboard 裡就會看到一大堆的 function，雖然佈署時都幫你顯示他的路由，但在後續管理上就會很麻煩。<br>而這次的實作只建立出一個 Lambda，透過 WSGI 幫忙轉發到裡面的路由，使用時只要更改 {proxy} 改自己寫的路由，這邊就是改成 /webhook 就可以測試囉！</p>\n<blockquote>\n<p>若是玩完不想留著的話可以下以下指令來刪除這個專案有用到的 AWS 資源。</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls remove</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"後記\"><a href=\"#後記\" class=\"headerlink\" title=\"後記\"></a>後記</h1><p>這次只是將上次的寫的 <a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a> 更新並加入 WSGI 以及 flask，在寫上篇文章當時在測試程式都要部署上去，或是用 serverless 的 invoke 來做本地端的模擬測試，但是要是接了像是 Line Message API 這類的第三方服務的話，根本沒辦法自己去模擬 replyToken 之類的參數，因此這次套用了 WSGI 以及 Flask 讓我可以在本地端搭配 ngrok 先測試完之後再將程式佈署上 AWS，如此以來既讓我的程式達到 Serverless，又不會為測試而影響到太多開發時間。<br>不過都只有 API 相關的路由好像有點難應用，接下來要研究一下怎麼讓前端框架可以一起上 AWS 並擁有 SSL (上次玩只到 http 沒有 SSL)，並加上 RDS 讓整體服務可以串起來，雖然這樣不像 Heroku 這麼人性化一鍵通包，不過至少也是讓服務可以個別管理擴充呢！<br>有興趣的朋友們可以參考我的 Github，若覺得不錯給個星星 ⭐️ 或是掌聲 👏 鼓勵我繼續研究下一個主題 😃！</p>\n<h1 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h1><blockquote>\n<p>免費方案，AWS <a href=\"https://aws.amazon.com/tw/free/faqs/\" target=\"_blank\" rel=\"noopener\">常見問與答集</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/OTxONmI.png\" alt><br><img src=\"https://i.imgur.com/ymZyKyN.png\" alt></p>\n<p>如果在做機器人時有用到類似 numpy, psycopg2 … 的套件的話，請參考 這篇文章，簡單來說因為 AWS 不會幫你編譯套件，所以需要透過 docker 來幫忙打包編譯並上傳。</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>如果還不知道 Serverless (以下簡稱 sls )的朋友可以先看我<a href=\"https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/\">上篇文章</a>，裡頭有介紹 <a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">Python</a> 以及 <a href=\"https://github.com/louis70109/aws-ruby-line-echo-bot\" target=\"_blank\" rel=\"noopener\">Ruby</a> 的範例。<br>還沒接觸 Serverless 之前，當開發完一包程式時就將它部署至 Heroku，實在是有夠方便又快速(還是免費的)。不過有個問題是當程式沒在運行時他會睡覺，身為一個免費仔做的小專案這樣是夠的，做為一個貪心的免費仔怎能容許睡覺睡這麼久 🤤！但若是照著我上篇分享的文章做，佈署程式沒問題，但就開發機器人我都要佈署才能測試，這未免也太不人性了 😒。","more":"<br>既然上次都用 Python 來寫了，為了解決這個問題，本篇會介紹如何在 Serverless 上導入 WSGI &amp; Flask，讓我們再開發時不僅可以在本地端 auto-reload，也可以搭配 ngrok 讓 chatbot wehook 能夠打過來做測試。</p>\n<div class=\"tenor-gif-embed\" data-postid=\"14472399\" data-share-method=\"host\" data-width=\"100%\" data-aspect-ratio=\"2.2232142857142856\"><a href=\"https://tenor.com/view/minions-amazing-cheer-yes-excited-gif-14472399\" target=\"_blank\" rel=\"noopener\">Minions Amazing GIF</a> from <a href=\"https://tenor.com/search/minions-gifs\" target=\"_blank\" rel=\"noopener\">Minions GIFs</a></div><script type=\"text/javascript\" async src=\"https://tenor.com/embed.js\"></script>\n\n<blockquote>\n<p>順便慶祝一下 python 以及 ruby 的兩個範例都過 Serverless 的 PR 了 ✌️</p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/PVcuACel.png\" alt><br><img src=\"https://i.imgur.com/RmqPM0bl.png\" alt></p>\n<h1 id=\"實作\"><a href=\"#實作\" class=\"headerlink\" title=\"實作\"></a>實作</h1><p>這次的主題是延續上次的文章，過程中若有像是 AWS key 之類的問題可以回顧一下～</p>\n<ul>\n<li><a href=\"https://nijialin.com/2019/10/31/%E4%BD%BF%E7%94%A8-Serverless-Line-Message-API-%E5%9C%A8-AWS-%E4%B8%8A%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B-Echo-bot/\">使用 Serverless &amp; LINE Message API 在 AWS 上打造一個 Echo bot</a></li>\n<li><a href=\"https://github.com/louis70109/aws-line-echo-bot?source=post_page-----f11de7dee7aa----------------------\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a></li>\n</ul>\n<p>首先先透過 sls 至 Github 將 Python 範例抓下來並建專案。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ serverless install --url https://github.com/louis70109/aws-line-echo-bot -n &lt;YOUR_FILE_NAME&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;YOUR_FILE_NAME&gt;</span><br></pre></td></tr></table></figure>\n\n<p>接著參考 <a href=\"https://serverless.com/plugins/serverless-wsgi/\" target=\"_blank\" rel=\"noopener\">官方文件</a> 上的實例，引入 WSGI &amp; requirements Plugin。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sls plugin install -n serverless-wsgi</span><br><span class=\"line\">$ sls plugin install -n serverless-python-requirements</span><br></pre></td></tr></table></figure>\n\n<p>接著加入 Flask 以及 line-bot-sdk 的相依套件版本(寫這篇時是使用 Flask 1.0.2 以及 line-bot-sdk 1.12.1)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> “Flask==1.0.2\\nline-bot-sdk==1.12.1” &gt; requirements.txt</span><br><span class=\"line\">$ pip install -r requirements.txt -—user</span><br></pre></td></tr></table></figure>\n\n<p>置換以下內容至 serverless.yml，讓 WSGI 去處理路由。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">service:</span> <span class=\"string\">&lt;YOUR_FILE_NAME&gt;</span></span><br><span class=\"line\"><span class=\"attr\">provider:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">aws</span></span><br><span class=\"line\"><span class=\"attr\">  runtime:</span> <span class=\"string\">python3.7</span></span><br><span class=\"line\"><span class=\"attr\">functions:</span></span><br><span class=\"line\"><span class=\"attr\">  api:</span></span><br><span class=\"line\"><span class=\"attr\">    handler:</span> <span class=\"string\">wsgi_handler.handler</span></span><br><span class=\"line\"><span class=\"attr\">    events:</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"attr\">      - http:</span> <span class=\"string\">ANY</span> <span class=\"string\">&#123;proxy+&#125;</span></span><br><span class=\"line\"><span class=\"attr\">custom:</span></span><br><span class=\"line\"><span class=\"attr\">  wsgi:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">api.app</span></span><br><span class=\"line\"><span class=\"attr\">plugins:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-python-requirements</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">serverless-wsgi</span></span><br></pre></td></tr></table></figure>\n\n<p>新增 api.py 並加入以下內容 (記得要換 chatbot token 哦！)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, request, abort</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    LineBotApi, WebhookHandler</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.exceptions <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    InvalidSignatureError</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">from</span> linebot.models <span class=\"keyword\">import</span> (</span><br><span class=\"line\">    MessageEvent, TextMessage, TextSendMessage,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/webhook\", methods=['POST'])</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">webhook</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    line_bot_api = LineBotApi(<span class=\"string\">'YOUR_CHANNEL_TOKEN'</span>)</span><br><span class=\"line\">    handler = WebhookHandler(<span class=\"string\">'YOUR_CNANNEL_SECRET_KEY'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># get X-Line-Signature header value</span></span><br><span class=\"line\">    signature = request.headers[<span class=\"string\">'X-Line-Signature'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    body = request.get_data(as_text=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    event = json.loads(body)</span><br><span class=\"line\">    print(event)</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        handler.handle(body, signature)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> InvalidSignatureError:</span><br><span class=\"line\">        print(</span><br><span class=\"line\">            <span class=\"string\">\"Invalid signature. Please check your channel access token/channel secret.\"</span>)</span><br><span class=\"line\">        abort(<span class=\"number\">400</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    token = event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'replyToken'</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> token == <span class=\"string\">\"00000000000000000000000000000000\"</span>:</span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        line_bot_api.reply_message(token, TextSendMessage(</span><br><span class=\"line\">            text=event[<span class=\"string\">'events'</span>][<span class=\"number\">0</span>][<span class=\"string\">'message'</span>][<span class=\"string\">'text'</span>]))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'OK'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n<p>接著就透過 WSGI 起一個 local server(預設 port 為 5000)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sls wsgi serve</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/zVY6YYB.png\" alt></p>\n<p>並加上 ngrok 並指定用 5000 port</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ./ngrok http 5000</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://i.imgur.com/K40h9e8.png\" alt></p>\n<p>將 ngrok 產生的網址貼進 webhook 欄位並加上 /wehbook 。<br>(註: 透過 sls 起的 local server 並不會有 /dev 或是 /prod 開頭的網址哦！)<br><img src=\"https://i.imgur.com/0BzEsP1.png\" alt></p>\n<p>若測試流程都順利的話，最後就是 Deploy 上 AWS 囉！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls deploy</span><br></pre></td></tr></table></figure>\n\n<p>佈署完應該會看到類似以下內容：<br><img src=\"https://i.imgur.com/vAiRaZS.png\" alt></p>\n<p>這裡大家可能會有個疑慮，為什麼上篇文章的 endpoints 會幫忙顯示路由，但這邊沒有呢？因為上篇文章的佈屬方法是屬於一個 function 對應一個 API，所以若寫了很多路由的話，在 AWS Dashboard 裡就會看到一大堆的 function，雖然佈署時都幫你顯示他的路由，但在後續管理上就會很麻煩。<br>而這次的實作只建立出一個 Lambda，透過 WSGI 幫忙轉發到裡面的路由，使用時只要更改 {proxy} 改自己寫的路由，這邊就是改成 /webhook 就可以測試囉！</p>\n<blockquote>\n<p>若是玩完不想留著的話可以下以下指令來刪除這個專案有用到的 AWS 資源。</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sls remove</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"後記\"><a href=\"#後記\" class=\"headerlink\" title=\"後記\"></a>後記</h1><p>這次只是將上次的寫的 <a href=\"https://github.com/louis70109/aws-line-echo-bot\" target=\"_blank\" rel=\"noopener\">aws-line-echo-bot</a> 更新並加入 WSGI 以及 flask，在寫上篇文章當時在測試程式都要部署上去，或是用 serverless 的 invoke 來做本地端的模擬測試，但是要是接了像是 Line Message API 這類的第三方服務的話，根本沒辦法自己去模擬 replyToken 之類的參數，因此這次套用了 WSGI 以及 Flask 讓我可以在本地端搭配 ngrok 先測試完之後再將程式佈署上 AWS，如此以來既讓我的程式達到 Serverless，又不會為測試而影響到太多開發時間。<br>不過都只有 API 相關的路由好像有點難應用，接下來要研究一下怎麼讓前端框架可以一起上 AWS 並擁有 SSL (上次玩只到 http 沒有 SSL)，並加上 RDS 讓整體服務可以串起來，雖然這樣不像 Heroku 這麼人性化一鍵通包，不過至少也是讓服務可以個別管理擴充呢！<br>有興趣的朋友們可以參考我的 Github，若覺得不錯給個星星 ⭐️ 或是掌聲 👏 鼓勵我繼續研究下一個主題 😃！</p>\n<h1 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h1><blockquote>\n<p>免費方案，AWS <a href=\"https://aws.amazon.com/tw/free/faqs/\" target=\"_blank\" rel=\"noopener\">常見問與答集</a></p>\n</blockquote>\n<p><img src=\"https://i.imgur.com/OTxONmI.png\" alt><br><img src=\"https://i.imgur.com/ymZyKyN.png\" alt></p>\n<p>如果在做機器人時有用到類似 numpy, psycopg2 … 的套件的話，請參考 這篇文章，簡單來說因為 AWS 不會幫你編譯套件，所以需要透過 docker 來幫忙打包編譯並上傳。</p>"},{"title":"鐵人賽-文章列表","abbrlink":324739178,"date":"2019-10-20T14:09:44.000Z","_content":"\n![](https://i.imgur.com/abW5lFB.jpg)\n\n大家好，我是 NiJia\n\n以下是我最近參加 IT 邦幫忙 30 天鐵人賽的[文章列表](https://ithelp.ithome.com.tw/users/20111481/ironman/2475)，主要是紀錄從我進入新公司後學到的`Serverless`，並透過結合 `LINE API` 實現在 `AWS` 上，歡迎大家參考取用 😃\n\n---\n\n- [Day1 - serverless 介紹](https://nijialin.com/2019/09/16/Day1-serverless-%E4%BB%8B%E7%B4%B9/)\n- [Day2 - 安裝並使用 wsgi & flask 建立第一個 Serverless 的專案](https://nijialin.com/2019/09/17/Day2-%E5%AE%89%E8%A3%9D%E4%B8%A6%E4%BD%BF%E7%94%A8%20wsgi%20&%20flask%20%E5%BB%BA%E7%AB%8B%E7%AC%AC%E4%B8%80%E5%80%8B%20Serverless%20%E7%9A%84%E5%B0%88%E6%A1%88/)\n- [Day3 - LINE Notify 介紹](https://nijialin.com/2019/09/18/Day3-LINE-Notify-%E4%BB%8B%E7%B4%B9/)\n- [Day4 - 認識與使用 S3 容器](https://nijialin.com/2019/09/19/Day4-%E8%AA%8D%E8%AD%98%E8%88%87%E4%BD%BF%E7%94%A8-S3-%E5%AE%B9%E5%99%A8/)\n  <!-- more -->\n- [Day5 - 做一個與 LINE Notify 連動的服務](https://nijialin.com/2019/09/20/Day5-%E5%81%9A%E4%B8%80%E5%80%8B%E8%88%87-LINE-Notify-%E9%80%A3%E5%8B%95%E7%9A%84%E6%9C%8D%E5%8B%99/)\n- [Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify](https://nijialin.com/2019/09/21/Day6-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BD%BF%E7%94%A8-Query-string-%E4%BE%86%E5%B9%AB%E5%BF%99%E7%99%BC%E9%80%81%E7%9A%84-LINE-Notify/)\n- [Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理](https://nijialin.com/2019/09/21/Day7-%E5%9C%A8-serverless-%E8%A3%A1%E4%BD%BF%E7%94%A8%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%AE%93%E9%80%99%E4%BA%9B-key-%E5%A5%BD%E7%AE%A1%E7%90%86/)\n- [Day8 - SQS 簡單介紹 & 建立](https://nijialin.com/2019/09/22/Day8-SQS-%E7%B0%A1%E5%96%AE%E4%BB%8B%E7%B4%B9-%E5%BB%BA%E7%AB%8B/)\n- [Day9 - SQS 串接 Notify 實作！](https://nijialin.com/2019/09/23/Day9-SQS-%E4%B8%B2%E6%8E%A5-Notify-%E5%AF%A6%E4%BD%9C%EF%BC%81/)\n- [Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹](https://nijialin.com/2019/09/24/Day10-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-1-%E4%BB%8B%E7%B4%B9/)\n- [Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步](https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/)\n- [Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作](https://nijialin.com/2019/09/26/Day12-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-3-%E6%87%89%E8%81%B2%E8%9F%B2%E5%AF%A6%E4%BD%9C/)\n- [Day13 - 試玩 python SDK](https://nijialin.com/2019/09/27/Day13-%E8%A9%A6%E7%8E%A9-python-SDK/)\n- [Day14 - LINE Richmenu 介紹](https://nijialin.com/2019/09/28/Day14-LINE-Richmenu-%E4%BB%8B%E7%B4%B9/)\n- [Day15 - 串接 LINE Richmenu API](https://nijialin.com/2019/09/29/Day15-%E4%B8%B2%E6%8E%A5-LINE-Richmenu-API/)\n- [Day16 - 實作一個上下頁的 richmenu](https://nijialin.com/2019/09/30/Day16-%E5%AF%A6%E4%BD%9C%E4%B8%80%E5%80%8B%E4%B8%8A%E4%B8%8B%E9%A0%81%E7%9A%84-richmenu/)\n- [Day17 - 看一下自己寫的東西都去哪了](https://nijialin.com/2019/10/01/Day17-%E7%9C%8B%E4%B8%80%E4%B8%8B%E8%87%AA%E5%B7%B1%E5%AF%AB%E7%9A%84%E6%9D%B1%E8%A5%BF%E9%83%BD%E5%8E%BB%E5%93%AA%E4%BA%86/)\n- [Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧](https://nijialin.com/2019/10/02/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧/)\n- [Day19 - LINE LOGIN 介紹](https://nijialin.com/2019/10/03/Day19-LINE-LOGIN-%E4%BB%8B%E7%B4%B9/)\n- [Day20 - LINE Login 申請與基本頁面](https://nijialin.com/2019/10/04/Day20-LINE-Login-%E7%94%B3%E8%AB%8B%E8%88%87%E5%9F%BA%E6%9C%AC%E9%A0%81%E9%9D%A2/)\n- [Day21 - LINE Login 實作](https://nijialin.com/2019/10/05/Day21-LINE-Login-%E5%AF%A6%E4%BD%9C/)\n- [Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號](https://nijialin.com/2019/10/06/Day22-%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E6%90%AD%E9%85%8D-%E4%BD%BF%E7%94%A8-Login-Message-API-%E8%AE%93%E4%BD%BF%E7%94%A8%E8%80%85%E5%9C%A8%E6%8E%83%E6%8F%8F%E5%8A%A0%E5%85%A5%E5%A5%BD%E5%8F%8B%E6%99%82%E5%B0%B1%E7%B6%81%E5%AE%9A%E5%B8%B3%E8%99%9F/)\n- [Day23 - LIFF(LINE Front-end Framework) 簡介](https://nijialin.com/2019/10/07/Day23-LIFF-LINE-Front-end-Framework-%E7%B0%A1%E4%BB%8B/)\n- [Day24 - 簡單使用 LINE LIFF API](https://nijialin.com/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/)\n- [Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧](https://nijialin.com/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/)\n- [Day26 - Use CDN (1) - 建立 Certificate 與 Domain](https://nijialin.com/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/)\n- [Day27 - Use CDN (2) - CloudFront](https://nijialin.com/2019/10/11/Day27-Use-CDN-2-CloudFront/)\n- [Day28 - 用 S3 幫忙轉址到原有的服務上](https://nijialin.com/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/)\n- [Day29 - LINE API 的使用心得](https://nijialin.com/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/)\n- [Day30 - 老是在吹 Serverless，他真的有那麼好？](https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/)\n","source":"_posts/鐵人賽-文章列表.md","raw":"---\ntitle: 鐵人賽-文章列表\ntags:\n  - Serverless\n  - LINE\n  - AWS\ncategories: 2019鐵人賽\nabbrlink: 324739178\ndate: 2019-10-20 22:09:44\n---\n\n![](https://i.imgur.com/abW5lFB.jpg)\n\n大家好，我是 NiJia\n\n以下是我最近參加 IT 邦幫忙 30 天鐵人賽的[文章列表](https://ithelp.ithome.com.tw/users/20111481/ironman/2475)，主要是紀錄從我進入新公司後學到的`Serverless`，並透過結合 `LINE API` 實現在 `AWS` 上，歡迎大家參考取用 😃\n\n---\n\n- [Day1 - serverless 介紹](https://nijialin.com/2019/09/16/Day1-serverless-%E4%BB%8B%E7%B4%B9/)\n- [Day2 - 安裝並使用 wsgi & flask 建立第一個 Serverless 的專案](https://nijialin.com/2019/09/17/Day2-%E5%AE%89%E8%A3%9D%E4%B8%A6%E4%BD%BF%E7%94%A8%20wsgi%20&%20flask%20%E5%BB%BA%E7%AB%8B%E7%AC%AC%E4%B8%80%E5%80%8B%20Serverless%20%E7%9A%84%E5%B0%88%E6%A1%88/)\n- [Day3 - LINE Notify 介紹](https://nijialin.com/2019/09/18/Day3-LINE-Notify-%E4%BB%8B%E7%B4%B9/)\n- [Day4 - 認識與使用 S3 容器](https://nijialin.com/2019/09/19/Day4-%E8%AA%8D%E8%AD%98%E8%88%87%E4%BD%BF%E7%94%A8-S3-%E5%AE%B9%E5%99%A8/)\n  <!-- more -->\n- [Day5 - 做一個與 LINE Notify 連動的服務](https://nijialin.com/2019/09/20/Day5-%E5%81%9A%E4%B8%80%E5%80%8B%E8%88%87-LINE-Notify-%E9%80%A3%E5%8B%95%E7%9A%84%E6%9C%8D%E5%8B%99/)\n- [Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify](https://nijialin.com/2019/09/21/Day6-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BD%BF%E7%94%A8-Query-string-%E4%BE%86%E5%B9%AB%E5%BF%99%E7%99%BC%E9%80%81%E7%9A%84-LINE-Notify/)\n- [Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理](https://nijialin.com/2019/09/21/Day7-%E5%9C%A8-serverless-%E8%A3%A1%E4%BD%BF%E7%94%A8%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%AE%93%E9%80%99%E4%BA%9B-key-%E5%A5%BD%E7%AE%A1%E7%90%86/)\n- [Day8 - SQS 簡單介紹 & 建立](https://nijialin.com/2019/09/22/Day8-SQS-%E7%B0%A1%E5%96%AE%E4%BB%8B%E7%B4%B9-%E5%BB%BA%E7%AB%8B/)\n- [Day9 - SQS 串接 Notify 實作！](https://nijialin.com/2019/09/23/Day9-SQS-%E4%B8%B2%E6%8E%A5-Notify-%E5%AF%A6%E4%BD%9C%EF%BC%81/)\n- [Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹](https://nijialin.com/2019/09/24/Day10-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-1-%E4%BB%8B%E7%B4%B9/)\n- [Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步](https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/)\n- [Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作](https://nijialin.com/2019/09/26/Day12-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-3-%E6%87%89%E8%81%B2%E8%9F%B2%E5%AF%A6%E4%BD%9C/)\n- [Day13 - 試玩 python SDK](https://nijialin.com/2019/09/27/Day13-%E8%A9%A6%E7%8E%A9-python-SDK/)\n- [Day14 - LINE Richmenu 介紹](https://nijialin.com/2019/09/28/Day14-LINE-Richmenu-%E4%BB%8B%E7%B4%B9/)\n- [Day15 - 串接 LINE Richmenu API](https://nijialin.com/2019/09/29/Day15-%E4%B8%B2%E6%8E%A5-LINE-Richmenu-API/)\n- [Day16 - 實作一個上下頁的 richmenu](https://nijialin.com/2019/09/30/Day16-%E5%AF%A6%E4%BD%9C%E4%B8%80%E5%80%8B%E4%B8%8A%E4%B8%8B%E9%A0%81%E7%9A%84-richmenu/)\n- [Day17 - 看一下自己寫的東西都去哪了](https://nijialin.com/2019/10/01/Day17-%E7%9C%8B%E4%B8%80%E4%B8%8B%E8%87%AA%E5%B7%B1%E5%AF%AB%E7%9A%84%E6%9D%B1%E8%A5%BF%E9%83%BD%E5%8E%BB%E5%93%AA%E4%BA%86/)\n- [Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧](https://nijialin.com/2019/10/02/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧/)\n- [Day19 - LINE LOGIN 介紹](https://nijialin.com/2019/10/03/Day19-LINE-LOGIN-%E4%BB%8B%E7%B4%B9/)\n- [Day20 - LINE Login 申請與基本頁面](https://nijialin.com/2019/10/04/Day20-LINE-Login-%E7%94%B3%E8%AB%8B%E8%88%87%E5%9F%BA%E6%9C%AC%E9%A0%81%E9%9D%A2/)\n- [Day21 - LINE Login 實作](https://nijialin.com/2019/10/05/Day21-LINE-Login-%E5%AF%A6%E4%BD%9C/)\n- [Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號](https://nijialin.com/2019/10/06/Day22-%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E6%90%AD%E9%85%8D-%E4%BD%BF%E7%94%A8-Login-Message-API-%E8%AE%93%E4%BD%BF%E7%94%A8%E8%80%85%E5%9C%A8%E6%8E%83%E6%8F%8F%E5%8A%A0%E5%85%A5%E5%A5%BD%E5%8F%8B%E6%99%82%E5%B0%B1%E7%B6%81%E5%AE%9A%E5%B8%B3%E8%99%9F/)\n- [Day23 - LIFF(LINE Front-end Framework) 簡介](https://nijialin.com/2019/10/07/Day23-LIFF-LINE-Front-end-Framework-%E7%B0%A1%E4%BB%8B/)\n- [Day24 - 簡單使用 LINE LIFF API](https://nijialin.com/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/)\n- [Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧](https://nijialin.com/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/)\n- [Day26 - Use CDN (1) - 建立 Certificate 與 Domain](https://nijialin.com/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/)\n- [Day27 - Use CDN (2) - CloudFront](https://nijialin.com/2019/10/11/Day27-Use-CDN-2-CloudFront/)\n- [Day28 - 用 S3 幫忙轉址到原有的服務上](https://nijialin.com/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/)\n- [Day29 - LINE API 的使用心得](https://nijialin.com/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/)\n- [Day30 - 老是在吹 Serverless，他真的有那麼好？](https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/)\n","slug":"鐵人賽-文章列表","published":1,"updated":"2020-06-19T14:03:58.879Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckbuc31m100687cri1r0g4vqc","content":"<p><img src=\"https://i.imgur.com/abW5lFB.jpg\" alt></p>\n<p>大家好，我是 NiJia</p>\n<p>以下是我最近參加 IT 邦幫忙 30 天鐵人賽的<a href=\"https://ithelp.ithome.com.tw/users/20111481/ironman/2475\" target=\"_blank\" rel=\"noopener\">文章列表</a>，主要是紀錄從我進入新公司後學到的<code>Serverless</code>，並透過結合 <code>LINE API</code> 實現在 <code>AWS</code> 上，歡迎大家參考取用 😃</p>\n<hr>\n<ul>\n<li><a href=\"https://nijialin.com/2019/09/16/Day1-serverless-%E4%BB%8B%E7%B4%B9/\">Day1 - serverless 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/17/Day2-%E5%AE%89%E8%A3%9D%E4%B8%A6%E4%BD%BF%E7%94%A8%20wsgi%20&%20flask%20%E5%BB%BA%E7%AB%8B%E7%AC%AC%E4%B8%80%E5%80%8B%20Serverless%20%E7%9A%84%E5%B0%88%E6%A1%88/\">Day2 - 安裝並使用 wsgi &amp; flask 建立第一個 Serverless 的專案</a></li>\n<li><a href=\"https://nijialin.com/2019/09/18/Day3-LINE-Notify-%E4%BB%8B%E7%B4%B9/\">Day3 - LINE Notify 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/19/Day4-%E8%AA%8D%E8%AD%98%E8%88%87%E4%BD%BF%E7%94%A8-S3-%E5%AE%B9%E5%99%A8/\">Day4 - 認識與使用 S3 容器</a><a id=\"more\"></a></li>\n<li><a href=\"https://nijialin.com/2019/09/20/Day5-%E5%81%9A%E4%B8%80%E5%80%8B%E8%88%87-LINE-Notify-%E9%80%A3%E5%8B%95%E7%9A%84%E6%9C%8D%E5%8B%99/\">Day5 - 做一個與 LINE Notify 連動的服務</a></li>\n<li><a href=\"https://nijialin.com/2019/09/21/Day6-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BD%BF%E7%94%A8-Query-string-%E4%BE%86%E5%B9%AB%E5%BF%99%E7%99%BC%E9%80%81%E7%9A%84-LINE-Notify/\">Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify</a></li>\n<li><a href=\"https://nijialin.com/2019/09/21/Day7-%E5%9C%A8-serverless-%E8%A3%A1%E4%BD%BF%E7%94%A8%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%AE%93%E9%80%99%E4%BA%9B-key-%E5%A5%BD%E7%AE%A1%E7%90%86/\">Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理</a></li>\n<li><a href=\"https://nijialin.com/2019/09/22/Day8-SQS-%E7%B0%A1%E5%96%AE%E4%BB%8B%E7%B4%B9-%E5%BB%BA%E7%AB%8B/\">Day8 - SQS 簡單介紹 &amp; 建立</a></li>\n<li><a href=\"https://nijialin.com/2019/09/23/Day9-SQS-%E4%B8%B2%E6%8E%A5-Notify-%E5%AF%A6%E4%BD%9C%EF%BC%81/\">Day9 - SQS 串接 Notify 實作！</a></li>\n<li><a href=\"https://nijialin.com/2019/09/24/Day10-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-1-%E4%BB%8B%E7%B4%B9/\">Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/\">Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步</a></li>\n<li><a href=\"https://nijialin.com/2019/09/26/Day12-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-3-%E6%87%89%E8%81%B2%E8%9F%B2%E5%AF%A6%E4%BD%9C/\">Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作</a></li>\n<li><a href=\"https://nijialin.com/2019/09/27/Day13-%E8%A9%A6%E7%8E%A9-python-SDK/\">Day13 - 試玩 python SDK</a></li>\n<li><a href=\"https://nijialin.com/2019/09/28/Day14-LINE-Richmenu-%E4%BB%8B%E7%B4%B9/\">Day14 - LINE Richmenu 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/29/Day15-%E4%B8%B2%E6%8E%A5-LINE-Richmenu-API/\">Day15 - 串接 LINE Richmenu API</a></li>\n<li><a href=\"https://nijialin.com/2019/09/30/Day16-%E5%AF%A6%E4%BD%9C%E4%B8%80%E5%80%8B%E4%B8%8A%E4%B8%8B%E9%A0%81%E7%9A%84-richmenu/\">Day16 - 實作一個上下頁的 richmenu</a></li>\n<li><a href=\"https://nijialin.com/2019/10/01/Day17-%E7%9C%8B%E4%B8%80%E4%B8%8B%E8%87%AA%E5%B7%B1%E5%AF%AB%E7%9A%84%E6%9D%B1%E8%A5%BF%E9%83%BD%E5%8E%BB%E5%93%AA%E4%BA%86/\">Day17 - 看一下自己寫的東西都去哪了</a></li>\n<li><a href=\"https://nijialin.com/2019/10/02/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧/\">Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧</a></li>\n<li><a href=\"https://nijialin.com/2019/10/03/Day19-LINE-LOGIN-%E4%BB%8B%E7%B4%B9/\">Day19 - LINE LOGIN 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/10/04/Day20-LINE-Login-%E7%94%B3%E8%AB%8B%E8%88%87%E5%9F%BA%E6%9C%AC%E9%A0%81%E9%9D%A2/\">Day20 - LINE Login 申請與基本頁面</a></li>\n<li><a href=\"https://nijialin.com/2019/10/05/Day21-LINE-Login-%E5%AF%A6%E4%BD%9C/\">Day21 - LINE Login 實作</a></li>\n<li><a href=\"https://nijialin.com/2019/10/06/Day22-%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E6%90%AD%E9%85%8D-%E4%BD%BF%E7%94%A8-Login-Message-API-%E8%AE%93%E4%BD%BF%E7%94%A8%E8%80%85%E5%9C%A8%E6%8E%83%E6%8F%8F%E5%8A%A0%E5%85%A5%E5%A5%BD%E5%8F%8B%E6%99%82%E5%B0%B1%E7%B6%81%E5%AE%9A%E5%B8%B3%E8%99%9F/\">Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號</a></li>\n<li><a href=\"https://nijialin.com/2019/10/07/Day23-LIFF-LINE-Front-end-Framework-%E7%B0%A1%E4%BB%8B/\">Day23 - LIFF(LINE Front-end Framework) 簡介</a></li>\n<li><a href=\"https://nijialin.com/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/\">Day24 - 簡單使用 LINE LIFF API</a></li>\n<li><a href=\"https://nijialin.com/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/\">Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧</a></li>\n<li><a href=\"https://nijialin.com/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/\">Day26 - Use CDN (1) - 建立 Certificate 與 Domain</a></li>\n<li><a href=\"https://nijialin.com/2019/10/11/Day27-Use-CDN-2-CloudFront/\">Day27 - Use CDN (2) - CloudFront</a></li>\n<li><a href=\"https://nijialin.com/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/\">Day28 - 用 S3 幫忙轉址到原有的服務上</a></li>\n<li><a href=\"https://nijialin.com/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/\">Day29 - LINE API 的使用心得</a></li>\n<li><a href=\"https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/\">Day30 - 老是在吹 Serverless，他真的有那麼好？</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p><img src=\"https://i.imgur.com/abW5lFB.jpg\" alt></p>\n<p>大家好，我是 NiJia</p>\n<p>以下是我最近參加 IT 邦幫忙 30 天鐵人賽的<a href=\"https://ithelp.ithome.com.tw/users/20111481/ironman/2475\" target=\"_blank\" rel=\"noopener\">文章列表</a>，主要是紀錄從我進入新公司後學到的<code>Serverless</code>，並透過結合 <code>LINE API</code> 實現在 <code>AWS</code> 上，歡迎大家參考取用 😃</p>\n<hr>\n<ul>\n<li><a href=\"https://nijialin.com/2019/09/16/Day1-serverless-%E4%BB%8B%E7%B4%B9/\">Day1 - serverless 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/17/Day2-%E5%AE%89%E8%A3%9D%E4%B8%A6%E4%BD%BF%E7%94%A8%20wsgi%20&%20flask%20%E5%BB%BA%E7%AB%8B%E7%AC%AC%E4%B8%80%E5%80%8B%20Serverless%20%E7%9A%84%E5%B0%88%E6%A1%88/\">Day2 - 安裝並使用 wsgi &amp; flask 建立第一個 Serverless 的專案</a></li>\n<li><a href=\"https://nijialin.com/2019/09/18/Day3-LINE-Notify-%E4%BB%8B%E7%B4%B9/\">Day3 - LINE Notify 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/19/Day4-%E8%AA%8D%E8%AD%98%E8%88%87%E4%BD%BF%E7%94%A8-S3-%E5%AE%B9%E5%99%A8/\">Day4 - 認識與使用 S3 容器</a>","more":"</li>\n<li><a href=\"https://nijialin.com/2019/09/20/Day5-%E5%81%9A%E4%B8%80%E5%80%8B%E8%88%87-LINE-Notify-%E9%80%A3%E5%8B%95%E7%9A%84%E6%9C%8D%E5%8B%99/\">Day5 - 做一個與 LINE Notify 連動的服務</a></li>\n<li><a href=\"https://nijialin.com/2019/09/21/Day6-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BD%BF%E7%94%A8-Query-string-%E4%BE%86%E5%B9%AB%E5%BF%99%E7%99%BC%E9%80%81%E7%9A%84-LINE-Notify/\">Day6 - 建立一個使用 Query string 來幫忙發送的 LINE Notify</a></li>\n<li><a href=\"https://nijialin.com/2019/09/21/Day7-%E5%9C%A8-serverless-%E8%A3%A1%E4%BD%BF%E7%94%A8%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%AE%93%E9%80%99%E4%BA%9B-key-%E5%A5%BD%E7%AE%A1%E7%90%86/\">Day7 - 在 serverless 裡使用環境變數讓這些 key 好管理</a></li>\n<li><a href=\"https://nijialin.com/2019/09/22/Day8-SQS-%E7%B0%A1%E5%96%AE%E4%BB%8B%E7%B4%B9-%E5%BB%BA%E7%AB%8B/\">Day8 - SQS 簡單介紹 &amp; 建立</a></li>\n<li><a href=\"https://nijialin.com/2019/09/23/Day9-SQS-%E4%B8%B2%E6%8E%A5-Notify-%E5%AF%A6%E4%BD%9C%EF%BC%81/\">Day9 - SQS 串接 Notify 實作！</a></li>\n<li><a href=\"https://nijialin.com/2019/09/24/Day10-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-1-%E4%BB%8B%E7%B4%B9/\">Day10 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (1) - 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/25/Day11-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-2-%E7%94%B3%E8%AB%8B%E4%B8%80%E6%AD%A5%E6%AD%A5/\">Day11 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (2) - 申請一步步</a></li>\n<li><a href=\"https://nijialin.com/2019/09/26/Day12-LINE-%E7%9A%84%E6%9C%8D%E5%8B%99%E9%83%BD%E7%8E%A9%E4%BA%86%EF%BC%8C%E6%80%8E%E9%BA%BC%E8%83%BD%E5%BF%98%E4%BA%86-Message-api-Bot-%E5%91%A2%EF%BC%9F-3-%E6%87%89%E8%81%B2%E8%9F%B2%E5%AF%A6%E4%BD%9C/\">Day12 - LINE 的服務都玩了，怎麼能忘了 Message api (Bot) 呢？ (3) - 應聲蟲實作</a></li>\n<li><a href=\"https://nijialin.com/2019/09/27/Day13-%E8%A9%A6%E7%8E%A9-python-SDK/\">Day13 - 試玩 python SDK</a></li>\n<li><a href=\"https://nijialin.com/2019/09/28/Day14-LINE-Richmenu-%E4%BB%8B%E7%B4%B9/\">Day14 - LINE Richmenu 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/09/29/Day15-%E4%B8%B2%E6%8E%A5-LINE-Richmenu-API/\">Day15 - 串接 LINE Richmenu API</a></li>\n<li><a href=\"https://nijialin.com/2019/09/30/Day16-%E5%AF%A6%E4%BD%9C%E4%B8%80%E5%80%8B%E4%B8%8A%E4%B8%8B%E9%A0%81%E7%9A%84-richmenu/\">Day16 - 實作一個上下頁的 richmenu</a></li>\n<li><a href=\"https://nijialin.com/2019/10/01/Day17-%E7%9C%8B%E4%B8%80%E4%B8%8B%E8%87%AA%E5%B7%B1%E5%AF%AB%E7%9A%84%E6%9D%B1%E8%A5%BF%E9%83%BD%E5%8E%BB%E5%93%AA%E4%BA%86/\">Day17 - 看一下自己寫的東西都去哪了</a></li>\n<li><a href=\"https://nijialin.com/2019/10/02/Day18-在-Serverless-上設定個排程來發送空氣污染檢測吧/\">Day18 - 在 Serverless 上設定個排程來發送空氣污染檢測吧</a></li>\n<li><a href=\"https://nijialin.com/2019/10/03/Day19-LINE-LOGIN-%E4%BB%8B%E7%B4%B9/\">Day19 - LINE LOGIN 介紹</a></li>\n<li><a href=\"https://nijialin.com/2019/10/04/Day20-LINE-Login-%E7%94%B3%E8%AB%8B%E8%88%87%E5%9F%BA%E6%9C%AC%E9%A0%81%E9%9D%A2/\">Day20 - LINE Login 申請與基本頁面</a></li>\n<li><a href=\"https://nijialin.com/2019/10/05/Day21-LINE-Login-%E5%AF%A6%E4%BD%9C/\">Day21 - LINE Login 實作</a></li>\n<li><a href=\"https://nijialin.com/2019/10/06/Day22-%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E6%90%AD%E9%85%8D-%E4%BD%BF%E7%94%A8-Login-Message-API-%E8%AE%93%E4%BD%BF%E7%94%A8%E8%80%85%E5%9C%A8%E6%8E%83%E6%8F%8F%E5%8A%A0%E5%85%A5%E5%A5%BD%E5%8F%8B%E6%99%82%E5%B0%B1%E7%B6%81%E5%AE%9A%E5%B8%B3%E8%99%9F/\">Day22 - 最常用的搭配 - 使用 Login + Message API 讓使用者在掃描加入好友時就綁定帳號</a></li>\n<li><a href=\"https://nijialin.com/2019/10/07/Day23-LIFF-LINE-Front-end-Framework-%E7%B0%A1%E4%BB%8B/\">Day23 - LIFF(LINE Front-end Framework) 簡介</a></li>\n<li><a href=\"https://nijialin.com/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/\">Day24 - 簡單使用 LINE LIFF API</a></li>\n<li><a href=\"https://nijialin.com/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/\">Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧</a></li>\n<li><a href=\"https://nijialin.com/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/\">Day26 - Use CDN (1) - 建立 Certificate 與 Domain</a></li>\n<li><a href=\"https://nijialin.com/2019/10/11/Day27-Use-CDN-2-CloudFront/\">Day27 - Use CDN (2) - CloudFront</a></li>\n<li><a href=\"https://nijialin.com/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/\">Day28 - 用 S3 幫忙轉址到原有的服務上</a></li>\n<li><a href=\"https://nijialin.com/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/\">Day29 - LINE API 的使用心得</a></li>\n<li><a href=\"https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/\">Day30 - 老是在吹 Serverless，他真的有那麼好？</a></li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"ckbuc31ih00017cri3f50tvjp","category_id":"ckbuc31ip00047crigbmscdx5","_id":"ckbuc31j0000e7crioo3laeph"},{"post_id":"ckbuc31iv00097crihhkpq6xd","category_id":"ckbuc31ip00047crigbmscdx5","_id":"ckbuc31j3000h7cri6m84ro3s"},{"post_id":"ckbuc31ix000b7cricxcw4ump","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31j5000l7crismxl9mnj"},{"post_id":"ckbuc31ir00067cri3pszhxrz","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31j6000p7cridjib8qzj"},{"post_id":"ckbuc31it00087crisp928fe6","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31j8000t7cripv7kfako"},{"post_id":"ckbuc31iy000d7critlodkaaw","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31jf000z7cri38dqk5lk"},{"post_id":"ckbuc31j2000g7crijc1liwiu","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31jh00137crizq4gu3ce"},{"post_id":"ckbuc31j4000j7cri1qsn9w2z","category_id":"ckbuc31jf000y7criotuxmklj","_id":"ckbuc31jj00187cri0d24gmrd"},{"post_id":"ckbuc31ji00177cri4xz0anac","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jm001e7crirz4nas96"},{"post_id":"ckbuc31j6000n7critcvcddsy","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jo001h7cri5pcwzmug"},{"post_id":"ckbuc31jj00197crif5kavgbh","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jp001k7cripyc3cu9v"},{"post_id":"ckbuc31jk001b7cric1qhjuu1","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jq001n7cri19flr5j1"},{"post_id":"ckbuc31j7000r7criiy5p8vg9","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jr001q7critq1bezpb"},{"post_id":"ckbuc31jm001d7cria1ofi71c","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jt001u7criz9bwurz8"},{"post_id":"ckbuc31jn001g7criqqt8l11o","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jv001y7criet2vjkhq"},{"post_id":"ckbuc31j9000v7crivp63kehw","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jw00227crigzc22oo8"},{"post_id":"ckbuc31jo001j7crifcs6m9z2","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jx00257cri7bpk7goy"},{"post_id":"ckbuc31jp001m7cripcnrb7cl","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31jz002a7criwi71qv3z"},{"post_id":"ckbuc31ja000x7cri44yh3ot8","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k0002d7criia4t4lka"},{"post_id":"ckbuc31jr001p7criezmsb8xs","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k1002h7criqjzfynik"},{"post_id":"ckbuc31js001t7crio2prjrph","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k3002k7crii7efh5y4"},{"post_id":"ckbuc31jf00107cri9rrrth4i","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k5002o7crihship4ti"},{"post_id":"ckbuc31jv001x7crijeputllf","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k6002q7critmhqx3sd"},{"post_id":"ckbuc31jw00217criqksancbr","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k7002u7cridc7liuxv"},{"post_id":"ckbuc31jg00127cri463vtr6d","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31k9002w7crikfdz2my9"},{"post_id":"ckbuc31jx00247crioct74x8d","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31ka002z7criz2ndot8v"},{"post_id":"ckbuc31jy00297crifo9guy3a","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kc00327cribi0vmcpq"},{"post_id":"ckbuc31jh00157cri1favswta","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kd00367crigrlibssl"},{"post_id":"ckbuc31jz002c7crihseqb7x1","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31ke00397crigdjvjk85"},{"post_id":"ckbuc31k1002g7cric9porh1d","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kg003b7crij26jgs47"},{"post_id":"ckbuc31k2002j7crijk9vvb1x","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kh003g7cri823up8hs"},{"post_id":"ckbuc31k4002n7crisglty9dg","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31ki003j7crihrka672p"},{"post_id":"ckbuc31k5002p7cri7z307e4p","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kk003n7crioo36s2vs"},{"post_id":"ckbuc31k7002t7crikpge8j1h","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31km003q7crivsd4xwn1"},{"post_id":"ckbuc31k8002v7crikyplbu4r","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kn003u7critj3t8nux"},{"post_id":"ckbuc31k9002y7crid8hwi6cj","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kp003w7cri2cd8sgff"},{"post_id":"ckbuc31kb00317cri6t330c6n","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31kr003z7cri1aobfcsr"},{"post_id":"ckbuc31kc00357criyncvkhpp","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31ks00427crixu3daqem"},{"post_id":"ckbuc31kf003a7criu357fb1d","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31kt00467cripv61p3th"},{"post_id":"ckbuc31kh003f7cripdbu9fki","category_id":"ckbuc31jf000y7criotuxmklj","_id":"ckbuc31ku00497crikvn1jnlj"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","category_id":"ckbuc31jf000y7criotuxmklj","_id":"ckbuc31kw004d7criibbfahzy"},{"post_id":"ckbuc31kd00387crivmf3f2k3","category_id":"ckbuc31kg003d7crixediulks","_id":"ckbuc31kx004g7cric2mzreyi"},{"post_id":"ckbuc31kk003m7crioozovmlw","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31l0004j7crigd95d38g"},{"post_id":"ckbuc31kl003p7criaus9a59p","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31l1004m7crinnotki9r"},{"post_id":"ckbuc31ko003v7criifha3704","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31l3004q7cri7b3xmnyr"},{"post_id":"ckbuc31kq003y7cric6segskw","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31l5004u7crim1n28i1u"},{"post_id":"ckbuc31kr00417cripwyhmo3f","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31l7004x7cric5wx6w72"},{"post_id":"ckbuc31kt00457crip8otm7fy","category_id":"ckbuc31jf000y7criotuxmklj","_id":"ckbuc31l900507crimwt3s95o"},{"post_id":"ckbuc31ku00487crix4bmdywf","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31lb00537crif4xsvx76"},{"post_id":"ckbuc31kv004c7crigzldkogf","category_id":"ckbuc31j5000m7criucs5w3lx","_id":"ckbuc31ld00567crihzg8b1vp"},{"post_id":"ckbuc31kw004f7crih984hxmi","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31lf005b7cri03ov129p"},{"post_id":"ckbuc31ky004i7crid9fonrdp","category_id":"ckbuc31kg003d7crixediulks","_id":"ckbuc31lg005e7crio29qvnjm"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31lj005j7crilqtsk70g"},{"post_id":"ckbuc31l0004l7cri97356dzf","category_id":"ckbuc31l4004s7criky3d1ezy","_id":"ckbuc31ln005m7cri26jdkcq4"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31lo005q7crii4dnw2be"},{"post_id":"ckbuc31la00527cri7n0ox0c4","category_id":"ckbuc31ip00047crigbmscdx5","_id":"ckbuc31lr005t7criyvns9z2x"},{"post_id":"ckbuc31l4004t7cridjgyl6x1","category_id":"ckbuc31l9004z7cri7duzpurk","_id":"ckbuc31lu005w7crind9mxn6v"},{"post_id":"ckbuc31lc00557crio1lfno1c","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31lx00617cririsqsrcv"},{"post_id":"ckbuc31l6004w7crimwsffyta","category_id":"ckbuc31ld00577cri0tmrlbpu","_id":"ckbuc31lz00647criafso7qs8"},{"post_id":"ckbuc31le005a7crib7dco3av","category_id":"ckbuc31lh005g7cri7jzfo9u8","_id":"ckbuc31m200697crip9yubxer"},{"post_id":"ckbuc31ln005o7cri8uf9vr62","category_id":"ckbuc31lh005g7cri7jzfo9u8","_id":"ckbuc31m2006b7cri5k0yuz43"},{"post_id":"ckbuc31lq005s7critfsq9ygj","category_id":"ckbuc31jf000y7criotuxmklj","_id":"ckbuc31m3006e7cri3r4f8srw"},{"post_id":"ckbuc31lg005d7cripw8lc81s","category_id":"ckbuc31lo005p7crivtshzpd6","_id":"ckbuc31m4006g7cri2knm25ss"},{"post_id":"ckbuc31lt005v7cri78xsr5zh","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31m5006j7crijix2rnmx"},{"post_id":"ckbuc31lw00607criqbkd7vzs","category_id":"ckbuc31iw000a7criy3rzqckq","_id":"ckbuc31m5006l7cri0yi77hna"},{"post_id":"ckbuc31li005i7criqc75bneh","category_id":"ckbuc31lv005y7cri8x4becca","_id":"ckbuc31m6006o7criyfcevnqs"},{"post_id":"ckbuc31lx00637crilt1tj34o","category_id":"ckbuc31lh005g7cri7jzfo9u8","_id":"ckbuc31m6006q7cri121ywtxh"},{"post_id":"ckbuc31m100687cri1r0g4vqc","category_id":"ckbuc31jh00147cri7afsh43d","_id":"ckbuc31m7006t7crikbtm921l"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","category_id":"ckbuc31m100667criose0w2tl","_id":"ckbuc31m7006v7crieuifd3cz"}],"PostTag":[{"post_id":"ckbuc31im00037criqb0duigm","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31j5000k7cri14h7rp6f"},{"post_id":"ckbuc31im00037criqb0duigm","tag_id":"ckbuc31ix000c7criwkxp64we","_id":"ckbuc31j6000o7crifmaydmr0"},{"post_id":"ckbuc31iv00097crihhkpq6xd","tag_id":"ckbuc31j3000i7crid8a05o0g","_id":"ckbuc31j8000s7cri10o6rmfi"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31j3000i7crid8a05o0g","_id":"ckbuc31js001s7crimfaiimea"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31ix000c7criwkxp64we","_id":"ckbuc31ju001v7crik3t1lnla"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31jg00117crixdsjugu4","_id":"ckbuc31jv00207crii5wjyhg6"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31jx00237crit4zaw11k"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31jl001c7crik2wx3sj6","_id":"ckbuc31jy00287cri28muz31v"},{"post_id":"ckbuc31ix000b7cricxcw4ump","tag_id":"ckbuc31jo001i7cridsccyiqw","_id":"ckbuc31jz002b7crine7y8krh"},{"post_id":"ckbuc31iy000d7critlodkaaw","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31k0002f7criubys37ro"},{"post_id":"ckbuc31iy000d7critlodkaaw","tag_id":"ckbuc31ju001w7criutd7ue15","_id":"ckbuc31k1002i7crivm7gp9k6"},{"post_id":"ckbuc31j2000g7crijc1liwiu","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31k3002m7crii3n4nihy"},{"post_id":"ckbuc31k4002n7crisglty9dg","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31k7002s7crisk5v2490"},{"post_id":"ckbuc31j4000j7cri1qsn9w2z","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31kb00307cri9ob8qo4s"},{"post_id":"ckbuc31j4000j7cri1qsn9w2z","tag_id":"ckbuc31k3002l7cri982bj3vm","_id":"ckbuc31kc00337criz5pllwy7"},{"post_id":"ckbuc31j4000j7cri1qsn9w2z","tag_id":"ckbuc31k6002r7crit0upj3kv","_id":"ckbuc31kd00377cri5uq3kebt"},{"post_id":"ckbuc31j6000n7critcvcddsy","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31kh003e7crih8jil3bi"},{"post_id":"ckbuc31j6000n7critcvcddsy","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31ki003h7criajz57ho3"},{"post_id":"ckbuc31j6000n7critcvcddsy","tag_id":"ckbuc31kc00347crigruvnlpl","_id":"ckbuc31kj003l7crih9eyf5ta"},{"post_id":"ckbuc31kf003a7criu357fb1d","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31kl003o7cri4imddhwh"},{"post_id":"ckbuc31kf003a7criu357fb1d","tag_id":"ckbuc31ju001w7criutd7ue15","_id":"ckbuc31km003s7crimro9uqde"},{"post_id":"ckbuc31j7000r7criiy5p8vg9","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31kr00407cri61qhe77t"},{"post_id":"ckbuc31j7000r7criiy5p8vg9","tag_id":"ckbuc31kj003k7cri25jrlfos","_id":"ckbuc31ks00437criuk36kjp0"},{"post_id":"ckbuc31j7000r7criiy5p8vg9","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31kt00477criiqezp43v"},{"post_id":"ckbuc31ko003v7criifha3704","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31kv004a7cri29vee7f8"},{"post_id":"ckbuc31ko003v7criifha3704","tag_id":"ckbuc31ju001w7criutd7ue15","_id":"ckbuc31kw004e7crilpkmuc0h"},{"post_id":"ckbuc31j9000v7crivp63kehw","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31l0004k7crizzxudgku"},{"post_id":"ckbuc31j9000v7crivp63kehw","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31l1004n7crihhva2eah"},{"post_id":"ckbuc31j9000v7crivp63kehw","tag_id":"ckbuc31kv004b7cri32vxbme3","_id":"ckbuc31l3004r7crinwkox7l3"},{"post_id":"ckbuc31ja000x7cri44yh3ot8","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31lc00547criq12ytpvr"},{"post_id":"ckbuc31ja000x7cri44yh3ot8","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31ld00587criludlz8jm"},{"post_id":"ckbuc31ja000x7cri44yh3ot8","tag_id":"ckbuc31kv004b7cri32vxbme3","_id":"ckbuc31lf005c7criuwyouj4l"},{"post_id":"ckbuc31la00527cri7n0ox0c4","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31lh005f7crib0tktjms"},{"post_id":"ckbuc31jf00107cri9rrrth4i","tag_id":"ckbuc31la00517criyayltdxv","_id":"ckbuc31lk005k7cri6lukddej"},{"post_id":"ckbuc31jf00107cri9rrrth4i","tag_id":"ckbuc31jg00117crixdsjugu4","_id":"ckbuc31ln005n7crid3p06j2x"},{"post_id":"ckbuc31ln005o7cri8uf9vr62","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31lt005u7cri7qn9ohlx"},{"post_id":"ckbuc31ln005o7cri8uf9vr62","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31lv005z7crifctqst28"},{"post_id":"ckbuc31ln005o7cri8uf9vr62","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31lx00627criisz26w6a"},{"post_id":"ckbuc31jg00127cri463vtr6d","tag_id":"ckbuc31lh005h7criagn89cxk","_id":"ckbuc31m100677crircpaox0e"},{"post_id":"ckbuc31jg00127cri463vtr6d","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31m2006a7criton1f047"},{"post_id":"ckbuc31jg00127cri463vtr6d","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31m3006d7crisolea05c"},{"post_id":"ckbuc31lx00637crilt1tj34o","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31m4006f7crihe0lm183"},{"post_id":"ckbuc31lx00637crilt1tj34o","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31m5006i7crizr3ku06b"},{"post_id":"ckbuc31lx00637crilt1tj34o","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31m5006k7crivay3x42s"},{"post_id":"ckbuc31m100687cri1r0g4vqc","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31m6006n7cri0xmdj3xf"},{"post_id":"ckbuc31m100687cri1r0g4vqc","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31m6006p7cri2jc1xxb5"},{"post_id":"ckbuc31m100687cri1r0g4vqc","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31m7006s7cri62zn0odd"},{"post_id":"ckbuc31jh00157cri1favswta","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31m7006u7crina7hij7s"},{"post_id":"ckbuc31jh00157cri1favswta","tag_id":"ckbuc31jg00117crixdsjugu4","_id":"ckbuc31m8006x7cridcpju5zl"},{"post_id":"ckbuc31jh00157cri1favswta","tag_id":"ckbuc31lh005h7criagn89cxk","_id":"ckbuc31m8006y7criggpwqqg1"},{"post_id":"ckbuc31ji00177cri4xz0anac","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31m800707crivgzct5yv"},{"post_id":"ckbuc31ji00177cri4xz0anac","tag_id":"ckbuc31lh005h7criagn89cxk","_id":"ckbuc31m900717cri7qm8rvpb"},{"post_id":"ckbuc31ji00177cri4xz0anac","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31m900737criig6cbsyt"},{"post_id":"ckbuc31jj00197crif5kavgbh","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31ma00767criim7lgo8c"},{"post_id":"ckbuc31jj00197crif5kavgbh","tag_id":"ckbuc31m7006w7crifjwcvv5v","_id":"ckbuc31ma00777crihqxi2aon"},{"post_id":"ckbuc31jj00197crif5kavgbh","tag_id":"ckbuc31kc00347crigruvnlpl","_id":"ckbuc31ma00797criejjt1kyu"},{"post_id":"ckbuc31jj00197crif5kavgbh","tag_id":"ckbuc31m900727criqyzqg06v","_id":"ckbuc31mb007a7crij0y59skz"},{"post_id":"ckbuc31jj00197crif5kavgbh","tag_id":"ckbuc31m900747criei26noa9","_id":"ckbuc31mb007c7cribn4uey5g"},{"post_id":"ckbuc31jk001b7cric1qhjuu1","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31mb007e7crilcfd0ks5"},{"post_id":"ckbuc31jk001b7cric1qhjuu1","tag_id":"ckbuc31kc00347crigruvnlpl","_id":"ckbuc31mb007f7crimcvb4ktk"},{"post_id":"ckbuc31jk001b7cric1qhjuu1","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mc007h7criyfk36zfb"},{"post_id":"ckbuc31jk001b7cric1qhjuu1","tag_id":"ckbuc31mb007b7crixcoetl2l","_id":"ckbuc31mc007i7cri4xfapdhz"},{"post_id":"ckbuc31jm001d7cria1ofi71c","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mc007k7crix007srfo"},{"post_id":"ckbuc31jm001d7cria1ofi71c","tag_id":"ckbuc31mc007g7crin82i8cmv","_id":"ckbuc31md007l7criq9zh7hrv"},{"post_id":"ckbuc31jn001g7criqqt8l11o","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31md007n7crieink2cm5"},{"post_id":"ckbuc31jn001g7criqqt8l11o","tag_id":"ckbuc31la00517criyayltdxv","_id":"ckbuc31md007o7crivwe06xb5"},{"post_id":"ckbuc31jo001j7crifcs6m9z2","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31me007r7cri5h3offe6"},{"post_id":"ckbuc31jo001j7crifcs6m9z2","tag_id":"ckbuc31mc007g7crin82i8cmv","_id":"ckbuc31me007s7cri88wcobqn"},{"post_id":"ckbuc31jp001m7cripcnrb7cl","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mg007w7criznb036kv"},{"post_id":"ckbuc31jp001m7cripcnrb7cl","tag_id":"ckbuc31mc007g7crin82i8cmv","_id":"ckbuc31mg007x7cri1h33r73e"},{"post_id":"ckbuc31jp001m7cripcnrb7cl","tag_id":"ckbuc31m900727criqyzqg06v","_id":"ckbuc31mh007z7cri3j9y4uwm"},{"post_id":"ckbuc31jr001p7criezmsb8xs","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mi00827cri15qxxt4f"},{"post_id":"ckbuc31jr001p7criezmsb8xs","tag_id":"ckbuc31mc007g7crin82i8cmv","_id":"ckbuc31mi00837cribuo1hrso"},{"post_id":"ckbuc31jr001p7criezmsb8xs","tag_id":"ckbuc31kv004b7cri32vxbme3","_id":"ckbuc31mj00857criq6lxipzk"},{"post_id":"ckbuc31jr001p7criezmsb8xs","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31mj00867cribvd4sz6w"},{"post_id":"ckbuc31js001t7crio2prjrph","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mj00887cripc2l8f9x"},{"post_id":"ckbuc31js001t7crio2prjrph","tag_id":"ckbuc31mi00817criqq6y42sw","_id":"ckbuc31mj00897crihjt0ug1o"},{"post_id":"ckbuc31jv001x7crijeputllf","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mk008b7crivlox1yr5"},{"post_id":"ckbuc31jv001x7crijeputllf","tag_id":"ckbuc31mi00817criqq6y42sw","_id":"ckbuc31mk008c7criynol0obm"},{"post_id":"ckbuc31jv001x7crijeputllf","tag_id":"ckbuc31mj00877cri66gamfu8","_id":"ckbuc31mk008e7crimgo3rfhp"},{"post_id":"ckbuc31jw00217criqksancbr","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31ml008g7crihazjs7ik"},{"post_id":"ckbuc31jw00217criqksancbr","tag_id":"ckbuc31mj008a7crisoj2dvxp","_id":"ckbuc31ml008h7crinlw7g6wb"},{"post_id":"ckbuc31jw00217criqksancbr","tag_id":"ckbuc31kc00347crigruvnlpl","_id":"ckbuc31ml008j7cri9hpoy33q"},{"post_id":"ckbuc31jx00247crioct74x8d","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31mm008m7cri40kw6rhg"},{"post_id":"ckbuc31jx00247crioct74x8d","tag_id":"ckbuc31mk008f7crik2x65mss","_id":"ckbuc31mm008n7criwfisbbks"},{"post_id":"ckbuc31jx00247crioct74x8d","tag_id":"ckbuc31ml008i7criah2jnq7a","_id":"ckbuc31mn008p7criaooj0hdj"},{"post_id":"ckbuc31jx00247crioct74x8d","tag_id":"ckbuc31ml008k7criibus8xjk","_id":"ckbuc31mn008q7cri28trt0q8"},{"post_id":"ckbuc31jy00297crifo9guy3a","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31mn008s7criv3g38j6b"},{"post_id":"ckbuc31jy00297crifo9guy3a","tag_id":"ckbuc31mk008f7crik2x65mss","_id":"ckbuc31mo008t7crido0gl55q"},{"post_id":"ckbuc31jy00297crifo9guy3a","tag_id":"ckbuc31mm008o7cri8ej99a12","_id":"ckbuc31mo008v7cril8za7wix"},{"post_id":"ckbuc31jz002c7crihseqb7x1","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31mo008x7crie6ef1xn6"},{"post_id":"ckbuc31jz002c7crihseqb7x1","tag_id":"ckbuc31m900727criqyzqg06v","_id":"ckbuc31mo008y7critihplrqd"},{"post_id":"ckbuc31jz002c7crihseqb7x1","tag_id":"ckbuc31mo008u7cri6qbwhz5g","_id":"ckbuc31mp00907criqvkytpch"},{"post_id":"ckbuc31k1002g7cric9porh1d","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mp00917crilopiojsm"},{"post_id":"ckbuc31k1002g7cric9porh1d","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31mq00937critbvdlc71"},{"post_id":"ckbuc31k1002g7cric9porh1d","tag_id":"ckbuc31mo008w7cri3ucxux1p","_id":"ckbuc31mq00947crimy63zs62"},{"post_id":"ckbuc31k2002j7crijk9vvb1x","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mr00967crix2jejr9o"},{"post_id":"ckbuc31k2002j7crijk9vvb1x","tag_id":"ckbuc31mo008z7cris2fgug46","_id":"ckbuc31mr00977cri0gfn3yax"},{"post_id":"ckbuc31k5002p7cri7z307e4p","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31ms00997crirlp07kmv"},{"post_id":"ckbuc31k5002p7cri7z307e4p","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31ms009a7crivgvzfqku"},{"post_id":"ckbuc31k5002p7cri7z307e4p","tag_id":"ckbuc31m900727criqyzqg06v","_id":"ckbuc31mt009c7crin7mcdx3k"},{"post_id":"ckbuc31k7002t7crikpge8j1h","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31mt009d7cridumefwga"},{"post_id":"ckbuc31k7002t7crikpge8j1h","tag_id":"ckbuc31mo008z7cris2fgug46","_id":"ckbuc31mt009f7critbfauth1"},{"post_id":"ckbuc31k7002t7crikpge8j1h","tag_id":"ckbuc31la00517criyayltdxv","_id":"ckbuc31mt009g7crizm4mxx8a"},{"post_id":"ckbuc31k8002v7crikyplbu4r","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31mt009h7crikd8ig4jh"},{"post_id":"ckbuc31k8002v7crikyplbu4r","tag_id":"ckbuc31ms009b7cri36ommj76","_id":"ckbuc31mu009j7cri6natg4ge"},{"post_id":"ckbuc31k9002y7crid8hwi6cj","tag_id":"ckbuc31mt009e7crig39l3m9m","_id":"ckbuc31mu009l7crir3ic8oay"},{"post_id":"ckbuc31k9002y7crid8hwi6cj","tag_id":"ckbuc31la00517criyayltdxv","_id":"ckbuc31mu009m7crifx8v11f7"},{"post_id":"ckbuc31kb00317cri6t330c6n","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31mv009o7crih9why1zd"},{"post_id":"ckbuc31kb00317cri6t330c6n","tag_id":"ckbuc31mu009k7criyzd3rqtz","_id":"ckbuc31mw009p7cri533jnmmc"},{"post_id":"ckbuc31kc00357criyncvkhpp","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31my009t7cri1o0gwo93"},{"post_id":"ckbuc31kc00357criyncvkhpp","tag_id":"ckbuc31mu009k7criyzd3rqtz","_id":"ckbuc31my009u7cripyz37mi7"},{"post_id":"ckbuc31kc00357criyncvkhpp","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31my009w7cri5yiuvo7g"},{"post_id":"ckbuc31kc00357criyncvkhpp","tag_id":"ckbuc31mo008z7cris2fgug46","_id":"ckbuc31my009x7crim4qrmlcn"},{"post_id":"ckbuc31kc00357criyncvkhpp","tag_id":"ckbuc31mx009r7cria89m3il0","_id":"ckbuc31mz009z7cricb78qpud"},{"post_id":"ckbuc31kd00387crivmf3f2k3","tag_id":"ckbuc31my009s7crijf9k9rwg","_id":"ckbuc31mz00a07crifw3mu8zu"},{"post_id":"ckbuc31kd00387crivmf3f2k3","tag_id":"ckbuc31ix000c7criwkxp64we","_id":"ckbuc31n000a27crizrrvmpdl"},{"post_id":"ckbuc31kd00387crivmf3f2k3","tag_id":"ckbuc31my009v7cri1tz49hnc","_id":"ckbuc31n000a37cris9am3y4f"},{"post_id":"ckbuc31kh003f7cripdbu9fki","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31n100a77cript3h8icu"},{"post_id":"ckbuc31kh003f7cripdbu9fki","tag_id":"ckbuc31mi00817criqq6y42sw","_id":"ckbuc31n100a87crij9vlfu4u"},{"post_id":"ckbuc31kh003f7cripdbu9fki","tag_id":"ckbuc31mz00a17crifheigofl","_id":"ckbuc31n200aa7crixo13aegp"},{"post_id":"ckbuc31kh003f7cripdbu9fki","tag_id":"ckbuc31lh005h7criagn89cxk","_id":"ckbuc31n200ab7cri2am8c8rv"},{"post_id":"ckbuc31kh003f7cripdbu9fki","tag_id":"ckbuc31n100a57crixhsnn3y6","_id":"ckbuc31n300ad7cri14thiynt"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31n300ae7critoei6nm0"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","tag_id":"ckbuc31n100a67cri52vun2yb","_id":"ckbuc31n300ag7criwodkjc82"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31n300ah7cri1ttvelw3"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31n300aj7criksdomts6"},{"post_id":"ckbuc31ki003i7cric6z4dv4j","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31n300ak7cri6ae1qlot"},{"post_id":"ckbuc31kk003m7crioozovmlw","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31n400al7crie75q04wv"},{"post_id":"ckbuc31kk003m7crioozovmlw","tag_id":"ckbuc31n300af7crie857k9zj","_id":"ckbuc31n400an7criha9bff9k"},{"post_id":"ckbuc31kl003p7criaus9a59p","tag_id":"ckbuc31n300ai7criclpuwyl2","_id":"ckbuc31n500ar7criqsix7oiu"},{"post_id":"ckbuc31kl003p7criaus9a59p","tag_id":"ckbuc31n400am7crixbffcz09","_id":"ckbuc31n500as7cris4ip48yw"},{"post_id":"ckbuc31kl003p7criaus9a59p","tag_id":"ckbuc31n400ao7cripta9fi1p","_id":"ckbuc31n500au7crirugcgqag"},{"post_id":"ckbuc31kl003p7criaus9a59p","tag_id":"ckbuc31n400ap7cri24r3ijz5","_id":"ckbuc31n500av7cri2b0ddh0s"},{"post_id":"ckbuc31kn003t7crit1ysqrwz","tag_id":"ckbuc31n400aq7crikdq8tejz","_id":"ckbuc31n600ax7criv8uqu18m"},{"post_id":"ckbuc31kn003t7crit1ysqrwz","tag_id":"ckbuc31n500at7crin6k9kv8i","_id":"ckbuc31n600ay7crinp57dsrt"},{"post_id":"ckbuc31kn003t7crit1ysqrwz","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31n600b07criyvmmdhmc"},{"post_id":"ckbuc31kq003y7cric6segskw","tag_id":"ckbuc31n500aw7cril9lkwv01","_id":"ckbuc31n600b17crioo1fj5sn"},{"post_id":"ckbuc31kr00417cripwyhmo3f","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31n700b37cri0ei1260r"},{"post_id":"ckbuc31kr00417cripwyhmo3f","tag_id":"ckbuc31n600az7crinvzef04i","_id":"ckbuc31n700b47cri1yitymy9"},{"post_id":"ckbuc31kt00457crip8otm7fy","tag_id":"ckbuc31n600b27crio0e28k5z","_id":"ckbuc31n900ba7cribmlbbtpn"},{"post_id":"ckbuc31kt00457crip8otm7fy","tag_id":"ckbuc31mt009e7crig39l3m9m","_id":"ckbuc31n900bb7crim909yag2"},{"post_id":"ckbuc31kt00457crip8otm7fy","tag_id":"ckbuc31mi00817criqq6y42sw","_id":"ckbuc31n900bd7crivbuq3pu5"},{"post_id":"ckbuc31kt00457crip8otm7fy","tag_id":"ckbuc31n400aq7crikdq8tejz","_id":"ckbuc31na00be7crig7oqeqza"},{"post_id":"ckbuc31kt00457crip8otm7fy","tag_id":"ckbuc31n800b87criu3brnzpv","_id":"ckbuc31na00bg7cri7b46j6mz"},{"post_id":"ckbuc31ku00487crix4bmdywf","tag_id":"ckbuc31jx00267criy52cmgvh","_id":"ckbuc31na00bh7crizvatdto2"},{"post_id":"ckbuc31ku00487crix4bmdywf","tag_id":"ckbuc31n600az7crinvzef04i","_id":"ckbuc31na00bj7crieqem0quj"},{"post_id":"ckbuc31kv004c7crigzldkogf","tag_id":"ckbuc31n900bc7crixb1wv398","_id":"ckbuc31na00bk7crikaf1nb8a"},{"post_id":"ckbuc31kv004c7crigzldkogf","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31nb00bm7cridonjt7bi"},{"post_id":"ckbuc31kw004f7crih984hxmi","tag_id":"ckbuc31na00bf7crikc5acx1y","_id":"ckbuc31nb00bo7cri8babmi9d"},{"post_id":"ckbuc31kw004f7crih984hxmi","tag_id":"ckbuc31na00bi7criz4ap19kw","_id":"ckbuc31nb00bp7criqfxacsqi"},{"post_id":"ckbuc31kw004f7crih984hxmi","tag_id":"ckbuc31nb00bl7criinv0q3o7","_id":"ckbuc31nb00br7crilcw74xqz"},{"post_id":"ckbuc31ky004i7crid9fonrdp","tag_id":"ckbuc31ix000c7criwkxp64we","_id":"ckbuc31nc00bt7crilxmjbdq7"},{"post_id":"ckbuc31ky004i7crid9fonrdp","tag_id":"ckbuc31nb00bn7cri1qsr91he","_id":"ckbuc31nc00bu7cri61ufrjbi"},{"post_id":"ckbuc31ky004i7crid9fonrdp","tag_id":"ckbuc31nb00bq7cri9b9sx7xq","_id":"ckbuc31nc00bw7crivq6qnpbz"},{"post_id":"ckbuc31l0004l7cri97356dzf","tag_id":"ckbuc31nc00bs7cri0ppie6tq","_id":"ckbuc31ne00c07crik506yt17"},{"post_id":"ckbuc31l0004l7cri97356dzf","tag_id":"ckbuc31nc00bv7criqec4plth","_id":"ckbuc31ne00c17cri6elk2m6z"},{"post_id":"ckbuc31l0004l7cri97356dzf","tag_id":"ckbuc31nd00bx7crie0so3nxc","_id":"ckbuc31nf00c37crinzwugh0w"},{"post_id":"ckbuc31l0004l7cri97356dzf","tag_id":"ckbuc31nd00by7cri7ra8isfd","_id":"ckbuc31nf00c47crine6qw3gi"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31nd00bz7cri9r0e3yyi","_id":"ckbuc31nh00ca7cripvazwwns"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31ne00c27cri2xsfnjdi","_id":"ckbuc31nh00cb7cri26dvv0o6"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31nf00c57crijhxky4er","_id":"ckbuc31ni00cd7crin2s5mg9v"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31nf00c67criadn7hvin","_id":"ckbuc31ni00ce7cri1x77cqr7"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31ng00c77crinabj40il","_id":"ckbuc31nk00cg7cri468yjndt"},{"post_id":"ckbuc31l2004p7cri9k2kny2v","tag_id":"ckbuc31ng00c87criwbp82lt8","_id":"ckbuc31nl00ch7crie8cecle9"},{"post_id":"ckbuc31l4004t7cridjgyl6x1","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31nl00cj7crib35zcfq6"},{"post_id":"ckbuc31l4004t7cridjgyl6x1","tag_id":"ckbuc31nh00cc7crij3apyirz","_id":"ckbuc31nl00ck7criepoue9nu"},{"post_id":"ckbuc31l4004t7cridjgyl6x1","tag_id":"ckbuc31ni00cf7cricjw3g27m","_id":"ckbuc31nm00cm7cri13qd5k07"},{"post_id":"ckbuc31l6004w7crimwsffyta","tag_id":"ckbuc31nl00ci7cri0dn3poao","_id":"ckbuc31nm00cn7crihopt5151"},{"post_id":"ckbuc31l6004w7crimwsffyta","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31nm00cp7crii7nhxoy9"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31nn00ct7criwf8gu8za"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","tag_id":"ckbuc31nl00cl7criz8nk9m5l","_id":"ckbuc31no00cu7criipd9adqg"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","tag_id":"ckbuc31nm00co7crion7bocy8","_id":"ckbuc31no00cw7crio49td9j6"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","tag_id":"ckbuc31nm00cq7criskreql55","_id":"ckbuc31no00cx7critxjum4l0"},{"post_id":"ckbuc31l7004y7cri7ypfw8kr","tag_id":"ckbuc31nm00cr7criycv4rbqx","_id":"ckbuc31no00cz7cri3peizomh"},{"post_id":"ckbuc31lc00557crio1lfno1c","tag_id":"ckbuc31nn00cs7cri814gi80v","_id":"ckbuc31np00d27cri64ni871t"},{"post_id":"ckbuc31lc00557crio1lfno1c","tag_id":"ckbuc31no00cv7crisr7fw8qg","_id":"ckbuc31np00d37criprtr4xus"},{"post_id":"ckbuc31lc00557crio1lfno1c","tag_id":"ckbuc31no00cy7cri526uc0er","_id":"ckbuc31np00d57criozfmz4sg"},{"post_id":"ckbuc31lc00557crio1lfno1c","tag_id":"ckbuc31no00d07criz9txk6ji","_id":"ckbuc31np00d67criftf746yb"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31ji00167crijjdkjnba","_id":"ckbuc31nr00db7cri0mou5kl0"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31nr00dc7crih4alddnd"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31np00d17cri6298kwvs","_id":"ckbuc31ns00de7cri6hzlggpl"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31np00d47cri9ix5wbl2","_id":"ckbuc31ns00df7criseyzms5j"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31ns00dh7crifdmo9b7n"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31nq00d87crizt8aklao","_id":"ckbuc31ns00di7crijsjguytw"},{"post_id":"ckbuc31le005a7crib7dco3av","tag_id":"ckbuc31nq00d97crikys90b6d","_id":"ckbuc31ns00dk7cria25pxeai"},{"post_id":"ckbuc31lg005d7cripw8lc81s","tag_id":"ckbuc31nr00da7criggr3pudr","_id":"ckbuc31nt00dm7crif52i1mhk"},{"post_id":"ckbuc31lg005d7cripw8lc81s","tag_id":"ckbuc31nr00dd7cric3jitwng","_id":"ckbuc31nt00dn7crirotc2umd"},{"post_id":"ckbuc31lg005d7cripw8lc81s","tag_id":"ckbuc31ns00dg7crisaa0nhg9","_id":"ckbuc31nt00dp7criir4ksu4g"},{"post_id":"ckbuc31lg005d7cripw8lc81s","tag_id":"ckbuc31ns00dj7crirjtwzhgk","_id":"ckbuc31nt00dq7criertjsm5v"},{"post_id":"ckbuc31li005i7criqc75bneh","tag_id":"ckbuc31ns00dl7criihyip7r5","_id":"ckbuc31nv00du7crike3sb8ws"},{"post_id":"ckbuc31li005i7criqc75bneh","tag_id":"ckbuc31nt00do7cribojiht4h","_id":"ckbuc31nv00dv7criaglvff8g"},{"post_id":"ckbuc31li005i7criqc75bneh","tag_id":"ckbuc31nt00dr7cri7seqoy74","_id":"ckbuc31nv00dx7crigkhvnj0p"},{"post_id":"ckbuc31li005i7criqc75bneh","tag_id":"ckbuc31nu00ds7cri9w7b0x3n","_id":"ckbuc31nw00dy7crigo0ewyxs"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","tag_id":"ckbuc31nu00dt7criugf6nfq9","_id":"ckbuc31nz00e27criaq94q6t2"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","tag_id":"ckbuc31nv00dw7criidxry94f","_id":"ckbuc31nz00e37criba2i91dl"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","tag_id":"ckbuc31it00077cri1zzlbc0s","_id":"ckbuc31o000e57cri5f4dq0az"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","tag_id":"ckbuc31nw00dz7critbahbd7u","_id":"ckbuc31o000e67crif6lbzlpl"},{"post_id":"ckbuc31lk005l7cri0h0lifaw","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31o100e87criw14idspe"},{"post_id":"ckbuc31lq005s7critfsq9ygj","tag_id":"ckbuc31n900bc7crixb1wv398","_id":"ckbuc31o100e97criv1fr7asa"},{"post_id":"ckbuc31lq005s7critfsq9ygj","tag_id":"ckbuc31nz00e47criizr9m1r6","_id":"ckbuc31o100eb7cris10228ej"},{"post_id":"ckbuc31lt005v7cri78xsr5zh","tag_id":"ckbuc31n100a97cri7vi3x16u","_id":"ckbuc31o200ed7criazi7x3b9"},{"post_id":"ckbuc31lt005v7cri78xsr5zh","tag_id":"ckbuc31jq001o7cri2dww6rzx","_id":"ckbuc31o200ee7crizc4yv2n6"},{"post_id":"ckbuc31lt005v7cri78xsr5zh","tag_id":"ckbuc31o100ea7cri4ckoqshi","_id":"ckbuc31o200eg7crie8pk65gt"},{"post_id":"ckbuc31lw00607criqbkd7vzs","tag_id":"ckbuc31o200ec7cri63qolvw2","_id":"ckbuc31o300ej7crio8h6c82r"},{"post_id":"ckbuc31lw00607criqbkd7vzs","tag_id":"ckbuc31o200ef7criw0oonoe2","_id":"ckbuc31o300ek7crif7bivqri"},{"post_id":"ckbuc31lw00607criqbkd7vzs","tag_id":"ckbuc31o200eh7cri4unq3y8w","_id":"ckbuc31o400el7crixudtag48"},{"post_id":"ckbuc31lw00607criqbkd7vzs","tag_id":"ckbuc31o300ei7criaxj7hpjd","_id":"ckbuc31o400em7crii47mbjc6"}],"Tag":[{"name":"Serverless","_id":"ckbuc31it00077cri1zzlbc0s"},{"name":"Docker","_id":"ckbuc31ix000c7criwkxp64we"},{"name":"日記","_id":"ckbuc31j3000i7crid8a05o0g"},{"name":"LINE SDK","_id":"ckbuc31jg00117crixdsjugu4"},{"name":"AWS","_id":"ckbuc31ji00167crijjdkjnba"},{"name":"LINT","_id":"ckbuc31jl001c7crik2wx3sj6"},{"name":"Netflix","_id":"ckbuc31jo001i7cridsccyiqw"},{"name":"LINE","_id":"ckbuc31jq001o7cri2dww6rzx"},{"name":"Dev Day 2019","_id":"ckbuc31ju001w7criutd7ue15"},{"name":"chatbot","_id":"ckbuc31jx00267criy52cmgvh"},{"name":"Google","_id":"ckbuc31k3002l7cri982bj3vm"},{"name":"Dialogflow","_id":"ckbuc31k6002r7crit0upj3kv"},{"name":"Lambda","_id":"ckbuc31kc00347crigruvnlpl"},{"name":"Message API","_id":"ckbuc31kj003k7cri25jrlfos"},{"name":"Message api","_id":"ckbuc31kv004b7cri32vxbme3"},{"name":"python","_id":"ckbuc31la00517criyayltdxv"},{"name":"Richmenu","_id":"ckbuc31lh005h7criagn89cxk"},{"name":"CloudFormation","_id":"ckbuc31m7006w7crifjwcvv5v"},{"name":"S3","_id":"ckbuc31m900727criqyzqg06v"},{"name":"API gateway","_id":"ckbuc31m900747criei26noa9"},{"name":"Schedule","_id":"ckbuc31mb007b7crixcoetl2l"},{"name":"LINE Login","_id":"ckbuc31mc007g7crin82i8cmv"},{"name":"LIFF","_id":"ckbuc31mi00817criqq6y42sw"},{"name":"webview","_id":"ckbuc31mj00877cri66gamfu8"},{"name":"warm-up","_id":"ckbuc31mj008a7crisoj2dvxp"},{"name":"CDN","_id":"ckbuc31mk008f7crik2x65mss"},{"name":"Route 53","_id":"ckbuc31ml008i7criah2jnq7a"},{"name":"Certificate Manager","_id":"ckbuc31ml008k7criibus8xjk"},{"name":"CloudFront","_id":"ckbuc31mm008o7cri8ej99a12"},{"name":"Route53","_id":"ckbuc31mo008u7cri6qbwhz5g"},{"name":"richmenu","_id":"ckbuc31mo008w7cri3ucxux1p"},{"name":"Notify","_id":"ckbuc31mo008z7cris2fgug46"},{"name":"dotenv","_id":"ckbuc31ms009b7cri36ommj76"},{"name":"LINE Notify","_id":"ckbuc31mt009e7crig39l3m9m"},{"name":"SQS","_id":"ckbuc31mu009k7criyzd3rqtz"},{"name":"IAM","_id":"ckbuc31mx009r7cria89m3il0"},{"name":"Mysql","_id":"ckbuc31my009s7crijf9k9rwg"},{"name":"PHPMyadmin","_id":"ckbuc31my009v7cri1tz49hnc"},{"name":"Flex message","_id":"ckbuc31mz00a17crifheigofl"},{"name":"Provider","_id":"ckbuc31n100a57crixhsnn3y6"},{"name":"Icon Switch","_id":"ckbuc31n100a67cri52vun2yb"},{"name":"Python","_id":"ckbuc31n100a97cri7vi3x16u"},{"name":"operator","_id":"ckbuc31n300af7crie857k9zj"},{"name":"Streamlabs","_id":"ckbuc31n300ai7criclpuwyl2"},{"name":"Youtube","_id":"ckbuc31n400am7crixbffcz09"},{"name":"Stream","_id":"ckbuc31n400ao7cripta9fi1p"},{"name":"meetups","_id":"ckbuc31n400ap7cri24r3ijz5"},{"name":"Twitch","_id":"ckbuc31n400aq7crikdq8tejz"},{"name":"irc","_id":"ckbuc31n500at7crin6k9kv8i"},{"name":"TypeScript","_id":"ckbuc31n500aw7cril9lkwv01"},{"name":"meetup","_id":"ckbuc31n600az7crinvzef04i"},{"name":"LINE Bot","_id":"ckbuc31n600b27crio0e28k5z"},{"name":"Bottender","_id":"ckbuc31n800b87criu3brnzpv"},{"name":"Chatbot","_id":"ckbuc31n900bc7crixb1wv398"},{"name":"PlantUML","_id":"ckbuc31na00bf7crikc5acx1y"},{"name":"Hexo","_id":"ckbuc31na00bi7criz4ap19kw"},{"name":"VScode","_id":"ckbuc31nb00bl7criinv0q3o7"},{"name":"container","_id":"ckbuc31nb00bn7cri1qsr91he"},{"name":"docker-compose","_id":"ckbuc31nb00bq7cri9b9sx7xq"},{"name":"Promise","_id":"ckbuc31nc00bs7cri0ppie6tq"},{"name":"IIFE","_id":"ckbuc31nc00bv7criqec4plth"},{"name":"Arrow Function","_id":"ckbuc31nd00bx7crie0so3nxc"},{"name":"Callback","_id":"ckbuc31nd00by7cri7ra8isfd"},{"name":"node-gyp","_id":"ckbuc31nd00bz7cri9r0e3yyi"},{"name":"MacOS","_id":"ckbuc31ne00c27cri2xsfnjdi"},{"name":"Xcode","_id":"ckbuc31nf00c57crijhxky4er"},{"name":"jest","_id":"ckbuc31nf00c67criadn7hvin"},{"name":"npm","_id":"ckbuc31ng00c77crinabj40il"},{"name":"yarn","_id":"ckbuc31ng00c87criwbp82lt8"},{"name":"Class level","_id":"ckbuc31nh00cc7crij3apyirz"},{"name":"Instance level","_id":"ckbuc31ni00cf7cricjw3g27m"},{"name":"Sentry","_id":"ckbuc31nl00ci7cri0dn3poao"},{"name":"GCP","_id":"ckbuc31nl00cl7criz8nk9m5l"},{"name":"Azure","_id":"ckbuc31nm00co7crion7bocy8"},{"name":"Heroku","_id":"ckbuc31nm00cq7criskreql55"},{"name":"cold start","_id":"ckbuc31nm00cr7criycv4rbqx"},{"name":"Lint","_id":"ckbuc31nn00cs7cri814gi80v"},{"name":"Flake8","_id":"ckbuc31no00cv7crisr7fw8qg"},{"name":"SonarQube","_id":"ckbuc31no00cy7cri526uc0er"},{"name":"ESLint","_id":"ckbuc31no00d07criz9txk6ji"},{"name":"API Gateway","_id":"ckbuc31np00d17cri6298kwvs"},{"name":"Authorizer","_id":"ckbuc31np00d47cri9ix5wbl2"},{"name":"Amazon Web Service","_id":"ckbuc31nq00d87crizt8aklao"},{"name":"JWT","_id":"ckbuc31nq00d97crikys90b6d"},{"name":"PostgreSQL","_id":"ckbuc31nr00da7criggr3pudr"},{"name":"pgAdmin","_id":"ckbuc31nr00dd7cric3jitwng"},{"name":"SQL","_id":"ckbuc31ns00dg7crisaa0nhg9"},{"name":"DDL","_id":"ckbuc31ns00dj7crirjtwzhgk"},{"name":"核心型","_id":"ckbuc31ns00dl7criihyip7r5"},{"name":"應用型","_id":"ckbuc31nt00do7cribojiht4h"},{"name":"社群","_id":"ckbuc31nt00dr7cri7seqoy74"},{"name":"學習","_id":"ckbuc31nu00ds7cri9w7b0x3n"},{"name":"Swagger","_id":"ckbuc31nu00dt7criugf6nfq9"},{"name":"Flask","_id":"ckbuc31nv00dw7criidxry94f"},{"name":"Open Api","_id":"ckbuc31nw00dz7critbahbd7u"},{"name":"bottender","_id":"ckbuc31nz00e47criizr9m1r6"},{"name":"Lotify","_id":"ckbuc31o100ea7cri4ckoqshi"},{"name":"Http","_id":"ckbuc31o200ec7cri63qolvw2"},{"name":"SSL","_id":"ckbuc31o200ef7criw0oonoe2"},{"name":"OAuth","_id":"ckbuc31o200eh7cri4unq3y8w"},{"name":"OpenID","_id":"ckbuc31o300ei7criaxj7hpjd"}]}}